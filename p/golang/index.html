<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="An open-source programming language supported by Google."><title>Golang</title><link rel=canonical href=https://ilolicon.github.io/p/golang/><link rel=stylesheet href=/scss/style.min.abbd69b2908fdfcd5179898beaafd374514a86538d81639ddd2c58c06ae54e40.css><meta property="og:title" content="Golang"><meta property="og:description" content="An open-source programming language supported by Google."><meta property="og:url" content="https://ilolicon.github.io/p/golang/"><meta property="og:site_name" content="ilolicon's Blog"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="Cloud Native"><meta property="article:tag" content="Golang"><meta property="article:published_time" content="2021-06-29T17:03:46+08:00"><meta property="article:modified_time" content="2021-06-29T17:03:46+08:00"><meta name=twitter:title content="Golang"><meta name=twitter:description content="An open-source programming language supported by Google."><link rel="shortcut icon" href=/img/favicon.ico></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu96a5ab8e0364e843af4687201b687892_162934_300x0_resize_box_3.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>🍥</span></figure><div class=site-meta><h1 class=site-name><a href=/>ilolicon's Blog</a></h1><h2 class=site-description>Keep Calm and Carry On.</h2></div></header><ol class=social-menu><li><a href=https://github.com/ilolicon target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://twitter.com target=_blank title=Twitter rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><li><a href=/links/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg><span>Links</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>暗色模式</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#环境准备>环境准备</a><ol><li><a href=#安装>安装</a></li><li><a href=#配置>配置</a></li><li><a href=#编辑器>编辑器</a></li><li><a href=#运行程序>运行程序</a></li></ol></li><li><a href=#基本语法>基本语法</a><ol><li><a href=#基本结构>基本结构</a></li><li><a href=#简单示例>简单示例</a></li><li><a href=#基本组成元素>基本组成元素</a></li></ol></li><li><a href=#变量常量声明>变量常量声明</a><ol><li><a href=#变量声明>变量声明</a></li><li><a href=#常量声明>常量声明</a></li><li><a href=#const实现枚举>const实现枚举</a></li><li><a href=#计算赋值>计算赋值</a></li><li><a href=#简短声明>简短声明</a></li></ol></li><li><a href=#数据类型>数据类型</a><ol><li><a href=#基础数据类型>基础数据类型</a><ol><li><a href=#布尔类型>布尔类型</a></li><li><a href=#整数类型>整数类型</a></li><li><a href=#浮点类型>浮点类型</a></li><li><a href=#复数类型>复数类型</a></li><li><a href=#字符串类型>字符串类型</a></li><li><a href=#类型转换>类型转换</a></li><li><a href=#指针类型>指针类型</a></li></ol></li><li><a href=#复合数据类型>复合数据类型</a><ol><li><a href=#数组array>数组(array)</a></li><li><a href=#切片slice>切片(slice)</a></li><li><a href=#映射map>映射(map)</a></li><li><a href=#显示初始化值>显示初始化值</a></li></ol></li></ol></li><li><a href=#函数>函数</a><ol><li><a href=#功能>功能</a></li><li><a href=#定义调用>定义/调用</a><ol><li><a href=#函数名称>函数名称</a></li><li><a href=#函数参数形参>函数参数(形参)</a></li><li><a href=#返回值>返回值</a></li><li><a href=#函数调用>函数调用</a></li></ol></li><li><a href=#递归>递归</a></li><li><a href=#函数类型>函数类型</a></li><li><a href=#匿名函数>匿名函数</a></li><li><a href=#闭包>闭包</a></li><li><a href=#类型>类型</a><ol><li><a href=#值类型>值类型</a></li><li><a href=#引用类型>引用类型</a></li></ol></li><li><a href=#值传递>值传递</a></li><li><a href=#错误处理>错误处理</a><ol><li><a href=#panic抛出错误>panic抛出错误</a></li><li><a href=#捕获错误>捕获错误</a></li><li><a href=#延迟执行>延迟执行</a></li><li><a href=#defer注意事项>defer注意事项</a></li></ol></li></ol></li><li><a href=#作用域>作用域</a><ol><li><a href=#显式作用域>显式作用域</a></li></ol></li><li><a href=#隐式作用域>隐式作用域</a></li><li><a href=#流程控制>流程控制</a><ol><li><a href=#if>if</a></li><li><a href=#switch>switch</a></li><li><a href=#for>for</a></li><li><a href=#goto>goto</a></li></ol></li><li><a href=#单步调试工具-dlv>单步调试工具 dlv</a></li><li><a href=#包管理模块>包管理/模块</a><ol><li><a href=#gopath--vendor>GOPATH + vendor</a></li><li><a href=#module>MODULE</a></li></ol></li><li><a href=#导入总结>导入总结</a><ol><li><a href=#init函数>init函数</a><ol><li><a href=#可见性>可见性</a></li></ol></li></ol></li><li><a href=#标准库及第三方库>标准库及第三方库</a><ol><li><a href=#fmt>fmt</a></li><li><a href=#strconv>strconv</a></li><li><a href=#strings>strings</a></li><li><a href=#sync>sync</a><ol><li><a href=#syncatomic>sync.atomic</a></li><li><a href=#syncmutexrwmutex>sync.Mutex/RWMutex</a></li><li><a href=#syncmap>sync.Map</a></li><li><a href=#synconce>sync.Once</a></li><li><a href=#syncpool>sync.Pool</a></li></ol></li><li><a href=#runtime>runtime</a></li><li><a href=#logr>logr</a><ol><li><a href=#logrus>logrus</a></li><li><a href=#zap>zap</a></li></ol></li></ol></li><li><a href=#面向对象>面向对象</a><ol><li><a href=#自定义类型>自定义类型</a></li><li><a href=#定义>定义</a></li><li><a href=#别名与重定义>别名与重定义</a></li><li><a href=#结构体>结构体</a></li><li><a href=#匿名结构体>匿名结构体</a></li><li><a href=#new-和-make的区别>new 和 make的区别</a></li><li><a href=#结构体嵌套嵌入组合>结构体嵌套(嵌入/组合)</a></li><li><a href=#方法>方法</a><ol><li><a href=#定义-1>定义</a></li><li><a href=#可见性-1>可见性</a></li><li><a href=#方法表达式>方法表达式</a></li><li><a href=#方法值>方法值</a></li></ol></li></ol></li><li><a href=#文件操作>文件操作</a><ol><li><a href=#文件路径>文件路径</a></li><li><a href=#操作>操作</a></li><li><a href=#目录操作>目录操作</a></li><li><a href=#文件操作有关工具类>文件操作有关工具类</a></li><li><a href=#带缓冲区io>带缓冲区IO</a></li><li><a href=#几个结构体>几个结构体</a></li><li><a href=#文件格式>文件格式</a><ol><li><a href=#gob>gob</a></li><li><a href=#csv>csv</a></li></ol></li></ol></li><li><a href=#接口>接口</a><ol><li><a href=#定义赋值>定义/赋值</a></li><li><a href=#结构体赋值接口类型>结构体赋值接口类型</a></li><li><a href=#接口赋值接口>接口赋值接口</a></li><li><a href=#类型断言>类型断言</a></li><li><a href=#多个类型断言>多个类型断言</a></li><li><a href=#接口嵌入>接口嵌入</a></li><li><a href=#匿名接口>匿名接口</a></li><li><a href=#空接口及其使用>空接口及其使用</a></li></ol></li><li><a href=#json序列化反序列化>Json序列化/反序列化</a><ol><li><a href=#encodingjson>encoding/json</a></li><li><a href=#基本数据类型json-转换>基本数据类型/json 转换</a></li><li><a href=#自定义数据类型json转换>自定义数据类型/json转换</a></li><li><a href=#自定义嵌入结构体-转换>自定义嵌入结构体 转换</a></li><li><a href=#jsonvalid>json.Valid</a></li><li><a href=#对流的操作>对流的操作</a></li><li><a href=#jsonrawmessage>json.RawMessage</a></li><li><a href=#marshaljsonunmarshaljson>MarshalJSON/UnmarshalJSON</a></li></ol></li><li><a href=#反射>反射</a><ol><li><a href=#通过反射实现简单的orm>通过反射实现简单的ORM</a></li></ol></li><li><a href=#go并发>Go并发</a><ol><li><a href=#主例程>主例程</a></li><li><a href=#计数信号量waitgroup>计数信号量/WaitGroup</a></li><li><a href=#闭包陷阱>闭包陷阱</a></li><li><a href=#并发通信加锁>并发通信/加锁</a></li><li><a href=#并发通信管道>并发通信/管道</a><ol><li><a href=#channel实现waitgroup>channel实现WaitGroup</a></li><li><a href=#带缓冲区channel>带缓冲区channel</a></li><li><a href=#关闭管道>关闭管道</a></li><li><a href=#管道循环>管道循环</a></li><li><a href=#并发下载图片示例>并发下载图片示例</a></li><li><a href=#管道类型读写管道>管道类型/读写管道</a></li><li><a href=#selectcase>selectcase</a></li><li><a href=#示例>示例</a></li><li><a href=#context上下文>context上下文</a></li></ol></li><li><a href=#简单的socketserver>简单的SocketServer</a><ol><li><a href=#servergo>server.go</a></li><li><a href=#clientgo>client.go</a></li></ol></li></ol></li><li><a href=#go使用私有仓库>Go使用私有仓库</a></li><li><a href=#reference-link>Reference Link</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/golang/ style=background-color:#38a8d2;color:#fff>Golang</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/golang/>Golang</a></h2><h3 class=article-subtitle>An open-source programming language supported by Google.</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Jun 29, 2021</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>阅读时长: 85 分钟</time></div></footer></div></header><section class=article-content><h2 id=环境准备>环境准备</h2><h3 id=安装>安装</h3><p><a class=link href=https://golang.google.cn/ target=_blank rel=noopener>官网下载安装</a></p><ul><li>Windwos下载go.msi安装</li><li>Linux下载go.tar.gz</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>解压: tar -xzvf go.tar.gz -C /usr/local/
</span></span><span class=line><span class=cl>配置环境变量<span class=o>(</span>windows安装会自动配置<span class=o>)</span>
</span></span><span class=line><span class=cl>  go <span class=nv>$PATH</span>
</span></span><span class=line><span class=cl>  <span class=nv>GOROOT</span> <span class=o>=</span>&gt; go安装路径
</span></span><span class=line><span class=cl>  <span class=nv>GOPATH</span> <span class=o>=</span>&gt; <span class=nv>$HOME</span>/go
</span></span></code></pre></td></tr></table></div></div><h3 id=配置>配置</h3><p><a class=link href=https://goproxy.cn/ target=_blank rel=noopener>Go模块代理</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>GO111MODULE</span><span class=o>=</span>on    <span class=c1># go模块管理</span>
</span></span><span class=line><span class=cl><span class=nv>GOPROXY</span><span class=o>=</span>https://goproxy.cn,direct  <span class=c1># 下载第三方包网络有问题的时候设置代理</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Windows</span>
</span></span><span class=line><span class=cl>1. 直接配置到环境变量<span class=o>(</span>优先级高<span class=o>)</span> <span class=o>=</span>&gt; 系统 - 高级设置 - 新增环境变量
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. 配置到go env
</span></span><span class=line><span class=cl>   go env -w <span class=nv>GO111MODULE</span><span class=o>=</span>on  <span class=c1># 写入go环境变量</span>
</span></span><span class=line><span class=cl>   go env -w <span class=nv>GOPROXY</span><span class=o>=</span>https://goproxy.cn,direct
</span></span><span class=line><span class=cl>           
</span></span><span class=line><span class=cl><span class=c1># Linux </span>
</span></span><span class=line><span class=cl><span class=c1># 配置脚本 /etc/profile.d/go.sh</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[[</span> <span class=s2>&#34;x&#34;</span> <span class=o>==</span> <span class=s2>&#34;x</span><span class=si>${</span><span class=nv>GOROOT</span><span class=si>}</span><span class=s2>&#34;</span> <span class=o>]]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nb>export</span> <span class=nv>GOROOT</span><span class=o>=</span>/usr/local/go
</span></span><span class=line><span class=cl>    <span class=nb>export</span> <span class=nv>GOPATH</span><span class=o>=</span><span class=si>${</span><span class=nv>HOME</span><span class=si>}</span>/go
</span></span><span class=line><span class=cl>    <span class=nb>export</span> <span class=nv>PATH</span><span class=o>=</span><span class=si>${</span><span class=nv>PATH</span><span class=si>}</span>:<span class=si>${</span><span class=nv>GOROOT</span><span class=si>}</span>/bin:<span class=si>${</span><span class=nv>GOPATH</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=编辑器>编辑器</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vscode + 插件即可
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ctrl + <span class=nb>shift</span> + p -&gt; go install/update tools -&gt; 全选安装插件
</span></span></code></pre></td></tr></table></div></div><h3 id=运行程序>运行程序</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// go工具链
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>go</span> <span class=nx>build</span> <span class=nx>hello</span><span class=p>.</span><span class=k>go</span> <span class=c1>// 编译
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>go</span> <span class=nx>run</span> <span class=nx>hello</span><span class=p>.</span><span class=k>go</span>   <span class=c1>// 编译+运行
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=err>常用参数：</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=nx>x</span>    <span class=c1>// 打印执行命令
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>-</span><span class=nx>n</span>    <span class=c1>// 只打印编译过程 并不执行
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>-</span><span class=nx>o</span>    <span class=c1>// 执行程序输出名称
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>-</span><span class=nx>work</span> <span class=c1>// 保留工作目录
</span></span></span></code></pre></td></tr></table></div></div><h2 id=基本语法>基本语法</h2><h3 id=基本结构>基本结构</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=cm>/* 
</span></span></span><span class=line><span class=cl><span class=cm>声明包 go要求每个源码都有属于的包
</span></span></span><span class=line><span class=cl><span class=cm>格式：package 包名
</span></span></span><span class=line><span class=cl><span class=cm>包名：目前阶段定义为main
</span></span></span><span class=line><span class=cl><span class=cm>声明包必须在源码的第一行 包声明前面可以包含注释
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 导入包：使用标准包或第三方包需要先导入
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 目前阶段认为 main函数为程序入口
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Hello, Golang&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=简单示例>简单示例</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// var 定义变量r 类型为float64 值为10
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>var</span> <span class=nx>r</span> <span class=kt>float64</span> <span class=p>=</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>confirm</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// const定义常量
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>const</span> <span class=nx>pi</span> <span class=kt>float64</span> <span class=p>=</span> <span class=mf>3.1415926</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 从控制台上读取数据
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Print</span><span class=p>(</span><span class=s>&#34;请输入半径：&#34;</span><span class=p>)</span> <span class=c1>// 打印内容之后不会加换行
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Scan</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>r</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 计算圆形面积
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>pi</span> <span class=o>*</span> <span class=nx>r</span> <span class=o>*</span> <span class=nx>r</span><span class=p>)</span> <span class=c1>// 打印内容之后自动换行
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=c1>// 从控制台接收是否继续的数据
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Print</span><span class=p>(</span><span class=s>&#34;是否继续(y/n)?&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Scan</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>confirm</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nx>confirm</span> <span class=o>!=</span> <span class=s>&#34;y&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=基本组成元素>基本组成元素</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>1. 标识符
</span></span><span class=line><span class=cl>2. 关键字
</span></span><span class=line><span class=cl>3. 字面量
</span></span><span class=line><span class=cl>4. 操作符
</span></span><span class=line><span class=cl>5. 分隔符
</span></span></code></pre></td></tr></table></div></div><h2 id=变量常量声明>变量常量声明</h2><h3 id=变量声明>变量声明</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 变量声明: var
</span></span></span><span class=line><span class=cl><span class=c1>// var 标识符 类型
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 定义全局变量
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>version</span> <span class=kt>string</span> <span class=p>=</span> <span class=s>&#34;1.1.1&#34;</span> <span class=c1>// 显示赋值
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// go中要求局部变量定义后必须使用
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 定义局部变量
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 未对局部变量进行显示复制 go会对变量设置默认值(零值)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// string 零值： 空字符串 &#34;&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>var</span> <span class=nx>funcVersion</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 省略类型 帮你徐显示设置默认值 go根据字面量或赋值的值类型进行推导
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>var</span> <span class=nx>name</span> <span class=p>=</span> <span class=s>&#34;minho&#34;</span> <span class=c1>// =&gt; var name string = &#34;minho&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 批量定义 没设置默认值需要指定类型 设置默认值可以不指定类型
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>var</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=nx>a1</span>      <span class=kt>int</span>
</span></span><span class=line><span class=cl>        <span class=nx>a2</span>      <span class=kt>string</span>
</span></span><span class=line><span class=cl>        <span class=nx>a3</span>      <span class=kt>int</span>    <span class=p>=</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl>        <span class=nx>a4</span>      <span class=kt>string</span> <span class=p>=</span> <span class=s>&#34;aaa&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nx>a5</span>             <span class=p>=</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl>        <span class=nx>a6</span>             <span class=p>=</span> <span class=s>&#34;666&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nx>a9</span><span class=p>,</span> <span class=nx>a10</span> <span class=kt>int</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>a7</span><span class=p>,</span> <span class=nx>a8</span> <span class=kt>string</span> <span class=c1>// 类型一样
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>var</span> <span class=nx>a11</span><span class=p>,</span> <span class=nx>a12</span> <span class=kt>string</span> <span class=p>=</span> <span class=s>&#34;a11&#34;</span><span class=p>,</span> <span class=s>&#34;a12&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>funcVersion</span><span class=p>,</span> <span class=nx>version</span><span class=p>,</span> <span class=nx>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>a1</span><span class=p>,</span> <span class=nx>a2</span><span class=p>,</span> <span class=nx>a3</span><span class=p>,</span> <span class=nx>a4</span><span class=p>,</span> <span class=nx>a5</span><span class=p>,</span> <span class=nx>a6</span><span class=p>,</span> <span class=nx>a7</span><span class=p>,</span> <span class=nx>a8</span><span class=p>,</span> <span class=nx>a9</span><span class=p>,</span> <span class=nx>a10</span><span class=p>,</span> <span class=nx>a11</span><span class=p>,</span> <span class=nx>a12</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=常量声明>常量声明</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 常量声明: const
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>const</span> <span class=nx>version</span> <span class=kt>string</span> <span class=p>=</span> <span class=s>&#34;2.2.2&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 常量必须显示设置默认值(因为常量定义之后就不能修改)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>const</span> <span class=nx>funcVersion</span> <span class=kt>string</span> <span class=p>=</span> <span class=s>&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>const</span> <span class=nx>pi</span> <span class=p>=</span> <span class=mf>3.141592653</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>const</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=nx>a1</span>     <span class=kt>string</span> <span class=p>=</span> <span class=s>&#34;222222&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nx>a2</span>     <span class=kt>int</span>    <span class=p>=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>        <span class=nx>a3</span><span class=p>,</span> <span class=nx>a4</span> <span class=kt>string</span> <span class=p>=</span> <span class=s>&#34;1&#34;</span><span class=p>,</span> <span class=s>&#34;2&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>const</span> <span class=nx>a5</span><span class=p>,</span> <span class=nx>a6</span> <span class=p>=</span> <span class=s>&#34;111&#34;</span><span class=p>,</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>const</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=nx>e1</span> <span class=p>=</span> <span class=s>&#34;aaa&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nx>e2</span> <span class=c1>// const里面 只定义标识符 使用上一行的常量标识符的值来进行赋值
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>e3</span>
</span></span><span class=line><span class=cl>        <span class=nx>e4</span>
</span></span><span class=line><span class=cl>        <span class=nx>e5</span> <span class=p>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=nx>e6</span>
</span></span><span class=line><span class=cl>        <span class=nx>e7</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>version</span><span class=p>,</span> <span class=nx>funcVersion</span><span class=p>,</span> <span class=nx>pi</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>a1</span><span class=p>,</span> <span class=nx>a2</span><span class=p>,</span> <span class=nx>a3</span><span class=p>,</span> <span class=nx>a4</span><span class=p>,</span> <span class=nx>a5</span><span class=p>,</span> <span class=nx>a6</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>e1</span><span class=p>,</span> <span class=nx>e2</span><span class=p>,</span> <span class=nx>e3</span><span class=p>,</span> <span class=nx>e4</span><span class=p>,</span> <span class=nx>e5</span><span class=p>,</span> <span class=nx>e6</span><span class=p>,</span> <span class=nx>e7</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=const实现枚举>const实现枚举</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// const + iota实现枚举
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>const</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=nx>e1</span> <span class=p>=</span> <span class=kc>iota</span> <span class=c1>// 0  iota 在小括号内初始化为0 每调用一次+1
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>e2</span>        <span class=c1>// 1
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>e3</span>        <span class=c1>// 2
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// enum 枚举 e.g: 星期几 1、2、3、4、5、6、7
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// iota 结合const使用
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>const</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=nx>a1</span> <span class=p>=</span> <span class=kc>iota</span> <span class=c1>// 0  在每个小括号内都会初始化
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>a2</span>
</span></span><span class=line><span class=cl>        <span class=nx>a3</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>e1</span><span class=p>,</span> <span class=nx>e2</span><span class=p>,</span> <span class=nx>e3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>a1</span><span class=p>,</span> <span class=nx>a2</span><span class=p>,</span> <span class=nx>a3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=计算赋值>计算赋值</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 变量赋值：可以通过任意表达式计算结果赋值
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>var</span> <span class=nx>a1</span> <span class=p>=</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>a2</span> <span class=p>=</span> <span class=nx>a1</span> <span class=o>+</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>a3</span> <span class=p>=</span> <span class=nx>a1</span> <span class=o>+</span> <span class=nx>a2</span> <span class=c1>// 变量/常量赋值 除了字面量 还可以是表达式
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 常量赋值：只能通过字面量/字面量计算结果/常量计算结果/常量经过某些函数计算的结果 赋值
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>const</span> <span class=nx>e1</span> <span class=p>=</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl>    <span class=kd>const</span> <span class=nx>e2</span> <span class=p>=</span> <span class=nx>e1</span> <span class=o>+</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl>    <span class=kd>const</span> <span class=nx>e3</span> <span class=p>=</span> <span class=nx>e1</span> <span class=o>*</span> <span class=nx>e2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>a4</span> <span class=p>=</span> <span class=nx>a3</span> <span class=o>+</span> <span class=nx>e3</span>
</span></span><span class=line><span class=cl>    <span class=c1>// const a4 = a3 + e3  // 报错 a3是变量的计算结果
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>a3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>e3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>a4</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=简短声明>简短声明</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// var xx int
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 简短声明：通过值来推导标识符类型
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 问题：
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 简短声明只能用在局部
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 多种数据类型使用同一个字面量标识 只能推导为默认类型
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 比如：整数 byte int int8 int16 int32 int 64 unit
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>name</span> <span class=o>:=</span> <span class=s>&#34;minho&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nx>id</span> <span class=o>:=</span> <span class=mi>1</span> <span class=c1>// 只能默认推导为int 如果想定义id为int64 不能使用简短类型
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>name</span><span class=p>,</span> <span class=nx>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=数据类型>数据类型</h2><h3 id=基础数据类型>基础数据类型</h3><h4 id=布尔类型>布尔类型</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=err>含义：</span>        <span class=err>表示真假</span>
</span></span><span class=line><span class=cl><span class=err>类型名</span><span class=p>(</span><span class=err>标识符</span><span class=p>)</span><span class=err>：</span><span class=kt>bool</span>
</span></span><span class=line><span class=cl><span class=err>初始化零值：</span>   <span class=kc>false</span>
</span></span><span class=line><span class=cl><span class=err>内存占用：</span>     <span class=mi>1</span><span class=err>个字节</span>
</span></span><span class=line><span class=cl><span class=err>值：</span>          <span class=kc>true</span><span class=p>(</span><span class=err>真</span><span class=p>)</span><span class=o>/</span><span class=kc>false</span><span class=p>(</span><span class=err>假</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>逻辑运算操作：</span>
</span></span><span class=line><span class=cl>  <span class=err>与</span> <span class=o>&amp;&amp;</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>expr1</span> <span class=o>&amp;&amp;</span> <span class=nx>expr2</span>
</span></span><span class=line><span class=cl>  <span class=err>或</span> <span class=o>||</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>expr1</span> <span class=o>||</span> <span class=nx>expr2</span>
</span></span><span class=line><span class=cl>  <span class=err>非</span> <span class=err>！</span> <span class=o>-</span><span class=p>&gt;</span> <span class=p>!</span><span class=nx>expr</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl><span class=err>关系运算：</span>
</span></span><span class=line><span class=cl>  <span class=err>等于</span>    <span class=o>-</span><span class=p>&gt;</span> <span class=o>==</span>
</span></span><span class=line><span class=cl>  <span class=err>不等于</span>  <span class=o>-</span><span class=p>&gt;</span> <span class=o>!=</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=整数类型>整数类型</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=err>整数</span><span class=p>:</span> 
</span></span><span class=line><span class=cl>    <span class=mi>1</span><span class=err>字节：</span><span class=mo>0000</span> <span class=mo>0000</span>
</span></span><span class=line><span class=cl>    <span class=err>有符号：可正</span><span class=o>/</span><span class=err>可负</span> <span class=o>-</span><span class=p>&gt;</span> <span class=err>首位：</span> <span class=mi>1</span><span class=err>负</span> <span class=mi>0</span><span class=err>正</span>
</span></span><span class=line><span class=cl>          <span class=mo>000</span> <span class=mo>0000</span> <span class=o>-</span><span class=mi>2</span><span class=p>^(</span><span class=nx>n</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=err>~</span> <span class=mi>2</span><span class=p>^(</span><span class=nx>n</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=err>无符号：只表示</span><span class=p>&gt;</span><span class=mi>0</span>
</span></span><span class=line><span class=cl>          <span class=mo>0000</span> <span class=mo>0000</span>
</span></span><span class=line><span class=cl>          <span class=mi>0</span> <span class=err>~</span> <span class=mi>2</span><span class=p>^</span><span class=nx>n</span> <span class=o>-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>          <span class=mi>0</span> <span class=err>~</span> <span class=mi>255</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=kt>int</span><span class=o>/</span><span class=kt>uint</span>     <span class=c1>// 32位机器=&gt;4字节 64位机器=&gt;8字节
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>byte</span>         <span class=c1>// 1字节  字节类型  ascii字符 -&gt; 整数
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>rune</span>         <span class=c1>// 32字节 码点     unicode编码表 字符 -&gt; 整数
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int8</span><span class=o>/</span><span class=kt>uint8</span>   <span class=c1>// 1字节 u开头的 无符号
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int16</span><span class=o>/</span><span class=kt>uint16</span> <span class=c1>// 2字节
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int32</span><span class=o>/</span><span class=kt>uint32</span> <span class=c1>// 4字节
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int64</span><span class=o>/</span><span class=kt>uint64</span> <span class=c1>// 8字节
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>uintptr</span>      <span class=c1>// 32位机器=&gt;4字节 64位机器=&gt;8字节
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=err>零值：</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=err>字面量</span><span class=p>:</span> <span class=err>各种进制表示</span>
</span></span><span class=line><span class=cl><span class=err>操作：</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=err>算术运算</span> <span class=o>+</span> <span class=o>-</span> <span class=o>*</span> <span class=o>/</span> <span class=o>%</span> <span class=o>++</span> <span class=o>--</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=err>关系运算</span> <span class=p>&gt;</span> <span class=p>&lt;</span> <span class=o>&lt;=</span> <span class=o>&gt;=</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=err>赋值运算</span> <span class=p>=</span> <span class=o>+=</span> <span class=o>-+</span> <span class=o>*=</span> <span class=o>/=</span> <span class=o>%=</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=o>+</span> <span class=kt>int64</span> <span class=o>-</span><span class=p>&gt;</span> <span class=err>强制类型转换：</span><span class=nb>int</span><span class=p>(</span><span class=nx>xx1</span><span class=p>)</span> <span class=o>+</span> <span class=nx>xx2</span>
</span></span><span class=line><span class=cl>               <span class=err>小范围</span> <span class=o>-</span><span class=p>&gt;</span> <span class=err>大范围</span> <span class=err>肯定无问题</span>
</span></span><span class=line><span class=cl>               <span class=err>大范围</span> <span class=o>-</span><span class=p>&gt;</span> <span class=err>小范围</span> <span class=err>可能被截断</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=浮点类型>浮点类型</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 小数
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=err>类型名：</span>
</span></span><span class=line><span class=cl>  <span class=kt>float32</span> <span class=o>-</span><span class=p>&gt;</span> <span class=mi>32</span><span class=err>位</span><span class=p>(</span><span class=mi>4</span><span class=err>字节</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kt>float64</span> <span class=o>-</span><span class=p>&gt;</span> <span class=mi>64</span><span class=err>位</span><span class=p>(</span><span class=mi>8</span><span class=err>字节</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=err>零值：</span><span class=mf>0.0</span> <span class=o>-</span><span class=p>&gt;</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=err>字面量：十进制的小数</span>
</span></span><span class=line><span class=cl><span class=err>操作：</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=err>算术运算</span> <span class=o>+</span> <span class=o>-</span> <span class=o>*</span> <span class=o>/</span> <span class=o>++</span> <span class=o>--</span> 
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=err>关系运算</span> <span class=p>&gt;</span> <span class=p>&lt;</span> <span class=o>&lt;=</span> <span class=o>&gt;=</span> 
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=err>浮点数：等于</span><span class=o>/</span><span class=err>不等于</span> <span class=p>|</span><span class=nx>a</span><span class=o>-</span><span class=nx>b</span><span class=p>|&lt;</span><span class=err>精度</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=err>赋值运算</span> <span class=p>=</span> <span class=o>+=</span> <span class=o>-+</span> <span class=o>*=</span> <span class=o>/=</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// %f 修饰
</span></span></span><span class=line><span class=cl><span class=c1>// %n.mf =&gt; n占位 m小数点保留位数(精度)
</span></span></span></code></pre></td></tr></table></div></div><h4 id=复数类型>复数类型</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 略
</span></span></span></code></pre></td></tr></table></div></div><h4 id=字符串类型>字符串类型</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=err>零值：</span><span class=s>&#34;&#34;</span> <span class=err>空字符串</span>
</span></span><span class=line><span class=cl><span class=err>字面量：</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=err>可解析字符串：</span> <span class=s>&#34;双引号&#34;</span> 
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=err>原生字符串：</span> <span class=s>`反引号`</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>特殊字符：</span>
</span></span><span class=line><span class=cl>    <span class=err>\</span><span class=nx>t</span> <span class=nx>tab</span>
</span></span><span class=line><span class=cl>    <span class=err>\</span><span class=nx>r</span> <span class=err>回车</span>
</span></span><span class=line><span class=cl>    <span class=err>\</span><span class=nx>n</span> <span class=err>换行</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>操作：</span>
</span></span><span class=line><span class=cl>  <span class=err>字符串连接：</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>  <span class=err>关系运算：</span>
</span></span><span class=line><span class=cl>    <span class=p>&gt;</span> <span class=o>&gt;=</span> <span class=p>&lt;</span> <span class=o>&lt;=</span> <span class=o>==</span> <span class=o>!=</span>
</span></span><span class=line><span class=cl>    <span class=err>从左边第一个元素开始比较</span><span class=p>(</span><span class=kt>byte</span><span class=p>)</span> <span class=err>不能确定继续比较下一个操作</span>
</span></span><span class=line><span class=cl>  <span class=err>赋值运算：</span>
</span></span><span class=line><span class=cl>    <span class=p>=</span>
</span></span><span class=line><span class=cl>    <span class=o>+=</span> 
</span></span><span class=line><span class=cl>  <span class=err>索引操作</span> <span class=p>=&gt;</span> <span class=kt>byte</span>
</span></span><span class=line><span class=cl>  <span class=err>切片操作</span> <span class=p>=&gt;</span> <span class=kt>byte</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>desc</span> <span class=kt>string</span> <span class=p>=</span> <span class=s>&#34;a\nb&#34;</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>desc2</span> <span class=kt>string</span> <span class=p>=</span> <span class=s>&#34;a\\nb&#34;</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>raw</span> <span class=kt>string</span> <span class=p>=</span> <span class=s>`a\nb`</span> <span class=c1>// 原生字符串可以包含多行
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>var</span> <span class=nx>raw2</span> <span class=kt>string</span> <span class=p>=</span> <span class=s>`
</span></span></span><span class=line><span class=cl><span class=s>    a\nb
</span></span></span><span class=line><span class=cl><span class=s>    fffds
</span></span></span><span class=line><span class=cl><span class=s>    adadw
</span></span></span><span class=line><span class=cl><span class=s>    weqejnfjsag
</span></span></span><span class=line><span class=cl><span class=s>    `</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>desc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>desc2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>raw</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>raw2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>s</span> <span class=o>:=</span> <span class=s>&#34;我叫&#34;</span> <span class=o>+</span> <span class=s>&#34;minho&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 索引： 0，1，2：我 3，4，5：叫 6：m ...
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 索引操作和切片操作 一定要注意字符串的编码
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 切片的时候 如果是非ascii码的话 可能会产生乱码
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>s</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %c\n&#34;</span><span class=p>,</span> <span class=nx>s</span><span class=p>[</span><span class=mi>6</span><span class=p>],</span> <span class=nx>s</span><span class=p>[</span><span class=mi>6</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>s</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>5</span><span class=p>])</span> <span class=c1>// 我�� 乱码
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%s\n&#34;</span><span class=p>,</span> <span class=nx>raw</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>$</span> <span class=k>go</span> <span class=nx>run</span> <span class=kt>string</span><span class=p>.</span><span class=k>go</span> 
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=nx>a</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=nx>b</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=nx>a</span><span class=err>\</span><span class=nx>nb</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=nx>a</span><span class=err>\</span><span class=nx>nb</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nx>a</span><span class=err>\</span><span class=nx>nb</span>       
</span></span><span class=line><span class=cl>        <span class=nx>fffds</span>      
</span></span><span class=line><span class=cl>        <span class=nx>adadw</span>      
</span></span><span class=line><span class=cl>        <span class=nx>weqejnfjsag</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=err>我叫</span><span class=nx>minho</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=mi>136</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=kt>uint8</span><span class=p>,</span> <span class=nx>m</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=err>我��</span> 
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=nx>a</span><span class=err>\</span><span class=nx>nb</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 重要: 索引和切片的时候 自己保证编码内容为ascii
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;unicode/utf8&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>txt</span> <span class=o>:=</span> <span class=s>&#34;我爱中华人名共和国!&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 获取字符串长度 len =&gt; 字节数量
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>txt</span><span class=p>))</span>                    <span class=c1>// 27
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>utf8</span><span class=p>.</span><span class=nf>RuneCountInString</span><span class=p>(</span><span class=nx>txt</span><span class=p>))</span> <span class=c1>// 10 获取字符长度
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 索引 切片
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%c\n&#34;</span><span class=p>,</span> <span class=nx>txt</span><span class=p>[</span><span class=mi>27</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=c1>// txt[27] = &#34;%&#34; // 字符串不可变 不能赋值
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 遍历 for range
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=nx>key</span><span class=p>,</span> <span class=nx>value</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>txt</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%d: %T, %c\n&#34;</span><span class=p>,</span> <span class=nx>key</span><span class=p>,</span> <span class=nx>value</span><span class=p>,</span> <span class=nx>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 切片 byte []byte
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 切片 rune []rune
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>bs</span> <span class=o>:=</span> <span class=p>[]</span><span class=nb>byte</span><span class=p>(</span><span class=nx>txt</span><span class=p>)</span> <span class=c1>// 类型转换 类似 int(&#39;32&#39;) 字节数量
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>rs</span> <span class=o>:=</span> <span class=p>[]</span><span class=nb>rune</span><span class=p>(</span><span class=nx>txt</span><span class=p>)</span> <span class=c1>// 字符的数量 可以转换为rune切片 再计算length
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>bs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>rs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// rune/byte 切片转字符串类型
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>string</span><span class=p>(</span><span class=nx>bs</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>string</span><span class=p>(</span><span class=nx>rs</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=类型转换>类型转换</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 类型转换
</span></span></span><span class=line><span class=cl><span class=c1>// &#34;123&#34; -&gt; int
</span></span></span><span class=line><span class=cl><span class=c1>// int -&gt; string
</span></span></span><span class=line><span class=cl><span class=c1>// &#34;12.2&#34; -&gt; float64
</span></span></span><span class=line><span class=cl><span class=c1>// float -&gt; string
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=err>包：</span><span class=nx>strconv</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=指针类型>指针类型</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>num</span> <span class=kt>int</span> <span class=p>=</span> <span class=mi>65</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>num1</span> <span class=o>:=</span> <span class=nx>num</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 修改
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>num1</span> <span class=p>=</span> <span class=mi>165</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 对num有无影响
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>num</span><span class=p>,</span> <span class=nx>num1</span><span class=p>)</span> <span class=c1>// 65 165
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>函数/方法
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>调用函数 参数传递会拷贝(赋值过程) 在函数内部对拷贝后的对象修改 不影响外部
</span></span></span><span class=line><span class=cl><span class=cm>但是：真的想在函数内部修改传递的参数 如何解决？
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>解决: 定义一个变量 存储对应变量的内存地址
</span></span></span><span class=line><span class=cl><span class=cm>pointerNum = 0x0005  // 存储num的内存地址
</span></span></span><span class=line><span class=cl><span class=cm>此时 通过pointerNum直接去修改内存中的数据
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>1. pointerNum是什么类型？ -&gt; 统称为指针类型
</span></span></span><span class=line><span class=cl><span class=cm>    int -&gt; *int
</span></span></span><span class=line><span class=cl><span class=cm>    string -&gt; *string
</span></span></span><span class=line><span class=cl><span class=cm>    type -&gt; *type
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>2. 如何拿到num的地址？ -&gt; 取引用
</span></span></span><span class=line><span class=cl><span class=cm>    &amp;varname
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>3. 如果通过pointerNum去操作num对应内存中的数据？ -&gt; 解引用 赋值
</span></span></span><span class=line><span class=cl><span class=cm>    *varname = xxx
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>num</span> <span class=kt>int</span> <span class=p>=</span> <span class=mi>65</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>num1</span> <span class=o>:=</span> <span class=nx>num</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 修改
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>num1</span> <span class=p>=</span> <span class=mi>165</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 对num有无影响
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>num</span><span class=p>,</span> <span class=nx>num1</span><span class=p>)</span> <span class=c1>// 65 165
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>pointNum</span> <span class=o>*</span><span class=kt>int</span>                          <span class=c1>// 定义
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %v\n&#34;</span><span class=p>,</span> <span class=nx>pointNum</span><span class=p>,</span> <span class=nx>pointNum</span><span class=p>)</span> <span class=c1>// *int, &lt;nil&gt;
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>pointNum</span> <span class=p>=</span> <span class=o>&amp;</span><span class=nx>num</span>                            <span class=c1>// 取引用（取内存地址赋值）
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %v\n&#34;</span><span class=p>,</span> <span class=nx>pointNum</span><span class=p>,</span> <span class=nx>pointNum</span><span class=p>)</span> <span class=c1>// *int, 0xc00001a098
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=o>*</span><span class=nx>pointNum</span> <span class=p>=</span> <span class=mi>116</span>  <span class=c1>// pointNum是指针类型 可以直接修改值
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>num</span><span class=p>)</span> <span class=c1>// 116
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 简短声明
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>pointNum2</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>num</span> <span class=c1>// 两个point指针存储的都是num的内存地址
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %v\n&#34;</span><span class=p>,</span> <span class=nx>pointNum2</span><span class=p>,</span> <span class=nx>pointNum2</span><span class=p>)</span> <span class=c1>// *int, 0xc00001a098
</span></span></span><span class=line><span class=cl><span class=c1></span>    
</span></span><span class=line><span class=cl>    <span class=o>*</span><span class=nx>pointNum2</span> <span class=p>=</span> <span class=mi>5757</span> <span class=c1>// pointNum2指针指向num的内存地址 修改的是num的值
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %v\n&#34;</span><span class=p>,</span> <span class=nx>num</span><span class=p>,</span> <span class=nx>num</span><span class=p>)</span> <span class=c1>// *int, 5757
</span></span></span><span class=line><span class=cl><span class=c1></span>    
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=o>*</span><span class=nx>pointNum</span><span class=p>,</span> <span class=o>*</span><span class=nx>pointNum2</span><span class=p>)</span> <span class=c1>// 5757, 5757 都指向num的值
</span></span></span><span class=line><span class=cl><span class=c1></span>    
</span></span><span class=line><span class=cl>    <span class=c1>// 先定义变量 -&gt; 取引用(取地址)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// new(T) 不用定义变量
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>pointer</span> <span class=o>:=</span> <span class=nb>new</span><span class=p>(</span><span class=kt>int</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %v, %v\n&#34;</span><span class=p>,</span> <span class=nx>pointer</span><span class=p>,</span> <span class=nx>pointer</span><span class=p>,</span> <span class=o>*</span><span class=nx>pointer</span><span class=p>)</span> <span class=c1>// *int, 0xc00001a110, 0
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%p\n&#34;</span><span class=p>,</span> <span class=nx>pointer</span><span class=p>)</span> <span class=c1>// 占位
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>$</span> <span class=k>go</span> <span class=nx>run</span> <span class=nx>pointer</span><span class=p>.</span><span class=k>go</span> 
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=mi>65</span> <span class=mi>165</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=o>*</span><span class=kt>int</span><span class=p>,</span> <span class=p>&lt;</span><span class=kc>nil</span><span class=p>&gt;</span>       
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=o>*</span><span class=kt>int</span><span class=p>,</span> <span class=mh>0xc00001a098</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=mi>116</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=o>*</span><span class=kt>int</span><span class=p>,</span> <span class=mh>0xc00001a098</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 了解：usafe包
</span></span></span></code></pre></td></tr></table></div></div><h3 id=复合数据类型>复合数据类型</h3><h4 id=数组array>数组(array)</h4><ul><li>序列
由相同类型元素组成的一个有序的集</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=mo>0123456</span>
</span></span><span class=line><span class=cl><span class=s>&#34;abcdefg&#34;</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>数组
由相同类型(任意类型)元素组成的一个<strong>固定长度</strong>的有序的集(一组固定长度的序列)</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=err>声明：</span> <span class=p>[</span><span class=nx>length</span><span class=p>]</span><span class=nx>T</span>
</span></span><span class=line><span class=cl>      <span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=kt>int</span>  <span class=c1>// 和下面的数组[5]int类型不同 只是元素类型相同都是int
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=p>[</span><span class=mi>5</span><span class=p>]</span><span class=kt>int</span>
</span></span><span class=line><span class=cl><span class=err>零值：由</span><span class=nx>N</span><span class=err>个</span><span class=nx>T</span><span class=err>类型的零值组成的数组</span><span class=p>(</span><span class=err>初始化</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;unsafe&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>nums</span> <span class=p>[</span><span class=mi>10</span><span class=p>]</span><span class=kt>int</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %v\n&#34;</span><span class=p>,</span> <span class=nx>nums</span><span class=p>,</span> <span class=nx>nums</span><span class=p>)</span> <span class=c1>// [10]int, [0 0 0 0 0 0 0 0 0 0]
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>names</span> <span class=p>[</span><span class=mi>10</span><span class=p>]</span><span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %q\n&#34;</span><span class=p>,</span> <span class=nx>names</span><span class=p>,</span> <span class=nx>names</span><span class=p>)</span> <span class=c1>// [10]string, [&#34;&#34; &#34;&#34; &#34;&#34; &#34;&#34; &#34;&#34; &#34;&#34; &#34;&#34; &#34;&#34; &#34;&#34; &#34;&#34;]
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 字面量 初始化值
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>nums</span> <span class=p>=</span> <span class=p>[</span><span class=mi>10</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>nums</span><span class=p>)</span> <span class=c1>// [1 2 3 0 0 0 0 0 0 0]
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 通过索引指定值
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>nums</span> <span class=p>=</span> <span class=p>[</span><span class=mi>10</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>5</span><span class=p>:</span> <span class=mi>3</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>nums</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// ... 语法糖 =&gt; go编译过程中进行转换
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 简写 根据{}中的元素 自动推导length
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>nums</span> <span class=p>=</span> <span class=p>[</span><span class=o>...</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>9</span><span class=p>:</span> <span class=mi>3</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %v\n&#34;</span><span class=p>,</span> <span class=nx>nums</span><span class=p>,</span> <span class=nx>nums</span><span class=p>)</span> <span class=c1>// [10]int, [0 0 0 0 0 0 0 0 0 0]
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 内存: int字节数量 * 元素的数量
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 64位 8字节 * 10个元素
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>unsafe</span><span class=p>.</span><span class=nf>Sizeof</span><span class=p>(</span><span class=nx>nums</span><span class=p>))</span> <span class=c1>// 80
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 操作
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 算数运算 无
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 关系运算: ==  !=
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>nums2</span> <span class=o>:=</span> <span class=p>[</span><span class=mi>10</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>nums</span> <span class=o>==</span> <span class=nx>nums2</span><span class=p>)</span> <span class=c1>// false 每个元素都相等才相等 长度不一样则类型不同 不能比较
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>nums3</span> <span class=o>:=</span> <span class=p>[</span><span class=mi>10</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>nums3</span> <span class=o>==</span> <span class=nx>nums2</span><span class=p>)</span> <span class=c1>// true
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 相关函数
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 长度
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>nums3</span><span class=p>))</span> <span class=c1>// 10
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 索引 通过索引获取每个元素的值
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 左-&gt;右：0, 1, 2, ..., len(array) - 1; 无反向索引(负索引)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>nums</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=nx>nums</span><span class=p>[</span><span class=mi>9</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 遍历数组元素
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=nx>nums</span><span class=p>);</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;key：%v value: %v\n&#34;</span><span class=p>,</span> <span class=nx>i</span><span class=p>,</span> <span class=nx>nums</span><span class=p>[</span><span class=nx>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// for range遍历
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=nx>index</span><span class=p>,</span> <span class=nx>value</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>nums</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>index</span><span class=p>,</span> <span class=nx>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 如果不使用index 用空白标识符 否则变量不使用 编译报错
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// var value int
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>value</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>nums</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 修改元素
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>nums</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>nums</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=p>=</span> <span class=mi>100</span> <span class=c1>// 直接通过索引赋值
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>nums</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=多维数组>多维数组</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// [length]T
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// T 可以是任意类型
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// T -&gt; [5]int
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 多维数组：数组本身的元素也是一个数组类型
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>var</span> <span class=nx>multi</span> <span class=p>[</span><span class=mi>3</span><span class=p>][</span><span class=mi>5</span><span class=p>]</span><span class=kt>int</span> <span class=c1>// T = [5]int =&gt; 二维数组
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %v\n&#34;</span><span class=p>,</span> <span class=nx>multi</span><span class=p>,</span> <span class=nx>multi</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>multi</span> <span class=p>=</span> <span class=p>[</span><span class=o>...</span><span class=p>][</span><span class=mi>5</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span> <span class=c1>// 也可以省略长度
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>},</span> <span class=c1>// 1: [5]int{1, 2, 3, 4, 5} 大括号里面定义二维 可以省略类型
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>{</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=mi>1</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>4</span><span class=p>:</span> <span class=mi>7</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 修改
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>multi</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>multi</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>multi</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>3</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>multi</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=p>=</span> <span class=p>[</span><span class=mi>5</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>multi</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>multi</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>3</span><span class=p>]</span> <span class=p>=</span> <span class=mi>1000</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>multi</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 遍历
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=nx>multi</span><span class=p>);</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=nx>j</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>j</span> <span class=p>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=nx>multi</span><span class=p>[</span><span class=nx>i</span><span class=p>]);</span> <span class=nx>j</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span><span class=p>,</span> <span class=nx>multi</span><span class=p>[</span><span class=nx>i</span><span class=p>][</span><span class=nx>j</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// range遍历
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=nx>index</span><span class=p>,</span> <span class=nx>value</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>multi</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=nx>index2</span><span class=p>,</span> <span class=nx>value2</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>value</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>index</span><span class=p>,</span> <span class=nx>index2</span><span class=p>,</span> <span class=nx>value2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=切片slice>切片(slice)</h4><p>切片：由相同类型元素组成的<strong>长度可变</strong>的有续集
声明：[]T // 数组去掉长度</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span><span class=lnt>204
</span><span class=lnt>205
</span><span class=lnt>206
</span><span class=lnt>207
</span><span class=lnt>208
</span><span class=lnt>209
</span><span class=lnt>210
</span><span class=lnt>211
</span><span class=lnt>212
</span><span class=lnt>213
</span><span class=lnt>214
</span><span class=lnt>215
</span><span class=lnt>216
</span><span class=lnt>217
</span><span class=lnt>218
</span><span class=lnt>219
</span><span class=lnt>220
</span><span class=lnt>221
</span><span class=lnt>222
</span><span class=lnt>223
</span><span class=lnt>224
</span><span class=lnt>225
</span><span class=lnt>226
</span><span class=lnt>227
</span><span class=lnt>228
</span><span class=lnt>229
</span><span class=lnt>230
</span><span class=lnt>231
</span><span class=lnt>232
</span><span class=lnt>233
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>nums</span> <span class=p>[]</span><span class=kt>int</span> <span class=c1>// var nums []int = nil
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// nil切片 赋值为nil
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %v, %v\n&#34;</span><span class=p>,</span> <span class=nx>nums</span><span class=p>,</span> <span class=nx>nums</span><span class=p>,</span> <span class=nx>nums</span> <span class=o>==</span> <span class=kc>nil</span><span class=p>)</span> <span class=c1>// []int, [], true
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 内存 暂时不关注
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 字面量
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>nums</span> <span class=p>=</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{}</span>                                      <span class=c1>// 空切片 不等于nil
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %v, %v\n&#34;</span><span class=p>,</span> <span class=nx>nums</span><span class=p>,</span> <span class=nx>nums</span><span class=p>,</span> <span class=nx>nums</span> <span class=o>==</span> <span class=kc>nil</span><span class=p>)</span> <span class=c1>// []int, [], false
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>nums</span> <span class=p>=</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>nums</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>nums</span> <span class=p>=</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>}</span> <span class=c1>// 长度可变
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>nums</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>nums</span> <span class=p>=</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>10</span><span class=p>:</span> <span class=mi>11</span><span class=p>}</span> <span class=c1>// [0 1 0 0 0 0 0 0 0 0 11]
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>nums</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// make([]int, length)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// length: 切片元素的数量
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 赋值有5个元素的int类型零值组成的切片
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>nums</span> <span class=p>=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>int</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>nums</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// make([]int, length, cap)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// length: 元素数量
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// cap: 容量 =&gt; 底层数组的长度
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// slice底层 =&gt; 数组存储 数组长度固定 当length == cap 再添加本素 重新申请内存 拷贝 释放旧数组内存
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 切片长度增长(元素数量) 增长 =&gt; 底层数组长度不够怎么办 =&gt; 重新生成一个新的可以容纳更多元素的数组(拷贝原来数组中的元素)
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 底层数组原长度：10 增加一个元素 增长：10 底层数组现长度：20
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 选择的元素：11 剩9个没有使用
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>nums</span> <span class=p>=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>int</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>nums</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 切片操作 =&gt; 数组 字符串 切片
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>numArray</span> <span class=o>:=</span> <span class=p>[</span><span class=mi>5</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>9</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %v\n&#34;</span><span class=p>,</span> <span class=nx>numArray</span><span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>3</span><span class=p>],</span> <span class=nx>numArray</span><span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>3</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=c1>// [start:end] start &lt;= end &lt;= length
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 数组切片赋值给切片
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>nums</span> <span class=p>=</span> <span class=nx>numArray</span><span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>3</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>nums</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 容量 cap()
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>nums</span> <span class=p>=</span> <span class=nx>numArray</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>4</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %v, %v, %v\n&#34;</span><span class=p>,</span> <span class=nx>nums</span><span class=p>,</span> <span class=nx>nums</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=nx>nums</span><span class=p>),</span> <span class=nb>cap</span><span class=p>(</span><span class=nx>nums</span><span class=p>))</span> <span class=c1>// []int, [1 3 5 7], 4, 5
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>nums</span> <span class=p>=</span> <span class=nx>numArray</span><span class=p>[</span><span class=mi>1</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %v, %v, %v\n&#34;</span><span class=p>,</span> <span class=nx>nums</span><span class=p>,</span> <span class=nx>nums</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=nx>nums</span><span class=p>),</span> <span class=nb>cap</span><span class=p>(</span><span class=nx>nums</span><span class=p>))</span> <span class=c1>// []int, [3 5 7 9], 4, 4
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 切片的切片操作
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %v\n&#34;</span><span class=p>,</span> <span class=nx>nums</span><span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>3</span><span class=p>],</span> <span class=nx>nums</span><span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>3</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 切片的赋值方式
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 1. 零值 nil切片
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 2. 字面量
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 3. make函数(指定容量 不指定容量)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 4. 切片操作(数组切片 切片切片)
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 操作：不能进行== 和 !=运算
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 函数： len cap append copy
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 元素的访问和修改： 通过索引 slice[i];slice[i] = value
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 切片操作：
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// slice[start:end:cap_end] start &lt;= end &lt;= cap_end &lt;= cap(slice)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// array[start:end:cap_end] start &lt;= end &lt;= cap_end &lt;= len(array)
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 切片底层：
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//   数组地址
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//     容量
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//     长度
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 长度：len() 容量：cap()
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>nums</span> <span class=p>=</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>nums</span><span class=p>),</span> <span class=nb>cap</span><span class=p>(</span><span class=nx>nums</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=nx>nums</span> <span class=p>=</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>nums</span><span class=p>),</span> <span class=nb>cap</span><span class=p>(</span><span class=nx>nums</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=nx>nums</span> <span class=p>=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>int</span><span class=p>,</span> <span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>nums</span><span class=p>),</span> <span class=nb>cap</span><span class=p>(</span><span class=nx>nums</span><span class=p>))</span> <span class=c1>// 10, 10
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>nums</span> <span class=p>=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>int</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>nums</span><span class=p>),</span> <span class=nb>cap</span><span class=p>(</span><span class=nx>nums</span><span class=p>))</span> <span class=c1>// 0, 10
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>nums</span> <span class=p>=</span> <span class=nx>numArray</span><span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>3</span><span class=p>]</span>  <span class=c1>// cap = length - start
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>numArray</span><span class=p>)</span> <span class=c1>// [1 3 5 7 9]
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>nums</span><span class=p>),</span> <span class=nb>cap</span><span class=p>(</span><span class=nx>nums</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 元素的访问和修改
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>nums</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>nums</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=p>=</span> <span class=mi>100</span> <span class=c1>// 索引的范围：0,length-1 or 0,cap-1?
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// fmt.Println(nums[1])
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// fmt.Println(nums[2]) // 运行时报错 索引范围是0，length-1
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 遍历
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=nx>nums</span><span class=p>);</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%v: %v\n&#34;</span><span class=p>,</span> <span class=nx>i</span><span class=p>,</span> <span class=nx>nums</span><span class=p>[</span><span class=nx>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>index</span><span class=p>,</span> <span class=nx>value</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>nums</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%v: %v\n&#34;</span><span class=p>,</span> <span class=nx>index</span><span class=p>,</span> <span class=nx>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 添加元素
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>nums</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>nums</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span> <span class=c1>// 末尾追加
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>nums</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>nums</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>nums</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span> <span class=c1>// 追加多个元素
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>nums</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 删除元素
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// go中没有直接删除元素的方法 需要用到： 切片 + 解包
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 删除索引为0的(首)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>nums</span> <span class=p>=</span> <span class=nx>nums</span><span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=nb>len</span><span class=p>(</span><span class=nx>nums</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>nums</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 删除索引为length-1的(尾)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>nums</span> <span class=p>=</span> <span class=nx>nums</span><span class=p>[:</span><span class=nb>len</span><span class=p>(</span><span class=nx>nums</span><span class=p>)</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>nums</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 删除中间的(索引为i)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// [0:i] + [i+1:len(nums)]
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 1. 循环append
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// prefix := nums[0:1]
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// suffix := nums[2:len(nums)]
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// fmt.Println(prefix, suffix)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// for _, value := range suffix {
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//     prefix = append(prefix, value)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// }
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// fmt.Println(prefix)
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 2. 解包方式 go把切片元素展开 语法糖
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>append</span><span class=p>(</span><span class=nx>nums</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>1</span><span class=p>],</span> <span class=nx>nums</span><span class=p>[</span><span class=mi>2</span><span class=p>:</span><span class=nb>len</span><span class=p>(</span><span class=nx>nums</span><span class=p>)]</span><span class=o>...</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// start:end start = 0  =&gt; [:end] 省略
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// start:end end = length =&gt; [start:]
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 容量
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 增长规则： &lt;= 1024  n =&gt; 2*n
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//          &gt; 1024 n =&gt; n*(1+~0.25)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>nums</span> <span class=p>=</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>nums</span><span class=p>),</span> <span class=nb>cap</span><span class=p>(</span><span class=nx>nums</span><span class=p>))</span> <span class=c1>// 0 0
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>nums</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>nums</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>nums</span><span class=p>),</span> <span class=nb>cap</span><span class=p>(</span><span class=nx>nums</span><span class=p>))</span> <span class=c1>// 1 1
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>nums</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>nums</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>nums</span><span class=p>),</span> <span class=nb>cap</span><span class=p>(</span><span class=nx>nums</span><span class=p>))</span> <span class=c1>// 2 2
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>nums</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>nums</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>nums</span><span class=p>),</span> <span class=nb>cap</span><span class=p>(</span><span class=nx>nums</span><span class=p>))</span> <span class=c1>// 3 4
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>nums</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>nums</span><span class=p>,</span> <span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>nums</span><span class=p>),</span> <span class=nb>cap</span><span class=p>(</span><span class=nx>nums</span><span class=p>))</span> <span class=c1>// 4 4
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>nums</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>nums</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>nums</span><span class=p>),</span> <span class=nb>cap</span><span class=p>(</span><span class=nx>nums</span><span class=p>))</span> <span class=c1>// 5 8
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 如果可以预期切片的最大长度 可以通过make函数指定cap容量 减少申请内存的损耗
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// start:end:cap_end
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>numArray</span> <span class=p>=</span> <span class=p>[</span><span class=mi>5</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>nums</span> <span class=p>=</span> <span class=nx>numArray</span><span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>3</span><span class=p>]</span> <span class=c1>// len = end - start; cap = len(底层数组) - start
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>nums</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>nums</span><span class=p>,</span> <span class=mi>1000</span><span class=p>)</span> <span class=c1>// 切片会共享底层数组
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>numArray</span><span class=p>)</span>     <span class=c1>// [1 3 5 1000 8]
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>nums</span><span class=p>)</span>         <span class=c1>// [3 5 1000]
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;#########&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>nums</span> <span class=p>=</span> <span class=nx>numArray</span><span class=p>[</span><span class=mi>3</span><span class=p>:</span><span class=mi>5</span><span class=p>]</span> <span class=c1>// [1000 8]
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>nums</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>nums</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>numArray</span><span class=p>)</span> <span class=c1>// [1 3 5 1000 8]
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>nums</span><span class=p>)</span>     <span class=c1>// [100 8 3]
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// [start:end:cap_end] 切片可以指定cap的位置(限制cap)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// end &lt;= cap_end &lt;= 底层数组的长度
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>nums</span> <span class=p>=</span> <span class=nx>numArray</span><span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>3</span><span class=p>:</span><span class=mi>4</span><span class=p>]</span>            <span class=c1>// cap = cap_end - start
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>nums</span><span class=p>),</span> <span class=nb>cap</span><span class=p>(</span><span class=nx>nums</span><span class=p>))</span> <span class=c1>// 2 2
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>nums</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>nums</span><span class=p>,</span> <span class=mi>999</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>nums</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>numArray</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1>// len和cap一样 append会触发扩容 扩容不会影响原来的底层数组 生成新的底层数组
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 否则 会影响底层数组(改变底层数组的值)
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 总结：如果使用数组来生成切片 那么操作切片(append扩容)根据容量的情况 会影响底层数组 或是生成新的底层数组
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 切片的切片操作
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// [start:end] start &lt;= end &lt;= cap(nums); end小于等于容量cap
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;###########&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>nums</span> <span class=p>=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>int</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>nums</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=p>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=nx>nums</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=p>=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>    <span class=nx>nums</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=p>=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>nums</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>numsSlice</span> <span class=o>:=</span> <span class=nx>nums</span><span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>5</span><span class=p>]</span> <span class=c1>// [2 3 0 0]
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>numsSlice</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>numsSlice</span><span class=p>),</span> <span class=nb>cap</span><span class=p>(</span><span class=nx>numsSlice</span><span class=p>))</span> <span class=c1>// 1, 9 仍然共享底层数组
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>numsSlice</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>numsSlice</span><span class=p>,</span> <span class=mi>100</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>nums</span><span class=p>)</span> <span class=c1>// numsSlice扩容了一个元素100 nums值改变 [1 2 3] =&gt; [1 2 100] 原因：共享了底层数组
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 限定cap
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>numsSlice</span> <span class=p>=</span> <span class=nx>nums</span><span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>2</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>numsSlice</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>numsSlice</span><span class=p>),</span> <span class=nb>cap</span><span class=p>(</span><span class=nx>numsSlice</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// copy函数(dst, src)  后面的切片拷贝到前面的切片
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// copy：只赋值索引相同的元素 复制值不够：保留  复制只太多：剔除 并不扩容
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>dst</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>int</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>src</span> <span class=o>:=</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// len(src) == len(dst)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>src</span><span class=p>,</span> <span class=nx>dst</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>copy</span><span class=p>(</span><span class=nx>dst</span><span class=p>,</span> <span class=nx>src</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>src</span><span class=p>,</span> <span class=nx>dst</span><span class=p>)</span> <span class=c1>// [2 3 4] [2 3 4]
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// len(dst) &gt; len(src) 保留未被覆盖部分
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>src</span> <span class=p>=</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{</span><span class=mi>200</span><span class=p>,</span> <span class=mi>300</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nb>copy</span><span class=p>(</span><span class=nx>dst</span><span class=p>,</span> <span class=nx>src</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>src</span><span class=p>,</span> <span class=nx>dst</span><span class=p>)</span> <span class=c1>// [200 300] [200 300 4]
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// len(dst) &lt; len(src)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>src</span> <span class=p>=</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1000</span><span class=p>,</span> <span class=mi>2000</span><span class=p>,</span> <span class=mi>3000</span><span class=p>,</span> <span class=mi>4000</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nb>copy</span><span class=p>(</span><span class=nx>dst</span><span class=p>,</span> <span class=nx>src</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>src</span><span class=p>,</span> <span class=nx>dst</span><span class=p>)</span> <span class=c1>// [1000 2000 3000 4000] [1000 2000 3000] 长度并不会在拷贝过程中进行调整
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 通过copy来删除索引为i的元素
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>nums</span> <span class=p>=</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 删除索引为2的
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>nums</span><span class=p>[</span><span class=mi>2</span><span class=p>:])</span> <span class=c1>// [3 4 5]
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>nums</span><span class=p>[</span><span class=mi>3</span><span class=p>:])</span> <span class=c1>// [4 5]
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nb>copy</span><span class=p>(</span><span class=nx>nums</span><span class=p>[</span><span class=mi>2</span><span class=p>:],</span> <span class=nx>nums</span><span class=p>[</span><span class=mi>3</span><span class=p>:])</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>nums</span><span class=p>[:</span><span class=nb>len</span><span class=p>(</span><span class=nx>nums</span><span class=p>)</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span> <span class=c1>// [1 2 4 5 5]
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=切片实现队列>切片实现队列</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 队列： 先进先出(消息队列)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>quene</span> <span class=o>:=</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=mi>1</span> <span class=mi>2</span> <span class=mi>3</span> <span class=p>=&gt;</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=err>进切片</span><span class=p>(</span><span class=err>添加到后面</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>append</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>append</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>append</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=err>出切片</span>
</span></span><span class=line><span class=cl>        <span class=err>获取索引为</span><span class=mi>0</span><span class=err>的元素</span> <span class=err>删除索引为</span><span class=mi>0</span><span class=err>的元素</span> <span class=nx>quene</span><span class=p>[</span><span class=mi>1</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>quene</span> <span class=o>:=</span> <span class=p>[]</span><span class=kt>string</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>txt</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;请输入任务(exit退出,do执行):&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Scan</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>txt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nx>txt</span> <span class=o>==</span> <span class=s>&#34;exit&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=nx>txt</span> <span class=o>==</span> <span class=s>&#34;do&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nx>quene</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;无任务&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;执行：&#34;</span><span class=p>,</span> <span class=nx>quene</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>                <span class=nx>quene</span> <span class=p>=</span> <span class=nx>quene</span><span class=p>[</span><span class=mi>1</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>quene</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>quene</span><span class=p>,</span> <span class=nx>txt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=切片实现堆栈>切片实现堆栈</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 堆栈： 先进后出 (有优先级的场景)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>stack</span> <span class=o>:=</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=mi>1</span> <span class=mi>2</span> <span class=mi>3</span> <span class=p>=&gt;</span> <span class=mi>3</span> <span class=mi>2</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=err>进切片：</span>
</span></span><span class=line><span class=cl>        <span class=nb>append</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>append</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>append</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=err>出切片：</span>
</span></span><span class=line><span class=cl>        <span class=err>获取索引为</span><span class=nb>len</span><span class=p>()</span><span class=o>-</span><span class=mi>1</span><span class=err>的元素</span> <span class=err>删除</span><span class=nb>len</span><span class=p>()</span><span class=o>-</span><span class=mi>1</span><span class=err>的元素</span> <span class=nx>stack</span><span class=p>[:</span><span class=nb>len</span><span class=p>(</span><span class=nx>stack</span><span class=p>)</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>stack</span> <span class=o>:=</span> <span class=p>[]</span><span class=kt>string</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>txt</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;请输入任务(exit退出,do执行):&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Scan</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>txt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nx>txt</span> <span class=o>==</span> <span class=s>&#34;exit&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=nx>txt</span> <span class=o>==</span> <span class=s>&#34;do&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nx>stack</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;无任务&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;执行：&#34;</span><span class=p>,</span> <span class=nx>stack</span><span class=p>[</span><span class=nb>len</span><span class=p>(</span><span class=nx>stack</span><span class=p>)</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>                <span class=nx>stack</span> <span class=p>=</span> <span class=nx>stack</span><span class=p>[:</span><span class=nb>len</span><span class=p>(</span><span class=nx>stack</span><span class=p>)</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>stack</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>stack</span><span class=p>,</span> <span class=nx>txt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 切片 []T
</span></span></span><span class=line><span class=cl><span class=c1>// T =&gt; [3]int  数组
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>[][</span><span class=mi>3</span><span class=p>]</span><span class=kt>int</span>
</span></span><span class=line><span class=cl><span class=c1>// T =&gt; []int   切片
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>[][]</span><span class=kt>int</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=循环删除切片多个元素>循环删除切片多个元素</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>sli</span> <span class=o>:=</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>,</span> <span class=mi>10</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 使用for循环遍历切片 并记录需要删除的元素的索引
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>indexesToDelete</span> <span class=o>:=</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>i</span><span class=p>,</span> <span class=nx>v</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>sli</span> <span class=p>{</span> 
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nx>v</span><span class=o>%</span><span class=mi>2</span> <span class=o>==</span> <span class=mi>0</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>indexesToDelete</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>indexesToDelete</span><span class=p>,</span> <span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 倒序遍历需要删除的元素的索引 因为删除元素后 切片的长度会发生变化
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 如果正序遍历 则可能产生索引越界
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=nb>len</span><span class=p>(</span><span class=nx>indexesToDelete</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span><span class=o>--</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>sli</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>sli</span><span class=p>[:</span><span class=nx>indexesToDelete</span><span class=p>[</span><span class=nx>i</span><span class=p>]],</span> <span class=nx>sli</span><span class=p>[</span><span class=nx>indexesToDelete</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span><span class=o>+</span><span class=mi>1</span><span class=p>:]</span><span class=o>...</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>sli</span><span class=p>)</span> <span class=c1>// [1 3 5 7 9]
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=映射map>映射(map)</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 切片 或者 数组 访问元素是直接通过索引访问
</span></span></span><span class=line><span class=cl><span class=c1>// 如果我要找一个值 不知道索引的情况下 那就得把所有元素都遍历一遍
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>slice</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>array</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>映射：</span><span class=c1>// 定义key和value对的集
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// (可能是有序的/可能是无序的 Go中是无序的：放入key的顺序与在内存中的顺序无关 与遍历无关)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=err>含义：</span> <span class=nx>ID</span> <span class=p>=&gt;</span> <span class=err>数据</span>
</span></span><span class=line><span class=cl>    <span class=err>映射实现方式：</span><span class=nf>hashtable</span><span class=p>(</span><span class=nx>go</span><span class=err>的实现方式</span><span class=p>)</span> <span class=nx>treemap</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>key</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=err>通过</span><span class=nx>key</span><span class=err>对</span><span class=nx>value</span><span class=err>进行增删查改</span>
</span></span><span class=line><span class=cl>    <span class=nx>key</span><span class=err>是唯一的</span>
</span></span><span class=line><span class=cl>    <span class=nx>key</span><span class=err>类型的要求：可以进行</span> <span class=o>==</span> <span class=o>!=</span><span class=err>判断</span> <span class=p>(</span><span class=err>不能为切片</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>value</span><span class=err>类型任意</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>定义：</span><span class=kd>map</span><span class=p>[</span><span class=nx>keyType</span><span class=p>]</span><span class=nx>valueType</span>
</span></span><span class=line><span class=cl><span class=err>赋值：</span>
</span></span><span class=line><span class=cl>    <span class=nx>make</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>make</span><span class=p>(</span><span class=kd>map</span><span class=p>[</span><span class=nx>keyType</span><span class=p>]</span><span class=nx>valueType</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=err>字面量：</span>
</span></span><span class=line><span class=cl>        <span class=kd>map</span><span class=p>[</span><span class=nx>keyType</span><span class=p>]</span><span class=nx>valueType</span><span class=p>{}</span>    <span class=c1>// 空map
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kd>map</span><span class=p>[</span><span class=nx>keyType</span><span class=p>]</span><span class=nx>valueType</span><span class=p>{</span><span class=nx>k1</span><span class=p>:</span><span class=nx>v</span><span class=p>,</span> <span class=nx>k2</span><span class=p>:</span><span class=nx>v</span><span class=p>,</span> <span class=nx>k3</span><span class=p>:</span><span class=nx>v</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=err>零值：</span><span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=err>操作：</span>
</span></span><span class=line><span class=cl>    <span class=err>元素数量：</span><span class=nb>len</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=err>元素操作：</span>
</span></span><span class=line><span class=cl>        <span class=err>获取：</span><span class=nx>mapName</span><span class=p>[</span><span class=nx>key</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=nx>key</span><span class=err>存在：</span><span class=nx>mapName</span><span class=p>[</span><span class=nx>key</span><span class=p>]</span> <span class=p>=&gt;</span> <span class=err>对应</span><span class=nx>value</span><span class=err>值</span>
</span></span><span class=line><span class=cl>            <span class=nx>key</span><span class=err>不存在：不会报错</span> <span class=err>返回对应</span><span class=nx>valueType</span><span class=err>类型的零值</span> <span class=err>因此</span> <span class=err>不能通过零值来判断</span><span class=nx>key</span><span class=err>否存在</span>
</span></span><span class=line><span class=cl>            <span class=err>如何判断</span><span class=nx>key</span><span class=err>是否存在：</span>
</span></span><span class=line><span class=cl>                <span class=nx>value</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=nx>mapName</span><span class=p>[</span><span class=nx>key</span><span class=p>]</span>  <span class=c1>// 可以返回两个值 ok表示key是否存在 true/false
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=nx>value</span> <span class=o>:=</span> <span class=nx>mapName</span><span class=p>[</span><span class=nx>key</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=err>增：</span>
</span></span><span class=line><span class=cl>            <span class=nx>mapName</span><span class=p>[</span><span class=nx>key</span><span class=p>]</span> <span class=p>=</span> <span class=nx>value</span> <span class=c1>// 存在修改 不存在增加
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=err>改：</span>
</span></span><span class=line><span class=cl>            <span class=nx>mapName</span><span class=p>[</span><span class=nx>key</span><span class=p>]</span> <span class=p>=</span> <span class=nx>value</span> 
</span></span><span class=line><span class=cl>        <span class=err>删：</span>
</span></span><span class=line><span class=cl>            <span class=nb>delete</span><span class=p>(</span><span class=nx>mapName</span><span class=p>,</span> <span class=nx>key</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// name =&gt; count 记录每个学生上课次数
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// key: string  value: int
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>var</span> <span class=nx>stats</span> <span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>int</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %v, %v\n&#34;</span><span class=p>,</span> <span class=nx>stats</span><span class=p>,</span> <span class=nx>stats</span><span class=p>,</span> <span class=nx>stats</span> <span class=o>==</span> <span class=kc>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 赋值
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>stats</span> <span class=p>=</span> <span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>int</span><span class=p>{}</span> <span class=c1>// 空map 不等于nil
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %v, %v\n&#34;</span><span class=p>,</span> <span class=nx>stats</span><span class=p>,</span> <span class=nx>stats</span><span class=p>,</span> <span class=nx>stats</span> <span class=o>==</span> <span class=kc>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>stats</span> <span class=p>=</span> <span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span><span class=s>&#34;minho&#34;</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span> <span class=s>&#34;kk&#34;</span><span class=p>:</span> <span class=mi>10</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %v, %v\n&#34;</span><span class=p>,</span> <span class=nx>stats</span><span class=p>,</span> <span class=nx>stats</span><span class=p>,</span> <span class=nx>stats</span> <span class=o>==</span> <span class=kc>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>stats</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// stats = make(map[string]int)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// fmt.Printf(&#34;%T, %v, %v\n&#34;, stats, stats, stats == nil)
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 获取元素
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>stats</span><span class=p>[</span><span class=s>&#34;minho&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>stats</span><span class=p>[</span><span class=s>&#34;minho11&#34;</span><span class=p>])</span> <span class=c1>// key不存在 不报错
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>value</span> <span class=o>:=</span> <span class=nx>stats</span><span class=p>[</span><span class=s>&#34;minho&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>value</span> <span class=p>=</span> <span class=nx>stats</span><span class=p>[</span><span class=s>&#34;minho11&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>value</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=nx>stats</span><span class=p>[</span><span class=s>&#34;minho&#34;</span><span class=p>]</span> <span class=c1>// 返回两个值 ok表示是否存在 true/false
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>value</span><span class=p>,</span> <span class=nx>ok</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>value</span><span class=p>,</span> <span class=nx>ok</span> <span class=p>=</span> <span class=nx>stats</span><span class=p>[</span><span class=s>&#34;minho11&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>value</span><span class=p>,</span> <span class=nx>ok</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 增加元素
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>stats</span><span class=p>[</span><span class=s>&#34;karubin&#34;</span><span class=p>]</span> <span class=p>=</span> <span class=mi>11</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>stats</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 修改元素
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>stats</span><span class=p>[</span><span class=s>&#34;karubin&#34;</span><span class=p>]</span> <span class=p>=</span> <span class=mi>9</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>stats</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 删除元素
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>stats</span><span class=p>[</span><span class=s>&#34;xxx&#34;</span><span class=p>]</span> <span class=p>=</span> <span class=mi>7</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>stats</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>delete</span><span class=p>(</span><span class=nx>stats</span><span class=p>,</span> <span class=s>&#34;xxx&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>delete</span><span class=p>(</span><span class=nx>stats</span><span class=p>,</span> <span class=s>&#34;xxxxxx&#34;</span><span class=p>)</span> <span class=c1>// 删除的key如果不存在 不报错
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>stats</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 遍历 for range
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=nx>key</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>stats</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>key</span><span class=p>,</span> <span class=nx>stats</span><span class=p>[</span><span class=nx>key</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>key</span><span class=p>,</span> <span class=nx>value</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>stats</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>key</span><span class=p>,</span> <span class=nx>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=显示初始化值>显示初始化值</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>nilSlice</span> <span class=p>[]</span><span class=kt>int</span> <span class=p>=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>int</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>nilMap</span> <span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>int</span> <span class=p>=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>int</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 显式为切片和map进行初始化值
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>append</span><span class=p>(</span><span class=nx>nilSlice</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span> <span class=c1>// [1]
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>nilMap</span><span class=p>[</span><span class=s>&#34;kk&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=nx>nilMap</span><span class=p>[</span><span class=s>&#34;kk&#34;</span><span class=p>]</span> <span class=p>=</span> <span class=mi>1</span> <span class=c1>// 没有初始化值 报错 nil map
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=函数>函数</h2><p>为代码片段定义一个名称</p><h3 id=功能>功能</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=mf>1.</span> <span class=err>代码功能明确</span>
</span></span><span class=line><span class=cl><span class=mf>2.</span> <span class=err>代码复用</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=定义调用>定义/调用</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=err>函数名称</span><span class=p>(</span><span class=err>函数参数</span><span class=p>,</span> <span class=o>...</span><span class=p>)</span> <span class=err>返回值</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 函数体
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=函数名称>函数名称</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 需要满足标识符规范
</span></span></span></code></pre></td></tr></table></div></div><h4 id=函数参数形参>函数参数(形参)</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 可以是任意多个
</span></span></span><span class=line><span class=cl><span class=c1>// 参数：参数名称(变量名) 参数类型
</span></span></span><span class=line><span class=cl><span class=c1>// 定义参数 就是定义一个变量
</span></span></span><span class=line><span class=cl><span class=c1>// 形参作用域：只能在该函数体内使用
</span></span></span><span class=line><span class=cl><span class=c1>// 多个参数使用逗号分割
</span></span></span><span class=line><span class=cl><span class=c1>// go里面没有参数默认值
</span></span></span><span class=line><span class=cl><span class=c1>// 多个连续参数类型一致 只保留连续参数中最后一个参数类型 前面n个参数类型省略
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// 可变参数
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 无参
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>sayHello</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Hello, Go&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 有参
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>sayHi</span><span class=p>(</span><span class=nx>name</span> <span class=kt>string</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Hi&#34;</span><span class=p>,</span> <span class=nx>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>add</span><span class=p>(</span><span class=nx>num1</span> <span class=kt>int</span><span class=p>,</span> <span class=nx>num2</span> <span class=kt>int</span><span class=p>)</span> <span class=p>(</span><span class=kt>int</span><span class=p>,</span> <span class=kt>string</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>num1</span> <span class=o>+</span> <span class=nx>num2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>num1</span> <span class=o>+</span> <span class=nx>num2</span><span class=p>,</span> <span class=s>&#34;add&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 连续同类型参数省略类型
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>merge</span><span class=p>(</span><span class=nx>a1</span> <span class=kt>bool</span><span class=p>,</span> <span class=nx>a2</span><span class=p>,</span> <span class=nx>a3</span><span class=p>,</span> <span class=nx>a4</span> <span class=kt>string</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>a1</span><span class=p>,</span> <span class=nx>a2</span><span class=p>,</span> <span class=nx>a3</span><span class=p>,</span> <span class=nx>a4</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 可变参数
</span></span></span><span class=line><span class=cl><span class=c1>// 变量名 ...T
</span></span></span><span class=line><span class=cl><span class=c1>// 可变参数在一个函数内只能定义一次
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>anyArgs</span><span class=p>(</span><span class=nx>args</span> <span class=o>...</span><span class=kt>string</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// 可以接收任意多个string类型的变量
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// args是切片类型
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 可变参数可以和固定参数结合使用 但只能放在最末尾
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>addN</span><span class=p>(</span><span class=nx>left</span><span class=p>,</span> <span class=nx>right</span> <span class=kt>int</span><span class=p>,</span> <span class=nx>args</span> <span class=o>...</span><span class=kt>int</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>sum</span> <span class=o>:=</span> <span class=nx>left</span> <span class=o>+</span> <span class=nx>right</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>value</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>args</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>sum</span> <span class=o>+=</span> <span class=nx>value</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>sum</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>addN</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=返回值>返回值</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 可以是任意多个 
</span></span></span><span class=line><span class=cl><span class=c1>// 无返回值不定义
</span></span></span><span class=line><span class=cl><span class=c1>// 有一个返回值： 需定义返回值的类型
</span></span></span><span class=line><span class=cl><span class=c1>// 多个返回值：需定义所有返回值的类型 用逗号分割 ()包含 连续相同返回类型 同样可以省略
</span></span></span><span class=line><span class=cl><span class=c1>// 返回值可以定义名称(命名返回值) 命名返回值 建议在函数简单的时候使用
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// 有返回值一定要用return关键字返回
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 无返回值
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>sayHello</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Hello, Go&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 单个返回值
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>add</span><span class=p>()</span> <span class=kt>int</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>2</span> <span class=o>+</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 多个返回值 同类型
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>calc</span><span class=p>()</span> <span class=p>(</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>2</span> <span class=o>+</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>2</span> <span class=o>-</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>2</span> <span class=o>*</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>2</span> <span class=o>/</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 返回多个值 不同类型
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>returnType</span><span class=p>()</span> <span class=p>(</span><span class=kt>int</span><span class=p>,</span> <span class=kt>bool</span><span class=p>,</span> <span class=kt>string</span><span class=p>,</span> <span class=p>[]</span><span class=kt>int</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1</span><span class=p>,</span> <span class=kc>true</span><span class=p>,</span> <span class=s>&#34;string_return&#34;</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 命名返回值
</span></span></span><span class=line><span class=cl><span class=c1>// 将函数执行完成时的name返回
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>returnName</span><span class=p>()</span> <span class=p>(</span><span class=nx>name</span> <span class=kt>string</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// return // 命名返回值 可以直接只写return 返回&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>name</span> <span class=p>=</span> <span class=s>&#34;returnName&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>returnNameArgs</span><span class=p>()</span> <span class=p>(</span><span class=nx>name</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>isBoby</span> <span class=kt>bool</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>name</span> <span class=p>=</span> <span class=nx>name</span> <span class=o>+</span> <span class=s>&#34;Minho&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>sayHello</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>r</span> <span class=o>:=</span> <span class=nf>add</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>r</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>num1</span><span class=p>,</span> <span class=nx>num2</span><span class=p>,</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>num4</span> <span class=o>:=</span> <span class=nf>calc</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>num1</span><span class=p>,</span> <span class=nx>num2</span><span class=p>,</span> <span class=nx>num4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>res1</span><span class=p>,</span> <span class=nx>res2</span><span class=p>,</span> <span class=nx>res3</span><span class=p>,</span> <span class=nx>res4</span> <span class=o>:=</span> <span class=nf>returnType</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>res1</span><span class=p>,</span> <span class=nx>res2</span><span class=p>,</span> <span class=nx>res3</span><span class=p>,</span> <span class=nx>res4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>res</span> <span class=o>:=</span> <span class=nf>returnName</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%q\n&#34;</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>name</span><span class=p>,</span> <span class=nx>isBody</span> <span class=o>:=</span> <span class=nf>returnNameArgs</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%q, %v\n&#34;</span><span class=p>,</span> <span class=nx>name</span><span class=p>,</span> <span class=nx>isBody</span><span class=p>)</span> <span class=c1>// Minho false
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=函数调用>函数调用</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 函数名称(实参参数) 实参的数量 == 形参的数量 
</span></span></span><span class=line><span class=cl><span class=c1>// 实参和形参：数量 需要一致 / 类型按顺序一致 / 数据按照顺序传递
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 函数调用 在栈上 一般是申请的连续的地址
</span></span></span><span class=line><span class=cl><span class=c1>// 闭包使用到的变量 go会存到堆中 该类变量生命周期边长
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>go</span> <span class=nx>tool</span> <span class=nx>compile</span> <span class=o>-</span><span class=nx>m</span> <span class=o>-</span><span class=nx>l</span> <span class=nx>xxx</span><span class=p>.</span><span class=k>go</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>xxx</span> <span class=nx>does</span> <span class=nx>not</span> <span class=nx>escape</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>xxx</span> <span class=nx>escapes</span> <span class=nx>to</span> <span class=nx>head</span> <span class=c1>// 逃逸到堆中
</span></span></span></code></pre></td></tr></table></div></div><h3 id=递归>递归</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 函数间接/直接调用自己
</span></span></span><span class=line><span class=cl><span class=c1>// 分治问题：将一个大问题拆分成N个相同解决方法的小问题
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 阶乘
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 递归实现阶乘
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>fact</span><span class=p>(</span><span class=nx>n</span> <span class=kt>int64</span><span class=p>)</span> <span class=kt>int64</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;call&#34;</span><span class=p>,</span> <span class=nx>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>n</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>||</span> <span class=nx>n</span> <span class=o>==</span> <span class=mi>1</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>1</span> <span class=c1>// 终止条件 没有的话会无限调用 调用深度(看语言层面是否有限制)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>rt</span> <span class=o>:=</span> <span class=nx>n</span> <span class=o>*</span> <span class=nf>fact</span><span class=p>(</span><span class=nx>n</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;result&#34;</span><span class=p>,</span> <span class=nx>n</span><span class=p>,</span> <span class=nx>rt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>rt</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nf>fact</span><span class=p>(</span><span class=mi>5</span><span class=p>))</span> <span class=c1>// 120
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>$</span> <span class=k>go</span> <span class=nx>run</span> <span class=nx>fact</span><span class=p>.</span><span class=k>go</span> <span class=c1>// 先进去的后得到结果 类似栈
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=nx>call</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=nx>call</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=nx>call</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=nx>call</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=nx>call</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=nx>result</span> <span class=mi>2</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=nx>result</span> <span class=mi>3</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=nx>result</span> <span class=mi>4</span> <span class=mi>24</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=nx>result</span> <span class=mi>5</span> <span class=mi>120</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 汉诺塔
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 将layer个盘子从t1移动到t3 借助t2
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>tower</span><span class=p>(</span><span class=nx>t1</span><span class=p>,</span> <span class=nx>t2</span><span class=p>,</span> <span class=nx>t3</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>layer</span> <span class=kt>int</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>layer</span> <span class=o>==</span> <span class=mi>1</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%s -&gt; %s\n&#34;</span><span class=p>,</span> <span class=nx>t1</span><span class=p>,</span> <span class=nx>t3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 先将layer-1个从t1 移动到t2 借助t3
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nf>tower</span><span class=p>(</span><span class=nx>t1</span><span class=p>,</span> <span class=nx>t3</span><span class=p>,</span> <span class=nx>t2</span><span class=p>,</span> <span class=nx>layer</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1>// t1 -&gt; t3
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%s -&gt; %s\n&#34;</span><span class=p>,</span> <span class=nx>t1</span><span class=p>,</span> <span class=nx>t3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 将layer-1个t2 移动到t3 借助t1
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nf>tower</span><span class=p>(</span><span class=nx>t2</span><span class=p>,</span> <span class=nx>t1</span><span class=p>,</span> <span class=nx>t3</span><span class=p>,</span> <span class=nx>layer</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>tower</span><span class=p>(</span><span class=s>&#34;A&#34;</span><span class=p>,</span> <span class=s>&#34;B&#34;</span><span class=p>,</span> <span class=s>&#34;C&#34;</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=函数类型>函数类型</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 定义函数类型的变量 赋值 函数, 调用 =&gt; 其他语言的高阶函数
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>add</span><span class=p>(</span><span class=nx>l</span><span class=p>,</span> <span class=nx>r</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>int</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>l</span> <span class=o>+</span> <span class=nx>r</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>mapFunc</span><span class=p>(</span><span class=nx>list</span> <span class=p>[]</span><span class=kt>int</span><span class=p>,</span> <span class=nx>tl</span> <span class=kd>func</span><span class=p>(</span><span class=kt>int</span><span class=p>)</span> <span class=kt>int</span><span class=p>)</span> <span class=p>[]</span><span class=kt>int</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>rt</span> <span class=o>:=</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>value</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>list</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>rt</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>rt</span><span class=p>,</span> <span class=nf>tl</span><span class=p>(</span><span class=nx>value</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>rt</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>tlAdd</span><span class=p>(</span><span class=nx>n</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>int</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>n</span> <span class=o>+</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T\n&#34;</span><span class=p>,</span> <span class=nx>add</span><span class=p>)</span> <span class=c1>// func(int, int) int
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 定义函数类型的变量
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>var</span> <span class=nx>f</span> <span class=kd>func</span><span class=p>(</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>int</span> <span class=c1>// 零值 nil
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>f</span> <span class=p>=</span> <span class=nx>add</span>                  <span class=c1>// 引用函数add
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T %v\n&#34;</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nf>f</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>))</span> <span class=c1>// 调用函数 5
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// map filter reduce
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 对切片进行操作
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// map: 对切片中每个元素通过某种转换得到结果组成新的切片
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// filter: 对切片的元素进行过滤
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// reduce: 初始化元素 将1个元素与初始化元素 =&gt; result + 2 =&gt; result + 3
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>nums</span> <span class=o>:=</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=c1>// map =&gt; 新的切片 []int
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nf>mapFunc</span><span class=p>(</span><span class=nx>nums</span><span class=p>,</span> <span class=nx>tlAdd</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=匿名函数>匿名函数</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>mapFunc</span><span class=p>(</span><span class=nx>list</span> <span class=p>[]</span><span class=kt>int</span><span class=p>,</span> <span class=nx>tl</span> <span class=kd>func</span><span class=p>(</span><span class=kt>int</span><span class=p>)</span> <span class=kt>int</span><span class=p>)</span> <span class=p>[]</span><span class=kt>int</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>rt</span> <span class=o>:=</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>value</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>list</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>rt</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>rt</span><span class=p>,</span> <span class=nf>tl</span><span class=p>(</span><span class=nx>value</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>rt</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 匿名函数：没有名字的函数 定义后直接赋值给某个变量 直接调用
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 往往做一些辅助性的功能(临时一个地方使用) 缩短作用域
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 匿名结构体
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 匿名接口
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>add</span> <span class=o>:=</span> <span class=kd>func</span><span class=p>(</span><span class=nx>left</span><span class=p>,</span> <span class=nx>right</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>int</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>left</span> <span class=o>+</span> <span class=nx>right</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %v\n&#34;</span><span class=p>,</span> <span class=nx>add</span><span class=p>,</span> <span class=nx>add</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nf>add</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span> <span class=mi>5</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// tlAdd5 := func(n int) int {
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//     return n + 5
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// }
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>nums</span> <span class=o>:=</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nf>mapFunc</span><span class=p>(</span><span class=nx>nums</span><span class=p>,</span> <span class=kd>func</span><span class=p>(</span><span class=nx>n</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>int</span> <span class=p>{</span> <span class=k>return</span> <span class=nx>n</span> <span class=o>+</span> <span class=mi>10</span> <span class=p>}))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>x</span> <span class=o>:=</span> <span class=kd>func</span><span class=p>(</span><span class=nx>left</span><span class=p>,</span> <span class=nx>right</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>int</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>left</span> <span class=o>+</span> <span class=nx>right</span>
</span></span><span class=line><span class=cl>    <span class=p>}(</span><span class=mi>5</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>func</span><span class=p>(</span><span class=nx>left</span><span class=p>,</span> <span class=nx>right</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>int</span> <span class=p>{</span> <span class=c1>// 不要返回值
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>left</span><span class=p>,</span> <span class=nx>right</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>left</span> <span class=o>+</span> <span class=nx>right</span>
</span></span><span class=line><span class=cl>    <span class=p>}(</span><span class=mi>11</span><span class=p>,</span> <span class=mi>11</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=闭包>闭包</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 在函数内部 会定义匿名函数 该匿名函数会引用外层函数的变量
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 生成一个新的函数 每次调用生成一个ID =&gt; 从start开始 id的间隔是step
</span></span></span><span class=line><span class=cl><span class=c1>// 面向切面编程 装饰器
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// generateId执行完成后 start step不能被销毁 闭包(内层匿名函数使用了外层函数的局部变量)使他们的生命周期变长
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>generateId</span><span class=p>(</span><span class=nx>start</span><span class=p>,</span> <span class=nx>step</span> <span class=kt>int</span><span class=p>)</span> <span class=kd>func</span><span class=p>()</span> <span class=kt>int</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kd>func</span><span class=p>()</span> <span class=kt>int</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;start: %v\n&#34;</span><span class=p>,</span> <span class=nx>start</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>id</span> <span class=o>:=</span> <span class=nx>start</span>
</span></span><span class=line><span class=cl>        <span class=nx>start</span> <span class=o>+=</span> <span class=nx>step</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>id</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>g1</span> <span class=o>:=</span> <span class=nf>generateId</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nf>g1</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nf>g1</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nf>g1</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nf>g1</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nf>g1</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>g100</span> <span class=o>:=</span> <span class=nf>generateId</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=mi>100</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nf>g100</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nf>g100</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nf>g100</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nf>g100</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 闭包：改变了变量的生命周期和作用域
</span></span></span><span class=line><span class=cl><span class=c1>// 变量的声明周期：从变量创建到销毁的过程
</span></span></span><span class=line><span class=cl><span class=c1>// 变量的作用域：变量可以使用的范围
</span></span></span></code></pre></td></tr></table></div></div><h3 id=类型>类型</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>var</span> <span class=nx>t</span> <span class=nx>T</span>
</span></span><span class=line><span class=cl><span class=nx>tmp</span> <span class=o>:=</span> <span class=nx>t</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 对tmp进行修改 可能影响到t =&gt; 引用类型
</span></span></span><span class=line><span class=cl><span class=c1>// 反之 任何操作都不能影响t =&gt; 值类型
</span></span></span></code></pre></td></tr></table></div></div><h4 id=值类型>值类型</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kt>int</span>
</span></span><span class=line><span class=cl><span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=kt>bool</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>...</span><span class=p>]</span><span class=kt>int</span> <span class=c1>// 数组 也是值类型
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=err>结构体</span>
</span></span><span class=line><span class=cl><span class=err>指针</span> <span class=nx>pointer</span> <span class=c1>// 有争议 为了降低函数参数拷贝带来的内存翻倍 会使用指针进行传递
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>nums</span> <span class=o>:=</span> <span class=p>[</span><span class=o>...</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>nums2</span> <span class=o>:=</span> <span class=nx>nums</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>nums</span><span class=p>,</span> <span class=nx>nums2</span><span class=p>)</span> <span class=c1>// [1 2 3 4 5] [1 2 3 4 5]
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>nums2</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=p>=</span> <span class=mi>1000</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>nums</span><span class=p>,</span> <span class=nx>nums2</span><span class=p>)</span> <span class=c1>// [1 2 3 4 5] [1000 2 3 4 5]
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=引用类型>引用类型</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 切片
</span></span></span><span class=line><span class=cl><span class=c1>// 映射
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// 使用了指针 或 内存地址
</span></span></span></code></pre></td></tr></table></div></div><h3 id=值传递>值传递</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=err>形参</span> <span class=p>=</span> <span class=err>实参</span>  
</span></span><span class=line><span class=cl><span class=c1>// 把实参 赋值给了实参 =&gt; 把实参的内存地址中的数据复制一份 赋值给形参
</span></span></span><span class=line><span class=cl><span class=c1>// 形参是实参的副本
</span></span></span><span class=line><span class=cl><span class=c1>// 在函数内对形参修改 不会对外面的实参有影响
</span></span></span><span class=line><span class=cl><span class=c1>// go中 不管值类型 还是引用类型 都会把实参对应内存地址的值复制一份 复制给形参
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// 注意：当传递的是 引用类型的时候 比如切片 因为共享底层数组的关系 在函数内修改索引的值 会影响底层数组的值 从而影响实参的值
</span></span></span></code></pre></td></tr></table></div></div><h3 id=错误处理>错误处理</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// go标准建议显式的将错误信息通过返回值返回给调用者 由调用者自行处理
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span><span class=p>()</span> <span class=p>(</span><span class=nx>xxx1</span><span class=p>,</span> <span class=nx>xxx2</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;errors&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;strconv&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>错误：
</span></span></span><span class=line><span class=cl><span class=cm>    语法错误 =&gt; 编译失败
</span></span></span><span class=line><span class=cl><span class=cm>    运行时 =&gt;
</span></span></span><span class=line><span class=cl><span class=cm>        可恢复错误/不可恢复错误
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>        网络问题失败
</span></span></span><span class=line><span class=cl><span class=cm>        读取文件失败
</span></span></span><span class=line><span class=cl><span class=cm>        写文件磁盘空间不足
</span></span></span><span class=line><span class=cl><span class=cm>        ...
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>fact</span><span class=p>(</span><span class=nx>n</span> <span class=kt>int64</span><span class=p>)</span> <span class=p>(</span><span class=kt>int64</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>n</span> <span class=p>&lt;</span> <span class=mi>0</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>errors</span><span class=p>.</span><span class=nf>New</span><span class=p>(</span><span class=s>&#34;计算错误&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>n</span> <span class=o>==</span> <span class=mi>1</span> <span class=o>||</span> <span class=nx>n</span> <span class=o>==</span> <span class=mi>0</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>1</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>r</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nf>fact</span><span class=p>(</span><span class=nx>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>==</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>n</span> <span class=o>*</span> <span class=nx>r</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;计算错误&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>i</span> <span class=kt>int</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>err</span> <span class=kt>error</span>
</span></span><span class=line><span class=cl>    <span class=c1>// i, err := strconv.Atoi(&#34;1.1.1.1&#34;)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>i</span><span class=p>,</span> <span class=nx>err</span> <span class=p>=</span> <span class=nx>strconv</span><span class=p>.</span><span class=nf>Atoi</span><span class=p>(</span><span class=s>&#34;1.1.1.1&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T %v\n&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=panic抛出错误>panic抛出错误</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>fact</span><span class=p>(</span><span class=nx>n</span> <span class=kt>int64</span><span class=p>)</span> <span class=kt>int64</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>n</span> <span class=p>&lt;</span> <span class=mi>0</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nb>panic</span><span class=p>(</span><span class=s>&#34;n不能小于0&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>n</span> <span class=o>==</span> <span class=mi>1</span> <span class=o>||</span> <span class=nx>n</span> <span class=o>==</span> <span class=mi>0</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>rt</span> <span class=o>:=</span> <span class=nx>n</span> <span class=o>*</span> <span class=nf>fact</span><span class=p>(</span><span class=nx>n</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>rt</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>fact</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=捕获错误>捕获错误</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// recover关键字 =&gt; 需要放置在延迟执行内部
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>fact</span><span class=p>(</span><span class=nx>n</span> <span class=kt>int64</span><span class=p>)</span> <span class=kt>int64</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>n</span> <span class=p>&lt;</span> <span class=mi>0</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nb>panic</span><span class=p>(</span><span class=s>&#34;n不能小于0&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>n</span> <span class=o>==</span> <span class=mi>1</span> <span class=o>||</span> <span class=nx>n</span> <span class=o>==</span> <span class=mi>0</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>rt</span> <span class=o>:=</span> <span class=nx>n</span> <span class=o>*</span> <span class=nf>fact</span><span class=p>(</span><span class=nx>n</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>rt</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// defer 函数调用
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>defer</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nx>errMsg</span> <span class=o>:=</span> <span class=nb>recover</span><span class=p>();</span> <span class=nx>errMsg</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>errMsg</span><span class=p>)</span> <span class=c1>// 相当于捕获错误
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}()</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nf>fact</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 函数将错误返回
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>fact</span><span class=p>(</span><span class=nx>n</span> <span class=kt>int64</span><span class=p>)</span> <span class=kt>int64</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>n</span> <span class=p>&lt;</span> <span class=mi>0</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nb>panic</span><span class=p>(</span><span class=s>&#34;n不能小于0&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>n</span> <span class=o>==</span> <span class=mi>1</span> <span class=o>||</span> <span class=nx>n</span> <span class=o>==</span> <span class=mi>0</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>rt</span> <span class=o>:=</span> <span class=nx>n</span> <span class=o>*</span> <span class=nf>fact</span><span class=p>(</span><span class=nx>n</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>rt</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>testError</span><span class=p>()</span> <span class=p>(</span><span class=nx>err</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// defer 函数调用
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>defer</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nx>errMsg</span> <span class=o>:=</span> <span class=nb>recover</span><span class=p>();</span> <span class=nx>errMsg</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>err</span> <span class=p>=</span> <span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;%v&#34;</span><span class=p>,</span> <span class=nx>errMsg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}()</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nf>fact</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nf>testError</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=延迟执行>延迟执行</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 执行函数 不管内部逻辑是否发生错误 都想要执行的代码
</span></span></span><span class=line><span class=cl><span class=c1>// 关键字：defer 后面必须跟函数调用
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>fact</span><span class=p>(</span><span class=nx>n</span> <span class=kt>int64</span><span class=p>)</span> <span class=kt>int64</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>n</span> <span class=p>&lt;</span> <span class=mi>0</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nb>panic</span><span class=p>(</span><span class=s>&#34;n不能小于0&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>n</span> <span class=o>==</span> <span class=mi>1</span> <span class=o>||</span> <span class=nx>n</span> <span class=o>==</span> <span class=mi>0</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>rt</span> <span class=o>:=</span> <span class=nx>n</span> <span class=o>*</span> <span class=nf>fact</span><span class=p>(</span><span class=nx>n</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>rt</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// defer 函数调用
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>defer</span> <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;main&#34;</span><span class=p>)</span> <span class=c1>// 不管是否有错误 都在所在的函数退出的时候执行
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>defer</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;defer 1&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}()</span>
</span></span><span class=line><span class=cl>    <span class=k>defer</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;defer 2&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}()</span>
</span></span><span class=line><span class=cl>    <span class=k>defer</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;defer 3&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}()</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nf>fact</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// $ go run panic.go // 同一个函数内多个defer 先定义的后执行
</span></span></span><span class=line><span class=cl><span class=c1>// 1
</span></span></span><span class=line><span class=cl><span class=c1>// defer 3
</span></span></span><span class=line><span class=cl><span class=c1>// defer 2
</span></span></span><span class=line><span class=cl><span class=c1>// defer 1
</span></span></span><span class=line><span class=cl><span class=c1>// main
</span></span></span></code></pre></td></tr></table></div></div><h4 id=defer注意事项>defer注意事项</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// defer内修改值
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>test</span><span class=p>()</span> <span class=p>(</span><span class=nx>i</span> <span class=kt>int</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>defer</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// defer 函数退出前执行 这个时候返回2
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// 除了error场景 不要在defer中使用修改返回值
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>i</span> <span class=p>=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>    <span class=p>}()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>i</span> <span class=p>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>i</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nf>test</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 闭包陷阱
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;start&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=mi>3</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span> <span class=c1>// 函数退出的时候 i的值为3 闭包陷阱
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>defer</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;end&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// $ go run defer2.go
</span></span></span><span class=line><span class=cl><span class=c1>// start
</span></span></span><span class=line><span class=cl><span class=c1>// end
</span></span></span><span class=line><span class=cl><span class=c1>// 3
</span></span></span><span class=line><span class=cl><span class=c1>// 3
</span></span></span><span class=line><span class=cl><span class=c1>// 3
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// 注意：defer不要写在循环之内
</span></span></span></code></pre></td></tr></table></div></div><h2 id=作用域>作用域</h2><ul><li>作用域内定义变量只能被声明一次且变量必须使用 否则编译错误</li><li>在不同作用域可定义相同的变量 此时局部将覆盖全局</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>version</span> <span class=kt>string</span> <span class=p>=</span> <span class=s>&#34;1.1.1&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span> <span class=c1>// main作用域
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 作用域： 变量的可使用范围
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// {}显示的声明一个作用域范围 - 嵌套{}可以想象为一个树状图
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 1. 在某个作用域范围内定义的变量 可以在其作用域每使用；子孙定义的 父看不见
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 2. 若标识符在某个作用域中有定义 若子孙某层作用域内重新定义 则被覆盖
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 对内穿透 就近原则 对外不可见(类比Python作用域记忆)
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;version1&#34;</span><span class=p>,</span> <span class=nx>version</span><span class=p>)</span> <span class=c1>// 1.1.1
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>var</span> <span class=nx>funcVersion</span> <span class=kt>string</span> <span class=p>=</span> <span class=s>&#34;2.2.2&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>version</span> <span class=kt>string</span> <span class=p>=</span> <span class=s>&#34;1.2.3&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;version2&#34;</span><span class=p>,</span> <span class=nx>version</span><span class=p>)</span> <span class=c1>// 1.2.3
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>//  funcVersion string = &#34;2.3.4&#34;  // 报错 同一块作用域 不能重新定义
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>{</span> <span class=c1>// A{}块
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;version3&#34;</span><span class=p>,</span> <span class=nx>version</span><span class=p>)</span> <span class=c1>// 1.2.3
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>version</span> <span class=p>=</span> <span class=s>&#34;AAAAA&#34;</span>                <span class=c1>// 这里直接修改的 main.version 重新赋值变量
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;version4&#34;</span><span class=p>,</span> <span class=nx>version</span><span class=p>)</span> <span class=c1>// AAAAA
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;version5&#34;</span><span class=p>,</span> <span class=nx>version</span><span class=p>)</span> <span class=c1>// AAAAA
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=p>{</span> <span class=c1>// B{}块
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;version6&#34;</span><span class=p>,</span> <span class=nx>version</span><span class=p>)</span> <span class=c1>// AAAA  main.version
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kd>var</span> <span class=nx>version</span> <span class=kt>string</span> <span class=p>=</span> <span class=s>&#34;BBBBB&#34;</span>     <span class=c1>// 在B块作用域内重新定义了一个version 没有改变main.version
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;version7&#34;</span><span class=p>,</span> <span class=nx>version</span><span class=p>)</span> <span class=c1>// BBBBB
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;version8&#34;</span><span class=p>,</span> <span class=nx>version</span><span class=p>)</span> <span class=c1>// AAAAA
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>version</span><span class=p>,</span> <span class=nx>funcVersion</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>$</span> <span class=k>go</span> <span class=nx>run</span> <span class=nx>scope</span><span class=p>.</span><span class=k>go</span> 
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=nx>version1</span> <span class=mf>1.1.1</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=nx>version2</span> <span class=mf>1.2.3</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=nx>version3</span> <span class=mf>1.2.3</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=nx>version4</span> <span class=nx>AAAAA</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=nx>version5</span> <span class=nx>AAAAA</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=nx>version6</span> <span class=nx>AAAAA</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=nx>version7</span> <span class=nx>BBBBB</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=nx>version8</span> <span class=nx>AAAAA</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=nx>AAAAA</span> <span class=mf>2.2.2</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=显式作用域>显式作用域</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=err>显式声明作用域：</span>
</span></span><span class=line><span class=cl>  <span class=p>{}</span> <span class=err>大括号</span> 
</span></span></code></pre></td></tr></table></div></div><h2 id=隐式作用域>隐式作用域</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=err>隐式声明作用域：</span>
</span></span><span class=line><span class=cl>  <span class=mf>1.</span> <span class=err>全局作用域</span>
</span></span><span class=line><span class=cl>  <span class=mf>2.</span> <span class=err>包作用域</span>
</span></span><span class=line><span class=cl>  <span class=mf>3.</span> <span class=err>文件作用域</span>
</span></span><span class=line><span class=cl>  <span class=mf>4.</span> <span class=k>if</span> <span class=k>switch</span> <span class=k>for</span> <span class=k>select</span> <span class=nx>case</span><span class=err>语句块</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=流程控制>流程控制</h2><h3 id=if>if</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=k>if</span> <span class=nx>expr1</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>cmd1</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=nx>expr2</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>cmd2</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=nx>exprn</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>cmdn</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>default_cmd</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// if必须有 
</span></span></span><span class=line><span class=cl><span class=c1>// else if任意多个
</span></span></span><span class=line><span class=cl><span class=c1>// esle 0个或1个
</span></span></span></code></pre></td></tr></table></div></div><h3 id=switch>switch</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>value</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Scan</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>value</span><span class=p>)</span> <span class=c1>// 从console获取值
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=k>switch</span> <span class=nx>value</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=s>&#34;sg&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;gre2&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=s>&#34;us&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;gre3&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=s>&#34;tw&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;gre4&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>default</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;gre1&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=for>for</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// var s string = &#34;My name is Minho&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// for init; expr; end {}
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 1 + 2 + ... + 100
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>var</span> <span class=nx>total</span> <span class=kt>int</span> <span class=p>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>1</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;=</span> <span class=mi>100</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>total</span> <span class=o>+=</span> <span class=nx>i</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>total</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>total</span> <span class=p>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>i</span> <span class=kt>int</span> <span class=p>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>i</span> <span class=o>&lt;=</span> <span class=mi>100</span> <span class=p>{</span> <span class=c1>// 类while写法
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>total</span> <span class=o>+=</span> <span class=nx>i</span>
</span></span><span class=line><span class=cl>        <span class=nx>i</span><span class=o>++</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>total</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// var nums int = 0
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// for { // 死循环 类似于python： while True: cmd
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//     nums++
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//     fmt.Println(nums)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// }
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// break
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>1</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=mi>5</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nx>i</span> <span class=o>==</span> <span class=mi>3</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span> <span class=c1>// 结束循环
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=c1>// continue
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>1</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=mi>5</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nx>i</span> <span class=o>==</span> <span class=mi>3</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span> <span class=c1>// 跳过本次循环 下次继续
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// continue break只能跳出或结束当前循环
</span></span></span><span class=line><span class=cl><span class=c1>// 配合label使用 可以跳出到指定label
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>BEXIT</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=mi>3</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>j</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>j</span> <span class=p>&lt;</span> <span class=mi>3</span><span class=p>;</span> <span class=nx>j</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nx>j</span> <span class=o>==</span> <span class=mi>1</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span> <span class=nx>BEXIT</span> <span class=c1>// 直接跳出for循环
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>CEXIT</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=mi>3</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>j</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>j</span> <span class=p>&lt;</span> <span class=mi>3</span><span class=p>;</span> <span class=nx>j</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nx>j</span> <span class=o>==</span> <span class=mi>1</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span> <span class=nx>CEXIT</span> <span class=c1>// 直接跳出到for循环
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=goto>goto</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>total</span><span class=p>,</span> <span class=nx>incr</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>START</span><span class=p>:</span> <span class=c1>// label表示  标识符:
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>total</span> <span class=o>+=</span> <span class=nx>incr</span>
</span></span><span class=line><span class=cl>    <span class=nx>incr</span><span class=o>++</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>incr</span> <span class=o>&lt;=</span> <span class=mi>100</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>goto</span> <span class=nx>START</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>goto</span> <span class=nx>END</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>total</span><span class=p>)</span> <span class=c1>// 此时 永远无法执行这个print语句
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=nx>END</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;total:&#34;</span><span class=p>,</span> <span class=nx>total</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=单步调试工具-dlv>单步调试工具 dlv</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ dlv debug xxx.go  <span class=c1># help查看完整帮助</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># vscode有图形界面可以调试 debug模式</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=包管理模块>包管理/模块</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 包 模块
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=err>代码</span><span class=nx>main</span> <span class=p>=&gt;</span> <span class=err>分函数</span> <span class=p>=&gt;</span> <span class=err>分文件</span> <span class=p>=&gt;</span> <span class=err>分文件夹</span> <span class=c1>// 代码整理(项目的组织方式)
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=err>第三方别人开发的包</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>github</span><span class=p>.</span><span class=nx>com</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span><span class=p>&gt;</span> <span class=err>下载</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span><span class=p>&gt;</span> <span class=nx>GOPATH</span> <span class=nx>src</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>go</span><span class=err>工具：</span>
</span></span><span class=line><span class=cl>  <span class=k>go</span> <span class=nx>build</span>
</span></span><span class=line><span class=cl>  <span class=k>go</span> <span class=nx>install</span> <span class=err>第三方包地址</span>
</span></span><span class=line><span class=cl>  <span class=k>go</span> <span class=nx>get</span> <span class=err>第三方包地址</span> <span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>ilolicon</span><span class=o>/</span><span class=nx>xxx</span>  <span class=c1>// 下载第三方包
</span></span></span><span class=line><span class=cl><span class=c1></span>     <span class=nx>git</span><span class=o>/</span><span class=nx>svn</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>第三方包查找地址：</span>
</span></span><span class=line><span class=cl>  <span class=nx>https</span><span class=p>:</span><span class=c1>//godoc.org/
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>https</span><span class=p>:</span><span class=c1>//gowalker.org/
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=err>变量可见性：</span>
</span></span><span class=line><span class=cl>  <span class=err>首字母大小写的问题</span>
</span></span><span class=line><span class=cl>    <span class=err>首字母小写的变量只对包内可见</span>
</span></span><span class=line><span class=cl>    <span class=err>首字母大写才对外部的其他包可见</span><span class=p>(</span><span class=err>可以调用</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 包
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=err>包名：在同一个文件夹内</span> <span class=err>包名必须一致</span>
</span></span><span class=line><span class=cl><span class=nx>main</span><span class=err>包：可编译为可执行的结果</span><span class=p>(</span><span class=err>二进制程序</span><span class=p>)</span> <span class=kn>package</span> <span class=err>定义为</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl><span class=err>功能代码：若功能不需要编译为可执行程序</span> <span class=o>-</span><span class=p>&gt;</span> <span class=err>命名为非</span><span class=nx>main</span> <span class=o>-</span><span class=p>&gt;</span> <span class=err>可以任意定义</span> <span class=o>-</span><span class=p>&gt;</span> <span class=err>标识符规范</span><span class=p>(</span><span class=err>一般使用文件夹名称</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=err>若不在同一个包下面调用不同文件中定义的函数</span>
</span></span><span class=line><span class=cl>  <span class=err>导入：</span>
</span></span><span class=line><span class=cl>    <span class=o>-</span> <span class=nx>package</span><span class=err>包名和目录一致：导入目录路径</span><span class=p>(</span><span class=nx>GOPATH</span> <span class=nx>src</span><span class=err>后面的目录路径</span><span class=p>)</span> <span class=kn>import</span> <span class=s>&#34;cmdb/user&#34;</span>
</span></span><span class=line><span class=cl>    <span class=o>-</span> <span class=nx>package</span><span class=err>包名和目录不一致：</span><span class=kn>import</span> <span class=s>&#34;cmdb/idc&#34;</span> <span class=err>注意</span> <span class=err>导入仍是路径</span> <span class=err>但是这个调用的包名则不一致</span>
</span></span><span class=line><span class=cl>  <span class=err>调用：通过包名</span><span class=p>.</span><span class=err>函数名称</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// GO111MODULE
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>GO111MODULE</span><span class=p>=</span><span class=nx>on</span><span class=o>/</span><span class=nx>off</span><span class=o>/</span><span class=nx>auto</span>
</span></span><span class=line><span class=cl><span class=nx>on</span>   <span class=o>-</span><span class=p>&gt;</span> <span class=err>启动</span><span class=nx>module</span>
</span></span><span class=line><span class=cl><span class=nx>off</span>  <span class=o>-</span><span class=p>&gt;</span> <span class=err>关闭</span><span class=nx>module</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>gopath</span> <span class=o>+</span> <span class=nx>vendor</span>
</span></span><span class=line><span class=cl><span class=nx>auto</span> <span class=o>-</span><span class=p>&gt;</span> <span class=err>自动判断</span>
</span></span><span class=line><span class=cl>        <span class=err>依据：代码不再</span><span class=nx>GOPATH</span><span class=err>目录</span> <span class=err>目录存在</span><span class=k>go</span><span class=p>.</span><span class=nx>mod</span><span class=err>文件</span> <span class=o>-</span><span class=p>&gt;</span> <span class=err>都满足为</span><span class=nx>module</span> <span class=err>否则为</span><span class=nx>gopath</span><span class=o>+</span><span class=nx>vendor</span><span class=err>方式</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=gopath--vendor>GOPATH + vendor</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=err>方案</span><span class=mi>1</span><span class=err>：</span><span class=mf>1.11</span> <span class=err>之前</span> <span class=nx>gopath</span> <span class=o>+</span> <span class=nx>vendor</span><span class=err>方式</span><span class=o>/</span><span class=err>其他开源方案</span>
</span></span><span class=line><span class=cl><span class=nx>gopath</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span><span class=p>&gt;</span> <span class=nf>GOPATH</span><span class=p>(</span><span class=err>配置一个或者多个目录</span><span class=p>)</span> <span class=c1>// GOPATH=C:\Users\97431\go
</span></span></span><span class=line><span class=cl><span class=c1></span>     <span class=c1>// 代码必须放在GOPATH目录下
</span></span></span><span class=line><span class=cl><span class=c1></span>     <span class=nx>src</span> <span class=o>-</span><span class=p>&gt;</span> <span class=err>源码</span>
</span></span><span class=line><span class=cl>     <span class=nx>bin</span> <span class=o>-</span><span class=p>&gt;</span> <span class=err>放二进制文件</span>
</span></span><span class=line><span class=cl>     <span class=nx>pkg</span> <span class=o>-</span><span class=p>&gt;</span> <span class=err>第三方包</span><span class=p>(</span><span class=err>经过编译过的</span><span class=p>.</span><span class=nx>a</span><span class=err>文件</span><span class=p>)</span> <span class=c1>// go install xx的时候会生成相关依赖的.a文件 -&gt; 编译快
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=nx>vendor</span><span class=p>:</span> <span class=err>主要解决多版本问题</span> <span class=err>优先调用</span><span class=nx>vendor</span><span class=err>目录下面的版本</span><span class=p>(</span><span class=err>代码</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>vendor</span><span class=err>：可以放在任何目录</span> <span class=err>查找的时候：</span>
</span></span><span class=line><span class=cl>        <span class=err>当前目录查找</span><span class=nf>vendor</span><span class=p>(</span><span class=err>无</span><span class=nx>vendor</span><span class=o>/</span><span class=err>有</span><span class=nx>vendor</span><span class=err>无包</span><span class=p>)</span> <span class=o>-</span><span class=p>&gt;</span> <span class=err>上一级目录</span> <span class=o>-</span><span class=p>&gt;</span> <span class=o>...</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>GOPATH</span> <span class=nx>vendor</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>GOPATH</span> <span class=o>-</span><span class=p>&gt;</span> <span class=err>标准库</span> <span class=o>-</span><span class=p>&gt;</span> <span class=err>报错</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 代码放在GOPATH目录下 可以在任意目录build
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>go</span> <span class=nx>build</span> <span class=p>.</span> <span class=o>||</span> <span class=k>go</span> <span class=nx>build</span> <span class=nf>user</span><span class=p>(</span><span class=nx>GOPATH</span> <span class=nx>src</span><span class=err>下面的目录名</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// cp $WORK\b001\exe\a.out.exe C:\GoWorkspace\go\bin\user.exe 
</span></span></span><span class=line><span class=cl><span class=c1>// 将程序编译并拷贝到GOPATH的bin目录下
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>go</span> <span class=nx>install</span> <span class=o>-</span><span class=nx>x</span> <span class=nf>user</span><span class=p>(</span><span class=nx>GOPATH</span> <span class=nx>src</span><span class=err>下面的目录名</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 导入包
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>GOPATH/
</span></span></span><span class=line><span class=cl><span class=cm>  cmdb/
</span></span></span><span class=line><span class=cl><span class=cm>    user/
</span></span></span><span class=line><span class=cl><span class=cm>      main.go  // 都在user包里面 调用user.go里面的函数 直接使用函数名称调用即可
</span></span></span><span class=line><span class=cl><span class=cm>      user.go  // 都在user包里面 
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 在同一个包下面调用不同文件中定义的函数 -&gt; 直接调用函数名称
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nf>add</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nf>modify</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>delete</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nf>find</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>------------------------------</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>GOPATH/
</span></span></span><span class=line><span class=cl><span class=cm>  cmdb/
</span></span></span><span class=line><span class=cl><span class=cm>    user/
</span></span></span><span class=line><span class=cl><span class=cm>      user.go  // 功能代码
</span></span></span><span class=line><span class=cl><span class=cm>    idc/
</span></span></span><span class=line><span class=cl><span class=cm>      idc.go  // 功能代码
</span></span></span><span class=line><span class=cl><span class=cm>    main.go
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;cmdb/user&#34;</span> <span class=c1>// GOPATH src后面的目录路径
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 在不同包下面调用不同文件中定义的函数 -&gt; 先导入包 -&gt; 通道包名.函数名称
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 但是这里会报错 =&gt; 变量可见性问题 标识符首字符小写 只能包内使用 不能导出
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>user</span><span class=p>.</span><span class=nf>add</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>user</span><span class=p>.</span><span class=nf>modify</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>user</span><span class=p>.</span><span class=nb>delete</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>user</span><span class=p>.</span><span class=nf>find</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=module>MODULE</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=err>方案</span><span class=mi>2</span><span class=err>：</span><span class=mf>1.11</span><span class=err>及之后</span> <span class=nf>GOMODULE</span><span class=p>(</span><span class=err>重点</span><span class=p>)</span> <span class=c1>// GO 1.11 MODULE
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=err>优势：</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=err>不用设置</span><span class=nx>GOPATH</span> <span class=err>代码可以任意放置</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=err>自动下载依赖管理</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=err>版本控制</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=err>不允许使用相对导入</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=nx>replace</span><span class=err>机制</span><span class=p>(</span><span class=err>网络问题</span><span class=nx>goproxy</span> <span class=err>和</span> <span class=err>包重命名问题</span> <span class=err>现在很少使用</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>GO111MODULE</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 初始化模块
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>go</span> <span class=nx>mod</span> <span class=nx>init</span> <span class=err>模块名称</span> <span class=c1>// go mod init cmdb
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>go</span> <span class=nx>mod</span> <span class=nx>tidy</span> <span class=c1>// 下载依赖的第三方模块
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=err>执行：</span><span class=k>go</span> <span class=nx>run</span> <span class=p>.</span>
</span></span><span class=line><span class=cl>       <span class=k>go</span> <span class=nx>build</span> <span class=p>.</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>  <span class=c1>// 模块名称命名
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=mf>1.</span> <span class=err>远程仓库的命名称</span> <span class=nx>cmdb</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>ilolicon</span><span class=o>/</span><span class=nx>cmdb</span> <span class=c1>// 简单 不能作为第三方包使用
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=mf>2.</span> <span class=err>带上仓库地址：</span><span class=nx>git</span> <span class=nx>mod</span> <span class=nx>init</span> <span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>ilolicon</span><span class=o>/</span><span class=nx>cmdb</span> <span class=c1>// github地址 + 用户名 + 账号名称
</span></span></span><span class=line><span class=cl><span class=c1></span>     <span class=err>指定版本：依赖</span><span class=nx>tag</span> <span class=nx>git</span><span class=o>/</span><span class=nx>svn</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>tag</span> <span class=nx>v0</span><span class=p>.</span><span class=nx>x</span><span class=p>.</span><span class=nx>x</span> <span class=nx>v1</span><span class=p>.</span><span class=nx>x</span><span class=p>.</span><span class=nx>x</span>
</span></span><span class=line><span class=cl>     <span class=err>下载指定版本：</span><span class=k>go</span> <span class=nx>get</span> <span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>ilolicon</span><span class=o>/</span><span class=nx>math</span><span class=err>@</span><span class=nx>v1</span><span class=mf>.0.0</span> <span class=err>或者手动修改</span><span class=k>go</span><span class=p>.</span><span class=nx>mod</span><span class=err>文件</span> <span class=err>重新</span><span class=k>go</span> <span class=nx>mod</span> <span class=nx>tidy</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// GO111MODULE 导入包 同模块
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 同模块 -&gt; modulename(go mod init初始化时给出的模块名称)/目录路径
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// go.mod文本文件 依赖 模块名称 可以直接修改
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=s>&#34;cmdbxx/user&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Hello, World&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>user</span><span class=p>.</span><span class=nf>Add</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>-----------------------</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;cmdb/user&#34;</span> <span class=c1>// 同模块 -&gt; modulename/目录路径
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=s>&#34;github.com/beego/beego/v2/server/web&#34;</span> <span class=c1>// 使用第三方模块 go mod tidy
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Hello, World&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>user</span><span class=p>.</span><span class=nf>Add</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>web</span><span class=p>.</span><span class=nf>Run</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 导入远程第三方包
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>       <span class=c1>// go mod tidy 会自动去下载
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=s>&#34;github.com/ilolicon/math&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>math</span><span class=p>.</span><span class=nx>PI</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>math</span><span class=p>.</span><span class=nf>Add</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span> <span class=mi>7</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// math包设置 模块名以 github.com + 用户名 + 模块名 设置
</span></span></span><span class=line><span class=cl><span class=c1>// go mod init github.com/ilolicon/math
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>math</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>const</span> <span class=nx>PI</span> <span class=kt>float32</span> <span class=p>=</span> <span class=mf>3.141592653</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>Add</span><span class=p>(</span><span class=nx>l</span><span class=p>,</span> <span class=nx>r</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>int</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>l</span> <span class=o>+</span> <span class=nx>r</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 包名冲突 使用别名解决
</span></span></span><span class=line><span class=cl><span class=c1>// 别名导入
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=nx>testmod</span><span class=o>/</span><span class=nx>aaa</span><span class=o>/</span><span class=nx>math</span><span class=s>&#34;  // 绝对路径导入 -&gt; 还有相对路径导入 gomod禁用
</span></span></span><span class=line><span class=cl><span class=s>    bmath &#34;</span><span class=nx>testmod</span><span class=o>/</span><span class=nx>bbb</span><span class=o>/</span><span class=nx>math</span><span class=s>&#34; // 别名直接在导入包前面设置即可
</span></span></span><span class=line><span class=cl><span class=s>)
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>func main() {
</span></span></span><span class=line><span class=cl><span class=s>    math.Add(1, 1)
</span></span></span><span class=line><span class=cl><span class=s>    bmath.Add(1, 1)
</span></span></span><span class=line><span class=cl><span class=s>}
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>// 点导入
</span></span></span><span class=line><span class=cl><span class=s>import (
</span></span></span><span class=line><span class=cl><span class=s>    . &#34;</span><span class=nx>testmod</span><span class=o>/</span><span class=nx>aaa</span><span class=o>/</span><span class=nx>math</span><span class=s>&#34; // 点导入 调用包内函数的变量 不用加包名 尽量不用 减少变量污染
</span></span></span><span class=line><span class=cl><span class=s>)
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>func main() {
</span></span></span><span class=line><span class=cl><span class=s>    Add(1, 1)
</span></span></span><span class=line><span class=cl><span class=s>}
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>// 下划线导入
</span></span></span><span class=line><span class=cl><span class=s>// 包导入不使用 会报错 可以使用下划线导入
</span></span></span><span class=line><span class=cl><span class=s>// 不使用还导入 有什么作用？ -&gt; 包初始化 执行包内初始化函数 func init() {}
</span></span></span><span class=line><span class=cl><span class=s>import (
</span></span></span><span class=line><span class=cl><span class=s>    _ &#34;</span><span class=nx>testmod</span><span class=o>/</span><span class=nx>aaa</span><span class=o>/</span><span class=nx>math</span><span class=err>&#34;</span>  <span class=c1>// 别名导入的特殊形式 注册机制会用到
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=导入总结>导入总结</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=cm>/* 
</span></span></span><span class=line><span class=cl><span class=cm>导入包
</span></span></span><span class=line><span class=cl><span class=cm> 绝对路径导入
</span></span></span><span class=line><span class=cl><span class=cm>   GOPATH src下的目录
</span></span></span><span class=line><span class=cl><span class=cm>   gomod 同模块 模块名称/路径
</span></span></span><span class=line><span class=cl><span class=cm>         第三方模块 第三方模块名称/路径
</span></span></span><span class=line><span class=cl><span class=cm> 别名导入
</span></span></span><span class=line><span class=cl><span class=cm>   导入多个相同名称的包
</span></span></span><span class=line><span class=cl><span class=cm>   
</span></span></span><span class=line><span class=cl><span class=cm> 下划线导入
</span></span></span><span class=line><span class=cl><span class=cm>   包初始化 init 不要依赖他的顺序
</span></span></span><span class=line><span class=cl><span class=cm>   
</span></span></span><span class=line><span class=cl><span class=cm> 相对路径导入
</span></span></span><span class=line><span class=cl><span class=cm>   gomod中禁用
</span></span></span><span class=line><span class=cl><span class=cm>   
</span></span></span><span class=line><span class=cl><span class=cm> 点导入
</span></span></span><span class=line><span class=cl><span class=cm>   尽量不用 容易变量冲突 污染
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=init函数>init函数</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 导入包 会自动调用该包内的init函数
</span></span></span><span class=line><span class=cl><span class=c1>// 一个包内可以有任意多个 可以定义无数次 但建议只写1个
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>init</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>cmd</span> <span class=c1>// go定义的初始化函数 没有参数 没有返回值 包被导入的时候 自动执行
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=可见性>可见性</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 只能在包内可用：包内可见 变量名称小写
</span></span></span><span class=line><span class=cl><span class=c1>// 可以在包外使用：包外可见 变量名称大写
</span></span></span></code></pre></td></tr></table></div></div><h2 id=标准库及第三方库>标准库及第三方库</h2><p><a class=link href=https://golang.google.cn/pkg/ target=_blank rel=noopener>标准库官网文档</a></p><p><a class=link href=https://studygolang.com/pkgdoc target=_blank rel=noopener>Golang标准库中文文档</a></p><h3 id=fmt>fmt</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>()</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>格式化的字符串 占位 后面的数据进行填充
</span></span></span><span class=line><span class=cl><span class=cm>  占位符
</span></span></span><span class=line><span class=cl><span class=cm>    %T %v %#V 与数据类型无关 打印变量类型 %v %#V 以可识别的格式打印
</span></span></span><span class=line><span class=cl><span class=cm>    %s 字符串
</span></span></span><span class=line><span class=cl><span class=cm>    %d 整数
</span></span></span><span class=line><span class=cl><span class=cm>    %t 布尔值true|false
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>name</span> <span class=p>=</span> <span class=s>&#34;minho&#34;</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>id</span> <span class=p>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;name: %T, id: %T\n&#34;</span><span class=p>,</span> <span class=nx>name</span><span class=p>,</span> <span class=nx>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;name: %v, id: %v\n&#34;</span><span class=p>,</span> <span class=nx>name</span><span class=p>,</span> <span class=nx>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;name: %#v, id: %#v\n&#34;</span><span class=p>,</span> <span class=nx>name</span><span class=p>,</span> <span class=nx>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;name: %s, id: %d\n&#34;</span><span class=p>,</span> <span class=nx>name</span><span class=p>,</span> <span class=nx>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>$</span> <span class=k>go</span> <span class=nx>run</span> <span class=nx>debug</span><span class=p>.</span><span class=k>go</span> 
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=nx>name</span><span class=p>:</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>id</span><span class=p>:</span> <span class=kt>int</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=nx>name</span><span class=p>:</span> <span class=nx>minho</span><span class=p>,</span> <span class=nx>id</span><span class=p>:</span> <span class=mi>1</span>   
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=nx>name</span><span class=p>:</span> <span class=s>&#34;minho&#34;</span><span class=p>,</span> <span class=nx>id</span><span class=p>:</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>&gt;</span> <span class=nx>name</span><span class=p>:</span> <span class=nx>minho</span><span class=p>,</span> <span class=nx>id</span><span class=p>:</span> <span class=mi>1</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>输入输出</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 输出
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nx>fmt</span><span class=p>.</span><span class=nf>Print</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nx>fmt</span><span class=p>.</span><span class=nx>Printf</span> <span class=o>-</span><span class=p>&gt;</span> <span class=err>占位符</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 输入(从控制台获取输入)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>fmt</span><span class=p>.</span><span class=nx>Scan</span>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 先定义比变量
</span></span></span><span class=line><span class=cl><span class=c1>// fmt.Scan(&amp;变量名)
</span></span></span></code></pre></td></tr></table></div></div><h3 id=strconv>strconv</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// import &#34;strconv&#34;
</span></span></span><span class=line><span class=cl><span class=c1>// strconv包实现了基本数据类型和其字符串表示的相互转换
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;strconv&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// i, err := strconv.Atoi(&#34;10&#34;)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// if err != nil {
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//     panic(err)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// }
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// fmt.Printf(&#34;%T, %v\n&#34;, i, i)
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 上面部分可以写在一行 if放在最前面 这样变量i err就成了if块的局部变量
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=nx>i</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>strconv</span><span class=p>.</span><span class=nf>Atoi</span><span class=p>(</span><span class=s>&#34;10&#34;</span><span class=p>);</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span> <span class=c1>// string =&gt; int
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nb>panic</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %v\n&#34;</span><span class=p>,</span> <span class=nx>i</span><span class=p>,</span> <span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// int =&gt; string
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %v\n&#34;</span><span class=p>,</span> <span class=nx>strconv</span><span class=p>.</span><span class=nf>Itoa</span><span class=p>(</span><span class=mi>10</span><span class=p>),</span> <span class=nx>strconv</span><span class=p>.</span><span class=nf>Itoa</span><span class=p>(</span><span class=mi>10</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// string =&gt; float64
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>f</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>strconv</span><span class=p>.</span><span class=nf>ParseFloat</span><span class=p>(</span><span class=s>&#34;12.2&#34;</span><span class=p>,</span> <span class=mi>64</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nb>panic</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %v\n&#34;</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// float64 =&gt; string
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strconv</span><span class=p>.</span><span class=nf>FormatFloat</span><span class=p>(</span><span class=mf>12.2</span><span class=p>,</span> <span class=sc>&#39;E&#39;</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>64</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strconv</span><span class=p>.</span><span class=nf>FormatFloat</span><span class=p>(</span><span class=mf>12.2</span><span class=p>,</span> <span class=sc>&#39;f&#39;</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>64</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// string =&gt; int8 int16 int32 int64 -&gt; ParseInt ParseUint
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// int8 int16 int32 int64 =&gt; string -&gt; FormatInt FormatUint
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=strings>strings</h3><p><a class=link href=https://golang.google.cn/pkg/strings/ target=_blank rel=noopener>用于操作字符的简单函数</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;strings&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>Compare</span><span class=p>(</span><span class=s>&#34;abc&#34;</span><span class=p>,</span> <span class=s>&#34;ade&#34;</span><span class=p>))</span>        <span class=c1>// -1
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>Contains</span><span class=p>(</span><span class=s>&#34;abc&#34;</span><span class=p>,</span> <span class=s>&#34;ab&#34;</span><span class=p>))</span>        <span class=c1>// true
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>Count</span><span class=p>(</span><span class=s>&#34;abcabcabc&#34;</span><span class=p>,</span> <span class=s>&#34;ab&#34;</span><span class=p>))</span>     <span class=c1>// 3
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>EqualFold</span><span class=p>(</span><span class=s>&#34;ab&#34;</span><span class=p>,</span> <span class=s>&#34;AB&#34;</span><span class=p>))</span>        <span class=c1>// true 比较 忽略大小写
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>Fields</span><span class=p>(</span><span class=s>&#34;a b\tc\r\nd\fe&#34;</span><span class=p>))</span>     <span class=c1>// [a b c d e]
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>HasPrefix</span><span class=p>(</span><span class=s>&#34;test.go&#34;</span><span class=p>,</span> <span class=s>&#34;test&#34;</span><span class=p>))</span> <span class=c1>// true
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>HasSuffix</span><span class=p>(</span><span class=s>&#34;test.go&#34;</span><span class=p>,</span> <span class=s>&#34;.exe&#34;</span><span class=p>))</span> <span class=c1>// false
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>Index</span><span class=p>(</span><span class=s>&#34;1abcabc&#34;</span><span class=p>,</span> <span class=s>&#34;ab&#34;</span><span class=p>))</span>       <span class=c1>// 1 字符在字符串中出现的位置(索引) 没找到返回-1
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>LastIndex</span><span class=p>(</span><span class=s>&#34;1abcabc&#34;</span><span class=p>,</span> <span class=s>&#34;ab&#34;</span><span class=p>))</span>   <span class=c1>// 4
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 连接与分割
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>Join</span><span class=p>([]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;a&#34;</span><span class=p>,</span> <span class=s>&#34;b&#34;</span><span class=p>,</span> <span class=s>&#34;c&#34;</span><span class=p>},</span> <span class=s>&#34;-&#34;</span><span class=p>))</span> <span class=c1>// a-b-c
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>Split</span><span class=p>(</span><span class=s>&#34;a-b-c&#34;</span><span class=p>,</span> <span class=s>&#34;-&#34;</span><span class=p>))</span>                <span class=c1>// 分割为切片
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>SplitN</span><span class=p>(</span><span class=s>&#34;a-b-c&#34;</span><span class=p>,</span> <span class=s>&#34;-&#34;</span><span class=p>,</span> <span class=mi>2</span><span class=p>))</span>            <span class=c1>// [a b-c]
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>Repeat</span><span class=p>(</span><span class=s>&#34;*&#34;</span><span class=p>,</span> <span class=mi>20</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>Replace</span><span class=p>(</span><span class=s>&#34;abc,abc,abcd, abd&#34;</span><span class=p>,</span> <span class=s>&#34;abc&#34;</span><span class=p>,</span> <span class=s>&#34;xyz&#34;</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>))</span> <span class=c1>// -1 == ReplaceAll
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>Trim</span><span class=p>(</span><span class=s>&#34;bcaAbcdeacb&#34;</span><span class=p>,</span> <span class=s>&#34;abc&#34;</span><span class=p>))</span> <span class=c1>// Abcde 左右都移除
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// TrimLeft/TrimRight 和 TrimSuffix/TrimPreffix 区别
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// TrimLeft/TrimRight 把给出的字符串中的每一个字符 都去目标字符串中移除
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// TrimSuffix/TrimPreffix 把给出的字符串当作一个整体 去目标字符串中移除
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>TrimSpace</span><span class=p>(</span><span class=s>&#34; abc abc\r\n\f&#34;</span><span class=p>))</span> <span class=c1>// abc abc 去除前后空白字符
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 类比 bytes包 一个对字符串操作 一个对字节切片操作
</span></span></span></code></pre></td></tr></table></div></div><h3 id=sync>sync</h3><h4 id=syncatomic>sync.atomic</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 原子操作
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=err>原子操作是指过程中不能中断的操作</span><span class=nx>s</span> <span class=nx>Go</span><span class=err>语言</span><span class=nx>sync</span><span class=o>/</span><span class=nx>atomic</span><span class=err>包中提供了五类原子操作函数</span> <span class=err>其操作对象为整数型或整数指针</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=nx>Add</span><span class=o>*</span> <span class=err>增加</span><span class=o>/</span><span class=err>减少</span><span class=nx>s</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=nx>Load</span><span class=o>*</span> <span class=err>载入</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=nx>Store</span><span class=o>*</span> <span class=err>存储</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=nx>Swap</span><span class=o>*</span> <span class=err>更新</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=nx>CompareAndSwap</span><span class=o>*</span> <span class=err>比较第一个参数引用值是否与第二个参数值相同</span> <span class=err>若相同则将第一个参数值更新为第三个参数</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 对共享内存操作 - 加锁
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;sync&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>counter</span> <span class=kt>int</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>wg</span> <span class=nx>sync</span><span class=p>.</span><span class=nx>WaitGroup</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>locker</span> <span class=nx>sync</span><span class=p>.</span><span class=nx>Mutex</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>wg</span><span class=p>.</span><span class=nf>Add</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=mi>5</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>go</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=nx>x</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>x</span> <span class=p>&lt;</span> <span class=mi>10000</span><span class=p>;</span> <span class=nx>x</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>locker</span><span class=p>.</span><span class=nf>Lock</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=nx>counter</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                <span class=nx>locker</span><span class=p>.</span><span class=nf>Unlock</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=nx>wg</span><span class=p>.</span><span class=nf>Done</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>}()</span>
</span></span><span class=line><span class=cl>        <span class=k>go</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=nx>x</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>x</span> <span class=p>&lt;</span> <span class=mi>10000</span><span class=p>;</span> <span class=nx>x</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>locker</span><span class=p>.</span><span class=nf>Lock</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=nx>counter</span> <span class=o>-=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                <span class=nx>locker</span><span class=p>.</span><span class=nf>Unlock</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=nx>wg</span><span class=p>.</span><span class=nf>Done</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>}()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>wg</span><span class=p>.</span><span class=nf>Wait</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>counter</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 不加go关键字使用协程 结果为0
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 使用go启动协程之后 对同一个内存(&amp;counter)进行操作 会有冲突 需要加锁 或 原子操作
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 原子操作 操作类型有限 使用较少
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;sync&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;sync/atomic&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>counter</span> <span class=kt>int64</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>wg</span> <span class=nx>sync</span><span class=p>.</span><span class=nx>WaitGroup</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>wg</span><span class=p>.</span><span class=nf>Add</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=mi>5</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>go</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=nx>x</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>x</span> <span class=p>&lt;</span> <span class=mi>10000</span><span class=p>;</span> <span class=nx>x</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>atomic</span><span class=p>.</span><span class=nf>AddInt64</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>counter</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=nx>wg</span><span class=p>.</span><span class=nf>Done</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>}()</span>
</span></span><span class=line><span class=cl>        <span class=k>go</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=nx>x</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>x</span> <span class=p>&lt;</span> <span class=mi>10000</span><span class=p>;</span> <span class=nx>x</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>atomic</span><span class=p>.</span><span class=nf>AddInt64</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>counter</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=nx>wg</span><span class=p>.</span><span class=nf>Done</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>}()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>wg</span><span class=p>.</span><span class=nf>Wait</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>counter</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=syncmutexrwmutex>sync.Mutex/RWMutex</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// sync.Mutex 互斥锁
</span></span></span><span class=line><span class=cl><span class=c1>// sync.RWMutex 读写锁
</span></span></span><span class=line><span class=cl><span class=c1>// obj =&gt; 写write: g1 write; g2 write 需要加锁 不能同时写 互斥 =&gt; 互斥锁
</span></span></span><span class=line><span class=cl><span class=c1>// obj =&gt; 读read: g1 read; g2 write 正在写不让读 正在读不让写 =&gt; 互斥锁
</span></span></span><span class=line><span class=cl><span class=c1>// obj =&gt; 读read： g1 read; g2 read 正在读被其他读(可以允许 如果使用Mutex 有锁不会让其他协程读) =&gt; 读写锁
</span></span></span></code></pre></td></tr></table></div></div><h4 id=syncmap>sync.Map</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// Go的内置类型 map 不是线程安全的
</span></span></span><span class=line><span class=cl><span class=c1>// sync.Map是线程安全的 但操作的类型都是接口类型 需要进行断言(类型转换)
</span></span></span></code></pre></td></tr></table></div></div><h4 id=synconce>sync.Once</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 控制程序只执行一次 包括并发的情况下
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;sync&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>conf</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;conf&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>once</span> <span class=nx>sync</span><span class=p>.</span><span class=nx>Once</span>
</span></span><span class=line><span class=cl>    <span class=c1>// once.Do(conf)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// once.Do(conf)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// once.Do(conf)
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>wg</span> <span class=nx>sync</span><span class=p>.</span><span class=nx>WaitGroup</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=mi>10</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>wg</span><span class=p>.</span><span class=nf>Add</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>go</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>once</span><span class=p>.</span><span class=nf>Do</span><span class=p>(</span><span class=nx>conf</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=c1>// conf()
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>wg</span><span class=p>.</span><span class=nf>Done</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>}()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>wg</span><span class=p>.</span><span class=nf>Wait</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=syncpool>sync.Pool</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// sync.Pool
</span></span></span><span class=line><span class=cl><span class=c1>// 需要资源 从池子里面获取 当池子中没有会进行创建并返回 有则直接复用 用完后归还 资源的重复利用
</span></span></span><span class=line><span class=cl><span class=c1>// 对象创建时耗费资源
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// 网络连接池
</span></span></span><span class=line><span class=cl><span class=c1>// 数据库连接池
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;sync&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>objPool</span> <span class=o>:=</span> <span class=nx>sync</span><span class=p>.</span><span class=nx>Pool</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>New</span><span class=p>:</span> <span class=kd>func</span><span class=p>()</span> <span class=kd>interface</span><span class=p>{}</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;new&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=s>&#34;123456789&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>obj</span> <span class=o>:=</span> <span class=nx>objPool</span><span class=p>.</span><span class=nf>Get</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>obj</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>obj2</span> <span class=o>:=</span> <span class=nx>objPool</span><span class=p>.</span><span class=nf>Get</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>obj2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>objPool</span><span class=p>.</span><span class=nf>Put</span><span class=p>(</span><span class=nx>obj</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>obj3</span> <span class=o>:=</span> <span class=nx>objPool</span><span class=p>.</span><span class=nf>Get</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>obj3</span><span class=p>)</span> <span class=c1>// 直接打印123..9 不会调用打印new
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 自定义连接池结构体
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>TCPPool</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>addr</span>    <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>pool</span>    <span class=o>*</span><span class=nx>sync</span><span class=p>.</span><span class=nx>Pool</span>
</span></span><span class=line><span class=cl>    <span class=nx>max</span>        <span class=kt>int</span> <span class=c1>// 池子中保持的 最大连接数 超过报错
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>idle</span>    <span class=kt>int</span> <span class=c1>// 池子中闲置的连接数量
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>min</span>     <span class=kt>int</span> <span class=c1>// 池子中最小的连接数
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>poolCnt</span> <span class=kt>int</span> <span class=c1>// 池子的连接数量
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>count</span>     <span class=kt>int</span> <span class=c1>// 总的连接数量
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>locker</span>     <span class=o>*</span><span class=nx>sync</span><span class=p>.</span><span class=nx>Mutex</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=runtime>runtime</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// go doc runtime go运行时的一些配置信息
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>GOMAXPROCS</span><span class=p>(</span><span class=nx>n</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>int</span> <span class=c1>// 配置GMP模型中 P的数量
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>GOROOT</span><span class=p>()</span> <span class=kt>string</span> <span class=c1>// 获取Go的安装目录
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>Gosched</span><span class=p>()</span> <span class=c1>// 让出时间片
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>NumCPU</span><span class=p>()</span> <span class=kt>int</span> <span class=c1>// 获取CPU数量
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>NumGoroutine</span><span class=p>()</span> <span class=kt>int</span> <span class=c1>// 获取协程数量
</span></span></span></code></pre></td></tr></table></div></div><h3 id=logr>logr</h3><h4 id=logrus>logrus</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>logger</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;path&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;runtime&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;strconv&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>log</span> <span class=s>&#34;github.com/sirupsen/logrus&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;gopkg.in/natefinch/lumberjack.v2&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>RotateLogger</span><span class=p>(</span><span class=nx>logName</span> <span class=kt>string</span><span class=p>)</span> <span class=o>*</span><span class=nx>lumberjack</span><span class=p>.</span><span class=nx>Logger</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>cfg</span> <span class=o>:=</span> <span class=nx>global</span><span class=p>.</span><span class=nx>CFG</span><span class=p>.</span><span class=nx>Log</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=o>&amp;</span><span class=nx>lumberjack</span><span class=p>.</span><span class=nx>Logger</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>Filename</span><span class=p>:</span>   <span class=nx>logName</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>MaxSize</span><span class=p>:</span>    <span class=nx>cfg</span><span class=p>.</span><span class=nx>MaxSize</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>MaxBackups</span><span class=p>:</span> <span class=nx>cfg</span><span class=p>.</span><span class=nx>MaxBackups</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>LocalTime</span><span class=p>:</span>  <span class=nx>cfg</span><span class=p>.</span><span class=nx>LocalTime</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>Compress</span><span class=p>:</span>   <span class=nx>cfg</span><span class=p>.</span><span class=nx>Compress</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>Logger</span><span class=p>(</span><span class=nx>cfg</span> <span class=o>*</span><span class=nx>config</span><span class=p>.</span><span class=nx>Config</span><span class=p>)</span> <span class=o>*</span><span class=nx>log</span><span class=p>.</span><span class=nx>Logger</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>cfg</span><span class=p>.</span><span class=nx>ServerLog</span> <span class=o>==</span> <span class=s>&#34;&#34;</span> <span class=o>||</span> <span class=nx>cfg</span><span class=p>.</span><span class=nx>MaxSize</span> <span class=o>==</span> <span class=mi>0</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>log</span><span class=p>.</span><span class=nf>Fatal</span><span class=p>(</span><span class=s>&#34;invalid configurations, please check&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>l</span> <span class=o>:=</span> <span class=nf>RotateLogger</span><span class=p>(</span><span class=nx>cfg</span><span class=p>.</span><span class=nx>ServerLog</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>logger</span> <span class=o>:=</span> <span class=nx>log</span><span class=p>.</span><span class=nf>New</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>logger</span><span class=p>.</span><span class=nf>SetOutput</span><span class=p>(</span><span class=nx>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>level</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>log</span><span class=p>.</span><span class=nf>ParseLevel</span><span class=p>(</span><span class=nx>cfg</span><span class=p>.</span><span class=nx>LogLevel</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>log</span><span class=p>.</span><span class=nf>Fatalf</span><span class=p>(</span><span class=s>&#34;invalid log level: %s&#34;</span><span class=p>,</span> <span class=nx>cfg</span><span class=p>.</span><span class=nx>LogLevel</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>logger</span><span class=p>.</span><span class=nf>SetLevel</span><span class=p>(</span><span class=nx>level</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>logger</span><span class=p>.</span><span class=nf>SetReportCaller</span><span class=p>(</span><span class=nx>cfg</span><span class=p>.</span><span class=nx>ReportCaller</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>logger</span><span class=p>.</span><span class=nf>SetFormatter</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>log</span><span class=p>.</span><span class=nx>TextFormatter</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>DisableColors</span><span class=p>:</span>   <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>TimestampFormat</span><span class=p>:</span> <span class=s>&#34;2006-01-02 15:04:05&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>CallerPrettyfier</span><span class=p>:</span> <span class=kd>func</span><span class=p>(</span><span class=nx>f</span> <span class=o>*</span><span class=nx>runtime</span><span class=p>.</span><span class=nx>Frame</span><span class=p>)</span> <span class=p>(</span><span class=nx>function</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>file</span> <span class=kt>string</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=s>&#34;&#34;</span><span class=p>,</span> <span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;%s:%s&#34;</span><span class=p>,</span> <span class=nx>path</span><span class=p>.</span><span class=nf>Base</span><span class=p>(</span><span class=nx>f</span><span class=p>.</span><span class=nx>File</span><span class=p>),</span> <span class=nx>strconv</span><span class=p>.</span><span class=nf>Itoa</span><span class=p>(</span><span class=nx>f</span><span class=p>.</span><span class=nx>Line</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>l</span><span class=p>.</span><span class=nf>Close</span><span class=p>();</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>log</span><span class=p>.</span><span class=nf>Fatal</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>logger</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=zap>zap</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>logger</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;os&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;time&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.uber.org/zap&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.uber.org/zap/zapcore&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;gopkg.in/natefinch/lumberjack.v2&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>Logger</span><span class=p>(</span><span class=nx>cfg</span> <span class=o>*</span><span class=nx>config</span><span class=p>.</span><span class=nx>Config</span><span class=p>)</span> <span class=o>*</span><span class=nx>zap</span><span class=p>.</span><span class=nx>Logger</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=nx>customLevelEncoder</span> <span class=p>=</span> <span class=kd>func</span><span class=p>(</span><span class=nx>level</span> <span class=nx>zapcore</span><span class=p>.</span><span class=nx>Level</span><span class=p>,</span> <span class=nx>encoder</span> <span class=nx>zapcore</span><span class=p>.</span><span class=nx>PrimitiveArrayEncoder</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>encoder</span><span class=p>.</span><span class=nf>AppendString</span><span class=p>(</span><span class=nx>level</span><span class=p>.</span><span class=nf>String</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=nx>customTimeEncoder</span> <span class=p>=</span> <span class=kd>func</span><span class=p>(</span><span class=nx>t</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Time</span><span class=p>,</span> <span class=nx>encoder</span> <span class=nx>zapcore</span><span class=p>.</span><span class=nx>PrimitiveArrayEncoder</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>encoder</span><span class=p>.</span><span class=nf>AppendString</span><span class=p>(</span><span class=nx>t</span><span class=p>.</span><span class=nf>Format</span><span class=p>(</span><span class=s>&#34;2006-01-02 15:04:05.000&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>encoderConfig</span> <span class=o>:=</span> <span class=nx>zapcore</span><span class=p>.</span><span class=nx>EncoderConfig</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>MessageKey</span><span class=p>:</span>     <span class=s>&#34;msg&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>LevelKey</span><span class=p>:</span>       <span class=s>&#34;level&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>TimeKey</span><span class=p>:</span>        <span class=s>&#34;time&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>NameKey</span><span class=p>:</span>        <span class=s>&#34;logger&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>CallerKey</span><span class=p>:</span>      <span class=s>&#34;caller&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>StacktraceKey</span><span class=p>:</span>  <span class=s>&#34;stacktrace&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>LineEnding</span><span class=p>:</span>     <span class=nx>zapcore</span><span class=p>.</span><span class=nx>DefaultLineEnding</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>EncodeLevel</span><span class=p>:</span>    <span class=nx>customLevelEncoder</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>EncodeTime</span><span class=p>:</span>     <span class=nx>customTimeEncoder</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>EncodeDuration</span><span class=p>:</span> <span class=nx>zapcore</span><span class=p>.</span><span class=nx>SecondsDurationEncoder</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>EncodeCaller</span><span class=p>:</span>   <span class=nx>zapcore</span><span class=p>.</span><span class=nx>ShortCallerEncoder</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>encoder</span> <span class=nx>zapcore</span><span class=p>.</span><span class=nx>Encoder</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>cfg</span><span class=p>.</span><span class=nx>Log</span><span class=p>.</span><span class=nx>JsonFormat</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>encoder</span> <span class=p>=</span> <span class=nx>zapcore</span><span class=p>.</span><span class=nf>NewJSONEncoder</span><span class=p>(</span><span class=nx>encoderConfig</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>encoder</span> <span class=p>=</span> <span class=nx>zapcore</span><span class=p>.</span><span class=nf>NewConsoleEncoder</span><span class=p>(</span><span class=nx>encoderConfig</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 日志轮询
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>lumberjackLogger</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>lumberjack</span><span class=p>.</span><span class=nx>Logger</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>Filename</span><span class=p>:</span>   <span class=nx>cfg</span><span class=p>.</span><span class=nx>Log</span><span class=p>.</span><span class=nx>Filename</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>MaxSize</span><span class=p>:</span>    <span class=nx>cfg</span><span class=p>.</span><span class=nx>Log</span><span class=p>.</span><span class=nx>MaxSize</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>MaxAge</span><span class=p>:</span>     <span class=nx>cfg</span><span class=p>.</span><span class=nx>Log</span><span class=p>.</span><span class=nx>MaxAge</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>MaxBackups</span><span class=p>:</span> <span class=nx>cfg</span><span class=p>.</span><span class=nx>Log</span><span class=p>.</span><span class=nx>MaxBackups</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>Compress</span><span class=p>:</span>   <span class=nx>cfg</span><span class=p>.</span><span class=nx>Log</span><span class=p>.</span><span class=nx>Compress</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>syncer</span> <span class=nx>zapcore</span><span class=p>.</span><span class=nx>WriteSyncer</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>cfg</span><span class=p>.</span><span class=nx>Log</span><span class=p>.</span><span class=nx>LogInConsole</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>syncer</span> <span class=p>=</span> <span class=nx>zapcore</span><span class=p>.</span><span class=nf>NewMultiWriteSyncer</span><span class=p>(</span><span class=nx>zapcore</span><span class=p>.</span><span class=nf>AddSync</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Stdout</span><span class=p>),</span> <span class=nx>zapcore</span><span class=p>.</span><span class=nf>AddSync</span><span class=p>(</span><span class=nx>lumberjackLogger</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>syncer</span> <span class=p>=</span> <span class=nx>zapcore</span><span class=p>.</span><span class=nf>AddSync</span><span class=p>(</span><span class=nx>lumberjackLogger</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>core</span> <span class=o>:=</span> <span class=nx>zapcore</span><span class=p>.</span><span class=nf>NewCore</span><span class=p>(</span><span class=nx>encoder</span><span class=p>,</span> <span class=nx>syncer</span><span class=p>,</span> <span class=nx>cfg</span><span class=p>.</span><span class=nx>Log</span><span class=p>.</span><span class=nf>UnmarshalLevel</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=nx>logger</span> <span class=o>:=</span> <span class=nx>zap</span><span class=p>.</span><span class=nf>New</span><span class=p>(</span><span class=nx>core</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>cfg</span><span class=p>.</span><span class=nx>Log</span><span class=p>.</span><span class=nx>ShowLine</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>logger</span> <span class=p>=</span> <span class=nx>logger</span><span class=p>.</span><span class=nf>WithOptions</span><span class=p>(</span><span class=nx>zap</span><span class=p>.</span><span class=nf>AddCaller</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>logger</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=面向对象>面向对象</h2><h3 id=自定义类型>自定义类型</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=o>-</span> <span class=err>想要自己定义一个由不同类型元素</span><span class=p>(</span><span class=err>属性</span> <span class=err>字段</span><span class=p>)</span><span class=err>组成一个复合类型</span> <span class=o>-</span> <span class=err>结构体</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>别名</span><span class=o>&amp;</span><span class=err>重新定义</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=err>别名</span> <span class=err>与原有类型相同</span> <span class=err>无区别</span> <span class=err>不能定义新的方法</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=err>重新定义：将现有的类型进行重新定义</span> <span class=err>对新的类型提供一些方法</span> <span class=err>与原有类型的类型无关</span> <span class=err>具有原有类型特性</span> <span class=err>但是可以与原有类型进行相互转换</span> <span class=err>如：计数功能</span> <span class=kt>int</span> <span class=o>-</span><span class=p>&gt;</span> <span class=err>计数类型</span><span class=p>;</span> <span class=nx>http</span><span class=err>包里的</span><span class=nx>Header</span> <span class=kd>type</span> <span class=nx>Header</span> <span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>][]</span><span class=kt>string</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>面向对象：</span>
</span></span><span class=line><span class=cl>  <span class=err>代码复用</span> <span class=p>=&gt;</span> <span class=err>继承</span> <span class=err>组合</span>
</span></span><span class=line><span class=cl>  <span class=nx>Go</span><span class=p>:</span> <span class=err>嵌入</span> <span class=p>=&gt;</span> <span class=err>组合模式</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=定义>定义</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 定义的关键字
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span>   <span class=c1>// 变量定义
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>const</span> <span class=c1>// 常量定义
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span>  <span class=c1>// 函数定义
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span>  <span class=c1>// 自定义类型定义
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>TypeName</span> <span class=nx>Formatter</span>
</span></span><span class=line><span class=cl><span class=err>重定义：</span><span class=kd>type</span> <span class=nx>Counter</span> <span class=kt>int</span>
</span></span><span class=line><span class=cl><span class=err>结构体：</span><span class=kd>type</span> <span class=nx>User</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=err>属性名称</span><span class=mi>1</span> <span class=err>属性类型</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=err>属性名称</span><span class=mi>2</span> <span class=err>属性类型</span><span class=mi>2</span>
</span></span><span class=line><span class=cl>    <span class=err>属性名称</span><span class=mi>3</span> <span class=err>属性类型</span><span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>别名：</span><span class=kd>type</span> <span class=nx>TypeName</span> <span class=p>=</span> <span class=nx>Formatter</span>
</span></span><span class=line><span class=cl>  <span class=kd>type</span> <span class=kt>byte</span> <span class=p>=</span> <span class=kt>uint8</span>
</span></span><span class=line><span class=cl>  <span class=kd>type</span> <span class=kt>rune</span> <span class=p>=</span> <span class=kt>int32</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=别名与重定义>别名与重定义</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Counter</span> <span class=p>=</span> <span class=kt>int</span>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Counter2</span> <span class=kt>int</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>count</span> <span class=nx>Counter</span>
</span></span><span class=line><span class=cl>    <span class=nx>count</span> <span class=p>=</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T\n&#34;</span><span class=p>,</span> <span class=nx>count</span><span class=p>)</span> <span class=c1>// int
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>count2</span> <span class=nx>Counter2</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T %v\n&#34;</span><span class=p>,</span> <span class=nx>count2</span><span class=p>,</span> <span class=nx>count2</span><span class=p>)</span> <span class=c1>// main.Counter2 0
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>count2</span> <span class=o>+=</span> <span class=nf>Counter2</span><span class=p>(</span><span class=nx>count</span><span class=p>)</span> <span class=c1>// 可以与原类型进行类型转换
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>count2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=结构体>结构体</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;time&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 定义结构体 =&gt; 类 =&gt; 封装
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>type StructName struct {
</span></span></span><span class=line><span class=cl><span class=cm>    Field1 FieldType1
</span></span></span><span class=line><span class=cl><span class=cm>    Field2 FieldType2
</span></span></span><span class=line><span class=cl><span class=cm>    ...
</span></span></span><span class=line><span class=cl><span class=cm>}
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>type User struct {
</span></span></span><span class=line><span class=cl><span class=cm>    id         int
</span></span></span><span class=line><span class=cl><span class=cm>    name       string
</span></span></span><span class=line><span class=cl><span class=cm>    addr       string
</span></span></span><span class=line><span class=cl><span class=cm>    tel        string
</span></span></span><span class=line><span class=cl><span class=cm>    birthday   string/uinxtime/time.Time 首选time
</span></span></span><span class=line><span class=cl><span class=cm>    created_at string/uinxtime/time.Time
</span></span></span><span class=line><span class=cl><span class=cm>    updated_at time.Time
</span></span></span><span class=line><span class=cl><span class=cm>    flag       bool // 标识逻辑删除
</span></span></span><span class=line><span class=cl><span class=cm>    status     int // 1删除 0未删除
</span></span></span><span class=line><span class=cl><span class=cm>    deleted_at *time.Time // 已删除: 删除时间 非nil 未删除：nil 指针零值
</span></span></span><span class=line><span class=cl><span class=cm>}
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>User</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>id</span>        <span class=kt>int</span>
</span></span><span class=line><span class=cl>    <span class=nx>name</span>      <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>addr</span>      <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>tel</span>       <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>brithday</span>  <span class=nx>time</span><span class=p>.</span><span class=nx>Time</span>
</span></span><span class=line><span class=cl>    <span class=nx>createdAt</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Time</span>
</span></span><span class=line><span class=cl>    <span class=nx>updatedAt</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Time</span>
</span></span><span class=line><span class=cl>    <span class=nx>flag</span>      <span class=kt>bool</span>
</span></span><span class=line><span class=cl>    <span class=nx>status</span>    <span class=kt>int</span>
</span></span><span class=line><span class=cl>    <span class=nx>deletedAt</span> <span class=o>*</span><span class=nx>time</span><span class=p>.</span><span class=nx>Time</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 类 构造器 =&gt; 创建对应类的实例(对象/变量) // Go中无构造器的说法
</span></span></span><span class=line><span class=cl><span class=c1>// 函数 N(n)ew 结构体名称 构建结构体的(值/指针)对象
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>NewUser</span><span class=p>(</span><span class=nx>id</span> <span class=kt>int</span><span class=p>,</span> <span class=nx>name</span><span class=p>,</span> <span class=nx>addr</span><span class=p>,</span> <span class=nx>tel</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>birtday</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Time</span><span class=p>)</span> <span class=nx>User</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>User</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>id</span><span class=p>:</span>        <span class=nx>id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>name</span><span class=p>:</span>      <span class=nx>name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>addr</span><span class=p>:</span>      <span class=nx>addr</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>tel</span><span class=p>:</span>       <span class=nx>tel</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>brithday</span><span class=p>:</span>  <span class=nx>birtday</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>createdAt</span><span class=p>:</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=nx>updatedAt</span><span class=p>:</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=nx>flag</span><span class=p>:</span>      <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>status</span><span class=p>:</span>    <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>deletedAt</span><span class=p>:</span> <span class=kc>nil</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 返回指针对象
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>NewUserPoint</span><span class=p>(</span><span class=nx>id</span> <span class=kt>int</span><span class=p>,</span> <span class=nx>name</span><span class=p>,</span> <span class=nx>addr</span><span class=p>,</span> <span class=nx>tel</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>birtday</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Time</span><span class=p>)</span> <span class=o>*</span><span class=nx>User</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=o>&amp;</span><span class=nx>User</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>id</span><span class=p>:</span>        <span class=nx>id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>name</span><span class=p>:</span>      <span class=nx>name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>addr</span><span class=p>:</span>      <span class=nx>addr</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>tel</span><span class=p>:</span>       <span class=nx>tel</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>brithday</span><span class=p>:</span>  <span class=nx>birtday</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>createdAt</span><span class=p>:</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=nx>updatedAt</span><span class=p>:</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=nx>flag</span><span class=p>:</span>      <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>status</span><span class=p>:</span>    <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>deletedAt</span><span class=p>:</span> <span class=kc>nil</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 定义User类型的变量
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>var</span> <span class=nx>u</span> <span class=nx>User</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T\n&#34;</span><span class=p>,</span> <span class=nx>u</span><span class=p>)</span> <span class=c1>// main.User
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 零值 =&gt; 所有属性的零值组成的一个User类型的变量值
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%v\n&#34;</span><span class=p>,</span> <span class=nx>u</span><span class=p>)</span> <span class=c1>// 非nil
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%#v\n&#34;</span><span class=p>,</span> <span class=nx>u</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 赋值 字面量
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 设置值 按照结构体中属性定义额顺序设置 -&gt; 需要给所有属性都进行赋值
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>u</span> <span class=p>=</span> <span class=nx>User</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=s>&#34;minho&#34;</span><span class=p>,</span> <span class=s>&#34;成都&#34;</span><span class=p>,</span> <span class=s>&#34;13424244434&#34;</span><span class=p>,</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>(),</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>(),</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>(),</span> <span class=kc>false</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=kc>nil</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%#v\n&#34;</span><span class=p>,</span> <span class=nx>u</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 指定名称赋值 未指定的属性名称 对应类型的零值进行初始化
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>u</span> <span class=p>=</span> <span class=nx>User</span><span class=p>{</span><span class=nx>id</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span> <span class=nx>name</span><span class=p>:</span> <span class=s>&#34;KATHR1NE&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%#v\n&#34;</span><span class=p>,</span> <span class=nx>u</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 属性进行访问和修改
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>u</span><span class=p>.</span><span class=nx>id</span><span class=p>,</span> <span class=nx>u</span><span class=p>.</span><span class=nx>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>u</span><span class=p>.</span><span class=nx>addr</span> <span class=p>=</span> <span class=s>&#34;北京&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%#v\n&#34;</span><span class=p>,</span> <span class=nx>u</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 结构体 值类型 赋值修改不影响原来的变量
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 指针类型的对象
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>var</span> <span class=nx>u3</span> <span class=o>*</span><span class=nx>User</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %v\n&#34;</span><span class=p>,</span> <span class=nx>u3</span><span class=p>,</span> <span class=nx>u3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 指针赋值 =&gt; 取引用 &amp;
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// new 申请空间并对元素使用0值进行初始化 取地址 赋值
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>u3</span> <span class=p>=</span> <span class=o>&amp;</span><span class=nx>u</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%#v\n&#34;</span><span class=p>,</span> <span class=nx>u3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>u4</span> <span class=o>*</span><span class=nx>User</span> <span class=p>=</span> <span class=nb>new</span><span class=p>(</span><span class=nx>User</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%#v\n&#34;</span><span class=p>,</span> <span class=nx>u4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 字面量取引用
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>var</span> <span class=nx>u5</span> <span class=o>*</span><span class=nx>User</span> <span class=p>=</span> <span class=o>&amp;</span><span class=nx>User</span><span class=p>{}</span>  <span class=c1>// User{} User的零值
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%#v\n&#34;</span><span class=p>,</span> <span class=nx>u5</span><span class=p>)</span> <span class=c1>// 与 new(User)一样
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;################&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>u6</span> <span class=o>:=</span> <span class=nf>NewUser</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=s>&#34;lemon&#34;</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>,</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=nx>u7</span> <span class=o>:=</span> <span class=nf>NewUserPoint</span><span class=p>(</span><span class=mi>11</span><span class=p>,</span> <span class=s>&#34;kathr1ne&#34;</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>,</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T %v\n&#34;</span><span class=p>,</span> <span class=nx>u6</span><span class=p>,</span> <span class=nx>u6</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T %v\n&#34;</span><span class=p>,</span> <span class=nx>u7</span><span class=p>,</span> <span class=nx>u7</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=匿名结构体>匿名结构体</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 匿名结构体 =&gt; 不定义名称 =&gt; 不能再定义对应的变量 =&gt; 只需要定义该种结构的一个变量
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>user</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>id</span> <span class=kt>int</span>
</span></span><span class=line><span class=cl>        <span class=nx>name</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T\n&#34;</span><span class=p>,</span> <span class=nx>user</span><span class=p>)</span>  <span class=c1>// struct {id: int name: string} 
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%#v\n&#34;</span><span class=p>,</span> <span class=nx>user</span><span class=p>)</span> <span class=c1>// 对应类型的零值
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 使用：
</span></span></span><span class=line><span class=cl><span class=c1>// 程序的配置
</span></span></span><span class=line><span class=cl><span class=c1>// template =&gt; 数据(匿名结构体) =&gt; 传递给模板
</span></span></span></code></pre></td></tr></table></div></div><h3 id=new-和-make的区别>new 和 make的区别</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// new make
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>make</span> <span class=p>=&gt;</span> <span class=err>创建对象</span>
</span></span><span class=line><span class=cl>    <span class=nx>slice</span><span class=p>,</span><span class=kd>map</span><span class=p>,</span><span class=kd>chan</span>
</span></span><span class=line><span class=cl><span class=nx>new</span>  <span class=p>=&gt;</span> <span class=err>返回指针</span> <span class=err>创建结构体指针对象</span>
</span></span><span class=line><span class=cl>    <span class=nx>new</span> <span class=err>基本数据类型</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>i</span> <span class=kt>int</span> <span class=p>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=nx>p</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>i</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>p</span> <span class=o>:=</span> <span class=nb>new</span><span class=p>(</span><span class=kt>int</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>new</span><span class=p>(</span><span class=nx>Struct</span><span class=p>)</span> <span class=o>==</span> <span class=o>&amp;</span><span class=nx>Struct</span><span class=p>{}</span> <span class=p>=&gt;</span> <span class=nx>New</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=结构体嵌套嵌入组合>结构体嵌套(嵌入/组合)</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 地址结构体
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>Address</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Province</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>City</span>     <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>Street</span>   <span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 定义用户信息
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>User</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Id</span>    <span class=kt>int</span>
</span></span><span class=line><span class=cl>    <span class=nx>Name</span>  <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>Tel</span>   <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>Email</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>Addr</span>  <span class=nx>Address</span> <span class=c1>// 嵌入Address结构体 即定义Address结构体的属性 - 命名嵌入
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>PAddr</span> <span class=o>*</span><span class=nx>Address</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 1. 定义
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>var</span> <span class=nx>u</span> <span class=nx>User</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>addr</span> <span class=nx>Address</span> <span class=p>=</span> <span class=nx>Address</span><span class=p>{</span><span class=nx>Province</span><span class=p>:</span> <span class=s>&#34;四川&#34;</span><span class=p>,</span> <span class=nx>City</span><span class=p>:</span> <span class=s>&#34;成都&#34;</span><span class=p>,</span> <span class=nx>Street</span><span class=p>:</span> <span class=s>&#34;高新&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 2. 赋值
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>u</span> <span class=p>=</span> <span class=nx>User</span><span class=p>{</span><span class=nx>Id</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=nx>Name</span><span class=p>:</span> <span class=s>&#34;Minho&#34;</span><span class=p>,</span> <span class=nx>Tel</span><span class=p>:</span> <span class=s>&#34;13308047517&#34;</span><span class=p>,</span> <span class=nx>Email</span><span class=p>:</span> <span class=s>&#34;97431110@qq.com&#34;</span><span class=p>,</span> <span class=nx>Addr</span><span class=p>:</span> <span class=nx>addr</span><span class=p>,</span> <span class=nx>PAddr</span><span class=p>:</span> <span class=o>&amp;</span><span class=nx>addr</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%#v\n&#34;</span><span class=p>,</span> <span class=nx>u</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 3. 属性的访问和修改
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>u</span><span class=p>.</span><span class=nx>Id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%#v\n&#34;</span><span class=p>,</span> <span class=nx>u</span><span class=p>.</span><span class=nx>Addr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>u</span><span class=p>.</span><span class=nx>PAddr</span><span class=p>,</span> <span class=nx>u</span><span class=p>.</span><span class=nx>PAddr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>u</span><span class=p>.</span><span class=nx>Id</span> <span class=p>=</span> <span class=mi>100</span>
</span></span><span class=line><span class=cl>    <span class=nx>u</span><span class=p>.</span><span class=nx>Addr</span> <span class=p>=</span> <span class=nx>Address</span><span class=p>{</span><span class=s>&#34;北京&#34;</span><span class=p>,</span> <span class=s>&#34;北京&#34;</span><span class=p>,</span> <span class=s>&#34;海定区&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>u</span><span class=p>.</span><span class=nx>PAddr</span> <span class=p>=</span> <span class=o>&amp;</span><span class=nx>Address</span><span class=p>{</span><span class=s>&#34;北京&#34;</span><span class=p>,</span> <span class=s>&#34;北京&#34;</span><span class=p>,</span> <span class=s>&#34;昌平区&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>u</span><span class=p>.</span><span class=nx>Addr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>u</span><span class=p>.</span><span class=nx>PAddr</span><span class=p>,</span> <span class=nx>u</span><span class=p>.</span><span class=nx>PAddr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>u</span><span class=p>.</span><span class=nx>Addr</span><span class=p>.</span><span class=nx>Street</span> <span class=p>=</span> <span class=s>&#34;安静区&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>u</span><span class=p>.</span><span class=nx>Addr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>u</span><span class=p>.</span><span class=nx>PAddr</span><span class=p>.</span><span class=nx>Street</span> <span class=p>=</span> <span class=s>&#34;PP区&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>u</span><span class=p>.</span><span class=nx>PAddr</span><span class=p>.</span><span class=nx>Street</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 匿名嵌入 不写属性名称 直接写类型
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Address</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Provice</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>City</span>    <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>Street</span>    <span class=kt>string</span> 
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>User</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Id</span>        <span class=kt>int</span>
</span></span><span class=line><span class=cl>    <span class=nx>Name</span>    <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>Tel</span>        <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>Address</span> <span class=c1>// 匿名嵌入 自定义属性名Address(与类型名一致) 只能匿名嵌入一次
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>Street</span>    <span class=kt>string</span> <span class=c1>// 属性名与匿名嵌入对象属性名相同
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Company</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Name</span>        <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>Province</span>    <span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 匿名嵌入两个对象 两个对象中有相同的属性名
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>User2</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Id</span>        <span class=kt>int</span>
</span></span><span class=line><span class=cl>    <span class=nx>Name</span>    <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>Tel</span>        <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>Street</span>     <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>Address</span>
</span></span><span class=line><span class=cl>    <span class=nx>Company</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 定义赋值访问 和命名嵌入基本一致
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 不一样的地方
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 当访问匿名嵌入对象的属性时可以省略嵌入对象的属性名
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>var</span> <span class=nx>u</span> <span class=nx>User</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>u</span><span class=p>.</span><span class=nx>Street</span><span class=p>)</span> <span class=c1>// 优先查找当前对象 若无再查找匿名对象中的属性名
</span></span></span><span class=line><span class=cl><span class=c1></span>    
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>u2</span> <span class=nx>User2</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>u2</span><span class=p>.</span><span class=nx>Provice</span><span class=p>)</span> <span class=c1>// 多个匿名嵌入对象具有相同属性名 Go直接报错 语言层面 不知道选择哪个(二义性) Go限制开发者使用全路径    
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 建议
</span></span></span><span class=line><span class=cl><span class=c1>// 1. 不使用匿名嵌入
</span></span></span><span class=line><span class=cl><span class=c1>// 2. 使用匿名嵌入 访问属性的时候 使用全路径
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// 可以匿名嵌入指针对象
</span></span></span></code></pre></td></tr></table></div></div><h3 id=方法>方法</h3><h4 id=定义-1>定义</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 方法：给特定类型定义的函数 只能由特定的类型进行调用
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// 函数定义
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>funcName</span><span class=p>(</span><span class=nx>args</span><span class=p>)</span> <span class=nx>returns</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 方法比函数多出 =&gt; 接收者
</span></span></span><span class=line><span class=cl><span class=c1>// 接收者：指定函数属于哪个类型 只能由对应的类型进行调用
</span></span></span><span class=line><span class=cl><span class=c1>// 除了接收者 方法的参数/返回值 与go中的函数完全一致
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// 方法定义
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>receiver</span><span class=p>)</span> <span class=nf>methodName</span><span class=p>(</span><span class=nx>args</span><span class=p>)</span> <span class=nx>returns</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 接收者也是一个参数： t T 参数类型 方法所属的类型 该方法只能由T类型的对象进行调用
</span></span></span><span class=line><span class=cl><span class=c1>// T 自定义类型
</span></span></span><span class=line><span class=cl><span class=c1>// t 变量名 在对象调用方法时用来传递调用的对象
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=mf>1.</span> <span class=err>值接收者：</span><span class=nx>t</span> <span class=nx>T</span>
</span></span><span class=line><span class=cl><span class=mf>2.</span> <span class=err>指针接收者：</span><span class=nx>t</span> <span class=o>*</span><span class=nx>T</span>
</span></span><span class=line><span class=cl><span class=mf>3.</span> <span class=err>方法内不需要访问</span><span class=o>/</span><span class=err>修改</span><span class=nx>t</span><span class=err>对象的属性</span> <span class=err>可以把</span><span class=nx>t</span><span class=err>省略</span> <span class=err>保留类型</span><span class=nx>T</span><span class=err>即可</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>User</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>id</span>    <span class=kt>int</span>
</span></span><span class=line><span class=cl>    <span class=nx>name</span>  <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>tel</span>   <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>email</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 定义User的方法 返回用户名
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>u</span> <span class=nx>User</span><span class=p>)</span> <span class=nf>GetName</span><span class=p>()</span> <span class=kt>string</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// u: 调用者的值拷贝
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=s>&#34;GetName:&#34;</span> <span class=o>+</span> <span class=nx>u</span><span class=p>.</span><span class=nx>name</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 修改名称的方法
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>u</span> <span class=nx>User</span><span class=p>)</span> <span class=nf>SetName</span><span class=p>(</span><span class=nx>name</span> <span class=kt>string</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>u</span><span class=p>.</span><span class=nx>name</span> <span class=p>=</span> <span class=nx>name</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 指针接收者
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>u</span> <span class=o>*</span><span class=nx>User</span><span class=p>)</span> <span class=nf>PsetName</span><span class=p>(</span><span class=nx>name</span> <span class=kt>string</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>u</span><span class=p>.</span><span class=nx>name</span> <span class=p>=</span> <span class=nx>name</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>User</span><span class=p>)</span> <span class=nf>No</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;No&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>u</span> <span class=o>:=</span> <span class=nx>User</span><span class=p>{</span><span class=nx>name</span><span class=p>:</span> <span class=s>&#34;minho&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>u</span><span class=p>.</span><span class=nf>GetName</span><span class=p>())</span> <span class=c1>// 调用方法 对象.方法名称(参数)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>u</span><span class=p>.</span><span class=nf>SetName</span><span class=p>(</span><span class=s>&#34;karuin&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>u</span><span class=p>.</span><span class=nf>GetName</span><span class=p>())</span> <span class=c1>// GetName:minho
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 调用PsetName
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 语法糖：如果接收者时指针接收者 调用可以使用值对象 =&gt; Go自动进行取引用
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>u</span><span class=p>.</span><span class=nf>PsetName</span><span class=p>(</span><span class=s>&#34;lemon&#34;</span><span class=p>)</span>      <span class=c1>// =&gt; (&amp;u).PsetName(&#34;lemon&#34;)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>u</span><span class=p>.</span><span class=nf>GetName</span><span class=p>())</span> <span class=c1>// GetName:lemon
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>p</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>User</span><span class=p>{</span><span class=nx>name</span><span class=p>:</span> <span class=s>&#34;MM&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 语法糖 接收者是值接收者调用指针对象 =&gt; 自动进行解引用
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>p</span><span class=p>.</span><span class=nf>GetName</span><span class=p>())</span> <span class=c1>// fmt.Println((*p).GetName())
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>p</span><span class=p>.</span><span class=nf>PsetName</span><span class=p>(</span><span class=s>&#34;QQ&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>p</span><span class=p>.</span><span class=nf>GetName</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>p</span><span class=p>.</span><span class=nf>No</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Counter</span> <span class=p>=</span> <span class=kt>int</span> <span class=c1>// 别名不能定义方法
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// 重定义可以定义方法
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>Counter</span> <span class=kt>int</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>c</span> <span class=o>*</span><span class=nx>Counter</span><span class=p>)</span> <span class=nf>Incr</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=o>*</span><span class=nx>c</span><span class=p>)</span><span class=o>++</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=可见性-1>可见性</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 与属性相同
</span></span></span><span class=line><span class=cl><span class=c1>// 首字母大写 =&gt; 包外可见
</span></span></span><span class=line><span class=cl><span class=c1>// 首字母小写 =&gt; 包内可见
</span></span></span></code></pre></td></tr></table></div></div><h4 id=方法表达式>方法表达式</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>User</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Name</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>u</span> <span class=nx>User</span><span class=p>)</span> <span class=nf>GetName</span><span class=p>()</span> <span class=kt>string</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>u</span><span class=p>.</span><span class=nx>Name</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>u</span> <span class=nx>User</span><span class=p>)</span> <span class=nf>SetName</span><span class=p>(</span><span class=nx>name</span> <span class=kt>string</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>u</span><span class=p>.</span><span class=nx>Name</span> <span class=p>=</span> <span class=nx>name</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>u</span> <span class=o>*</span><span class=nx>User</span><span class=p>)</span> <span class=nf>PsetName</span><span class=p>(</span><span class=nx>name</span> <span class=kt>string</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>u</span><span class=p>.</span><span class=nx>Name</span> <span class=p>=</span> <span class=nx>name</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 定义 =&gt; T类型
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 调用 =&gt; T(值/指针)变量/对象/实例
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 访问方法
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=c1>// T.方法名
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=c1>// 定义对象 对象.方法名
</span></span></span><span class=line><span class=cl><span class=c1></span>    
</span></span><span class=line><span class=cl>    <span class=c1>// 方法表达式
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 值接收者类型
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>f</span> <span class=o>:=</span> <span class=nx>User</span><span class=p>.</span><span class=nx>GetName</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T\n&#34;</span><span class=p>,</span> <span class=nx>f</span><span class=p>)</span> <span class=c1>// func(main.User) string 是一个函数类型 可以直接调用 参数为自定义User类型
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nf>f</span><span class=p>(</span><span class=nx>User</span><span class=p>{</span><span class=nx>Name</span><span class=p>:</span> <span class=s>&#34;minho&#34;</span><span class=p>}))</span> <span class=c1>// minho
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmr</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>User</span><span class=p>.</span><span class=nf>GetName</span><span class=p>(</span><span class=nx>User</span><span class=p>{</span><span class=nx>Name</span><span class=p>:</span> <span class=s>&#34;XXXX&#34;</span><span class=p>}))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>f2</span> <span class=o>:=</span> <span class=nx>User</span><span class=p>.</span><span class=nx>SetName</span> <span class=c1>// 多个参数
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmr</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T\n&#34;</span><span class=p>,</span> <span class=nx>f2</span><span class=p>)</span> <span class=c1>// func(main.User, string)
</span></span></span><span class=line><span class=cl><span class=c1></span>    
</span></span><span class=line><span class=cl>    <span class=c1>// 指针类型接收者
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>f3</span> <span class=o>:=</span> <span class=p>(</span><span class=o>*</span><span class=nx>User</span><span class=p>).</span><span class=nx>PsetName</span> <span class=c1>// 方法为指针接收者 调用者必须为对应类型的指针类型 User.PsetName报错
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T\n&#34;</span><span class=p>,</span> <span class=nx>f3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>f4</span> <span class=o>:=</span> <span class=p>(</span><span class=o>*</span><span class=nx>User</span><span class=p>).</span><span class=nx>GetName</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T\n&#34;</span><span class=p>,</span> <span class=nx>f4</span><span class=p>)</span> <span class=c1>// func(*main.User) string
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 如果定义了值接收者方法 Go会自动生成一个对应的指针接收者方法
</span></span></span></code></pre></td></tr></table></div></div><h4 id=方法值>方法值</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 代码接上
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=nx>u</span> <span class=p>=</span> <span class=nx>User</span><span class=p>{</span><span class=nx>Name</span><span class=p>:</span> <span class=s>&#34;Minho&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>m1</span> <span class=p>=</span> <span class=nx>u</span><span class=p>.</span><span class=nx>GetName</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T\n&#34;</span><span class=p>,</span> <span class=nx>m1</span><span class=p>)</span> <span class=c1>// func() strirng
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nf>m1</span><span class=p>())</span> <span class=c1>// 加括号执行 Minho
</span></span></span></code></pre></td></tr></table></div></div><h2 id=文件操作>文件操作</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 相关包(常用)
</span></span></span><span class=line><span class=cl><span class=c1>// os：文件操作
</span></span></span><span class=line><span class=cl><span class=c1>// filepath：文件路径
</span></span></span><span class=line><span class=cl><span class=c1>// bufio：带缓冲区IO
</span></span></span><span class=line><span class=cl><span class=c1>// fs: 抽象包 1.15提供的
</span></span></span><span class=line><span class=cl><span class=c1>// ioutil: 提供工具函数
</span></span></span></code></pre></td></tr></table></div></div><h3 id=文件路径>文件路径</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 相对路径
</span></span></span><span class=line><span class=cl><span class=c1>// 绝对路径
</span></span></span></code></pre></td></tr></table></div></div><h3 id=操作>操作</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 文件内容：010101 []byte &lt;=编码/解码=&gt; string(utf8)
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=err>读文件</span>
</span></span><span class=line><span class=cl>  <span class=nx>os</span><span class=p>.</span><span class=nf>Open</span><span class=p>()</span> <span class=c1>// 文件必须存在
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=err>参数：路径</span>
</span></span><span class=line><span class=cl>    <span class=err>返回值：</span><span class=o>*</span><span class=nx>File</span><span class=p>,</span> <span class=kt>error</span>
</span></span><span class=line><span class=cl>  <span class=err>读文件</span>
</span></span><span class=line><span class=cl>    <span class=nf>Read</span><span class=p>([]</span><span class=kt>byte</span><span class=p>)</span> <span class=nx>n</span><span class=p>,</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>    <span class=nf>ReadAt</span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span> <span class=kt>int64</span><span class=p>)</span> <span class=nx>n</span><span class=p>,</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>  <span class=err>关闭文件</span>
</span></span><span class=line><span class=cl>    <span class=nf>Close</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span><span class=lnt>204
</span><span class=lnt>205
</span><span class=lnt>206
</span><span class=lnt>207
</span><span class=lnt>208
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;io&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;os&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>path</span> <span class=o>:=</span> <span class=s>&#34;readfile.txt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>file</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>Open</span><span class=p>(</span><span class=nx>path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;error:&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>defer</span> <span class=nx>file</span><span class=p>.</span><span class=nf>Close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;success&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 读文件
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>data</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>n</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>file</span><span class=p>.</span><span class=nf>Read</span><span class=p>(</span><span class=nx>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=c1>// 出错
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=nx>io</span><span class=p>.</span><span class=nx>EOF</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>data</span><span class=p>[:</span><span class=nx>n</span><span class=p>],</span> <span class=nb>string</span><span class=p>(</span><span class=nx>data</span><span class=p>[:</span><span class=nx>n</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 读取文件内容到字节切片data中
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// n:读取字节的数量 error: EOF 结束符
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// n, err := file.Read(data)
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=c1>// fmt.Println(data, n, err)
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// fmt.Println(data[:n])
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// fmt.Printf(&#34;%q, %q&#34;, string(data), string(data[:n]))
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=c1>// file.Close()
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>写文件</span>
</span></span><span class=line><span class=cl>  <span class=nx>os</span><span class=p>.</span><span class=nf>Crete</span><span class=p>()</span> <span class=c1>// 创建文件 go doc os.Create 
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// 文件不存在 创建; 文件存在：清空
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=err>写：</span>
</span></span><span class=line><span class=cl>    <span class=nx>Write</span>
</span></span><span class=line><span class=cl>    <span class=nx>WriteString</span>
</span></span><span class=line><span class=cl>    <span class=nx>WriteAt</span>
</span></span><span class=line><span class=cl>  <span class=err>关闭文件：</span>
</span></span><span class=line><span class=cl>    <span class=nx>Close</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// copyFile
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;io&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;log&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;os&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// copyfile src dst
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Args</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>3</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>log</span><span class=p>.</span><span class=nf>Fatal</span><span class=p>(</span><span class=s>&#34;usage: copyfile srcfile dstfile&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>srcFile</span><span class=p>,</span> <span class=nx>dstFile</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nx>Args</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=nx>os</span><span class=p>.</span><span class=nx>Args</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 读取srcFile
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>src</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>Open</span><span class=p>(</span><span class=nx>srcFile</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>log</span><span class=p>.</span><span class=nf>Fatal</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>defer</span> <span class=nx>src</span><span class=p>.</span><span class=nf>Close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 写dstFile
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>dst</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>Create</span><span class=p>(</span><span class=nx>dstFile</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>log</span><span class=p>.</span><span class=nf>Fatal</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>defer</span> <span class=nx>dst</span><span class=p>.</span><span class=nf>Close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>bufferSize</span> <span class=o>:=</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl>    <span class=nx>data</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span> <span class=nx>bufferSize</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>n</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>src</span><span class=p>.</span><span class=nf>Read</span><span class=p>(</span><span class=nx>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=nx>io</span><span class=p>.</span><span class=nx>EOF</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>log</span><span class=p>.</span><span class=nf>Fatal</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=nx>n</span><span class=p>,</span> <span class=nx>err</span> <span class=p>=</span> <span class=nx>dst</span><span class=p>.</span><span class=nf>Write</span><span class=p>(</span><span class=nx>data</span><span class=p>[:</span><span class=nx>n</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>log</span><span class=p>.</span><span class=nf>Fatal</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>追加文件</span>
</span></span><span class=line><span class=cl>  <span class=nx>OpenFile</span>
</span></span><span class=line><span class=cl>  <span class=nx>os</span><span class=p>.</span><span class=nf>OpenFile</span><span class=p>(</span><span class=nx>path</span><span class=p>,</span> <span class=nx>os</span><span class=p>.</span><span class=nx>O_CREATE</span><span class=p>|</span><span class=nx>os</span><span class=p>.</span><span class=nx>OWRONLY</span><span class=p>|</span><span class=nx>os</span><span class=p>.</span><span class=nx>O_APPEND</span><span class=p>,</span> <span class=nx>os</span><span class=p>.</span><span class=nx>ModePerm</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>文件指针</span>
</span></span><span class=line><span class=cl>  <span class=nf>Seek</span><span class=p>(</span><span class=nx>offset</span><span class=p>,</span> <span class=nx>whence</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>whence</span>
</span></span><span class=line><span class=cl>    <span class=mi>0</span> <span class=err>文件开始位置</span> 
</span></span><span class=line><span class=cl>    <span class=mi>1</span> <span class=err>当前指针位置</span> 
</span></span><span class=line><span class=cl>    <span class=mi>2</span> <span class=err>文件末尾</span>
</span></span><span class=line><span class=cl>  <span class=nx>offset</span> <span class=err>偏移</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=err>获取位置</span><span class=nf>Seek</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 将日志和文件结合起来
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;log&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;os&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>file</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>OpenFile</span><span class=p>(</span><span class=s>&#34;web.log&#34;</span><span class=p>,</span> <span class=nx>os</span><span class=p>.</span><span class=nx>O_CREATE</span><span class=p>|</span><span class=nx>os</span><span class=p>.</span><span class=nx>O_WRONLY</span><span class=p>|</span><span class=nx>OS</span><span class=p>.</span><span class=nx>O_APPEND</span><span class=p>,</span> <span class=nx>os</span><span class=p>.</span><span class=nx>ModePerm</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>log</span><span class=p>.</span><span class=nf>Fatal</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>log</span><span class=p>.</span><span class=nf>SetOutput</span><span class=p>(</span><span class=nx>file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>log</span><span class=p>.</span><span class=nf>Print</span><span class=p>(</span><span class=s>&#34;第一条日志&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>--</span>
</span></span><span class=line><span class=cl><span class=nx>fmt</span><span class=p>.</span><span class=nx>Print</span><span class=o>/</span><span class=nx>Println</span><span class=o>/</span><span class=nx>Printf</span>    <span class=c1>// 输出内容
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>fmt</span><span class=p>.</span><span class=nx>Sprint</span><span class=o>/</span><span class=nx>Sprintln</span><span class=o>/</span><span class=nx>Sprintf</span> <span class=c1>// 将字符串作为值返回
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>fmt</span><span class=p>.</span><span class=nx>Fprint</span><span class=o>/</span><span class=nx>Fprintln</span><span class=o>/</span><span class=nf>Fprintf</span><span class=p>(</span><span class=nx>io</span><span class=p>.</span><span class=nx>Writer</span><span class=p>,</span> <span class=err>变量</span><span class=o>/</span><span class=err>模板</span><span class=p>,</span> <span class=err>变量</span><span class=p>)</span> <span class=c1>// 将内容写入文件
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>file</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>Create</span><span class=p>(</span><span class=s>&#34;file&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Fprint</span><span class=p>(</span><span class=nx>file</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>  <span class=c1>// 将1 2 3写入文件
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Fprintln</span><span class=p>(</span><span class=nx>file</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Fprintf</span><span class=p>(</span><span class=nx>file</span><span class=p>,</span> <span class=s>&#34;My name is %s\n&#34;</span><span class=p>,</span> <span class=s>&#34;Minho&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>--</span>
</span></span><span class=line><span class=cl><span class=nx>fmt</span><span class=p>.</span><span class=nx>Scan</span>  <span class=c1>// 从控制台扫描(读取)变量
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>fmt</span><span class=p>.</span><span class=nx>Fscan</span> <span class=c1>// 从文件扫描
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>fmt</span><span class=p>.</span><span class=nx>Sscan</span> <span class=c1>// 从字符串扫描
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=o>--</span>
</span></span><span class=line><span class=cl><span class=c1>// 读取目录下的子文件(有可能是一个文件 有可能是一个目录)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>file</span><span class=p>.</span><span class=nf>Readdir</span><span class=p>(</span><span class=mi>10</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>file</span><span class=p>.</span><span class=nf>Readdirnames</span><span class=p>(</span><span class=mi>10</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>file</span><span class=p>.</span><span class=nf>Readdirnames</span><span class=p>(</span><span class=mi>10</span><span class=p>))</span> <span class=c1>// 10 读取10个文件或目录
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>file</span><span class=p>.</span><span class=nf>Readdirnames</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>))</span> <span class=c1>// -1 读取所有文件或目录
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;log&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;os&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>file</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>Open</span><span class=p>(</span><span class=s>&#34;.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nx>os</span><span class=p>.</span><span class=nf>IsNotExist</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;文件不存在&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=nx>log</span><span class=p>.</span><span class=nf>Fatal</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>defer</span> <span class=nx>file</span><span class=p>.</span><span class=nf>Close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>files</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>file</span><span class=p>.</span><span class=nf>Readdir</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>f</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>files</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 文件信息
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>f</span><span class=p>.</span><span class=nf>IsDir</span><span class=p>(),</span> <span class=nx>f</span><span class=p>.</span><span class=nf>Name</span><span class=p>(),</span> <span class=nx>f</span><span class=p>.</span><span class=nf>Size</span><span class=p>(),</span> <span class=nx>f</span><span class=p>.</span><span class=nf>ModTime</span><span class=p>(),</span> <span class=nx>f</span><span class=p>.</span><span class=nf>Mode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>--</span>
</span></span><span class=line><span class=cl><span class=nx>file</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>Stat</span><span class=p>(</span><span class=nx>file</span><span class=o>/</span><span class=nx>dir</span><span class=p>)</span> <span class=c1>// reutrn FileInfo
</span></span></span><span class=line><span class=cl><span class=c1>// 判断文件是否存在
</span></span></span><span class=line><span class=cl><span class=c1>// os.Lstat =&gt; 链接文件的信息 os.Stat =&gt; 源文件的信息
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>os</span><span class=p>.</span><span class=nf>IsExist</span><span class=p>(</span><span class=kt>error</span><span class=p>)</span>  <span class=c1>// 参数为：error类型 返回 bool
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>os</span><span class=p>.</span><span class=nf>IsNotExist</span><span class=p>(</span><span class=kt>error</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>os</span><span class=p>.</span><span class=nf>Remove</span><span class=p>(</span><span class=nx>file</span><span class=p>)</span>                   <span class=c1>// 删除文件
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>os</span><span class=p>.</span><span class=nf>Remove</span><span class=p>(</span><span class=nx>dir</span><span class=p>)</span>                    <span class=c1>// 删除目录
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>os</span><span class=p>.</span><span class=nf>Removeall</span><span class=p>(</span><span class=nx>dir</span><span class=p>)</span>                 <span class=c1>// rm -rf 目录不为空也可以删除
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>os</span><span class=p>.</span><span class=nf>Rename</span><span class=p>(</span><span class=s>&#34;aa&#34;</span><span class=p>,</span> <span class=s>&#34;bb&#34;</span><span class=p>)</span>             <span class=c1>// 文件重命名
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>os</span><span class=p>.</span><span class=nf>Chmod</span><span class=p>(</span><span class=s>&#34;aa&#34;</span><span class=p>,</span> <span class=mo>0600</span><span class=p>)</span>              <span class=c1>// 设置权限
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>os</span><span class=p>.</span><span class=nf>Mkdir</span><span class=p>(</span><span class=s>&#34;xxx&#34;</span><span class=p>,</span> <span class=nx>os</span><span class=p>.</span><span class=nx>ModePerm</span><span class=p>)</span>      <span class=c1>// 创建目录
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>os</span><span class=p>.</span><span class=nf>MkdirAll</span><span class=p>(</span><span class=s>&#34;x/y/z&#34;</span><span class=p>,</span> <span class=nx>os</span><span class=p>.</span><span class=nx>ModePerm</span><span class=p>)</span> <span class=c1>// mkdir -p
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=o>--</span>
</span></span><span class=line><span class=cl><span class=nx>io</span><span class=p>.</span><span class=nx>Copy</span>  <span class=c1>// 复制文件
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>io</span><span class=p>.</span><span class=nf>MultiWriter</span><span class=p>()</span>  <span class=c1>// 输出流(可以写数据的)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>io</span><span class=p>.</span><span class=nf>MultiReader</span><span class=p>()</span>  <span class=c1>// 输入流(可以读取数据的) 按照顺序读取所有文件中的内容
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=nx>f1</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>Create</span><span class=p>(</span><span class=s>&#34;f1.txt&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>f2</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>Create</span><span class=p>(</span><span class=s>&#34;f2.txt&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>m</span> <span class=o>:=</span> <span class=nx>io</span><span class=p>.</span><span class=nf>MultiWriter</span><span class=p>(</span><span class=nx>f1</span><span class=p>,</span> <span class=nx>f2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>m</span><span class=p>.</span><span class=nf>Write</span><span class=p>([]</span><span class=nb>byte</span><span class=p>(</span><span class=s>&#34;abc&#34;</span><span class=p>))</span> <span class=c1>// 写到多个流
</span></span></span></code></pre></td></tr></table></div></div><h3 id=目录操作>目录操作</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// filepath
</span></span></span><span class=line><span class=cl><span class=c1>// go doc filepath
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=nx>filepath</span><span class=p>.</span><span class=nf>Abs</span><span class=p>(</span><span class=s>&#34;.&#34;</span><span class=p>)</span>              <span class=c1>// 获取绝对路径
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>filepath</span><span class=p>.</span><span class=nf>Dir</span><span class=p>(</span><span class=s>&#34;/root/cfg.ini&#34;</span><span class=p>)</span>  <span class=c1>// 获取文件目录 /root
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>filepath</span><span class=p>.</span><span class=nf>Base</span><span class=p>(</span><span class=s>&#34;/root/cfg.ini&#34;</span><span class=p>)</span> <span class=c1>// 获取文件名 cfg.ini
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>filepath</span><span class=p>.</span><span class=nf>Ext</span><span class=p>(</span><span class=s>&#34;/root/cfg.ini&#34;</span><span class=p>)</span>  <span class=c1>// 获取文件后缀 .ini
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>filepath</span><span class=p>.</span><span class=nf>Join</span><span class=p>(</span><span class=s>&#34;/root/mm&#34;</span><span class=p>,</span> <span class=s>&#34;xx&#34;</span><span class=p>,</span> <span class=s>&#34;ll.ini&#34;</span><span class=p>)</span> <span class=c1>// 拼接路径
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>filepath</span><span class=p>.</span><span class=nf>Split</span><span class=p>(</span><span class=s>&#34;/root/cfg.ini&#34;</span><span class=p>)</span> <span class=c1>// 分隔path /root/ cfg.ini
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=nx>filepath</span><span class=p>.</span><span class=nf>Glob</span><span class=p>(</span><span class=s>&#34;./*.go&#34;</span><span class=p>)</span> <span class=c1>// 匹配文件 类似Unix通配符
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>filepath</span><span class=p>.</span><span class=nf>Glob</span><span class=p>(</span><span class=s>&#34;./*/*.txt&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// filepath.Walk 遍历目录
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>filepath</span><span class=p>.</span><span class=nf>Walk</span><span class=p>(</span><span class=s>&#34;.&#34;</span><span class=p>,</span> <span class=kd>func</span><span class=p>(</span><span class=nx>path</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>fileInfo</span> <span class=nx>fs</span><span class=p>.</span><span class=nx>FileInfo</span><span class=p>,</span> <span class=nx>err</span> <span class=kt>error</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span><span class=k>return</span> <span class=kc>nil</span><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=文件操作有关工具类>文件操作有关工具类</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// go doc ioutil
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;io/ioutil&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;os&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// data, _ := ioutil.ReadFile(&#34;alias.go&#34;)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// fmt.Println(string(data))
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>files</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>ioutil</span><span class=p>.</span><span class=nf>ReadDir</span><span class=p>(</span><span class=s>&#34;.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>info</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>files</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>info</span><span class=p>.</span><span class=nf>Name</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>ioutil</span><span class=p>.</span><span class=nf>WriteFile</span><span class=p>(</span><span class=s>&#34;ioutil.txt&#34;</span><span class=p>,</span> <span class=p>[]</span><span class=nb>byte</span><span class=p>(</span><span class=s>&#34;xxxx&#34;</span><span class=p>),</span> <span class=nx>os</span><span class=p>.</span><span class=nx>ModePerm</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>ioutil</span><span class=p>.</span><span class=nf>WriteFile</span><span class=p>(</span><span class=s>&#34;ioutil.txt&#34;</span><span class=p>,</span> <span class=p>[]</span><span class=kt>byte</span><span class=p>{</span><span class=mi>57</span><span class=p>,</span> <span class=mi>58</span><span class=p>,</span> <span class=mi>59</span><span class=p>},</span> <span class=nx>os</span><span class=p>.</span><span class=nx>ModePerm</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>dir</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>ioutil</span><span class=p>.</span><span class=nf>TempDir</span><span class=p>(</span><span class=s>&#34;.&#34;</span><span class=p>,</span> <span class=s>&#34;temp_&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>dir</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>file</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>ioutil</span><span class=p>.</span><span class=nf>TempFile</span><span class=p>(</span><span class=s>&#34;.&#34;</span><span class=p>,</span> <span class=s>&#34;tempfile_&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>defer</span> <span class=nx>file</span><span class=p>.</span><span class=nf>Close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>file</span><span class=p>.</span><span class=nf>WriteString</span><span class=p>(</span><span class=s>&#34;xxx&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=带缓冲区io>带缓冲区IO</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 为提高性能
</span></span></span><span class=line><span class=cl><span class=c1>// 程序中定义(类似)切片 内部定义切片(指定切片的长度) 读取内容到切片 函数直接从切片中读取数据 当切片中数据读取完成后 再从硬盘读取
</span></span></span><span class=line><span class=cl><span class=c1>// 写数据类似 先写到切片 写满刷新到磁盘 可以主动刷新
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=nx>bufio</span> <span class=c1>// go doc bufio
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>Scanner</span>
</span></span><span class=line><span class=cl>  <span class=nx>Reader</span>
</span></span><span class=line><span class=cl>  <span class=nx>Writer</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Scanner
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;bufio&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;os&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// var txt string
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// fmt.Scan(&amp;txt) // fmt.Scan 不带缓冲区IO 不接收空白和空格
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// fmt.Println(&#34;scan:&#34;, txt)
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 带缓冲区IO
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 读取字符串数据 strconv
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>scanner</span> <span class=o>:=</span> <span class=nx>bufio</span><span class=p>.</span><span class=nf>NewScanner</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Stdin</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>scanner</span><span class=p>.</span><span class=nf>Scan</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;输入内容：&#34;</span><span class=p>,</span> <span class=nx>scanner</span><span class=p>.</span><span class=nf>Text</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;输入内容：&#34;</span><span class=p>,</span> <span class=nx>scanner</span><span class=p>.</span><span class=nf>Bytes</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>scanner</span><span class=p>.</span><span class=nf>Err</span><span class=p>())</span> <span class=c1>// 查看错误信息
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Reader
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;bufio&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;os&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>file</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>Open</span><span class=p>(</span><span class=s>&#34;bufio.txt&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>reader</span> <span class=o>:=</span> <span class=nx>bufio</span><span class=p>.</span><span class=nf>NewReader</span><span class=p>(</span><span class=nx>file</span><span class=p>)</span> <span class=c1>// defaultBufSize = 4096 4kb
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// bufio.NewReaderSize()
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>data</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>n</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>reader</span><span class=p>.</span><span class=nf>Read</span><span class=p>(</span><span class=nx>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>data</span><span class=p>[:</span><span class=nx>n</span><span class=p>])</span> <span class=c1>// linux strace 查看系统调用
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>n</span><span class=p>,</span> <span class=nx>_</span> <span class=p>=</span> <span class=nx>file</span><span class=p>.</span><span class=nf>Read</span><span class=p>(</span><span class=nx>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>data</span><span class=p>[:</span><span class=nx>n</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// isPrefix是True的话 还需要继续读取 表示一行还没有读取完整
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 在缓冲区中数据处理完成后若无换行就会返回isPrefix为True需要继续读取
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>ctx</span><span class=p>,</span> <span class=nx>isPrefix</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>reader</span><span class=p>.</span><span class=nf>ReadLine</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>string</span><span class=p>(</span><span class=nx>ctx</span><span class=p>),</span> <span class=nx>isPrefix</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Writer
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;bufio&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;os&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>file</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>Create</span><span class=p>(</span><span class=s>&#34;bufio.txt&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>defer</span> <span class=nx>file</span><span class=p>.</span><span class=nf>Close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>writer</span> <span class=o>:=</span> <span class=nx>bufio</span><span class=p>.</span><span class=nf>NewWriter</span><span class=p>(</span><span class=nx>file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>writer</span><span class=p>.</span><span class=nf>WriteString</span><span class=p>(</span><span class=s>&#34;abcxyz&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=nx>writer</span><span class=p>.</span><span class=nf>Flush</span><span class=p>()</span> <span class=c1>// 将缓冲区数据刷新到磁盘 否则文件没用内容
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>--</span>
</span></span><span class=line><span class=cl><span class=c1>// go实现tailf命令
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;bufio&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;io&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;log&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;os&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;time&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Args</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>2</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>log</span><span class=p>.</span><span class=nf>Fatal</span><span class=p>(</span><span class=s>&#34;usage: tailf xxx.log&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>file</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>Open</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Args</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>log</span><span class=p>.</span><span class=nf>Fatal</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>reader</span> <span class=o>:=</span> <span class=nx>bufio</span><span class=p>.</span><span class=nf>NewReaderSize</span><span class=p>(</span><span class=nx>file</span><span class=p>,</span> <span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>line</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>4096</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>data</span><span class=p>,</span> <span class=nx>isPrefix</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>reader</span><span class=p>.</span><span class=nf>ReadLine</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=nx>io</span><span class=p>.</span><span class=nx>EOF</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>log</span><span class=p>.</span><span class=nf>Print</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=nx>time</span><span class=p>.</span><span class=nf>Sleep</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=c1>// break
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=nx>isPrefix</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>line</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>line</span><span class=p>,</span> <span class=nx>data</span><span class=o>...</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nx>line</span><span class=p>)</span> <span class=p>&gt;</span> <span class=mi>0</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>string</span><span class=p>(</span><span class=nb>append</span><span class=p>(</span><span class=nx>line</span><span class=p>,</span> <span class=nx>data</span><span class=o>...</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>                <span class=nx>line</span> <span class=p>=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>4096</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>string</span><span class=p>(</span><span class=nx>data</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 缓存算法：淘汰时间最早的 LRU缓存
</span></span></span></code></pre></td></tr></table></div></div><h3 id=几个结构体>几个结构体</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// go doc strings
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>Builder</span> <span class=kd>struct</span><span class=p>{</span> <span class=o>...</span> <span class=p>}</span> <span class=c1>// 字符串变成流对象操作
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>Reader</span> <span class=kd>struct</span><span class=p>{</span> <span class=o>...</span> <span class=p>}</span>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>func</span> <span class=nf>NewReader</span><span class=p>(</span><span class=nx>s</span> <span class=kt>string</span><span class=p>)</span> <span class=o>*</span><span class=nx>Reader</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// go doc bytes.Reader
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// 在内存中对字节切片和字符串处理
</span></span></span><span class=line><span class=cl><span class=c1>// 拼接字符串：string.Builder byte.Buffer
</span></span></span><span class=line><span class=cl><span class=c1>// 下载文件在内存中处理：bytes.Buffer  // 不落盘
</span></span></span></code></pre></td></tr></table></div></div><h3 id=文件格式>文件格式</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 需要将数据落盘(磁盘存储) 网络传输
</span></span></span><span class=line><span class=cl><span class=c1>// 内存 =序列化=&gt; []byte(string) =&gt; 反序列化=&gt; 内存
</span></span></span><span class=line><span class=cl><span class=c1>// 编码方式：gob csv json protocolbuffer 序列化和反序列化的方案
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// 序列化(编码)
</span></span></span><span class=line><span class=cl><span class=c1>// 反序列化(解码)
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=err>库：</span>
</span></span><span class=line><span class=cl>  <span class=err>编码：</span><span class=nx>Marshal</span>
</span></span><span class=line><span class=cl>       <span class=nx>Encoder</span>
</span></span><span class=line><span class=cl>  <span class=err>解码：</span><span class=nx>Unmarshal</span>
</span></span><span class=line><span class=cl>       <span class=nx>Decoder</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 用哪种类型的数据编码 就解码为对应的数据类型
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>gob</span> <span class=p>=&gt;</span> <span class=nx>Go</span><span class=err>语言提供的编码</span> <span class=err>二进制编码方式</span>
</span></span><span class=line><span class=cl><span class=nx>encoding</span><span class=o>/</span><span class=nx>gob</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=gob>gob</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;encoding/gob&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;os&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 属性名称都大写
</span></span></span><span class=line><span class=cl><span class=c1>// 序列化和反序列化需要访问属性
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>User</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Id</span>   <span class=kt>int</span>
</span></span><span class=line><span class=cl>    <span class=nx>Name</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>Addr</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 非go内置的基本类型和复合数据类型 需要注册
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>gob</span><span class=p>.</span><span class=nf>Register</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>User</span><span class=p>{})</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>users</span> <span class=o>:=</span> <span class=p>[]</span><span class=o>*</span><span class=nx>User</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=s>&#34;Minho&#34;</span><span class=p>,</span> <span class=s>&#34;SC&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=mi>2</span><span class=p>,</span> <span class=s>&#34;lemon&#34;</span><span class=p>,</span> <span class=s>&#34;SH&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=mi>3</span><span class=p>,</span> <span class=s>&#34;karubin&#34;</span><span class=p>,</span> <span class=s>&#34;GD&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>file</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>Create</span><span class=p>(</span><span class=s>&#34;data.gob&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 编码
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>encoder</span> <span class=o>:=</span> <span class=nx>gob</span><span class=p>.</span><span class=nf>NewEncoder</span><span class=p>(</span><span class=nx>file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>err</span> <span class=o>:=</span> <span class=nx>encoder</span><span class=p>.</span><span class=nf>Encode</span><span class=p>(</span><span class=nx>users</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>file</span><span class=p>.</span><span class=nf>Close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 解码
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>file</span><span class=p>,</span> <span class=nx>_</span> <span class=p>=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>Open</span><span class=p>(</span><span class=s>&#34;data.gob&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>defer</span> <span class=nx>file</span><span class=p>.</span><span class=nf>Close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>decoder</span> <span class=o>:=</span> <span class=nx>gob</span><span class=p>.</span><span class=nf>NewDecoder</span><span class=p>(</span><span class=nx>file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>user2</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=o>*</span><span class=nx>User</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>err</span> <span class=p>=</span> <span class=nx>decoder</span><span class=p>.</span><span class=nf>Decode</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>user2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>err</span><span class=p>,</span> <span class=nx>user2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>u</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>user2</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%#v\n&#34;</span><span class=p>,</span> <span class=nx>u</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=csv>csv</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;encoding/csv&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;os&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>file</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>Open</span><span class=p>(</span><span class=s>&#34;table.csv&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>defer</span> <span class=nx>file</span><span class=p>.</span><span class=nf>Close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>reader</span> <span class=o>:=</span> <span class=nx>csv</span><span class=p>.</span><span class=nf>NewReader</span><span class=p>(</span><span class=nx>file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>line</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>reader</span><span class=p>.</span><span class=nf>Read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>err</span><span class=p>,</span> <span class=nx>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>line</span><span class=p>,</span> <span class=nx>err</span> <span class=p>=</span> <span class=nx>reader</span><span class=p>.</span><span class=nf>Read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>err</span><span class=p>,</span> <span class=nx>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>line</span><span class=p>,</span> <span class=nx>err</span> <span class=p>=</span> <span class=nx>reader</span><span class=p>.</span><span class=nf>Read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>err</span><span class=p>,</span> <span class=nx>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>line</span><span class=p>,</span> <span class=nx>err</span> <span class=p>=</span> <span class=nx>reader</span><span class=p>.</span><span class=nf>Read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>err</span><span class=p>,</span> <span class=nx>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>file</span><span class=p>,</span> <span class=nx>_</span> <span class=p>=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>Create</span><span class=p>(</span><span class=s>&#34;table.csv&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>writer</span> <span class=o>:=</span> <span class=nx>csv</span><span class=p>.</span><span class=nf>NewWriter</span><span class=p>(</span><span class=nx>file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>writer</span><span class=p>.</span><span class=nf>Write</span><span class=p>([]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;A1&#34;</span><span class=p>,</span> <span class=s>&#34;B1&#34;</span><span class=p>,</span> <span class=s>&#34;C1&#34;</span><span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=nx>writer</span><span class=p>.</span><span class=nf>Write</span><span class=p>([]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;A2&#34;</span><span class=p>,</span> <span class=s>&#34;B2&#34;</span><span class=p>,</span> <span class=s>&#34;C2&#34;</span><span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=nx>writer</span><span class=p>.</span><span class=nf>Write</span><span class=p>([]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;A3&#34;</span><span class=p>,</span> <span class=s>&#34;B3&#34;</span><span class=p>,</span> <span class=s>&#34;C3&#34;</span><span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=nx>writer</span><span class=p>.</span><span class=nf>Write</span><span class=p>([]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;A4&#34;</span><span class=p>,</span> <span class=s>&#34;B4&#34;</span><span class=p>,</span> <span class=s>&#34;C4&#34;</span><span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=nx>writer</span><span class=p>.</span><span class=nf>Flush</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=接口>接口</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=err>数据</span> <span class=o>+</span> <span class=err>行为</span> <span class=p>=&gt;</span> <span class=err>结构体属性</span> <span class=err>方法</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 都有类似的方法
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>os</span><span class=p>.</span><span class=nx>File</span><span class=p>:</span> <span class=nx>read</span>    <span class=nx>write</span>
</span></span><span class=line><span class=cl><span class=nx>strings</span><span class=p>.</span><span class=nx>Builder</span><span class=p>:</span> <span class=nx>write</span>
</span></span><span class=line><span class=cl><span class=nx>strings</span><span class=p>.</span><span class=nx>Reader</span><span class=p>:</span>  <span class=nx>read</span>
</span></span><span class=line><span class=cl><span class=nx>bytes</span><span class=p>.</span><span class=nx>Buffer</span><span class=p>:</span>    <span class=nx>write</span> <span class=nx>read</span>
</span></span><span class=line><span class=cl><span class=nx>bytes</span><span class=p>.</span><span class=nx>Reader</span><span class=p>:</span>    <span class=nx>read</span>
</span></span><span class=line><span class=cl><span class=nx>bufio</span><span class=p>.</span><span class=nx>Writer</span><span class=p>:</span>    <span class=nx>write</span>
</span></span><span class=line><span class=cl><span class=nx>bufio</span><span class=p>.</span><span class=nx>Reader</span><span class=p>:</span>    <span class=nx>read</span>
</span></span><span class=line><span class=cl><span class=nx>bufio</span><span class=p>.</span><span class=nx>Scanner</span><span class=p>:</span>   <span class=nx>read</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>接口：对行为的抽象</span>
</span></span><span class=line><span class=cl><span class=err>行为抽象的对象</span> <span class=p>=&gt;</span> <span class=err>实现行为的对象</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 定义
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=err>接口：定义的一些函数</span><span class=p>(</span><span class=mi>0</span> <span class=mi>1</span> <span class=nx>n</span><span class=err>个</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=err>签名：函数名称</span> <span class=err>参数列表</span> <span class=err>返回值列表</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 关键字：interface
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>TypeName</span> <span class=nx>Formatter</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>InterfaceName</span> <span class=kd>interface</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=err>方法签名</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 断言 =&gt; 接口
</span></span></span><span class=line><span class=cl><span class=c1>// 对应类型的变量, ok := 接口类型变量.(类型)
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// switch 接口类型变量.(type) { // switch p := 接口类型变量.(type)
</span></span></span><span class=line><span class=cl><span class=c1>// case GobPersistent:
</span></span></span><span class=line><span class=cl><span class=c1>// case CsvPersistent:
</span></span></span><span class=line><span class=cl><span class=c1>// case *JsonPersistent:
</span></span></span><span class=line><span class=cl><span class=c1>// case *ProtobufPersistent:
</span></span></span><span class=line><span class=cl><span class=c1>// default:
</span></span></span><span class=line><span class=cl><span class=c1>// }
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// 如何实现一个可以接收任意类型变量的函数
</span></span></span></code></pre></td></tr></table></div></div><h3 id=定义赋值>定义/赋值</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>User</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Id</span>   <span class=kt>int</span>
</span></span><span class=line><span class=cl>    <span class=nx>Name</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 定义一个持久化数据接口
</span></span></span><span class=line><span class=cl><span class=c1>// 行为：Save保存User切片 Load: 加载User切片
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>Persistent</span> <span class=kd>interface</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>Save</span><span class=p>([]</span><span class=nx>User</span><span class=p>,</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>error</span>
</span></span><span class=line><span class=cl>    <span class=nf>Load</span><span class=p>(</span><span class=kt>string</span><span class=p>)</span> <span class=p>([]</span><span class=nx>User</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GobPersistent</span> <span class=kd>struct</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 定义了Persistent接口所有(一个也不能少 但是可以多)的方法 就叫Gobpersistent实现了Persistent接口
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>g</span> <span class=nx>GobPersistent</span><span class=p>)</span> <span class=nf>Save</span><span class=p>(</span><span class=nx>users</span> <span class=p>[]</span><span class=nx>User</span><span class=p>,</span> <span class=nx>path</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;gob persistent Save&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>g</span> <span class=nx>GobPersistent</span><span class=p>)</span> <span class=nf>Load</span><span class=p>(</span><span class=nx>path</span> <span class=kt>string</span><span class=p>)</span> <span class=p>([]</span><span class=nx>User</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;gob persistent Load&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>nil</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>CsvPersistent</span> <span class=kd>struct</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>c</span> <span class=nx>CsvPersistent</span><span class=p>)</span> <span class=nf>Save</span><span class=p>(</span><span class=nx>users</span> <span class=p>[]</span><span class=nx>User</span><span class=p>,</span> <span class=nx>path</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;csv persistent Save&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>c</span> <span class=nx>CsvPersistent</span><span class=p>)</span> <span class=nf>Load</span><span class=p>(</span><span class=nx>path</span> <span class=kt>string</span><span class=p>)</span> <span class=p>([]</span><span class=nx>User</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;csv persistent Load&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>nil</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>call</span><span class=p>(</span><span class=nx>persistent</span> <span class=nx>Persistent</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;call:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>persistent</span><span class=p>.</span><span class=nf>Save</span><span class=p>(</span><span class=kc>nil</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>persistent</span><span class=p>.</span><span class=nf>Load</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>JsonPersistent</span> <span class=kd>struct</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>j</span> <span class=o>*</span><span class=nx>JsonPersistent</span><span class=p>)</span> <span class=nf>Save</span><span class=p>(</span><span class=nx>users</span> <span class=p>[]</span><span class=nx>User</span><span class=p>,</span> <span class=nx>path</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;json persistent Save&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>j</span> <span class=o>*</span><span class=nx>JsonPersistent</span><span class=p>)</span> <span class=nf>Load</span><span class=p>(</span><span class=nx>path</span> <span class=kt>string</span><span class=p>)</span> <span class=p>([]</span><span class=nx>User</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;json persistent Load&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>nil</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>ProtobufPersistent</span> <span class=kd>struct</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>p</span> <span class=o>*</span><span class=nx>ProtobufPersistent</span><span class=p>)</span> <span class=nf>Save</span><span class=p>(</span><span class=nx>users</span> <span class=p>[]</span><span class=nx>User</span><span class=p>,</span> <span class=nx>path</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;protobuf persistent Save&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>p</span> <span class=nx>ProtobufPersistent</span><span class=p>)</span> <span class=nf>Load</span><span class=p>(</span><span class=nx>path</span> <span class=kt>string</span><span class=p>)</span> <span class=p>([]</span><span class=nx>User</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;protobuf persistent Load&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>nil</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>persistent</span> <span class=nx>Persistent</span>
</span></span><span class=line><span class=cl>    <span class=c1>// persistent := GobPersistent{}
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>persistent</span><span class=p>,</span> <span class=nx>persistent</span><span class=p>)</span> <span class=c1>// nil nil
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 赋值/初始化
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 接口 不能直接通过接口类型初始化对象
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 需要使用实现行为(实现接口的所有方法 某个对象的类型定义了接口中所有的方法)的对象
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>persistent</span> <span class=p>=</span> <span class=nx>CsvPersistent</span><span class=p>{}</span> <span class=c1>// 如果有接口后 只需要需改实现
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>persistent</span><span class=p>,</span> <span class=nx>persistent</span><span class=p>)</span> <span class=c1>// Gobpersistent, Gobpersistent{}
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>persistent</span><span class=p>.</span><span class=nf>Save</span><span class=p>(</span><span class=kc>nil</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>)</span>                        <span class=c1>// =&gt; Gobpersistent-&gt;Save
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>persistent</span><span class=p>.</span><span class=nf>Load</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>)</span>                             <span class=c1>// Gobpersistent-&gt;Load
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nf>call</span><span class=p>(</span><span class=nx>persistent</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 多态 =&gt; 某个对象赋值为不同对象 体现出不同的行为
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;多态&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nf>call</span><span class=p>(</span><span class=nx>GobPersistent</span><span class=p>{})</span>
</span></span><span class=line><span class=cl>    <span class=nf>call</span><span class=p>(</span><span class=nx>CsvPersistent</span><span class=p>{})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 定义类型 与 接口 是否实现 无语法上直接关联
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 鸭子类型
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// persistent为什么不直接定义为Gobpersistent？
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 改动代码非常麻烦 特别涉及到各种Gobpersistent参数传递的时候
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 指针对象
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>persistent</span> <span class=p>=</span> <span class=nb>new</span><span class=p>(</span><span class=nx>CsvPersistent</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>persistent</span><span class=p>,</span> <span class=nx>persistent</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>persistent</span><span class=p>.</span><span class=nf>Load</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>persistent</span><span class=p>.</span><span class=nf>Save</span><span class=p>(</span><span class=kc>nil</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nf>call</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>CsvPersistent</span><span class=p>{})</span>
</span></span><span class=line><span class=cl>    <span class=nf>call</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>GobPersistent</span><span class=p>{})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 疑问：为什么指针对象也有Save和Load方法
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 方法是值接收者 调用对象是一个指针 可以直接调用值接收者方法 -&gt; 语法糖 指针对象会自动进行解引用
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 但是接口这一块并不是语法糖
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 指针类型接收者方法 如何赋值
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;指针接收者：&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>persistent</span> <span class=p>=</span> <span class=nb>new</span><span class=p>(</span><span class=nx>JsonPersistent</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>persistent</span><span class=p>.</span><span class=nf>Load</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>persistent</span><span class=p>.</span><span class=nf>Save</span><span class=p>(</span><span class=kc>nil</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// persistent = JsonPersistent{}
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// persistent.Load(&#34;&#34;)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// persistent.Save(nil, &#34;&#34;)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// sonPersistent does not implement Persistent (Load method has pointer receiver)
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 又有指针 又有值接收者方法
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// ProtobufPersistent{} =&gt; 未实现Save值接收者方法
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// new(ProtobufPersistent) =&gt; 可以
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>persistent</span> <span class=p>=</span> <span class=o>&amp;</span><span class=nx>ProtobufPersistent</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=nx>persistent</span><span class=p>.</span><span class=nf>Load</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>persistent</span><span class=p>.</span><span class=nf>Save</span><span class=p>(</span><span class=kc>nil</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 接口方法是值接收者 会生成对应的指针接收者方法
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 接口方式是指针接收者 不会生成对应的值接收者方法
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=结构体赋值接口类型>结构体赋值接口类型</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>User</span> <span class=kd>struct</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Persistent</span> <span class=kd>interface</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>Save</span><span class=p>([]</span><span class=nx>User</span><span class=p>,</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>error</span>
</span></span><span class=line><span class=cl>    <span class=nf>Load</span><span class=p>(</span><span class=kt>string</span><span class=p>)</span> <span class=p>([]</span><span class=nx>User</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GobPersistent</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Version</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>g</span> <span class=nx>GobPersistent</span><span class=p>)</span> <span class=nf>Save</span><span class=p>(</span><span class=nx>u</span> <span class=p>[]</span><span class=nx>User</span><span class=p>,</span> <span class=nx>path</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Save&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>g</span> <span class=nx>GobPersistent</span><span class=p>)</span> <span class=nf>Load</span><span class=p>(</span><span class=nx>path</span> <span class=kt>string</span><span class=p>)</span> <span class=p>([]</span><span class=nx>User</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Load&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>nil</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>g</span> <span class=nx>GobPersistent</span><span class=p>)</span> <span class=nf>Test</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Test&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 接口赋值不能省略类型 省略之后类型不一样 一个是接口类型 一个是结构体
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>var</span> <span class=nx>persistent</span> <span class=nx>Persistent</span> <span class=p>=</span> <span class=nx>GobPersistent</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=c1>// var persistent = GobPersistent{}
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%#v\n&#34;</span><span class=p>,</span> <span class=nx>persistent</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>persistent</span><span class=p>.</span><span class=nf>Save</span><span class=p>(</span><span class=kc>nil</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>)</span> <span class=c1>// 正常调用
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>persistent</span><span class=p>.</span><span class=nf>Load</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>)</span>      <span class=c1>// 正常调用
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// persistent.Test()               // type Persistent has no field or method Test. 不能调用Test方法 Persistent接口无Test方法 =&gt; 行为丢失
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// fmt.Println(persistent.Version) // 不能获取Version属性
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=接口赋值接口>接口赋值接口</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>User</span> <span class=kd>struct</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Persistent</span> <span class=kd>interface</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>Save</span><span class=p>([]</span><span class=nx>User</span><span class=p>,</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>error</span>
</span></span><span class=line><span class=cl>    <span class=nf>Load</span><span class=p>(</span><span class=kt>string</span><span class=p>)</span> <span class=p>([]</span><span class=nx>User</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GobPersistent</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Version</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>g</span> <span class=nx>GobPersistent</span><span class=p>)</span> <span class=nf>Save</span><span class=p>(</span><span class=nx>u</span> <span class=p>[]</span><span class=nx>User</span><span class=p>,</span> <span class=nx>path</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Save&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>g</span> <span class=nx>GobPersistent</span><span class=p>)</span> <span class=nf>Load</span><span class=p>(</span><span class=nx>path</span> <span class=kt>string</span><span class=p>)</span> <span class=p>([]</span><span class=nx>User</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Load&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>nil</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>g</span> <span class=nx>GobPersistent</span><span class=p>)</span> <span class=nf>Test</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Test&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Saver</span> <span class=kd>interface</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>Save</span><span class=p>([]</span><span class=nx>User</span><span class=p>,</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>error</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Loader</span> <span class=kd>interface</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>Load</span><span class=p>(</span><span class=kt>string</span><span class=p>)</span> <span class=p>([]</span><span class=nx>User</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Dumper</span> <span class=kd>interface</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>Save</span><span class=p>([]</span><span class=nx>User</span><span class=p>,</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>error</span>
</span></span><span class=line><span class=cl>    <span class=nf>Dump</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>persistent</span> <span class=nx>Persistent</span> <span class=p>=</span> <span class=nx>GobPersistent</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%#v\n&#34;</span><span class=p>,</span> <span class=nx>persistent</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>saver</span> <span class=nx>Saver</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>saver</span><span class=p>,</span> <span class=nx>saver</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>saver</span> <span class=p>=</span> <span class=nx>GobPersistent</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>saver</span><span class=p>,</span> <span class=nx>saver</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>saver</span><span class=p>.</span><span class=nf>Save</span><span class=p>(</span><span class=kc>nil</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>saver</span> <span class=p>=</span> <span class=nx>persistent</span> <span class=c1>// 接口对象赋值给另一个接口对象
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>saver</span><span class=p>,</span> <span class=nx>saver</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>loader</span> <span class=nx>Loader</span> <span class=p>=</span> <span class=nx>persistent</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>loader</span><span class=p>,</span> <span class=nx>loader</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 没有实现Dump方法 无法赋值
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// var dumper Dumper = persistent
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 接口赋值可以使用自定义类型创建的对象赋值 或者 通过接口类型的变量进行赋值(需要实现对应的方法)
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 接口赋值的过程中 会丢失一些方法
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=类型断言>类型断言</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>User</span> <span class=kd>struct</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Persistent</span> <span class=kd>interface</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>Save</span><span class=p>([]</span><span class=nx>User</span><span class=p>,</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>error</span>
</span></span><span class=line><span class=cl>    <span class=nf>Load</span><span class=p>(</span><span class=kt>string</span><span class=p>)</span> <span class=p>([]</span><span class=nx>User</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GobPersistent</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Version</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>g</span> <span class=nx>GobPersistent</span><span class=p>)</span> <span class=nf>Save</span><span class=p>(</span><span class=nx>u</span> <span class=p>[]</span><span class=nx>User</span><span class=p>,</span> <span class=nx>path</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Save&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>g</span> <span class=nx>GobPersistent</span><span class=p>)</span> <span class=nf>Load</span><span class=p>(</span><span class=nx>path</span> <span class=kt>string</span><span class=p>)</span> <span class=p>([]</span><span class=nx>User</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Load&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>nil</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>g</span> <span class=nx>GobPersistent</span><span class=p>)</span> <span class=nf>Test</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;gob Test&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>CsvPersistent</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Version</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>c</span> <span class=nx>CsvPersistent</span><span class=p>)</span> <span class=nf>Save</span><span class=p>(</span><span class=nx>u</span> <span class=p>[]</span><span class=nx>User</span><span class=p>,</span> <span class=nx>path</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Save&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>c</span> <span class=nx>CsvPersistent</span><span class=p>)</span> <span class=nf>Load</span><span class=p>(</span><span class=nx>path</span> <span class=kt>string</span><span class=p>)</span> <span class=p>([]</span><span class=nx>User</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Load&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>nil</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>c</span> <span class=nx>CsvPersistent</span><span class=p>)</span> <span class=nf>Test</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;csv Test&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Saver</span> <span class=kd>interface</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>Save</span><span class=p>([]</span><span class=nx>User</span><span class=p>,</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>error</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>persistent</span> <span class=nx>Persistent</span> <span class=p>=</span> <span class=nx>GobPersistent</span><span class=p>{</span><span class=s>&#34;1.1.1&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 类型转换
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 断言：只能对接口类型做操作 转换为一个更具体的类型
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 对应类型的变量, ok := 接口类型变量.(类型)
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// persistent.Test()
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>gobPersistent</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=nx>persistent</span><span class=p>.(</span><span class=nx>GobPersistent</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %#v, %T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>ok</span><span class=p>,</span> <span class=nx>ok</span><span class=p>,</span> <span class=nx>gobPersistent</span><span class=p>,</span> <span class=nx>gobPersistent</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>gobPersistent</span><span class=p>.</span><span class=nf>Test</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>gobPersistent</span><span class=p>.</span><span class=nx>Version</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// user没有实现persistent接口 无法断言
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// user, ok := persistent.(User)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// fmt.Println(user, ok)
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>csvPersistent</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=nx>persistent</span><span class=p>.(</span><span class=nx>CsvPersistent</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %#v, %T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>ok</span><span class=p>,</span> <span class=nx>ok</span><span class=p>,</span> <span class=nx>csvPersistent</span><span class=p>,</span> <span class=nx>csvPersistent</span><span class=p>)</span> <span class=c1>// ok == false
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>csvPersistent</span><span class=p>.</span><span class=nf>Test</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>saver</span> <span class=nx>Saver</span> <span class=p>=</span> <span class=nx>persistent</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>p</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=nx>saver</span><span class=p>.(</span><span class=nx>Persistent</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %#v, %T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>ok</span><span class=p>,</span> <span class=nx>ok</span><span class=p>,</span> <span class=nx>p</span><span class=p>,</span> <span class=nx>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>p</span><span class=p>.</span><span class=nf>Load</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>g</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=nx>saver</span><span class=p>.(</span><span class=nx>GobPersistent</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %#v, %T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>ok</span><span class=p>,</span> <span class=nx>ok</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>g</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>g</span><span class=p>.</span><span class=nx>Version</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>c</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=nx>saver</span><span class=p>.(</span><span class=nx>CsvPersistent</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %#v, %T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>ok</span><span class=p>,</span> <span class=nx>ok</span><span class=p>,</span> <span class=nx>c</span><span class=p>,</span> <span class=nx>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>c</span><span class=p>.</span><span class=nf>Test</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=多个类型断言>多个类型断言</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 多个类型断言 if...else / switch
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>persistent</span> <span class=nx>Persistent</span> <span class=p>=</span> <span class=o>&amp;</span><span class=nx>ProtobufPersistent</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// if g, ok := persistent.(GobPersistent); ok {
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//     fmt.Println(&#34;g&#34;, g, ok)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// } else if c, ok := persistent.(CsvPersistent); ok {
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//     fmt.Println(&#34;c&#34;, c, ok)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// } else if j, ok := persistent.(*JsonPersistent); ok {
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//     fmt.Println(&#34;j&#34;, j, ok)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// } else if p, ok := persistent.(*ProtobufPersistent); ok {
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//     fmt.Println(&#34;p&#34;, p, ok)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// } else {
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//     fmt.Println(&#34;error&#34;)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// }
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>        switch 接口类型变量.(type) {
</span></span></span><span class=line><span class=cl><span class=cm>        case GobPersistent:
</span></span></span><span class=line><span class=cl><span class=cm>        case CsvPersistent:
</span></span></span><span class=line><span class=cl><span class=cm>        case *JsonPersistent:
</span></span></span><span class=line><span class=cl><span class=cm>        case *ProtobufPersistent:
</span></span></span><span class=line><span class=cl><span class=cm>        default:
</span></span></span><span class=line><span class=cl><span class=cm>        }
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>        switch p := 接口类型变量.(type) {
</span></span></span><span class=line><span class=cl><span class=cm>        case GobPersistent:
</span></span></span><span class=line><span class=cl><span class=cm>        case CsvPersistent:
</span></span></span><span class=line><span class=cl><span class=cm>        case *JsonPersistent:
</span></span></span><span class=line><span class=cl><span class=cm>        case *ProtobufPersistent:
</span></span></span><span class=line><span class=cl><span class=cm>        default:
</span></span></span><span class=line><span class=cl><span class=cm>        }
</span></span></span><span class=line><span class=cl><span class=cm>    */</span>
</span></span><span class=line><span class=cl>    <span class=k>switch</span> <span class=nx>p</span> <span class=o>:=</span> <span class=nx>persistent</span><span class=p>.(</span><span class=kd>type</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=nx>GobPersistent</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;g&#34;</span><span class=p>,</span> <span class=nx>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=nx>CsvPersistent</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;c&#34;</span><span class=p>,</span> <span class=nx>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=o>*</span><span class=nx>JsonPersistent</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;j&#34;</span><span class=p>,</span> <span class=nx>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=o>*</span><span class=nx>ProtobufPersistent</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;p&#34;</span><span class=p>,</span> <span class=nx>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>default</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;error&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=接口嵌入>接口嵌入</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span><span class=lnt>93
</span><span class=lnt>94
</span><span class=lnt>95
</span><span class=lnt>96
</span><span class=lnt>97
</span><span class=lnt>98
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>User</span> <span class=kd>struct</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GobPersistent</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Version</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>g</span> <span class=nx>GobPersistent</span><span class=p>)</span> <span class=nf>Save</span><span class=p>(</span><span class=nx>u</span> <span class=p>[]</span><span class=nx>User</span><span class=p>,</span> <span class=nx>path</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Save&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>g</span> <span class=nx>GobPersistent</span><span class=p>)</span> <span class=nf>Load</span><span class=p>(</span><span class=nx>path</span> <span class=kt>string</span><span class=p>)</span> <span class=p>([]</span><span class=nx>User</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Load&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>nil</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Saver</span> <span class=kd>interface</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>Save</span><span class=p>([]</span><span class=nx>User</span><span class=p>,</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>error</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Loader</span> <span class=kd>interface</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>Load</span><span class=p>(</span><span class=kt>string</span><span class=p>)</span> <span class=p>([]</span><span class=nx>User</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>PersistentV2</span> <span class=kd>interface</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Saver</span>
</span></span><span class=line><span class=cl>    <span class=nx>Loader</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>PersistentV3</span> <span class=kd>interface</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Saver</span>
</span></span><span class=line><span class=cl>    <span class=nx>Loader</span>
</span></span><span class=line><span class=cl>    <span class=nf>Dump</span><span class=p>()</span> <span class=c1>// V3这个接口 还需要实现Dump方法
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 接口只有匿名嵌入
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>var</span> <span class=nx>persistentV2</span> <span class=nx>PersistentV2</span> <span class=p>=</span> <span class=nx>GobPersistent</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>persistentV2</span><span class=p>,</span> <span class=nx>persistentV2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>persistentV2</span><span class=p>.</span><span class=nf>Load</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>persistentV2</span><span class=p>.</span><span class=nf>Save</span><span class=p>(</span><span class=kc>nil</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 结构体当前使用接口嵌入
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>User</span> <span class=kd>struct</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Persistent</span> <span class=kd>interface</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>Save</span><span class=p>([]</span><span class=nx>User</span><span class=p>,</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>error</span>
</span></span><span class=line><span class=cl>    <span class=nf>Load</span><span class=p>(</span><span class=kt>string</span><span class=p>)</span> <span class=p>([]</span><span class=nx>User</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GobPersistent</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Version</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>g</span> <span class=nx>GobPersistent</span><span class=p>)</span> <span class=nf>Save</span><span class=p>(</span><span class=nx>u</span> <span class=p>[]</span><span class=nx>User</span><span class=p>,</span> <span class=nx>path</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Save&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>g</span> <span class=nx>GobPersistent</span><span class=p>)</span> <span class=nf>Load</span><span class=p>(</span><span class=nx>path</span> <span class=kt>string</span><span class=p>)</span> <span class=p>([]</span><span class=nx>User</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Load&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>nil</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Storer</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Persistent</span> <span class=nx>Persistent</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>StorerV2</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Persistent</span> <span class=c1>// 匿名嵌入
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>storer</span> <span class=o>:=</span> <span class=nx>Storer</span><span class=p>{</span><span class=nx>GobPersistent</span><span class=p>{}}</span>
</span></span><span class=line><span class=cl>    <span class=nx>storer</span><span class=p>.</span><span class=nx>Persistent</span><span class=p>.</span><span class=nf>Load</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>storer</span><span class=p>.</span><span class=nx>Persistent</span><span class=p>.</span><span class=nf>Save</span><span class=p>(</span><span class=kc>nil</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>storerV2</span> <span class=o>:=</span> <span class=nx>StorerV2</span><span class=p>{</span><span class=nx>GobPersistent</span><span class=p>{}}</span>
</span></span><span class=line><span class=cl>    <span class=nx>storerV2</span><span class=p>.</span><span class=nx>Persistent</span><span class=p>.</span><span class=nf>Load</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>storerV2</span><span class=p>.</span><span class=nx>Persistent</span><span class=p>.</span><span class=nf>Save</span><span class=p>(</span><span class=kc>nil</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>storerV2</span><span class=p>.</span><span class=nf>Load</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>storerV2</span><span class=p>.</span><span class=nf>Save</span><span class=p>(</span><span class=kc>nil</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=匿名接口>匿名接口</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>test</span> <span class=p>=</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;匿名函数&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>user</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>ID</span>   <span class=kt>string</span>
</span></span><span class=line><span class=cl>        <span class=nx>Name</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=c1>// 匿名结构体
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>saver</span> <span class=kd>interface</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>Save</span><span class=p>(</span><span class=kt>string</span><span class=p>)</span> <span class=kt>error</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=c1>// 匿名接口
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>test</span><span class=p>,</span> <span class=nx>test</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>user</span><span class=p>,</span> <span class=nx>user</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>saver</span><span class=p>,</span> <span class=nx>saver</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=空接口及其使用>空接口及其使用</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>EmptyStruct</span> <span class=kd>struct</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>EmptyInterface</span> <span class=kd>interface</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>emptyStr</span> <span class=o>:=</span> <span class=s>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>emptyStr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>emptySlice</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>int</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>emptySlice</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>emptyMap</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>string</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>emptyMap</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>emptyStruct</span> <span class=o>:=</span> <span class=nx>EmptyStruct</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>emptyStruct</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 空接口
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>var</span> <span class=nx>emptyInterface</span> <span class=nx>EmptyInterface</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 空接口如何赋值?
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 空接口没有定义任何的签名 任意对象都可以赋值给空接口
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>emptyInterface</span> <span class=p>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>emptyInterface</span><span class=p>,</span> <span class=nx>emptyInterface</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>emptyInterface</span> <span class=p>=</span> <span class=s>&#34;123&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>emptyInterface</span><span class=p>,</span> <span class=nx>emptyInterface</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>emptyInterface</span> <span class=p>=</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>emptyInterface</span><span class=p>,</span> <span class=nx>emptyInterface</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>emptyInterface</span> <span class=p>=</span> <span class=nx>emptyStruct</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>emptyInterface</span><span class=p>,</span> <span class=nx>emptyInterface</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>emptyInterface</span> <span class=p>=</span> <span class=nx>emptySlice</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>emptyInterface</span><span class=p>,</span> <span class=nx>emptyInterface</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 空接口 + 匿名
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>var</span> <span class=nx>empty</span> <span class=kd>interface</span><span class=p>{}</span> <span class=c1>// empty空接口的变量
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>empty</span><span class=p>,</span> <span class=nx>empty</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>empty</span> <span class=p>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>empty</span><span class=p>,</span> <span class=nx>empty</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>empty</span> <span class=p>=</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>empty</span><span class=p>,</span> <span class=nx>empty</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>)</span> <span class=c1>// fmt.Println 可以打印任意类型的变量
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 如何实现一个可以接收任意类型变量的函数 =&gt; 使用空接口
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nf>t</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nf>t</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nf>t</span><span class=p>(</span><span class=kc>true</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nf>t</span><span class=p>([]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;1&#34;</span><span class=p>,</span> <span class=s>&#34;@&#34;</span><span class=p>}))</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nf>t</span><span class=p>(</span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span><span class=s>&#34;1&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=s>&#34;@&#34;</span><span class=p>:</span> <span class=mi>2</span><span class=p>}))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 如何实现一个可以接收任意数量 任意类型的函数
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nf>args</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nf>args</span><span class=p>(</span><span class=s>&#34;abc&#34;</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=p>[]</span><span class=kt>string</span><span class=p>{})</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>t</span><span class=p>(</span><span class=nx>args</span> <span class=kd>interface</span><span class=p>{})</span> <span class=kt>string</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;%T&#34;</span><span class=p>,</span> <span class=nx>args</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>args</span><span class=p>(</span><span class=nx>args</span> <span class=o>...</span><span class=kd>interface</span><span class=p>{})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>i</span><span class=p>,</span> <span class=nx>arg</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>args</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nf>t</span><span class=p>(</span><span class=nx>arg</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=json序列化反序列化>Json序列化/反序列化</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=mf>1.</span> <span class=nx>Type</span><span class=p>,</span> <span class=nx>Value</span>
</span></span><span class=line><span class=cl><span class=mf>2.</span> <span class=err>使用反射</span>
</span></span><span class=line><span class=cl><span class=mf>3.</span> <span class=err>反射应用</span><span class=p>(</span><span class=err>内部实现使用反射</span><span class=p>)</span><span class=err>：</span> <span class=nx>json</span> <span class=err>\</span> <span class=nx>xml</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=encodingjson>encoding/json</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=k>go</span> <span class=nx>doc</span> <span class=nx>encoding</span><span class=o>/</span><span class=nx>json</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=基本数据类型json-转换>基本数据类型/json 转换</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/* json: 格式化的字符串
</span></span></span><span class=line><span class=cl><span class=cm>GO                  =&gt;          Json
</span></span></span><span class=line><span class=cl><span class=cm>数值：number(int/float)   =&gt; 1.1 10 -10
</span></span></span><span class=line><span class=cl><span class=cm>字符串：string              =&gt; &#34;&#34;
</span></span></span><span class=line><span class=cl><span class=cm>布尔：bool                =&gt; true, false
</span></span></span><span class=line><span class=cl><span class=cm>数组：[]Type/[Length]Type =&gt; [1, 2, 3, &#34;&#34;, &#34;&#34;]
</span></span></span><span class=line><span class=cl><span class=cm>字典(Object):map[KTepy]Value     =&gt; {&#34;key&#34;: value, &#34;key2&#34;: value2}
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>Go数据类型 与 Json字符串转换
</span></span></span><span class=line><span class=cl><span class=cm>Go数据类型 &lt;=&gt; Gob二进制字符串
</span></span></span><span class=line><span class=cl><span class=cm>Go数据类型 &lt;=&gt; xml字符串
</span></span></span><span class=line><span class=cl><span class=cm>Go数据类型 &lt;=&gt; Protobuffer
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>持久化/网络传输
</span></span></span><span class=line><span class=cl><span class=cm>=&gt; 序列化： Go数据类型 =&gt; 字符串(文本/二进制)
</span></span></span><span class=line><span class=cl><span class=cm>=&gt; 反序列化：字符串(文本/二进制) =&gt; Go数据类型
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>编码规则 =&gt; 库(包)
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;encoding/json&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=nx>number</span> <span class=kt>float64</span>        <span class=p>=</span> <span class=mf>1.1</span>
</span></span><span class=line><span class=cl>        <span class=nx>name</span>   <span class=kt>string</span>         <span class=p>=</span> <span class=s>&#34;minho&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nx>isBody</span> <span class=kt>bool</span>           <span class=p>=</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>        <span class=nx>users</span>  <span class=p>[]</span><span class=kt>string</span>       <span class=p>=</span> <span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;1&#34;</span><span class=p>,</span> <span class=s>&#34;2&#34;</span><span class=p>,</span> <span class=s>&#34;3&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=nx>scores</span> <span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>int</span> <span class=p>=</span> <span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span><span class=s>&#34;1&#34;</span><span class=p>:</span> <span class=mi>90</span><span class=p>,</span> <span class=s>&#34;2&#34;</span><span class=p>:</span> <span class=mi>80</span><span class=p>,</span> <span class=s>&#34;3&#34;</span><span class=p>:</span> <span class=mi>100</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 序列化为json字符串
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>b</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>json</span><span class=p>.</span><span class=nf>Marshal</span><span class=p>(</span><span class=nx>number</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%#v, %T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nb>string</span><span class=p>(</span><span class=nx>b</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>b</span><span class=p>,</span> <span class=nx>err</span> <span class=p>=</span> <span class=nx>json</span><span class=p>.</span><span class=nf>Marshal</span><span class=p>(</span><span class=nx>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%#v, %T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nb>string</span><span class=p>(</span><span class=nx>b</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>b</span><span class=p>,</span> <span class=nx>err</span> <span class=p>=</span> <span class=nx>json</span><span class=p>.</span><span class=nf>Marshal</span><span class=p>(</span><span class=nx>isBody</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%#v, %T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nb>string</span><span class=p>(</span><span class=nx>b</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>b</span><span class=p>,</span> <span class=nx>err</span> <span class=p>=</span> <span class=nx>json</span><span class=p>.</span><span class=nf>Marshal</span><span class=p>(</span><span class=nx>users</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%#v, %T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nb>string</span><span class=p>(</span><span class=nx>b</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>b</span><span class=p>,</span> <span class=nx>err</span> <span class=p>=</span> <span class=nx>json</span><span class=p>.</span><span class=nf>Marshal</span><span class=p>(</span><span class=nx>scores</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%#v, %T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nb>string</span><span class=p>(</span><span class=nx>b</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Unmarshal 反序列化
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>jsonB</span> <span class=o>:=</span> <span class=s>`
</span></span></span><span class=line><span class=cl><span class=s>    {
</span></span></span><span class=line><span class=cl><span class=s>        &#34;name&#34;: &#34;minho&#34;,
</span></span></span><span class=line><span class=cl><span class=s>        &#34;age&#34;: 30,
</span></span></span><span class=line><span class=cl><span class=s>        &#34;isBody&#34;: true,
</span></span></span><span class=line><span class=cl><span class=s>        &#34;scores&#34;: [1, 2, 3, 4]
</span></span></span><span class=line><span class=cl><span class=s>    }
</span></span></span><span class=line><span class=cl><span class=s>    `</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>rs</span> <span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kd>interface</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>err</span> <span class=p>=</span> <span class=nx>json</span><span class=p>.</span><span class=nf>Unmarshal</span><span class=p>([]</span><span class=nb>byte</span><span class=p>(</span><span class=nx>jsonB</span><span class=p>),</span> <span class=o>&amp;</span><span class=nx>rs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%#v, %#v\n&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>,</span> <span class=nx>rs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>value</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>rs</span><span class=p>[</span><span class=s>&#34;name&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T&#34;</span><span class=p>,</span> <span class=nx>value</span><span class=p>)</span> <span class=c1>// value是一个空接口
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>v</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=nx>value</span><span class=p>.(</span><span class=kt>string</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %T, %#v, %#v\n&#34;</span><span class=p>,</span> <span class=nx>v</span><span class=p>,</span> <span class=nx>ok</span><span class=p>,</span> <span class=nx>v</span><span class=p>,</span> <span class=nx>ok</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=自定义数据类型json转换>自定义数据类型/json转换</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;encoding/json&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 需要设置属性与Json字符串中key的对应关系
</span></span></span><span class=line><span class=cl><span class=c1>// Id =&gt; json.pk =&gt; 通过结构体(属性)标签设置
</span></span></span><span class=line><span class=cl><span class=c1>// key1:&#34;value1&#34; key2:&#34;value2&#34;
</span></span></span><span class=line><span class=cl><span class=c1>// json:&#34;name&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// 网络传输时 不需要将某个key进行序列化 `json:&#34;-&#34;` 结构体标签设置为- 序列化/反序列化不会携带该属性
</span></span></span><span class=line><span class=cl><span class=c1>// json:&#34;-&#34; 序列化和反序列化时忽略属性
</span></span></span><span class=line><span class=cl><span class=c1>// json:&#34;name,type(string),omitempty&#34;
</span></span></span><span class=line><span class=cl><span class=c1>// omitempty 属性对应的值为零值在json字符串中不包含(忽略0值)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>User</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Id</span>       <span class=kt>int</span>               <span class=s>`json:&#34;pk,string&#34;`</span>
</span></span><span class=line><span class=cl>    <span class=nx>Name</span>     <span class=kt>string</span>            <span class=s>`json:&#34;name&#34;`</span>
</span></span><span class=line><span class=cl>    <span class=nx>Password</span> <span class=kt>string</span>            <span class=s>`json:&#34;-&#34;`</span>
</span></span><span class=line><span class=cl>    <span class=nx>IsBoy</span>    <span class=kt>bool</span>              <span class=s>`json:&#34;isBoy&#34;`</span>
</span></span><span class=line><span class=cl>    <span class=nx>Scores</span>   <span class=p>[]</span><span class=kt>float64</span>         <span class=s>`json:&#34;scores&#34;`</span>
</span></span><span class=line><span class=cl>    <span class=nx>Phone</span>    <span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>string</span> <span class=s>`json:&#34;phone&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>user</span> <span class=o>:=</span> <span class=nx>User</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=s>&#34;minho&#34;</span><span class=p>,</span> <span class=s>&#34;123#@&#34;</span><span class=p>,</span> <span class=kc>true</span><span class=p>,</span> <span class=p>[]</span><span class=kt>float64</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>},</span> <span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;tel&#34;</span><span class=p>:</span> <span class=s>&#34;13308047517&#34;</span><span class=p>}}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>b</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>json</span><span class=p>.</span><span class=nf>Marshal</span><span class=p>(</span><span class=nx>user</span><span class=p>)</span>             <span class=c1>// 自定义属性是小写 json包无法访问属性
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%#v, %#v\n&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>,</span> <span class=nb>string</span><span class=p>(</span><span class=nx>b</span><span class=p>))</span> <span class=c1>// 转换字典Object key是属性名称 value是值
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>jsonB</span> <span class=o>:=</span> <span class=s>`
</span></span></span><span class=line><span class=cl><span class=s>    {
</span></span></span><span class=line><span class=cl><span class=s>        &#34;pk&#34;: &#34;10&#34;,
</span></span></span><span class=line><span class=cl><span class=s>        &#34;name&#34;: &#34;minho&#34;,
</span></span></span><span class=line><span class=cl><span class=s>        &#34;Password&#34;: &#34;123@abc&#34;,
</span></span></span><span class=line><span class=cl><span class=s>        &#34;isBoy&#34;: false,
</span></span></span><span class=line><span class=cl><span class=s>        &#34;phone&#34;: {&#34;mobile&#34;: &#34;12314341&#34;}
</span></span></span><span class=line><span class=cl><span class=s>    }
</span></span></span><span class=line><span class=cl><span class=s>    `</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>u</span> <span class=nx>User</span>
</span></span><span class=line><span class=cl>    <span class=nx>err</span> <span class=p>=</span> <span class=nx>json</span><span class=p>.</span><span class=nf>Unmarshal</span><span class=p>([]</span><span class=nb>byte</span><span class=p>(</span><span class=nx>jsonB</span><span class=p>),</span> <span class=o>&amp;</span><span class=nx>u</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%#v, %#v\n&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>,</span> <span class=nx>u</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>users</span> <span class=o>:=</span> <span class=p>[]</span><span class=nx>User</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=s>&#34;minho&#34;</span><span class=p>,</span> <span class=s>&#34;123#@&#34;</span><span class=p>,</span> <span class=kc>true</span><span class=p>,</span> <span class=p>[]</span><span class=kt>float64</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>},</span> <span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;tel&#34;</span><span class=p>:</span> <span class=s>&#34;13308047517&#34;</span><span class=p>}},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=mi>2</span><span class=p>,</span> <span class=s>&#34;minho2&#34;</span><span class=p>,</span> <span class=s>&#34;123#@&#34;</span><span class=p>,</span> <span class=kc>true</span><span class=p>,</span> <span class=p>[]</span><span class=kt>float64</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>},</span> <span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;tel&#34;</span><span class=p>:</span> <span class=s>&#34;13308047517&#34;</span><span class=p>}},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=mi>3</span><span class=p>,</span> <span class=s>&#34;minho3&#34;</span><span class=p>,</span> <span class=s>&#34;123#@&#34;</span><span class=p>,</span> <span class=kc>true</span><span class=p>,</span> <span class=p>[]</span><span class=kt>float64</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>},</span> <span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;tel&#34;</span><span class=p>:</span> <span class=s>&#34;13308047517&#34;</span><span class=p>}},</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 调试可以打印格式输出 网络传输不用 浪费字节
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>b</span><span class=p>,</span> <span class=nx>err</span> <span class=p>=</span> <span class=nx>json</span><span class=p>.</span><span class=nf>MarshalIndent</span><span class=p>(</span><span class=nx>users</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>,</span> <span class=s>&#34;\t&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%#v, %s\n&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>,</span> <span class=nb>string</span><span class=p>(</span><span class=nx>b</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>jsonB</span> <span class=p>=</span> <span class=s>`
</span></span></span><span class=line><span class=cl><span class=s>    [
</span></span></span><span class=line><span class=cl><span class=s>        {
</span></span></span><span class=line><span class=cl><span class=s>                &#34;pk&#34;: &#34;11&#34;,
</span></span></span><span class=line><span class=cl><span class=s>                &#34;name&#34;: &#34;minho&#34;,
</span></span></span><span class=line><span class=cl><span class=s>                &#34;isBoy&#34;: true,
</span></span></span><span class=line><span class=cl><span class=s>                &#34;scores&#34;: [
</span></span></span><span class=line><span class=cl><span class=s>                        1,
</span></span></span><span class=line><span class=cl><span class=s>                        3,
</span></span></span><span class=line><span class=cl><span class=s>                        4
</span></span></span><span class=line><span class=cl><span class=s>                ],
</span></span></span><span class=line><span class=cl><span class=s>                &#34;phone&#34;: {
</span></span></span><span class=line><span class=cl><span class=s>                        &#34;tel&#34;: &#34;13308047517&#34;
</span></span></span><span class=line><span class=cl><span class=s>                }
</span></span></span><span class=line><span class=cl><span class=s>        },
</span></span></span><span class=line><span class=cl><span class=s>        {
</span></span></span><span class=line><span class=cl><span class=s>                &#34;pk&#34;: &#34;22&#34;,
</span></span></span><span class=line><span class=cl><span class=s>                &#34;name&#34;: &#34;minho2&#34;,
</span></span></span><span class=line><span class=cl><span class=s>                &#34;isBoy&#34;: true,
</span></span></span><span class=line><span class=cl><span class=s>                &#34;scores&#34;: [
</span></span></span><span class=line><span class=cl><span class=s>                        1,
</span></span></span><span class=line><span class=cl><span class=s>                        3,
</span></span></span><span class=line><span class=cl><span class=s>                        4
</span></span></span><span class=line><span class=cl><span class=s>                ],
</span></span></span><span class=line><span class=cl><span class=s>                &#34;phone&#34;: {
</span></span></span><span class=line><span class=cl><span class=s>                        &#34;tel&#34;: &#34;13308047517&#34;
</span></span></span><span class=line><span class=cl><span class=s>                }
</span></span></span><span class=line><span class=cl><span class=s>        },
</span></span></span><span class=line><span class=cl><span class=s>        {
</span></span></span><span class=line><span class=cl><span class=s>                &#34;pk&#34;: &#34;33&#34;,
</span></span></span><span class=line><span class=cl><span class=s>                &#34;name&#34;: &#34;minho3&#34;,
</span></span></span><span class=line><span class=cl><span class=s>                &#34;isBoy&#34;: true,
</span></span></span><span class=line><span class=cl><span class=s>                &#34;scores&#34;: [
</span></span></span><span class=line><span class=cl><span class=s>                        1,
</span></span></span><span class=line><span class=cl><span class=s>                        3,
</span></span></span><span class=line><span class=cl><span class=s>                        4
</span></span></span><span class=line><span class=cl><span class=s>                ],
</span></span></span><span class=line><span class=cl><span class=s>                &#34;phone&#34;: {
</span></span></span><span class=line><span class=cl><span class=s>                        &#34;tel&#34;: &#34;13308047517&#34;
</span></span></span><span class=line><span class=cl><span class=s>                }
</span></span></span><span class=line><span class=cl><span class=s>        }
</span></span></span><span class=line><span class=cl><span class=s>]
</span></span></span><span class=line><span class=cl><span class=s>`</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>us</span> <span class=p>[]</span><span class=nx>User</span>
</span></span><span class=line><span class=cl>    <span class=nx>err</span> <span class=p>=</span> <span class=nx>json</span><span class=p>.</span><span class=nf>Unmarshal</span><span class=p>([]</span><span class=nb>byte</span><span class=p>(</span><span class=nx>jsonB</span><span class=p>),</span> <span class=o>&amp;</span><span class=nx>us</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>err</span><span class=p>,</span> <span class=nx>us</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=自定义嵌入结构体-转换>自定义嵌入结构体 转换</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;encoding/json&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Addr</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Street</span> <span class=kt>string</span> <span class=s>`json:&#34;street&#34;`</span>
</span></span><span class=line><span class=cl>    <span class=nx>No</span>     <span class=kt>string</span> <span class=s>`json:&#34;no&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>User</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Id</span>   <span class=kt>int</span>    <span class=s>`json:&#34;id&#34;`</span>
</span></span><span class=line><span class=cl>    <span class=nx>Name</span> <span class=kt>string</span> <span class=s>`json:&#34;name&#34;`</span>
</span></span><span class=line><span class=cl>    <span class=nx>Addr</span> <span class=nx>Addr</span>   <span class=s>`json:&#34;addr&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>u</span> <span class=o>:=</span> <span class=nx>User</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s>&#34;minho&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>Addr</span><span class=p>{</span><span class=s>&#34;成都&#34;</span><span class=p>,</span> <span class=s>&#34;640000&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>b</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>json</span><span class=p>.</span><span class=nf>MarshalIndent</span><span class=p>(</span><span class=nx>u</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>,</span> <span class=s>&#34;\t&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>string</span><span class=p>(</span><span class=nx>b</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 等于嵌入Object
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>jsonB</span> <span class=o>:=</span> <span class=s>`
</span></span></span><span class=line><span class=cl><span class=s>    {
</span></span></span><span class=line><span class=cl><span class=s>        &#34;id&#34;: 1,
</span></span></span><span class=line><span class=cl><span class=s>        &#34;name&#34;: &#34;minho&#34;,
</span></span></span><span class=line><span class=cl><span class=s>        &#34;addr&#34;: {
</span></span></span><span class=line><span class=cl><span class=s>                &#34;street&#34;: &#34;成都&#34;,
</span></span></span><span class=line><span class=cl><span class=s>                &#34;no&#34;: &#34;640000&#34;
</span></span></span><span class=line><span class=cl><span class=s>        }
</span></span></span><span class=line><span class=cl><span class=s>    }
</span></span></span><span class=line><span class=cl><span class=s>    `</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>rs</span> <span class=nx>User</span>
</span></span><span class=line><span class=cl>    <span class=nx>json</span><span class=p>.</span><span class=nf>Unmarshal</span><span class=p>([]</span><span class=nb>byte</span><span class=p>(</span><span class=nx>jsonB</span><span class=p>),</span> <span class=o>&amp;</span><span class=nx>rs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>rs</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=jsonvalid>json.Valid</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 验证一个字符串是否是正确的json格式
</span></span></span></code></pre></td></tr></table></div></div><h3 id=对流的操作>对流的操作</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 序列化到文件/从文件反序列化
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;encoding/json&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;os&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Addr</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Street</span> <span class=kt>string</span> <span class=s>`json:&#34;street&#34;`</span>
</span></span><span class=line><span class=cl>    <span class=nx>No</span>     <span class=kt>string</span> <span class=s>`json:&#34;no&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>User</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Id</span>   <span class=kt>int</span>    <span class=s>`json:&#34;id&#34;`</span>
</span></span><span class=line><span class=cl>    <span class=nx>Name</span> <span class=kt>string</span> <span class=s>`json:&#34;name&#34;`</span>
</span></span><span class=line><span class=cl>    <span class=nx>Addr</span> <span class=nx>Addr</span>   <span class=s>`json:&#34;addr&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>u</span> <span class=o>:=</span> <span class=nx>User</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=s>&#34;MInho&#34;</span><span class=p>,</span> <span class=nx>Addr</span><span class=p>{</span><span class=s>&#34;成都&#34;</span><span class=p>,</span> <span class=s>&#34;10001&#34;</span><span class=p>}}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>file</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>Create</span><span class=p>(</span><span class=s>&#34;user.json&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>defer</span> <span class=nx>file</span><span class=p>.</span><span class=nf>Close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>encoder</span> <span class=o>:=</span> <span class=nx>json</span><span class=p>.</span><span class=nf>NewEncoder</span><span class=p>(</span><span class=nx>file</span><span class=p>)</span> <span class=c1>// Strout输出到控制台
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>err</span> <span class=o>:=</span> <span class=nx>encoder</span><span class=p>.</span><span class=nf>Encode</span><span class=p>(</span><span class=nx>u</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>file</span><span class=p>,</span> <span class=nx>_</span> <span class=p>=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>Open</span><span class=p>(</span><span class=s>&#34;user.json&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>decoder</span> <span class=o>:=</span> <span class=nx>json</span><span class=p>.</span><span class=nf>NewDecoder</span><span class=p>(</span><span class=nx>file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>user</span> <span class=nx>User</span>
</span></span><span class=line><span class=cl>    <span class=nx>err</span> <span class=p>=</span> <span class=nx>decoder</span><span class=p>.</span><span class=nf>Decode</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>user</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>err</span><span class=p>,</span> <span class=nx>user</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=jsonrawmessage>json.RawMessage</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;encoding/json&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>User</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Id</span>   <span class=kt>int</span>
</span></span><span class=line><span class=cl>    <span class=nx>Name</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>Addr</span> <span class=nx>json</span><span class=p>.</span><span class=nx>RawMessage</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>txt</span> <span class=o>:=</span> <span class=s>`{
</span></span></span><span class=line><span class=cl><span class=s>        &#34;id&#34;: 100,
</span></span></span><span class=line><span class=cl><span class=s>        &#34;name&#34;: &#34;Minho&#34;, 
</span></span></span><span class=line><span class=cl><span class=s>        &#34;addr&#34;: {&#34;street&#34;: &#34;成都&#34;, &#34;no&#34;: &#34;10002&#34;}
</span></span></span><span class=line><span class=cl><span class=s>        }`</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>u</span> <span class=nx>User</span>
</span></span><span class=line><span class=cl>    <span class=nx>err</span> <span class=o>:=</span> <span class=nx>json</span><span class=p>.</span><span class=nf>Unmarshal</span><span class=p>([]</span><span class=nb>byte</span><span class=p>(</span><span class=nx>txt</span><span class=p>),</span> <span class=o>&amp;</span><span class=nx>u</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>err</span><span class=p>,</span> <span class=nx>u</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=marshaljsonunmarshaljson>MarshalJSON/UnmarshalJSON</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;encoding/json&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;time&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Date</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>d</span> <span class=nx>Date</span><span class=p>)</span> <span class=nf>MarshalJSON</span><span class=p>()</span> <span class=p>([]</span><span class=kt>byte</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>json</span><span class=p>.</span><span class=nf>Marshal</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nf>Time</span><span class=p>(</span><span class=nx>d</span><span class=p>).</span><span class=nf>Format</span><span class=p>(</span><span class=s>&#34;2006-01-02&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// UnmarshalJSON 一般要赋值 定义成指针类型接收者
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>d</span> <span class=o>*</span><span class=nx>Date</span><span class=p>)</span> <span class=nf>UnmarshalJSON</span><span class=p>(</span><span class=nx>b</span> <span class=p>[]</span><span class=kt>byte</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>s</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>json</span><span class=p>.</span><span class=nf>Unmarshal</span><span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=o>&amp;</span><span class=nx>s</span><span class=p>);</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>date</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Parse</span><span class=p>(</span><span class=s>&#34;2006-01-02&#34;</span><span class=p>,</span> <span class=nx>s</span><span class=p>);</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=o>*</span><span class=nx>d</span> <span class=p>=</span> <span class=nf>Date</span><span class=p>(</span><span class=nx>date</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>User</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Id</span>        <span class=kt>int</span>
</span></span><span class=line><span class=cl>    <span class=nx>Name</span>      <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>Birthday</span>  <span class=nx>time</span><span class=p>.</span><span class=nx>Time</span>
</span></span><span class=line><span class=cl>    <span class=nx>Birthday2</span> <span class=nx>Date</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>u</span> <span class=o>:=</span> <span class=nx>User</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>,</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>(),</span> <span class=nf>Date</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>())}</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 无法序列化Birthday2
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>b</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>json</span><span class=p>.</span><span class=nf>MarshalIndent</span><span class=p>(</span><span class=nx>u</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>,</span> <span class=s>&#34;\t&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>string</span><span class=p>(</span><span class=nx>b</span><span class=p>),</span> <span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>txt</span> <span class=o>:=</span> <span class=s>`
</span></span></span><span class=line><span class=cl><span class=s>    {
</span></span></span><span class=line><span class=cl><span class=s>        &#34;Id&#34;: 2,
</span></span></span><span class=line><span class=cl><span class=s>        &#34;Name&#34;: &#34;Minho&#34;,
</span></span></span><span class=line><span class=cl><span class=s>        &#34;Birthday&#34;: &#34;2021-08-20T17:34:58.3897013+08:00&#34;,
</span></span></span><span class=line><span class=cl><span class=s>        &#34;Birthday2&#34;: &#34;2021-08-31&#34;
</span></span></span><span class=line><span class=cl><span class=s>    }
</span></span></span><span class=line><span class=cl><span class=s>    `</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>us</span> <span class=nx>User</span>
</span></span><span class=line><span class=cl>    <span class=nx>err</span> <span class=p>=</span> <span class=nx>json</span><span class=p>.</span><span class=nf>Unmarshal</span><span class=p>([]</span><span class=nb>byte</span><span class=p>(</span><span class=nx>txt</span><span class=p>),</span> <span class=o>&amp;</span><span class=nx>us</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>err</span><span class=p>,</span> <span class=nx>us</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// MarshalText / UnmarshalText
</span></span></span><span class=line><span class=cl><span class=c1>// 与JSON区别是不需要再使用json.Marshal()函数转换
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Date2</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>d</span> <span class=nx>Date2</span><span class=p>)</span> <span class=nf>MarshalText</span><span class=p>()</span> <span class=p>([]</span><span class=kt>byte</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>[]</span><span class=nb>byte</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nf>Time</span><span class=p>(</span><span class=nx>d</span><span class=p>).</span><span class=nf>Format</span><span class=p>(</span><span class=s>&#34;2006-01-02&#34;</span><span class=p>)),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>d</span> <span class=o>*</span><span class=nx>Date2</span><span class=p>)</span> <span class=nf>UnmarshalText</span><span class=p>(</span><span class=nx>b</span> <span class=p>[]</span><span class=kt>byte</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>s</span> <span class=p>=</span> <span class=o>:=</span> <span class=nb>string</span><span class=p>(</span><span class=nx>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>date</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Parse</span><span class=p>(</span><span class=s>&#34;2006-01-02&#34;</span><span class=p>,</span> <span class=nx>s</span><span class=p>);</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=o>*</span><span class=nx>d</span> <span class=p>=</span> <span class=nf>Date2</span><span class=p>(</span><span class=nx>date</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=反射>反射</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 反射是指在运行时动态的访问和修改任意类型对象的结构和成员
</span></span></span><span class=line><span class=cl><span class=c1>// 在go语言中提供reflect包提供反射的功能
</span></span></span><span class=line><span class=cl><span class=c1>// 每一个变量都有两个属性：类型(Type) 和值(Value)
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=k>go</span> <span class=nx>doc</span> <span class=nx>reflect</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=通过反射实现简单的orm>通过反射实现简单的ORM</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 生成结构体对应的建表SQL语句
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;log&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;reflect&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;strings&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// sql:&#34;type(text);size(32);pk;null;default()&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>User</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Id</span>   <span class=kt>int</span>
</span></span><span class=line><span class=cl>    <span class=nx>Name</span> <span class=kt>string</span> <span class=s>`sql:&#34;type(text)&#34;`</span>
</span></span><span class=line><span class=cl>    <span class=nx>Addr</span> <span class=kt>string</span> <span class=s>`sql:&#34;type(varchar);size(1024);null;default(成都)&#34;`</span>
</span></span><span class=line><span class=cl>    <span class=nx>Desc</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>u</span> <span class=nx>User</span><span class=p>)</span> <span class=nf>TableName</span><span class=p>()</span> <span class=kt>string</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s>&#34;account&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Department</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Id</span>   <span class=kt>int</span>
</span></span><span class=line><span class=cl>    <span class=nx>Name</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>Addr</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>snake</span><span class=p>(</span><span class=nx>name</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>string</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>strings</span><span class=p>.</span><span class=nf>ToLower</span><span class=p>(</span><span class=nx>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>tableName</span><span class=p>(</span><span class=nx>value</span> <span class=nx>reflect</span><span class=p>.</span><span class=nx>Value</span><span class=p>)</span> <span class=kt>string</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>tableName</span> <span class=o>:=</span> <span class=nx>value</span><span class=p>.</span><span class=nf>Elem</span><span class=p>().</span><span class=nf>Type</span><span class=p>().</span><span class=nf>Name</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>methodValue</span> <span class=o>:=</span> <span class=nx>value</span><span class=p>.</span><span class=nf>MethodByName</span><span class=p>(</span><span class=s>&#34;TableName&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>!</span><span class=nx>methodValue</span><span class=p>.</span><span class=nx>IsValid</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>tableName</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>methodType</span> <span class=o>:=</span> <span class=nx>methodValue</span><span class=p>.</span><span class=nf>Type</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=mi>0</span> <span class=o>!=</span> <span class=nx>methodType</span><span class=p>.</span><span class=nf>NumIn</span><span class=p>()</span> <span class=o>||</span> <span class=mi>1</span> <span class=o>!=</span> <span class=nx>methodType</span><span class=p>.</span><span class=nf>Numout</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>tableName</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>outType</span> <span class=o>:=</span> <span class=nx>methodType</span><span class=p>.</span><span class=nf>out</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span> <span class=nx>outType</span><span class=p>.</span><span class=nf>Kind</span><span class=p>()</span> <span class=o>!=</span> <span class=nx>reflect</span><span class=p>.</span><span class=nx>String</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>tableName</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>params</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=nx>reflect</span><span class=p>.</span><span class=nx>Value</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>rts</span> <span class=o>:=</span> <span class=nx>methodValue</span><span class=p>.</span><span class=nf>Call</span><span class=p>(</span><span class=nx>params</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>res</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=nf>String</span><span class=p>()</span> <span class=o>!=</span> <span class=s>&#34;&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>rts</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=nb>string</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>tableName</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>typeMapper</span><span class=p>(</span><span class=nx>field</span> <span class=nx>reflect</span><span class=p>.</span><span class=nx>StructField</span><span class=p>)</span> <span class=kt>string</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>kind</span> <span class=o>:=</span> <span class=nx>field</span><span class=p>.</span><span class=nx>Type</span><span class=p>.</span><span class=nf>Kind</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>tag</span> <span class=o>:=</span> <span class=nx>field</span><span class=p>.</span><span class=nx>Tag</span><span class=p>.</span><span class=nf>Get</span><span class=p>(</span><span class=s>&#34;sql&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>typeValue</span> <span class=o>:=</span> <span class=s>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nx>sizeValue</span> <span class=o>:=</span> <span class=s>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nx>defaultValue</span> <span class=o>:=</span> <span class=s>&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>switch</span> <span class=nx>kind</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=nx>reflect</span><span class=p>.</span><span class=nx>Int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nx>typeValue</span> <span class=p>=</span> <span class=s>&#34;int&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=nx>reflect</span><span class=p>.</span><span class=nx>String</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nx>typeValue</span> <span class=p>=</span> <span class=s>&#34;varchar&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nx>sizeValue</span> <span class=p>=</span> <span class=s>&#34;32&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>default</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s>&#34;text&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>pkValue</span> <span class=o>:=</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>    <span class=nx>nullValue</span> <span class=o>:=</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>v</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>strings</span><span class=p>.</span><span class=nf>Split</span><span class=p>(</span><span class=nx>tag</span><span class=p>,</span> <span class=s>&#34;;&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nx>strings</span><span class=p>.</span><span class=nf>HasPrefix</span><span class=p>(</span><span class=nx>v</span><span class=p>,</span> <span class=s>&#34;type(&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>typeValue</span> <span class=p>=</span> <span class=nx>v</span><span class=p>[</span><span class=mi>5</span> <span class=p>:</span> <span class=nb>len</span><span class=p>(</span><span class=nx>v</span><span class=p>)</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=nx>strings</span><span class=p>.</span><span class=nf>HasPrefix</span><span class=p>(</span><span class=nx>v</span><span class=p>,</span> <span class=s>&#34;size(&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>sizeValue</span> <span class=p>=</span> <span class=nx>v</span><span class=p>[</span><span class=mi>5</span> <span class=p>:</span> <span class=nb>len</span><span class=p>(</span><span class=nx>v</span><span class=p>)</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=nx>strings</span><span class=p>.</span><span class=nf>HasPrefix</span><span class=p>(</span><span class=nx>v</span><span class=p>,</span> <span class=s>&#34;default(&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>defaultValue</span> <span class=p>=</span> <span class=nx>v</span><span class=p>[</span><span class=mi>8</span> <span class=p>:</span> <span class=nb>len</span><span class=p>(</span><span class=nx>v</span><span class=p>)</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=nx>v</span> <span class=o>==</span> <span class=s>&#34;pk&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>pkValue</span> <span class=p>=</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=nx>v</span> <span class=o>==</span> <span class=s>&#34;null&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>nullValue</span> <span class=p>=</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>builder</span> <span class=nx>strings</span><span class=p>.</span><span class=nx>Builder</span>
</span></span><span class=line><span class=cl>    <span class=nx>builder</span><span class=p>.</span><span class=nf>WriteString</span><span class=p>(</span><span class=nx>typeValue</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>typeValue</span> <span class=o>==</span> <span class=s>&#34;varchar&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>builder</span><span class=p>.</span><span class=nf>WriteString</span><span class=p>(</span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;(%s)&#34;</span><span class=p>,</span> <span class=nx>sizeValue</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=c1>// builder.WriteString(&#34; &#34;)
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// varchar(32) primary key not null default &#34;&#34;;
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>pkValue</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>builder</span><span class=p>.</span><span class=nf>WriteString</span><span class=p>(</span><span class=s>&#34; primary key&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>!</span><span class=nx>nullValue</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>builder</span><span class=p>.</span><span class=nf>WriteString</span><span class=p>(</span><span class=s>&#34; not null&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>defaultValue</span> <span class=o>!=</span> <span class=s>&#34;&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>builder</span><span class=p>.</span><span class=nf>WriteString</span><span class=p>(</span><span class=s>&#34; default &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nx>typeValue</span> <span class=o>==</span> <span class=s>&#34;varchar&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>builder</span><span class=p>.</span><span class=nf>WriteString</span><span class=p>(</span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>`&#34;%s&#34;`</span><span class=p>,</span> <span class=nx>defaultValue</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>builder</span><span class=p>.</span><span class=nf>WriteString</span><span class=p>(</span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>`%s`</span><span class=p>,</span> <span class=nx>defaultValue</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>builder</span><span class=p>.</span><span class=nf>String</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>sqlDump</span><span class=p>(</span><span class=nx>models</span> <span class=o>...</span><span class=kd>interface</span><span class=p>{})</span> <span class=kt>string</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>builder</span> <span class=nx>strings</span><span class=p>.</span><span class=nx>Builder</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>model</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>models</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>t</span> <span class=o>:=</span> <span class=nx>reflect</span><span class=p>.</span><span class=nf>TypeOf</span><span class=p>(</span><span class=nx>model</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>v</span> <span class=o>:=</span> <span class=nx>reflect</span><span class=p>.</span><span class=nf>ValueOf</span><span class=p>(</span><span class=nx>model</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nx>t</span><span class=p>.</span><span class=nf>Kind</span><span class=p>()</span> <span class=o>==</span> <span class=nx>reflect</span><span class=p>.</span><span class=nx>Ptr</span> <span class=o>&amp;&amp;</span> <span class=nx>t</span><span class=p>.</span><span class=nf>Elem</span><span class=p>().</span><span class=nf>Kind</span><span class=p>()</span> <span class=o>==</span> <span class=nx>reflect</span><span class=p>.</span><span class=nx>Struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>st</span> <span class=o>:=</span> <span class=nx>t</span><span class=p>.</span><span class=nf>Elem</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=nx>builder</span><span class=p>.</span><span class=nf>WriteString</span><span class=p>(</span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;CREATE TABLE `%s` (\n&#34;</span><span class=p>,</span> <span class=nf>snake</span><span class=p>(</span><span class=nf>tableName</span><span class=p>(</span><span class=nx>v</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=nx>filedNum</span> <span class=o>:=</span> <span class=nx>st</span><span class=p>.</span><span class=nf>NumField</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nx>filedNum</span> <span class=o>==</span> <span class=mi>0</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>log</span><span class=p>.</span><span class=nf>Panicf</span><span class=p>(</span><span class=s>&#34;%s field num is zero&#34;</span><span class=p>,</span> <span class=nx>st</span><span class=p>.</span><span class=nf>Name</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=nx>filedNum</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>field</span> <span class=o>:=</span> <span class=nx>st</span><span class=p>.</span><span class=nf>Field</span><span class=p>(</span><span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=c1>// fmt.Println(field.Name, field.Type.Kind())
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=nx>builder</span><span class=p>.</span><span class=nf>WriteString</span><span class=p>(</span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;\t `%s` %s&#34;</span><span class=p>,</span> <span class=nf>snake</span><span class=p>(</span><span class=nx>field</span><span class=p>.</span><span class=nx>Name</span><span class=p>),</span> <span class=nf>typeMapper</span><span class=p>(</span><span class=nx>field</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=nx>i</span> <span class=o>!=</span> <span class=nx>filedNum</span><span class=o>-</span><span class=mi>1</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>builder</span><span class=p>.</span><span class=nf>WriteString</span><span class=p>(</span><span class=s>&#34;,&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=nx>builder</span><span class=p>.</span><span class=nf>WriteString</span><span class=p>(</span><span class=s>&#34;\n&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=nx>builder</span><span class=p>.</span><span class=nf>WriteString</span><span class=p>(</span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;) ENGINE=INNODB DEFAULT CHARSET utf8mb4;\n\n&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nb>panic</span><span class=p>(</span><span class=s>&#34;error&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>builder</span><span class=p>.</span><span class=nf>String</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>sql</span> <span class=o>:=</span> <span class=nf>sqlDump</span><span class=p>(</span><span class=nb>new</span><span class=p>(</span><span class=nx>User</span><span class=p>),</span> <span class=nb>new</span><span class=p>(</span><span class=nx>Department</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>sql</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=go并发>Go并发</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// OS: 进程/线程
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=err>进程：资源</span><span class=p>(</span><span class=err>内存</span><span class=o>/</span><span class=err>文件</span><span class=nx>IO</span><span class=p>)</span> <span class=err>以进程为单位</span> <span class=err>进程是资源分配的最小单位</span>
</span></span><span class=line><span class=cl><span class=err>线程：执行的逻辑</span><span class=p>(</span><span class=err>主线程</span><span class=p>)</span> <span class=err>执行调用的是线程</span> <span class=err>线程是</span><span class=nx>CPU</span><span class=err>调度的最小单元</span>
</span></span><span class=line><span class=cl><span class=err>协程：应用程序层面</span> <span class=err>用户态的调度</span><span class=p>(</span><span class=err>消耗小</span> <span class=err>性能很高</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=o>-</span> <span class=err>其他语言</span> <span class=err>第三方库</span> <span class=nx>python2</span><span class=mf>.7</span> <span class=p>=&gt;</span> <span class=nx>gevent</span> <span class=nx>greentleet</span>
</span></span><span class=line><span class=cl>     <span class=o>-</span> <span class=nx>Go</span> <span class=err>在语言层面就提供</span> <span class=nx>goroutine</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// GMP模型
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>G</span> <span class=p>=&gt;</span> <span class=err>例程</span> <span class=nx>goroutine</span>
</span></span><span class=line><span class=cl>  <span class=nx>M</span> <span class=p>=&gt;</span> <span class=err>执行代码的线程</span><span class=p>(</span><span class=nx>CPU</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>P</span> <span class=p>=&gt;</span> <span class=nx>Processer</span> <span class=err>调度</span> <span class=err>上下文的切换</span> <span class=err>内存申请</span><span class=o>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>P</span><span class=err>是连接</span><span class=nx>G</span><span class=err>和</span><span class=nx>M</span><span class=err>的</span><span class=p>(</span><span class=nx>Go</span><span class=err>中的调度器</span><span class=p>)</span> <span class=c1>// runtime包
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// 例程
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>go</span> <span class=err>函数调用</span> <span class=c1>// 关键字 go
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>goroutine</span><span class=err>执行切换：</span>
</span></span><span class=line><span class=cl>  <span class=nx>IO</span><span class=err>等待</span><span class=p>(</span><span class=nx>IO</span><span class=err>阻塞</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=err>到达执行时间</span><span class=p>(</span><span class=err>最大执行时间</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=err>内核切换</span>
</span></span><span class=line><span class=cl>  <span class=err>主动让出</span><span class=p>(</span><span class=nx>sleep</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// main函数由GO调用器创建例程进行执行 =&gt; 主例程 
</span></span></span><span class=line><span class=cl><span class=c1>// 自己用go关键字加函数调用创建的例程 =&gt; 工作例程
</span></span></span><span class=line><span class=cl><span class=c1>// 当主例程执行完成 自动结束所有工作例程
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// 在某个例程里面 代码执行顺序依然按照逻辑关系按顺序执行
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// 并发
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>goruntine</span> <span class=p>=&gt;</span> <span class=err>多个例程时</span> <span class=err>如何通信</span>
</span></span><span class=line><span class=cl>  <span class=err>并发通信</span>
</span></span><span class=line><span class=cl>    <span class=err>内存：变量</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=主例程>主例程</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;time&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 打印A-Z
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>printChats</span><span class=p>(</span><span class=nx>prefix</span> <span class=kt>string</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>c</span> <span class=o>:=</span> <span class=sc>&#39;A&#39;</span><span class=p>;</span> <span class=nx>c</span> <span class=o>&lt;=</span> <span class=sc>&#39;Z&#39;</span><span class=p>;</span> <span class=nx>c</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%s: %c\n&#34;</span><span class=p>,</span> <span class=nx>prefix</span><span class=p>,</span> <span class=nx>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>time</span><span class=p>.</span><span class=nf>Sleep</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nx>Millisecond</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 至少有三个
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// c1 c2交叉执行 c1 c2同时在执行
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>go</span> <span class=nf>printChats</span><span class=p>(</span><span class=s>&#34;c1:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>go</span> <span class=nf>printChats</span><span class=p>(</span><span class=s>&#34;c2:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>time</span><span class=p>.</span><span class=nf>Sleep</span><span class=p>(</span><span class=mi>3</span> <span class=o>*</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Millisecond</span><span class=p>)</span> <span class=c1>// 不等待 没有结果打印 因为主例程直接退出
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 问题： 能否等待工作例程结束后 再让主例程退出(主例程要等待某几个/或等待所有的工作例程结束)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=计数信号量waitgroup>计数信号量/WaitGroup</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;sync&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;time&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 打印A-Z
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>printChats</span><span class=p>(</span><span class=nx>wg</span> <span class=o>*</span><span class=nx>sync</span><span class=p>.</span><span class=nx>WaitGroup</span><span class=p>,</span> <span class=nx>prefix</span> <span class=kt>string</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>defer</span> <span class=nx>wg</span><span class=p>.</span><span class=nf>Done</span><span class=p>()</span> <span class=c1>// stage B
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=nx>c</span> <span class=o>:=</span> <span class=sc>&#39;A&#39;</span><span class=p>;</span> <span class=nx>c</span> <span class=o>&lt;=</span> <span class=sc>&#39;Z&#39;</span><span class=p>;</span> <span class=nx>c</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%s: %c\n&#34;</span><span class=p>,</span> <span class=nx>prefix</span><span class=p>,</span> <span class=nx>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>time</span><span class=p>.</span><span class=nf>Sleep</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nx>Millisecond</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=c1>// stage C
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>wg</span><span class=p>.</span><span class=nf>Add</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>go</span> <span class=nf>childChars</span><span class=p>(</span><span class=nx>wg</span><span class=p>,</span> <span class=nx>prefix</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>childChars</span><span class=p>(</span><span class=nx>wg</span> <span class=o>*</span><span class=nx>sync</span><span class=p>.</span><span class=nx>WaitGroup</span><span class=p>,</span> <span class=nx>prefix</span> <span class=kt>string</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>defer</span> <span class=nx>wg</span><span class=p>.</span><span class=nf>Done</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>c</span> <span class=o>:=</span> <span class=sc>&#39;A&#39;</span><span class=p>;</span> <span class=nx>c</span> <span class=o>&lt;=</span> <span class=sc>&#39;Z&#39;</span><span class=p>;</span> <span class=nx>c</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;child.%s: %c\n&#34;</span><span class=p>,</span> <span class=nx>prefix</span><span class=p>,</span> <span class=nx>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>time</span><span class=p>.</span><span class=nf>Sleep</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nx>Millisecond</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>wg</span> <span class=nx>sync</span><span class=p>.</span><span class=nx>WaitGroup</span> <span class=c1>// 定义计数信号量
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>        stage A
</span></span></span><span class=line><span class=cl><span class=cm>        go func() {
</span></span></span><span class=line><span class=cl><span class=cm>            stage B
</span></span></span><span class=line><span class=cl><span class=cm>            ...
</span></span></span><span class=line><span class=cl><span class=cm>            有可能会报错
</span></span></span><span class=line><span class=cl><span class=cm>            ...
</span></span></span><span class=line><span class=cl><span class=cm>            stage C
</span></span></span><span class=line><span class=cl><span class=cm>        }
</span></span></span><span class=line><span class=cl><span class=cm>        stage D
</span></span></span><span class=line><span class=cl><span class=cm>    */</span>
</span></span><span class=line><span class=cl>    <span class=c1>// wg.Add(N) =&gt; 启动例程之前执行 stage A阶段；在计数信号量中+N
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// wg.Done() =&gt; 例程执行结束后调用(例程函数退出时) stage C； 如何保证wg.Done()一定执行 stage B + defer; 当函数执行结束对计数信号量减1
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// wg.Wait() =&gt; 启动所有例程后调用 等待计数为0之后执行(不是0的时候一直等待)
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>wg</span><span class=p>.</span><span class=nf>Add</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=c1>// stage A
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>go</span> <span class=nf>printChats</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>wg</span><span class=p>,</span> <span class=s>&#34;c1&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>wg</span><span class=p>.</span><span class=nf>Add</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>                <span class=c1>// stage A
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>go</span> <span class=nf>printChats</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>wg</span><span class=p>,</span> <span class=s>&#34;c2&#34;</span><span class=p>)</span> <span class=c1>// wg需要时指针 否则时两个wg 函数里面的wg Done减少计数的时候 不影响外面的wg
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Wait&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>wg</span><span class=p>.</span><span class=nf>Wait</span><span class=p>()</span> <span class=c1>// stage D
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Over&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// WaitGroup.Add数量 &lt;= 例程数量
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 某些例程不需要等待结束 即可结束主例程(程序)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=闭包陷阱>闭包陷阱</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;sync&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;time&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>wg</span> <span class=o>:=</span> <span class=nx>sync</span><span class=p>.</span><span class=nx>WaitGroup</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>wg</span><span class=p>.</span><span class=nf>Add</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=mi>2</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>go</span> <span class=kd>func</span><span class=p>(</span><span class=nx>i</span> <span class=kt>int</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>prefix</span> <span class=o>:=</span> <span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;c%d&#34;</span><span class=p>,</span> <span class=nx>i</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=nx>c</span> <span class=o>:=</span> <span class=sc>&#39;A&#39;</span><span class=p>;</span> <span class=nx>c</span> <span class=o>&lt;=</span> <span class=sc>&#39;A&#39;</span><span class=p>;</span> <span class=nx>c</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%s: %c\n&#34;</span><span class=p>,</span> <span class=nx>prefix</span><span class=p>,</span> <span class=nx>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nx>time</span><span class=p>.</span><span class=nf>Sleep</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nx>Millisecond</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=nx>wg</span><span class=p>.</span><span class=nf>Done</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>}(</span><span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Wait&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>wg</span><span class=p>.</span><span class=nf>Wait</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Over&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 使用的是同一个wg变量 不用再传递指针
</span></span></span><span class=line><span class=cl><span class=c1>// go func匿名函数里面使用的i变量 需要参数传递进来 如果直接使用外部i变量 结果不确定(联想延迟执行) for循环执行完i=2 执行例程 输出结果中 prefix值为3
</span></span></span></code></pre></td></tr></table></div></div><h3 id=并发通信加锁>并发通信/加锁</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 多个例程对同一个内存资源进行修改 未对资源进行同步限制 导致修改数据混乱
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;sync&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;time&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 从一个账户借钱/还钱
</span></span></span><span class=line><span class=cl><span class=c1>// 账户初始化500*10000
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// 解决方法：借钱和还钱过程中不要中断
</span></span></span><span class=line><span class=cl><span class=c1>// 加锁
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>money</span> <span class=kt>int</span> <span class=p>=</span> <span class=mi>500</span> <span class=o>*</span> <span class=mi>10000</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>locker</span> <span class=nx>sync</span><span class=p>.</span><span class=nx>Mutex</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 借钱
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>borrow</span><span class=p>(</span><span class=nx>m</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>int</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>locker</span><span class=p>.</span><span class=nf>Lock</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>defer</span> <span class=nx>locker</span><span class=p>.</span><span class=nf>Unlock</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>money</span> <span class=p>&lt;</span> <span class=nx>m</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 退出一定要释放锁
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// locker.Unlock()
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>return</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>money</span> <span class=o>-=</span> <span class=nx>m</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// locker.Unlock()
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=nx>m</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 还钱
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>payback</span><span class=p>(</span><span class=nx>m</span> <span class=kt>int</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>locker</span><span class=p>.</span><span class=nf>Lock</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>defer</span> <span class=nx>locker</span><span class=p>.</span><span class=nf>Unlock</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>money</span> <span class=o>+=</span> <span class=nx>m</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 2个人借钱 A/B
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>wg</span> <span class=o>:=</span> <span class=nx>sync</span><span class=p>.</span><span class=nx>WaitGroup</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>person</span> <span class=o>:=</span> <span class=sc>&#39;A&#39;</span><span class=p>;</span> <span class=nx>person</span> <span class=o>&lt;=</span> <span class=sc>&#39;Z&#39;</span><span class=p>;</span> <span class=nx>person</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>wg</span><span class=p>.</span><span class=nf>Add</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>go</span> <span class=kd>func</span><span class=p>(</span><span class=nx>person</span> <span class=kt>rune</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>defer</span> <span class=nx>wg</span><span class=p>.</span><span class=nf>Done</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=c1>// 每次2000
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>m</span> <span class=o>:=</span> <span class=nf>borrow</span><span class=p>(</span><span class=mi>2000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nx>time</span><span class=p>.</span><span class=nf>Sleep</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Microsecond</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=nf>payback</span><span class=p>(</span><span class=nx>m</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>}(</span><span class=nx>person</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>wg</span><span class=p>.</span><span class=nf>Wait</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;money:&#34;</span><span class=p>,</span> <span class=nx>money</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=并发通信管道>并发通信/管道</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;time&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 管道
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// CSP原理(顺序通信进程)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 队列 buffer区(线程/协程安全) -&gt; 入队列 -&gt; 出队列
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 类型 chan T T:Go不限制类型 但是常常放一些值类型
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 如果放一个切片(引用类型 修改会直接修改内存上面的值)到管道 其他例程从管道中读取切片后 对切片元素修改 会对放入端切片有影响
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 放置int类型元素的管道
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>var</span> <span class=nx>channel</span> <span class=kd>chan</span> <span class=kt>int</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%T, %#v\n&#34;</span><span class=p>,</span> <span class=nx>channel</span><span class=p>,</span> <span class=nx>channel</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 赋值 make函数
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 对应有对管道不通的读和写操作的例程
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// make(chan T) 不带缓冲区的管道
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// make(chan T, size) 带缓冲区的管道 长度size
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 5 size =&gt; 1 1 1 1 1 =&gt; 1 缓冲区满 需要等待(阻塞) 如果Go检查无goroutine可以读 发生死锁
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 读 读空channel 如果Go检查无goroutine可以写 产生死锁
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>channel</span> <span class=p>=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kt>int</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 如何写
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>go</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>time</span><span class=p>.</span><span class=nf>Sleep</span><span class=p>(</span><span class=mi>5</span> <span class=o>*</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>channel</span> <span class=o>&lt;-</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl>    <span class=p>}()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 如何读
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>e</span> <span class=o>:=</span> <span class=o>&lt;-</span><span class=nx>channel</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=channel实现waitgroup>channel实现WaitGroup</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// channel实现sync.WaitGroup 
</span></span></span><span class=line><span class=cl><span class=c1>// 需要提前知道你的程序需要起多少个例程
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>channel</span> <span class=kd>chan</span> <span class=kt>int</span> <span class=p>=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kt>int</span><span class=p>)</span> <span class=c1>// 初始化
</span></span></span><span class=line><span class=cl><span class=c1></span>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=mi>2</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>go</span> <span class=kd>func</span><span class=p>(</span><span class=nx>i</span> <span class=kt>int</span><span class=p>){</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=nx>c</span> <span class=o>:=</span> <span class=sc>&#39;A&#39;</span><span class=p>;</span> <span class=nx>c</span> <span class=o>&lt;=</span> <span class=sc>&#39;Z&#39;</span><span class=p>;</span> <span class=nx>c</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%d, %c\n&#34;</span><span class=p>,</span> <span class=nx>i</span><span class=p>,</span> <span class=nx>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> 
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1>// 执行完例程之后写入数据
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>channel</span> <span class=o>&lt;-</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=p>}(</span><span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;wait&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=mi>2</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;-</span><span class=nx>channel</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;over&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=带缓冲区channel>带缓冲区channel</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;time&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 带缓冲区channel
</span></span></span><span class=line><span class=cl><span class=c1>// channel跟队列类似 先进先出
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// var channel chan string = make(chan string, 3)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// var channel = make(chan string, 3)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>channel</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kt>string</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>channel</span><span class=p>))</span> <span class=c1>// 0
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>channel</span> <span class=o>&lt;-</span> <span class=s>&#34;a&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>channel</span><span class=p>))</span> <span class=c1>// 1
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>channel</span> <span class=o>&lt;-</span> <span class=s>&#34;b&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nx>channel</span> <span class=o>&lt;-</span> <span class=s>&#34;c&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>channel</span><span class=p>))</span> <span class=c1>// 3
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=o>&lt;-</span><span class=nx>channel</span><span class=p>)</span>    <span class=c1>// a
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>channel</span> <span class=o>&lt;-</span> <span class=s>&#34;d&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=o>&lt;-</span><span class=nx>channel</span><span class=p>)</span> <span class=c1>// b
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=o>&lt;-</span><span class=nx>channel</span><span class=p>)</span> <span class=c1>// c
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=o>&lt;-</span><span class=nx>channel</span><span class=p>)</span> <span class=c1>// d
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=k>go</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>time</span><span class=p>.</span><span class=nf>Sleep</span><span class=p>(</span><span class=mi>5</span> <span class=o>*</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>channel</span> <span class=o>&lt;-</span> <span class=s>&#34;x&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=o>&lt;-</span><span class=nx>channel</span><span class=p>)</span> <span class=c1>// 死锁 管道为空 没有程序继续些数据
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=关闭管道>关闭管道</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=err>管道关闭之后</span> <span class=err>无法再写入数据</span> <span class=err>报错：</span><span class=nx>panic</span><span class=p>:</span> <span class=nx>send</span> <span class=nx>on</span> <span class=nx>closed</span> <span class=nx>channel</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>管道关闭之后</span> <span class=err>可以读取数据</span> <span class=nx>v</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=o>&lt;-</span><span class=nx>channel</span>
</span></span><span class=line><span class=cl><span class=err>第二个值判断是否读取完数据</span> <span class=nx>false</span><span class=err>无法再读取且此时</span><span class=nx>v</span><span class=o>==</span><span class=mi>0</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 不带缓冲区管道
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;time&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>channel</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kt>int</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1>// bufferChannel := make(chan string, 3)
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=k>go</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>time</span><span class=p>.</span><span class=nf>Sleep</span><span class=p>(</span><span class=mi>3</span> <span class=o>*</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>v</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=o>&lt;-</span><span class=nx>channel</span> <span class=c1>// ok第二个参数 判断管道是否关闭
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>v</span><span class=p>,</span> <span class=nx>ok</span><span class=p>)</span> <span class=c1>// 1
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=nx>v</span><span class=p>,</span> <span class=nx>ok</span> <span class=p>=</span> <span class=o>&lt;-</span><span class=nx>channel</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>v</span><span class=p>,</span> <span class=nx>ok</span><span class=p>)</span> <span class=c1>// 0
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 关闭管道之后 还能读写吗
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 不能针对关闭的管道写数据 panic: send on closed channel
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 针对已经关闭的管道可以进行读取
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>channel</span> <span class=o>&lt;-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 关闭管道
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nb>close</span><span class=p>(</span><span class=nx>channel</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>time</span><span class=p>.</span><span class=nf>Sleep</span><span class=p>(</span><span class=mi>5</span> <span class=o>*</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 带缓冲区管道
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>bufferChannel</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kt>int</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>bufferChannel</span> <span class=o>&lt;-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=nb>close</span><span class=p>(</span><span class=nx>bufferChannel</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1>// bufferChannel &lt;- 2 // 关闭之后不能写 panic: send on closed channel
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>v</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=o>&lt;-</span><span class=nx>bufferChannel</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>v</span><span class=p>,</span> <span class=nx>ok</span><span class=p>)</span> <span class=c1>// 1 true
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>v</span><span class=p>,</span> <span class=nx>ok</span> <span class=p>=</span> <span class=o>&lt;-</span><span class=nx>bufferChannel</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>v</span><span class=p>,</span> <span class=nx>ok</span><span class=p>)</span> <span class=c1>// 0 false
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=管道循环>管道循环</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>channel</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kt>int</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>channel</span> <span class=o>&lt;-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=nx>channel</span> <span class=o>&lt;-</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>    <span class=nx>channel</span> <span class=o>&lt;-</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=nb>close</span><span class=p>(</span><span class=nx>channel</span><span class=p>)</span> <span class=c1>// 不关闭 range循环管道会报错 死锁
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>v</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>channel</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>v</span><span class=p>)</span> <span class=c1>// 自动判断是否还能取到值 false
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 手动自己判断第二个值
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// for {
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//     if v, ok := &lt;-channel; ok {
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//         fmt.Println(v)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//     } else {
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//         break
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//     }
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// }
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=并发下载图片示例>并发下载图片示例</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;sync&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;time&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>要获取网站图片 1.jpg, 2.jpg, ... , n,jpg
</span></span></span><span class=line><span class=cl><span class=cm>下载 m.jpg - n.jpg
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 模拟下载函数
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>download</span><span class=p>(</span><span class=nx>wg</span> <span class=o>*</span><span class=nx>sync</span><span class=p>.</span><span class=nx>WaitGroup</span><span class=p>,</span> <span class=nx>name</span><span class=p>,</span> <span class=nx>path</span> <span class=kt>string</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>defer</span> <span class=nx>wg</span><span class=p>.</span><span class=nf>Done</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>time</span><span class=p>.</span><span class=nf>Sleep</span><span class=p>(</span><span class=mi>10</span> <span class=o>*</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Millisecond</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;download %s to %s\n&#34;</span><span class=p>,</span> <span class=nx>name</span><span class=p>,</span> <span class=nx>path</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>start</span> <span class=o>:=</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>wg</span> <span class=o>:=</span> <span class=nx>sync</span><span class=p>.</span><span class=nx>WaitGroup</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=nx>m</span><span class=p>,</span> <span class=nx>n</span> <span class=o>:=</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>100</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=nx>m</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;=</span> <span class=nx>n</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>wg</span><span class=p>.</span><span class=nf>Add</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>go</span> <span class=nf>download</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>wg</span><span class=p>,</span> <span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;%d.jpg&#34;</span><span class=p>,</span> <span class=nx>i</span><span class=p>),</span> <span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;download/%d.jpg&#34;</span><span class=p>,</span> <span class=nx>i</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>wg</span><span class=p>.</span><span class=nf>Wait</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;spend time: %s\n&#34;</span><span class=p>,</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>().</span><span class=nf>Sub</span><span class=p>(</span><span class=nx>start</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 问题：需要下载数里很多怎么办？ 不能创建任意数量例程
</span></span></span><span class=line><span class=cl><span class=c1>// 固定N个例程区去请求 比如 每次10个(Pool)
</span></span></span><span class=line><span class=cl><span class=c1>// 利用管道：生产者消费者模型 生产下载任务 -&gt; 每次10worker消费
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;sync&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;time&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Fiel</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>name</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>path</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>download</span><span class=p>(</span><span class=nx>name</span><span class=p>,</span> <span class=nx>path</span> <span class=kt>string</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>time</span><span class=p>.</span><span class=nf>Sleep</span><span class=p>(</span><span class=mi>10</span> <span class=o>*</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Millisecond</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;download %s to %s\n&#34;</span><span class=p>,</span> <span class=nx>name</span><span class=p>,</span> <span class=nx>path</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>start</span> <span class=o>:=</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>N</span> <span class=o>:=</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl>    <span class=nx>m</span><span class=p>,</span> <span class=nx>n</span> <span class=o>:=</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>100</span>
</span></span><span class=line><span class=cl>    <span class=nx>channel</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=nx>Fiel</span><span class=p>,</span> <span class=nx>N</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>wg</span> <span class=o>:=</span> <span class=nx>sync</span><span class=p>.</span><span class=nx>WaitGroup</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 生产者
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 生成下载图片的例程
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>wg</span><span class=p>.</span><span class=nf>Add</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>go</span> <span class=kd>func</span><span class=p>(</span><span class=nx>channel</span> <span class=kd>chan</span><span class=o>&lt;-</span> <span class=nx>Fiel</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=nx>m</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;=</span> <span class=nx>n</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>channel</span> <span class=o>&lt;-</span> <span class=nx>Fiel</span><span class=p>{</span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;%d.jpg&#34;</span><span class=p>,</span> <span class=nx>i</span><span class=p>),</span> <span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;download/%d.jpg&#34;</span><span class=p>,</span> <span class=nx>i</span><span class=p>)}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=nb>close</span><span class=p>(</span><span class=nx>channel</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>wg</span><span class=p>.</span><span class=nf>Done</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 消费者
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;=</span> <span class=nx>N</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// N个下载图片例程
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>wg</span><span class=p>.</span><span class=nf>Add</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>go</span> <span class=kd>func</span><span class=p>(</span><span class=nx>channel</span> <span class=o>&lt;-</span><span class=kd>chan</span> <span class=nx>Fiel</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=nx>f</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>channel</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nf>download</span><span class=p>(</span><span class=nx>f</span><span class=p>.</span><span class=nx>name</span><span class=p>,</span> <span class=nx>f</span><span class=p>.</span><span class=nx>path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=nx>wg</span><span class=p>.</span><span class=nf>Done</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>}()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>wg</span><span class=p>.</span><span class=nf>Wait</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>().</span><span class=nf>Sub</span><span class=p>(</span><span class=nx>start</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=管道类型读写管道>管道类型/读写管道</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 在某个函数中只需要读 或者只需要写的时候
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 为防止在只读函数中误写 在只写函数中误读
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 可以将管道声明为 只读 或 只写管道
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 更多用在函数 形参定义
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 赋值
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>channel</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kt>int</span><span class=p>,</span> <span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>readChannel</span> <span class=o>&lt;-</span><span class=kd>chan</span> <span class=kt>int</span>  <span class=c1>// 只读管道
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>var</span> <span class=nx>writeChannel</span> <span class=kd>chan</span><span class=o>&lt;-</span> <span class=kt>int</span> <span class=c1>// 只写管道
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>readChannel</span> <span class=p>=</span> <span class=nx>channel</span>
</span></span><span class=line><span class=cl>    <span class=nx>writeChannel</span> <span class=p>=</span> <span class=nx>channel</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>writeChannel</span> <span class=o>&lt;-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=nx>writeChannel</span> <span class=o>&lt;-</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=o>&lt;-</span><span class=nx>readChannel</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=o>&lt;-</span><span class=nx>readChannel</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// var ch chan&lt;- int = make(chan int, 10)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 一般不这样声明 没有意义
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=selectcase>selectcase</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;time&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 多个管道进行读 某一个管道读取成功就执行对应逻辑
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 多个管道进行写 某一个管道写成功就执行对应逻辑
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 多个管道 某些进行读 某些进行写 某个管道 读/写成功 执行对应逻辑
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// select case
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>        select {
</span></span></span><span class=line><span class=cl><span class=cm>        case value, ok := &lt;-channel:
</span></span></span><span class=line><span class=cl><span class=cm>        case channel &lt;- value:
</span></span></span><span class=line><span class=cl><span class=cm>        default:
</span></span></span><span class=line><span class=cl><span class=cm>        }
</span></span></span><span class=line><span class=cl><span class=cm>    */</span>
</span></span><span class=line><span class=cl>    <span class=nx>channelV1</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kt>int</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>channelV2</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kt>int</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>go</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>time</span><span class=p>.</span><span class=nf>Sleep</span><span class=p>(</span><span class=mi>3</span> <span class=o>*</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>channelV1</span> <span class=o>&lt;-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=p>}()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;wait&#34;</span><span class=p>,</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=k>select</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=nx>v</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=o>&lt;-</span><span class=nx>channelV1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;channelV1:&#34;</span><span class=p>,</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>(),</span> <span class=nx>v</span><span class=p>,</span> <span class=nx>ok</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=nx>v</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=o>&lt;-</span><span class=nx>channelV2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;channelV2:&#34;</span><span class=p>,</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>(),</span> <span class=nx>v</span><span class=p>,</span> <span class=nx>ok</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>default</span><span class=p>:</span> <span class=c1>// 不会等待(case条件都没有读取数据 直接执行逻辑) 直接default 一般不会加
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;default&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;over&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=示例>示例</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 生成随机5个0 5个1组成的数
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>zero</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kt>int</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>one</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kt>int</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>go</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=mi>5</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>zero</span> <span class=o>&lt;-</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>go</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=mi>5</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>one</span> <span class=o>&lt;-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=mi>10</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>select</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=o>&lt;-</span><span class=nx>one</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nx>fmt</span><span class=p>.</span><span class=nf>Print</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=o>&lt;-</span><span class=nx>zero</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nx>fmt</span><span class=p>.</span><span class=nf>Print</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=context上下文>context上下文</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;context&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;time&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// go doc context
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 事件广播
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// ctx, cannel := context.WithCancel(ctx)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// cannel() =&gt; 广播消息
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>channel</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kt>int</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>go</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>channel</span> <span class=o>&lt;-</span> <span class=nx>i</span>
</span></span><span class=line><span class=cl>            <span class=nx>time</span><span class=p>.</span><span class=nf>Sleep</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nx>i</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 让例程执行10s之后就退出
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 根事件 只能通过 context.Backgroud创建
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// ctx, cannel := context.WithCancel(context.Background())
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// go func() {
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//     time.Sleep(10 * time.Second)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//     fmt.Println(&#34;cannel&#34;)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//     cannel() // 调用cannel就相当于向管道写入一个数据
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// }()
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>ctx</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>context</span><span class=p>.</span><span class=nf>WithTimeout</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>Background</span><span class=p>(),</span> <span class=mi>10</span><span class=o>*</span><span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=p>)</span> <span class=c1>// 10s后中断
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=nx>END</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>select</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=o>&lt;-</span><span class=nx>ctx</span><span class=p>.</span><span class=nf>Done</span><span class=p>():</span> <span class=c1>// 从管道读取到数 说明结束
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;interrupt&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span> <span class=nx>END</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=nx>v</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=o>&lt;-</span><span class=nx>channel</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>!</span><span class=nx>ok</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span> <span class=nx>END</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>v</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=简单的socketserver>简单的SocketServer</h3><h4 id=servergo>server.go</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;log&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;net&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;time&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 监听IP和端口
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>addr</span> <span class=o>:=</span> <span class=s>&#34;:9999&#34;</span> <span class=c1>// &#34;0.0.0.0:9999&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>listener</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>net</span><span class=p>.</span><span class=nf>Listen</span><span class=p>(</span><span class=s>&#34;tcp&#34;</span><span class=p>,</span> <span class=nx>addr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>log</span><span class=p>.</span><span class=nf>Fatal</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 获取客户端连接
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>conn</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>listener</span><span class=p>.</span><span class=nf>Accept</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=nx>time</span><span class=p>.</span><span class=nf>Sleep</span><span class=p>(</span><span class=mi>10</span> <span class=o>*</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>log</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;client：&#34;</span><span class=p>,</span> <span class=nx>conn</span><span class=p>.</span><span class=nf>RemoteAddr</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 交互处理
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Fprintf</span><span class=p>(</span><span class=nx>conn</span><span class=p>,</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>().</span><span class=nf>Format</span><span class=p>(</span><span class=s>&#34;2006-01-02 15:04:05&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 关闭连接
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>conn</span><span class=p>.</span><span class=nf>Close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 关闭服务器
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>listener</span><span class=p>.</span><span class=nf>Close</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 2021/08/27 11:41:26 client： 127.0.0.1:58934
</span></span></span><span class=line><span class=cl><span class=c1>// 2021/08/27 11:41:36 client： 127.0.0.1:58935
</span></span></span><span class=line><span class=cl><span class=c1>// 处理两个客户端连接 顺序执行没有并发 相差10s
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// 启动协程 处理客户端连接 此时服务端并发处理客户端请求
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>go</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>time</span><span class=p>.</span><span class=nf>Sleep</span><span class=p>(</span><span class=mi>10</span> <span class=o>*</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>log</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;client：&#34;</span><span class=p>,</span> <span class=nx>conn</span><span class=p>.</span><span class=nf>RemoteAddr</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 交互处理
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Fprintf</span><span class=p>(</span><span class=nx>conn</span><span class=p>,</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>().</span><span class=nf>Format</span><span class=p>(</span><span class=s>&#34;2006-01-02 15:04:05&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 关闭连接
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>conn</span><span class=p>.</span><span class=nf>Close</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}()</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=clientgo>client.go</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;log&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;net&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;time&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 连接服务器
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>addr</span> <span class=o>:=</span> <span class=s>&#34;127.0.0.1:9999&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nx>conn</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>net</span><span class=p>.</span><span class=nf>Dial</span><span class=p>(</span><span class=s>&#34;tcp&#34;</span><span class=p>,</span> <span class=nx>addr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>log</span><span class=p>.</span><span class=nf>Fatal</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>start</span> <span class=o>:=</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 交互
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>bytes</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span> <span class=mi>1024</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>n</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>conn</span><span class=p>.</span><span class=nf>Read</span><span class=p>(</span><span class=nx>bytes</span><span class=p>)</span> <span class=c1>// n 从byte里面读的数量
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>string</span><span class=p>(</span><span class=nx>bytes</span><span class=p>[:</span><span class=nx>n</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>().</span><span class=nf>Sub</span><span class=p>(</span><span class=nx>start</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 关闭连接
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>conn</span><span class=p>.</span><span class=nf>Close</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=go使用私有仓库>Go使用私有仓库</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>1. 配置GOPRIVATE变量
</span></span><span class=line><span class=cl>比如: go env -w <span class=nv>GOPRIVATE</span><span class=o>=</span>gitee.com
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. 配置SSH密钥<span class=o>(</span>步骤省略<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. 使用ssh替换https拉取依赖
</span></span><span class=line><span class=cl><span class=c1># 使用环境变量$GOPRIVATE 需要提前export</span>
</span></span><span class=line><span class=cl>git config --global url.<span class=s2>&#34;git@</span><span class=nv>$GOPRIVATE</span><span class=s2>:&#34;</span>.insteadOf <span class=s2>&#34;https://</span><span class=nv>$GOPRIVATE</span><span class=s2>&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=reference-link>Reference Link</h2><ul><li><p>Blogs</p><ul><li><a class=link href=https://sagikazarmark.hu/blog/decoding-custom-formats-with-viper/ target=_blank rel=noopener>使用Viper解码自定义格式</a></li><li><a class=link href=https://gosamples.dev/string-padding/ target=_blank rel=noopener>String padding in Go</a></li><li><a class=link href=https://hashnode.com/post/set-indentation-on-new-golang-yaml-v3-library-ckbrwl63001skn8s1lj3jmtln target=_blank rel=noopener>Set indentaton on yaml.v3</a></li><li><a class=link href=https://ueokande.github.io/go-slice-tricks/ target=_blank rel=noopener>Go slice tricks cheat sheet</a></li></ul></li><li><p>Github Issues</p><ul><li><a class=link href=https://github.com/go-yaml/yaml/issues/13 target=_blank rel=noopener>YAML库关于等同json.RawMessage的Issue</a></li></ul></li></ul></section><footer class=article-footer><section class=article-tags><a href=/tags/cloud-native/>Cloud Native</a>
<a href=/tags/golang/>Golang</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>相关文章</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/go-generics/><div class=article-details><h2 class=article-title>GO Generics</h2></div></a></article><article><a href=/p/go-design-patterns/><div class=article-details><h2 class=article-title>GO DESIGN PATTERNS</h2></div></a></article><article><a href=/p/go-functional-options/><div class=article-details><h2 class=article-title>GO FUNCTIONAL OPTIONS</h2></div></a></article></div></div></aside><script src=https://utteranc.es/client.js repo=ilolicon/ilolicon.github.io issue-term=pathname crossorigin=anonymous async></script><style>.utterances{max-width:unset}</style><script>let utterancesLoaded=!1;function setUtterancesTheme(e){let t=document.querySelector(".utterances iframe");t&&t.contentWindow.postMessage({type:"set-theme",theme:`github-${e}`},"https://utteranc.es")}addEventListener("message",e=>{if(e.origin!=="https://utteranc.es")return;utterancesLoaded=!0,setUtterancesTheme(document.documentElement.dataset.scheme)}),window.addEventListener("onColorSchemeChange",e=>{if(!utterancesLoaded)return;setUtterancesTheme(e.detail)})</script><footer class=site-footer><section class=copyright>&copy;
2017 -
2025 ilolicon's Blog</section><section class=powerby>Vicissitude🐳<br>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.21.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>