<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Django was invented to meet fast-moving newsroom deadlines, while satisfying the tough requirements of experienced web developers."><title>Django</title><link rel=canonical href=https://ilolicon.github.io/p/django/><link rel=stylesheet href=/scss/style.min.abbd69b2908fdfcd5179898beaafd374514a86538d81639ddd2c58c06ae54e40.css><meta property="og:title" content="Django"><meta property="og:description" content="Django was invented to meet fast-moving newsroom deadlines, while satisfying the tough requirements of experienced web developers."><meta property="og:url" content="https://ilolicon.github.io/p/django/"><meta property="og:site_name" content="ilolicon's Blog"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="Python"><meta property="article:tag" content="Django"><meta property="article:tag" content="Web"><meta property="article:tag" content="ORM"><meta property="article:published_time" content="2020-02-10T22:13:06+08:00"><meta property="article:modified_time" content="2020-02-10T22:13:06+08:00"><meta name=twitter:title content="Django"><meta name=twitter:description content="Django was invented to meet fast-moving newsroom deadlines, while satisfying the tough requirements of experienced web developers."><link rel="shortcut icon" href=/img/favicon.ico></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu96a5ab8e0364e843af4687201b687892_162934_300x0_resize_box_3.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>ğŸ¥</span></figure><div class=site-meta><h1 class=site-name><a href=/>ilolicon's Blog</a></h1><h2 class=site-description>Keep Calm and Carry On.</h2></div></header><ol class=social-menu><li><a href=https://github.com/ilolicon target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://twitter.com target=_blank title=Twitter rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><li><a href=/links/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg><span>Links</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>æš—è‰²æ¨¡å¼</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®å½•</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#djangoè¯·æ±‚ç”Ÿå‘½å‘¨æœŸ>Djangoè¯·æ±‚ç”Ÿå‘½å‘¨æœŸ</a><ol><li><a href=#æµç¨‹>æµç¨‹</a></li><li><a href=#æ‰©å±•>æ‰©å±•</a></li></ol></li><li><a href=#æ³¨æ„äº‹é¡¹>æ³¨æ„äº‹é¡¹</a></li><li><a href=#å®‰è£…>å®‰è£…</a></li><li><a href=#djangoåŸºæœ¬æ“ä½œ>DjangoåŸºæœ¬æ“ä½œ</a></li><li><a href=#åº”ç”¨>åº”ç”¨</a></li><li><a href=#ä¸»è¦æ–‡ä»¶ä»‹ç»>ä¸»è¦æ–‡ä»¶ä»‹ç»</a></li><li><a href=#é…ç½®æ–‡ä»¶>é…ç½®æ–‡ä»¶</a></li><li><a href=#djangoå°ç™½å¿…ä¼šä¸‰æ¿æ–§>Djangoå°ç™½å¿…ä¼šä¸‰æ¿æ–§</a><ol><li><a href=#httpresponse>HttpResponse</a></li><li><a href=#render>render</a></li><li><a href=#redirect>redirect</a></li></ol></li><li><a href=#ç™»å½•åŠŸèƒ½å®ç°>ç™»å½•åŠŸèƒ½å®ç°</a><ol><li><a href=#é™æ€æ–‡ä»¶é…ç½®>é™æ€æ–‡ä»¶é…ç½®</a></li><li><a href=#requestå¯¹è±¡æ–¹æ³•åˆè¯†>requestå¯¹è±¡æ–¹æ³•åˆè¯†</a></li></ol></li><li><a href=#orm>ORM</a><ol><li><a href=#djangoæœ¬è´¨>Djangoæœ¬è´¨</a></li><li><a href=#ormå¿«é€Ÿæµ‹è¯•>ORMå¿«é€Ÿæµ‹è¯•</a><ol><li><a href=#æµ‹è¯•è„šæœ¬>æµ‹è¯•è„šæœ¬</a></li><li><a href=#é…ç½®settingspy>é…ç½®<code>settings.py</code></a></li><li><a href=#ä¾èµ–>ä¾èµ–</a></li></ol></li><li><a href=#ormåˆè¯†>ORMåˆè¯†</a><ol><li><a href=#ç®€ä»‹>ç®€ä»‹</a></li><li><a href=#åˆ›å»ºmodelç±»>åˆ›å»ºmodelç±»</a></li><li><a href=#æ•°æ®åº“è¿ç§»>æ•°æ®åº“è¿ç§»</a></li><li><a href=#å­—æ®µç±»å‹>å­—æ®µç±»å‹</a></li></ol></li><li><a href=#å­—æ®µçš„å¢åˆ æ”¹æŸ¥>å­—æ®µçš„å¢åˆ æ”¹æŸ¥</a><ol><li><a href=#å­—æ®µçš„å¢åŠ >å­—æ®µçš„å¢åŠ </a></li><li><a href=#å­—æ®µçš„ä¿®æ”¹>å­—æ®µçš„ä¿®æ”¹</a></li><li><a href=#å­—æ®µçš„åˆ é™¤>å­—æ®µçš„åˆ é™¤</a></li></ol></li><li><a href=#æ•°æ®çš„å¢åˆ æ”¹æŸ¥>æ•°æ®çš„å¢åˆ æ”¹æŸ¥</a><ol><li><a href=#æŸ¥>æŸ¥</a></li><li><a href=#å¢>å¢</a></li><li><a href=#æ”¹>æ”¹</a></li><li><a href=#åˆ >åˆ </a></li></ol></li><li><a href=#ormåˆ›å»ºè¡¨å…³ç³»>ormåˆ›å»ºè¡¨å…³ç³»</a><ol><li><a href=#å¤šå¯¹å¤šçš„ä¸‰ç§åˆ›å»ºå…³ç³»>å¤šå¯¹å¤šçš„ä¸‰ç§åˆ›å»ºå…³ç³»</a></li></ol></li><li><a href=#modelå…ƒç¼–ç¨‹>Modelå…ƒç¼–ç¨‹</a><ol><li><a href=#æµ‹è¯•ç¯å¢ƒ>æµ‹è¯•ç¯å¢ƒ</a></li><li><a href=#modelæ•°æ®åº“æ¨¡å‹>Modelæ•°æ®åº“æ¨¡å‹</a></li><li><a href=#å…ƒç±»>å…ƒç±»</a></li></ol></li></ol></li><li><a href=#è·¯ç”±å±‚>è·¯ç”±å±‚</a><ol><li><a href=#è·¯ç”±åŒ¹é…>è·¯ç”±åŒ¹é…</a></li><li><a href=#urlåˆ†ç»„>URLåˆ†ç»„</a><ol><li><a href=#æ— ååˆ†ç»„>æ— ååˆ†ç»„</a></li><li><a href=#æœ‰ååˆ†ç»„>æœ‰ååˆ†ç»„</a></li><li><a href=#ä¸èƒ½æ··ç”¨>ä¸èƒ½æ··ç”¨</a></li><li><a href=#åå‘è§£æ>åå‘è§£æ</a></li></ol></li><li><a href=#è·¯ç”±åˆ†å‘>è·¯ç”±åˆ†å‘</a></li><li><a href=#åç§°ç©ºé—´>åç§°ç©ºé—´</a></li><li><a href=#ä¼ªé™æ€>ä¼ªé™æ€</a></li></ol></li><li><a href=#è§†å›¾å±‚>è§†å›¾å±‚</a><ol><li><a href=#ä¸‰æ¿æ–§>ä¸‰æ¿æ–§</a></li><li><a href=#renderç®€å•çš„å†…éƒ¨åŸç†>renderç®€å•çš„å†…éƒ¨åŸç†</a></li><li><a href=#jsonresponse>JsonResponse</a></li><li><a href=#djangoè‡ªå¸¦çš„åºåˆ—åŒ–ç»„ä»¶>Djangoè‡ªå¸¦çš„åºåˆ—åŒ–ç»„ä»¶</a></li><li><a href=#formè¡¨å•ä¸Šä¼ æ–‡ä»¶åŠåç«¯å¦‚ä½•æ“ä½œ>Formè¡¨å•ä¸Šä¼ æ–‡ä»¶åŠåç«¯å¦‚ä½•æ“ä½œ</a></li><li><a href=#requestå¯¹è±¡æ–¹æ³•>requestå¯¹è±¡æ–¹æ³•</a></li><li><a href=#fbvä¸cbv>FBVä¸CBV</a><ol><li><a href=#fbv>FBV</a></li><li><a href=#cbv>CBV</a></li></ol></li><li><a href=#cbvå¦‚ä½•æ·»åŠ è£…é¥°å™¨>CBVå¦‚ä½•æ·»åŠ è£…é¥°å™¨</a><ol><li><a href=#åŠ åœ¨cbvè§†å›¾çš„å…·ä½“æ–¹æ³•ä¸Š>åŠ åœ¨CBVè§†å›¾çš„å…·ä½“æ–¹æ³•ä¸Š</a></li><li><a href=#åŠ åœ¨ç±»è§†å›¾ä¸Š>åŠ åœ¨ç±»è§†å›¾ä¸Š</a></li><li><a href=#åŠ åœ¨dispathæ–¹æ³•ä¸Š>åŠ åœ¨dispathæ–¹æ³•ä¸Š</a></li></ol></li></ol></li><li><a href=#æ¨¡æ¿å±‚>æ¨¡æ¿å±‚</a><ol><li><a href=#æ¨¡æ¿è¯­æ³•>æ¨¡æ¿è¯­æ³•</a><ol><li><a href=#ä¼ å€¼>ä¼ å€¼</a></li><li><a href=#å–å€¼>å–å€¼</a></li><li><a href=#è¿‡æ»¤å™¨>è¿‡æ»¤å™¨</a></li><li><a href=#æ ‡ç­¾>æ ‡ç­¾</a></li></ol></li><li><a href=#è‡ªå®šä¹‰>è‡ªå®šä¹‰</a></li><li><a href=#æ¨¡æ¿ç»§æ‰¿>æ¨¡æ¿ç»§æ‰¿</a></li><li><a href=#æ¨¡æ¿å¯¼å…¥>æ¨¡æ¿å¯¼å…¥</a></li></ol></li><li><a href=#æ¨¡å‹å±‚>æ¨¡å‹å±‚</a><ol><li><a href=#æµ‹è¯•è„šæœ¬-1>æµ‹è¯•è„šæœ¬</a><ol><li><a href=#å•è¡¨æŸ¥è¯¢>å•è¡¨æŸ¥è¯¢</a></li><li><a href=#å¢-1>å¢</a></li><li><a href=#åˆ -1>åˆ </a></li><li><a href=#æ”¹-1>æ”¹</a></li><li><a href=#å¿…çŸ¥å¿…ä¼š13æ¡>å¿…çŸ¥å¿…ä¼š13æ¡</a></li><li><a href=#åŒä¸‹åˆ’çº¿æŸ¥è¯¢>åŒä¸‹åˆ’çº¿æŸ¥è¯¢</a></li></ol></li><li><a href=#å¤šè¡¨æ“ä½œ>å¤šè¡¨æ“ä½œ</a><ol><li><a href=#ä¸€å¯¹å¤š>ä¸€å¯¹å¤š</a></li><li><a href=#å¤šå¯¹å¤š>å¤šå¯¹å¤š</a></li></ol></li><li><a href=#è·¨è¡¨æŸ¥è¯¢é‡ç‚¹>è·¨è¡¨æŸ¥è¯¢(é‡ç‚¹)</a><ol><li><a href=#å­æŸ¥è¯¢>å­æŸ¥è¯¢</a></li><li><a href=#è”è¡¨æŸ¥è¯¢>è”è¡¨æŸ¥è¯¢</a></li></ol></li><li><a href=#èšåˆæŸ¥è¯¢>èšåˆæŸ¥è¯¢</a></li><li><a href=#åˆ†ç»„æŸ¥è¯¢>åˆ†ç»„æŸ¥è¯¢</a></li><li><a href=#fä¸qæŸ¥è¯¢>Fä¸QæŸ¥è¯¢</a></li><li><a href=#djangoä¸­å¦‚ä½•å¼€å¯äº‹åŠ¡>djangoä¸­å¦‚ä½•å¼€å¯äº‹åŠ¡</a></li><li><a href=#ormä¸­å¸¸ç”¨å­—æ®µåŠå‚æ•°>ormä¸­å¸¸ç”¨å­—æ®µåŠå‚æ•°</a></li><li><a href=#choiceså‚æ•°>choiceså‚æ•°</a></li><li><a href=#æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–>æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–</a><ol><li><a href=#onlyä¸defer>onlyä¸defer</a></li><li><a href=#select_relatedä¸prefetch_related>select_relatedä¸prefetch_related</a></li></ol></li><li><a href=#æ‰¹é‡æ’å…¥æ•°æ®>æ‰¹é‡æ’å…¥æ•°æ®</a></li></ol></li><li><a href=#formsç»„ä»¶>Formsç»„ä»¶</a><ol><li><a href=#å‰æˆ>å‰æˆ</a></li><li><a href=#åŸºæœ¬ä½¿ç”¨>åŸºæœ¬ä½¿ç”¨</a></li><li><a href=#æ ¡éªŒæ•°æ®>æ ¡éªŒæ•°æ®</a></li><li><a href=#æ¸²æŸ“æ ‡ç­¾>æ¸²æŸ“æ ‡ç­¾</a></li><li><a href=#å±•ç¤ºæç¤ºä¿¡æ¯>å±•ç¤ºæç¤ºä¿¡æ¯</a></li><li><a href=#é’©å­å‡½æ•°hook>é’©å­å‡½æ•°(hook)</a></li><li><a href=#é‡è¦å‚æ•°>é‡è¦å‚æ•°</a></li><li><a href=#å…¶ä»–å­—æ®µç±»å‹>å…¶ä»–å­—æ®µç±»å‹</a></li><li><a href=#formsç»„ä»¶æºç >Formsç»„ä»¶æºç </a></li><li><a href=#æ ¡éªŒå­—æ®µå±€éƒ¨é’©å­æºç è§£è¯»>æ ¡éªŒå­—æ®µ/å±€éƒ¨é’©å­æºç è§£è¯»</a></li><li><a href=#å…¨å±€é’©å­æºç è§£è¯»>å…¨å±€é’©å­æºç è§£è¯»</a><ol><li><a href=#_post_clean>_post_clean</a></li></ol></li></ol></li><li><a href=#cookieå’Œsession>Cookieå’ŒSession</a><ol><li><a href=#cookieæ“ä½œ>Cookieæ“ä½œ</a><ol><li><a href=#è®¾ç½®cookie>è®¾ç½®cookie</a></li><li><a href=#è·å–cookie>è·å–cookie</a></li><li><a href=#åˆ é™¤cookie>åˆ é™¤cookie</a></li><li><a href=#cookieç‰ˆç™»å½•éªŒè¯>cookieç‰ˆç™»å½•éªŒè¯</a></li></ol></li><li><a href=#sessionæ“ä½œ>Sessionæ“ä½œ</a><ol><li><a href=#è®¾ç½®session>è®¾ç½®session</a></li><li><a href=#è·å–session>è·å–session</a></li><li><a href=#æ¸…é™¤session>æ¸…é™¤session</a></li><li><a href=#djangoä¸­sessioné…ç½®>djangoä¸­sessioné…ç½®</a></li><li><a href=#sessionç‰ˆç™»å½•éªŒè¯>sessionç‰ˆç™»å½•éªŒè¯</a></li></ol></li></ol></li><li><a href=#djangoä¸­é—´ä»¶>Djangoä¸­é—´ä»¶</a><ol><li><a href=#ä¸­é—´ä»¶>ä¸­é—´ä»¶</a><ol><li><a href=#è‡ªå¸¦ä¸ƒä¸ªä¸­é—´ä»¶>è‡ªå¸¦ä¸ƒä¸ªä¸­é—´ä»¶</a></li><li><a href=#è‡ªå®šä¹‰ä¸­é—´ä»¶>è‡ªå®šä¹‰ä¸­é—´ä»¶</a></li><li><a href=#ä¸­é—´ä»¶æ–¹æ³•è¯¦è§£>ä¸­é—´ä»¶æ–¹æ³•è¯¦è§£</a></li></ol></li><li><a href=#ç¼–ç¨‹æ€æƒ³>ç¼–ç¨‹æ€æƒ³</a><ol><li><a href=#importlibç®€å•ä»‹ç»>importlibç®€å•ä»‹ç»</a></li><li><a href=#importlibè¿›é˜¶ä½¿ç”¨>importlibè¿›é˜¶ä½¿ç”¨</a></li></ol></li><li><a href=#csrfè·¨ç«™è¯·æ±‚ä¼ªé€ >csrfè·¨ç«™è¯·æ±‚ä¼ªé€ </a><ol><li><a href=#formè¡¨å•å¦‚ä½•æ ¡éªŒ>Formè¡¨å•å¦‚ä½•æ ¡éªŒ</a></li><li><a href=#ajaxå¦‚ä½•æ ¡éªŒ>Ajaxå¦‚ä½•æ ¡éªŒ</a></li><li><a href=#csrfç›¸å…³è£…é¥°å™¨>csrfç›¸å…³è£…é¥°å™¨</a></li></ol></li></ol></li><li><a href=#authæ¨¡å—>Authæ¨¡å—</a><ol><li><a href=#å¸¸ç”¨æ–¹æ³•æ€»ç»“>å¸¸ç”¨æ–¹æ³•æ€»ç»“</a></li><li><a href=#å®Œæ•´ä»£ç ç¤ºä¾‹>å®Œæ•´ä»£ç ç¤ºä¾‹</a></li><li><a href=#å¦‚ä½•æ‰©å±•auth_userè¡¨>å¦‚ä½•æ‰©å±•auth_userè¡¨</a></li></ol></li><li><a href=#djangoç‰ˆæœ¬åŒºåˆ«>Djangoç‰ˆæœ¬åŒºåˆ«</a><ol><li><a href=#è·¯ç”±å±‚-1>è·¯ç”±å±‚</a><ol><li><a href=#pathè½¬æ¢å™¨>pathè½¬æ¢å™¨</a></li></ol></li><li><a href=#æ¨¡å‹å±‚-1>æ¨¡å‹å±‚</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/python/ style=background-color:#fadf6c;color:#fff>PYTHON</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/django/>Django</a></h2><h3 class=article-subtitle>Django was invented to meet fast-moving newsroom deadlines, while satisfying the tough requirements of experienced web developers.</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Feb 10, 2020</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>é˜…è¯»æ—¶é•¿: 66 åˆ†é’Ÿ</time></div></footer></div></header><section class=article-content><p><a class=link href=https://docs.djangoproject.com/en/3.1/ target=_blank rel=noopener>Djangoè‹±æ–‡å®˜æ–¹æ–‡æ¡£</a></p><p><a class=link href=https://docs.djangoproject.com/zh-hans/3.1/ target=_blank rel=noopener>Djangoä¸­æ–‡å®˜æ–¹æ–‡æ¡£</a></p><h2 id=djangoè¯·æ±‚ç”Ÿå‘½å‘¨æœŸ>Djangoè¯·æ±‚ç”Ÿå‘½å‘¨æœŸ</h2><h3 id=æµç¨‹>æµç¨‹</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>æµè§ˆå™¨å‘é€è¯·æ±‚ =&gt; WEBç½‘å…³æœåŠ¡æ¥å£ =&gt; Djangoæ¡†æ¶
</span></span></span><span class=line><span class=cl><span class=s2>                                  -&gt; ä¸­é—´ä»¶ middleware (-&gt; ç¼“å­˜æ•°æ®åº“ æ‹¿åˆ°åˆ™è¿”å›)
</span></span></span><span class=line><span class=cl><span class=s2>                                  -&gt; è·¯ç”±å±‚ urls.py
</span></span></span><span class=line><span class=cl><span class=s2>                                  -&gt; è§†å›¾å±‚ views.py
</span></span></span><span class=line><span class=cl><span class=s2>                                    -&gt; æ¨¡æ¿å±‚ templates
</span></span></span><span class=line><span class=cl><span class=s2>                                    -&gt; æ¨¡å‹å±‚ modes.py
</span></span></span><span class=line><span class=cl><span class=s2>                                  -&gt; æ‹¿åˆ°æ•°æ®/æ¨¡æ¿ æ¸²æŸ“åæŒ‰è·¯å¾„è¿”å›
</span></span></span><span class=line><span class=cl><span class=s2>                            
</span></span></span><span class=line><span class=cl><span class=s2>è¯·æ±‚ç»è¿‡WEBç½‘å…³æœåŠ¡æ¥å£ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>  - djangoè‡ªå¸¦çš„æ˜¯wsgiref
</span></span></span><span class=line><span class=cl><span class=s2>    1. è¯·æ±‚æ¥çš„æ—¶å€™ è§£æè¯·æ±‚ å¹¶å°è£…ä¸ºrequestå¯¹è±¡
</span></span></span><span class=line><span class=cl><span class=s2>    2. å“åº”èµ°çš„æ—¶å€™ æ‰“åŒ…å¤„ç†
</span></span></span><span class=line><span class=cl><span class=s2>  - djangoè‡ªå¸¦çš„wsgirefæ¨¡å—æœ¬èº«èƒ½å¤Ÿæ”¯æŒçš„å¹¶å‘é‡å¾ˆå° æœ€å¤š1000å·¦å³
</span></span></span><span class=line><span class=cl><span class=s2>  - ä¸Šçº¿ä¼šæ¢æˆ nginx(åå‘ä»£ç†) + uwsgi
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>  WSGI/wsgiref/uwsgiæ˜¯ä»€ä¹ˆå…³ç³»?
</span></span></span><span class=line><span class=cl><span class=s2>    - WSGI æ˜¯åè®®
</span></span></span><span class=line><span class=cl><span class=s2>    - wsgiref/uwsgiæ˜¯å®ç°è¯¥åè®®çš„åŠŸèƒ½æ¨¡å—
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>è¯·æ±‚ç»è¿‡Djangoæ¡†æ¶ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>  -&gt; å…ˆç»è¿‡Djangoä¸­é—´ä»¶(ç±»ä¼¼ä¸djangoçš„ä¿å®‰ é—¨æˆ·)
</span></span></span><span class=line><span class=cl><span class=s2>  -&gt; è·¯ç”±å±‚ urls.py è·¯ç”±åŒ¹é…ä¸åˆ†å‘ è¯†åˆ«è·¯ç”±åŒ¹é…å¯¹åº”çš„è§†å›¾å‡½æ•°
</span></span></span><span class=line><span class=cl><span class=s2>  -&gt; è§†å›¾å±‚ views.py ç½‘ç«™æ•´ä½“çš„ä¸šåŠ¡é€»è¾‘
</span></span></span><span class=line><span class=cl><span class=s2>     - è§†å›¾å±‚å¯èƒ½éœ€è¦æ¨¡æ¿ -&gt; æ¨¡æ¿å±‚(templatesæ–‡ä»¶å¤¹) ç½‘ç«™æ‰€æœ‰çš„htmlé¡µé¢
</span></span></span><span class=line><span class=cl><span class=s2>     - è§†å›¾å±‚å¯èƒ½éœ€è¦æ•°æ® -&gt; æ¨¡å‹å±‚ models.py **é‡è¦** ORM
</span></span></span><span class=line><span class=cl><span class=s2>     - è§†å›¾å±‚æ‹¿åˆ°æ•°æ®ä¹‹å æ¸²æŸ“å¹¶æŒ‰è·¯å¾„è¿”å›
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ‰©å±•>æ‰©å±•</h3><p><strong>ç¼“å­˜æ•°æ®åº“</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>æå‰å·²ç»å°†ä½ æƒ³è¦çš„æ•°æ®å‡†å¤‡å¥½ ä½ æ¥ç›´æ¥æ‹¿å³å¯
</span></span></span><span class=line><span class=cl><span class=s2> - å‡è½»åç«¯å‹åŠ›
</span></span></span><span class=line><span class=cl><span class=s2> - æé«˜æ•ˆç‡å’Œå“åº”æ—¶é—´
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>ç¼“å­˜æ•°æ®åº“åœ¨è¯·æ±‚æµç¨‹ä¸­çš„ä½ç½®   
</span></span></span><span class=line><span class=cl><span class=s2>  - ç»è¿‡ä¸­é—´ä»¶ä¹‹å ç›´æ¥è¯·æ±‚ç¼“å­˜æ•°æ®åº“
</span></span></span><span class=line><span class=cl><span class=s2>    - æ‹¿åˆ° ç›´æ¥è¿”å›
</span></span></span><span class=line><span class=cl><span class=s2>    - æ²¡æ‹¿åˆ° èµ°æ­£å¸¸æµç¨‹ ç„¶åå­˜ä¸€ä»½åˆ°ç¼“å­˜æ•°æ®åº“å¹¶è¿”å›
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>å½“ä½ åœ¨ä¿®æ”¹æ•°æ®çš„æ—¶å€™ ä½ ä¼šå‘ç°æ•°æ®å¹¶ä¸æ˜¯ç«‹å³ä¿®æ”¹å®Œçš„
</span></span></span><span class=line><span class=cl><span class=s2>è€Œæ˜¯éœ€è¦ç»è¿‡ä¸€æ®µæ—¶é—´æ‰ä¼šä¿®æ”¹(è¿˜åœ¨è®¿é—®ç¼“å­˜çš„å†…å®¹)
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=æ³¨æ„äº‹é¡¹>æ³¨æ„äº‹é¡¹</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># å¦‚ä½•è®©ä½ çš„è®¡ç®—æœºèƒ½å¤Ÿæ­£å¸¸çš„å¯åŠ¨Djangoé¡¹ç›®</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>  1. è®¡ç®—æœºçš„åç§°ä¸èƒ½æœ‰ä¸­æ–‡
</span></span></span><span class=line><span class=cl><span class=s2>  2. ä¸€ä¸ªPycharmçª—å£åªå¼€ä¸€ä¸ªé¡¹ç›®
</span></span></span><span class=line><span class=cl><span class=s2>  3. é¡¹ç›®é‡Œé¢æ‰€æœ‰çš„æ–‡ä»¶ä¹Ÿå°½é‡ä¸è¦å‡ºç°ä¸­æ–‡
</span></span></span><span class=line><span class=cl><span class=s2>  4. Pythonè§£é‡Šå™¨ç»“è®ºä½¿ç”¨ 3.4-3.6ä¹‹é—´çš„ç‰ˆæœ¬
</span></span></span><span class=line><span class=cl><span class=s2>    4.1. å¦‚æœä½ çš„é¡¹ç›®æŠ¥é”™ ç‚¹å‡»æœ€åä¸€ä¸ªæŠ¥é”™ä¿¡æ¯ å»æºç ä¸­æŠŠé€—å·åˆ æ‰
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Djangoç‰ˆæœ¬é—®é¢˜</span>
</span></span><span class=line><span class=cl><span class=n>æ¨èä½¿ç”¨</span><span class=err>ï¼š</span><span class=n>LTS</span> <span class=n>å®˜æ–¹é•¿æœŸæ”¯æŒç»´æŠ¤çš„ç‰ˆæœ¬</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>1.x 2.x 3.x(æˆç†Ÿç‰ˆæœ¬å‡ºæ¥åè€ƒè™‘)
</span></span></span><span class=line><span class=cl><span class=s2>1.x å’Œ 2.x æœ¬èº«å·®è·å¹¶ä¸å¤§
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>  
</span></span></code></pre></td></tr></table></div></div><h2 id=å®‰è£…>å®‰è£…</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># å®‰è£…django == æŒ‡å®šå®‰è£…ç‰ˆæœ¬</span>
</span></span><span class=line><span class=cl>pip install <span class=nv>django</span><span class=o>==</span>x.x.x
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># e.g. ç›´æ¥å®‰è£… ä¼šè‡ªåŠ¨å¸è½½æ—§çš„å®‰è£…æ–°çš„</span>
</span></span><span class=line><span class=cl>pip install <span class=nv>django</span><span class=o>==</span>1.11.11
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸ</span>
</span></span><span class=line><span class=cl>django-admin  <span class=c1># çœ‹æ˜¯å¦è¾“å‡ºå¸®åŠ©æ–‡æ¡£</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=djangoåŸºæœ¬æ“ä½œ>DjangoåŸºæœ¬æ“ä½œ</h2><ul><li><strong>å‘½ä»¤è¡Œæ“ä½œ</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 1. åˆ›å»ºdjangoé¡¹ç›®</span>
</span></span><span class=line><span class=cl><span class=c1># å¦‚æœå·²ç»å®ç°åˆ›å»ºé¡¹ç›®ç›®å½• [ç›®å½•] ç›´æ¥æ¢ä¸º .(å½“å‰ç›®å½•)</span>
</span></span><span class=line><span class=cl><span class=n>django</span><span class=o>-</span><span class=n>admin</span> <span class=n>startproject</span> <span class=p>[</span><span class=n>é¡¹ç›®å</span><span class=p>]</span> <span class=p>[</span><span class=n>ç›®å½•</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>django</span><span class=o>-</span><span class=n>admin</span> <span class=n>startproject</span> <span class=p>[</span><span class=n>name</span><span class=p>]</span> <span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># e.g.</span>
</span></span><span class=line><span class=cl><span class=n>cd</span> <span class=n>MinhoDjango</span>  <span class=c1># è¿›å…¥å·²å­˜åœ¨çš„ç›®å½• ä½œä¸ºé¡¹ç›®æ ¹ç›®å½•</span>
</span></span><span class=line><span class=cl><span class=n>django</span><span class=o>-</span><span class=n>admin</span> <span class=n>startprojcet</span> <span class=n>mysite</span> <span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. å¯åŠ¨djangoç›®å½•</span>
</span></span><span class=line><span class=cl><span class=n>python</span> <span class=n>manage</span><span class=o>.</span><span class=n>py</span> <span class=n>runserver</span>  <span class=c1># é»˜è®¤: 127.0.0.1:8080</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. åˆ›å»ºåº”ç”¨</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>Next, start your first app by running python manage.py startapp [app_label].
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>åº”ç”¨ååº”è¯¥åšåˆ°è§åçŸ¥æ„ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>  - user
</span></span></span><span class=line><span class=cl><span class=s2>  - order
</span></span></span><span class=line><span class=cl><span class=s2>  - web
</span></span></span><span class=line><span class=cl><span class=s2>  - ...
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>python</span> <span class=n>manage</span><span class=o>.</span><span class=n>py</span> <span class=n>startapp</span> <span class=n>app01</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>Pycharmåˆ›å»º</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>1. File --&gt; New Project --&gt; Djangoé¡¹ç›®
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>2. å¯åŠ¨
</span></span></span><span class=line><span class=cl><span class=s2>    2.1 è¿˜æ˜¯ç”¨å‘½ä»¤è¡Œå¯åŠ¨
</span></span></span><span class=line><span class=cl><span class=s2>    2.2 ç‚¹å‡»ç»¿è‰²å°ç®­å¤´å³å¯
</span></span></span><span class=line><span class=cl><span class=s2>   
</span></span></span><span class=line><span class=cl><span class=s2>3. åˆ›å»ºåº”ç”¨app
</span></span></span><span class=line><span class=cl><span class=s2>    3.1 è¿˜æ˜¯ç”¨å‘½ä»¤è¡Œåˆ›å»º
</span></span></span><span class=line><span class=cl><span class=s2>    3.2 Tools --&gt; Run manage.py Task... # è¿›å…¥shell
</span></span></span><span class=line><span class=cl><span class=s2>        startapp app01  # åˆ›å»ºapp01 åº”ç”¨
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>4. ä¿®æ”¹ç«¯å£å·ä»¥åŠåˆ›å»ºserver
</span></span></span><span class=line><span class=cl><span class=s2>   å³ä¸Šè§’ --&gt; Edit Configure
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>åŒºåˆ«</strong></li></ul><p><strong>å‘½ä»¤è¡Œä¸pycharmåˆ›å»ºçš„åŒºåˆ«</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>  1. å‘½ä»¤è¡Œåˆ›å»ºä¸ä¼šè‡ªåŠ¨æœ‰ root_projects/templates æ–‡ä»¶å¤¹ éœ€è¦ä½ è‡ªå·±æ‰‹åŠ¨åˆ›å»º è€Œpycharmåˆ›å»ºä¼šè‡ªåŠ¨å¸®ä½ åˆ›å»ºå¹¶ä¸”è¿˜ä¼šè‡ªåŠ¨åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®å¯¹åº”çš„è·¯å¾„
</span></span></span><span class=line><span class=cl><span class=s2>  æ„å‘³ç€ ä½ åœ¨ç”¨å‘½ä»¤åˆ›å»ºdjangoé¡¹ç›®çš„æ—¶å€™ ä¸å•å•éœ€è¦åˆ›å»ºtemplatesæ–‡ä»¶å¤¹ è¿˜éœ€è¦å»é…ç½®æ–‡ä»¶ä¸­é…ç½®è·¯å¾„
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å‘½ä»¤è¡Œåˆ›å»º</span>
</span></span><span class=line><span class=cl><span class=n>TEMPLATES</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;BACKEND&#39;</span><span class=p>:</span> <span class=s1>&#39;django.template.backends.django.DjangoTemplates&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;DIRS&#39;</span><span class=p>:</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Pycharmåˆ›å»º</span>
</span></span><span class=line><span class=cl><span class=n>TEMPLATES</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;BACKEND&#39;</span><span class=p>:</span> <span class=s1>&#39;django.template.backends.django.DjangoTemplates&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;DIRS&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>BASE_DIR</span> <span class=o>/</span> <span class=s1>&#39;templates&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>       
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=åº”ç”¨>åº”ç”¨</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>django æ˜¯ä¸€æ¬¾ä¸“é—¨ç”¨æ¥å¼€å‘appçš„webæ¡†æ¶
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>djangoæ¡†æ¶å°±ç±»ä¼¼ä¸€æ‰€å¤§å­¦(ç©ºå£³å­ éœ€è¦è‡ªå·±åˆ›å»ºå…·æœ‰ä¸åŒåŠŸèƒ½çš„app)
</span></span></span><span class=line><span class=cl><span class=s2>appå°±ç±»ä¼¼å¤§è™šé¢é‡Œé¢çš„å„ä¸ªå­¦é™¢(å­¦é™¢--å…·ä½“åŠŸèƒ½çš„app)
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>æ¯”å¦‚å¼€å‘æ·˜å®ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>  - è®¢å•ç›¸å…³
</span></span></span><span class=line><span class=cl><span class=s2>  - ç”¨æˆ·ç›¸å…³
</span></span></span><span class=line><span class=cl><span class=s2>  - æŠ•è¯‰ç›¸å…³
</span></span></span><span class=line><span class=cl><span class=s2>  - åˆ›å»ºä¸åŒçš„appå¯¹åº”ä¸åŒçš„åŠŸèƒ½
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>å­¦è¯¾ç³»ç»Ÿï¼š
</span></span></span><span class=line><span class=cl><span class=s2>  - å­¦ç”ŸåŠŸèƒ½
</span></span></span><span class=line><span class=cl><span class=s2>  - è€å¸ˆåŠŸèƒ½
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>ä¸€ä¸ªappå°±æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„åŠŸèƒ½æ¨¡å—
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>åˆ›å»ºçš„åº”ç”¨ ä¸€å®šè¦å»é…ç½®æ–‡ä»¶ä¸­æ³¨å†Œ</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Application definition</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>ä¸€å®šè¦æ³¨å†Œ å¦åˆ™åº”ç”¨ä¸ç”Ÿæ•ˆ
</span></span></span><span class=line><span class=cl><span class=s2>åˆ›å»ºå‡ºæ¥çš„åº”ç”¨ ç¬¬ä¸€æ­¥å…ˆå»é…ç½®æ–‡ä»¶ä¸­æ³¨å†Œ
</span></span></span><span class=line><span class=cl><span class=s2>å¤‡æ³¨: åœ¨ä½¿ç”¨Pycharmåˆ›å»ºé¡¹ç›®çš„æ—¶å€™ Pycharmå¯ä»¥å¸®ä½ åˆ›å»ºä¸€ä¸ªappå¹¶è‡ªåŠ¨æ³¨å†Œ(ä»…ä¸€ä¸ª)
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>INSTALLED_APPS</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.contrib.admin&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.contrib.auth&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.contrib.contenttypes&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.contrib.sessions&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.contrib.messages&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.contrib.staticfiles&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;app01.apps.App01Config&#39;</span><span class=p>,</span>  <span class=c1># å…¨å†™</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;app02&#39;</span><span class=p>,</span>  <span class=c1># ç®€å†™</span>
</span></span><span class=line><span class=cl><span class=p>]</span>  <span class=c1># å…¨å†™ or ç®€å†™ é€‰æ‹©å…¶ä¸­ä¸€ç§å³å¯</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=ä¸»è¦æ–‡ä»¶ä»‹ç»>ä¸»è¦æ–‡ä»¶ä»‹ç»</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>MinhoDjango/
</span></span></span><span class=line><span class=cl><span class=s2>    - manage.py          djangoçš„å…¥å£æ–‡ä»¶
</span></span></span><span class=line><span class=cl><span class=s2>    - db.sqlite3         djangoè‡ªå¸¦çš„sqlite3æ•°æ®åº“(å°å‹æ•°æ®åº“ åŠŸèƒ½ä¸å…¨è¿˜æœ‰BUG)
</span></span></span><span class=line><span class=cl><span class=s2>    - mysite/
</span></span></span><span class=line><span class=cl><span class=s2>        - __init__.py
</span></span></span><span class=line><span class=cl><span class=s2>        - settings.py    é…ç½®æ–‡ä»¶
</span></span></span><span class=line><span class=cl><span class=s2>        - urls.py        è·¯ç”±ä¸è§†å›¾å¯¹åº”å…³ç³»(è·¯ç”±å±‚)
</span></span></span><span class=line><span class=cl><span class=s2>        - wsgi.py        wsgirefæ¨¡å—(å¿½ç•¥)
</span></span></span><span class=line><span class=cl><span class=s2>    - app01
</span></span></span><span class=line><span class=cl><span class=s2>        - migrations/    æ‰€æœ‰çš„æ•°æ®åº“è¿ç§»è®°å½•(ç±»æ—¥å¿—è®°å½•)
</span></span></span><span class=line><span class=cl><span class=s2>            - __init__.py
</span></span></span><span class=line><span class=cl><span class=s2>        - __init__.py
</span></span></span><span class=line><span class=cl><span class=s2>        - admin.py       djangoåå°ç®¡ç†
</span></span></span><span class=line><span class=cl><span class=s2>        - apps.py        æ³¨å†Œä½¿ç”¨
</span></span></span><span class=line><span class=cl><span class=s2>        - models.py      æ•°æ®åº“ç›¸å…³çš„ æ¨¡å‹ç±»(æ¨¡å‹å±‚ ORM)
</span></span></span><span class=line><span class=cl><span class=s2>        - tests.py       æµ‹è¯•æ–‡ä»¶(å¿½ç•¥)
</span></span></span><span class=line><span class=cl><span class=s2>        - views.py       è§†å›¾å‡½æ•°(è§†å›¾å±‚)
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=é…ç½®æ–‡ä»¶>é…ç½®æ–‡ä»¶</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># SECURITY WARNING: don&#39;t run with debug turned on in production!</span>
</span></span><span class=line><span class=cl><span class=n>DEBUG</span> <span class=o>=</span> <span class=kc>True</span>  <span class=c1># ä¸Šçº¿ä¹‹åæ”¹ä¸ºFlase</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ALLOWED_HOSTS</span> <span class=o>=</span> <span class=p>[]</span>  <span class=c1># ä¸Šçº¿ä¹‹åå¯ä»¥å†™ &#39;*&#39;  å…è®¸æ‰€æœ‰</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ³¨å†Œçš„app(appå°±æ˜¯è‡ªå¸¦çš„åŠŸèƒ½æ¨¡å—) djangoä¸€åˆ›å»ºå‡ºæ¥ è‡ªå¸¦6ä¸ªåŠŸèƒ½æ¨¡å—</span>
</span></span><span class=line><span class=cl><span class=c1># Application definition</span>
</span></span><span class=line><span class=cl><span class=n>INSTALLED_APPS</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.contrib.admin&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.contrib.auth&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.contrib.contenttypes&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.contrib.sessions&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.contrib.messages&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.contrib.staticfiles&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;app01.apps.App01Config&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;app02&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Djangoä¸­é—´ä»¶</span>
</span></span><span class=line><span class=cl><span class=n>MIDDLEWARE</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.middleware.security.SecurityMiddleware&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.contrib.sessions.middleware.SessionMiddleware&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.middleware.common.CommonMiddleware&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.middleware.csrf.CsrfViewMiddleware&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.contrib.auth.middleware.AuthenticationMiddleware&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.contrib.messages.middleware.MessageMiddleware&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.middleware.clickjacking.XFrameOptionsMiddleware&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># HTMLå­˜æ”¾è·¯å¾„é…ç½®</span>
</span></span><span class=line><span class=cl><span class=n>TEMPLATES</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># é¡¹ç›®æŒ‡å®šæ•°æ®åº“é…ç½® é»˜è®¤sqlite3</span>
</span></span><span class=line><span class=cl><span class=c1># Database</span>
</span></span><span class=line><span class=cl><span class=c1># https://docs.djangoproject.com/en/3.1/ref/settings/#databases</span>
</span></span><span class=line><span class=cl><span class=n>DATABASES</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;default&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;ENGINE&#39;</span><span class=p>:</span> <span class=s1>&#39;django.db.backends.sqlite3&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;NAME&#39;</span><span class=p>:</span> <span class=n>BASE_DIR</span> <span class=o>/</span> <span class=s1>&#39;db.sqlite3&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Password validation</span>
</span></span><span class=line><span class=cl><span class=c1># https://docs.djangoproject.com/en/3.1/ref/settings/#auth-password-validators</span>
</span></span><span class=line><span class=cl><span class=n>AUTH_PASSWORD_VALIDATORS</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ—¥å¿—è®°å½•å®è·µ</span>
</span></span><span class=line><span class=cl><span class=n>LOGGING</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;version&#39;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;disable_existing_loggers&#39;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;formatters&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;verbose&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;format&#39;</span><span class=p>:</span> <span class=s1>&#39;</span><span class=si>{levelname}</span><span class=s1> </span><span class=si>{asctime}</span><span class=s1> </span><span class=si>{module}</span><span class=s1> </span><span class=si>{process:d}</span><span class=s1> </span><span class=si>{thread:d}</span><span class=s1> </span><span class=si>{message}</span><span class=s1>&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;style&#39;</span><span class=p>:</span> <span class=s1>&#39;{&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;simple&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;format&#39;</span><span class=p>:</span> <span class=s1>&#39;</span><span class=si>{levelname}</span><span class=s1> </span><span class=si>{message}</span><span class=s1>&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;style&#39;</span><span class=p>:</span> <span class=s1>&#39;{&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;filters&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;require_debug_true&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;()&#39;</span><span class=p>:</span> <span class=s1>&#39;django.utils.log.RequireDebugTrue&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;handlers&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;console&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;level&#39;</span><span class=p>:</span> <span class=s1>&#39;INFO&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;filters&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;require_debug_true&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;class&#39;</span><span class=p>:</span> <span class=s1>&#39;logging.StreamHandler&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;formatter&#39;</span><span class=p>:</span> <span class=s1>&#39;simple&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;file&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;level&#39;</span><span class=p>:</span> <span class=s1>&#39;INFO&#39;</span><span class=p>,</span>  <span class=c1># å®é™…å¼€å‘å»ºè®®ä½¿ç”¨ERROR</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;class&#39;</span><span class=p>:</span> <span class=s1>&#39;logging.handlers.RotatingFileHandler&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;filename&#39;</span><span class=p>:</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=n>BASE_DIR</span><span class=p>),</span> <span class=s1>&#39;logs&#39;</span><span class=p>,</span> <span class=s1>&#39;chaos.log&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;maxBytes&#39;</span><span class=p>:</span> <span class=mi>200</span> <span class=o>*</span> <span class=mi>1024</span> <span class=o>*</span> <span class=mi>1024</span><span class=p>,</span>  <span class=c1># 100M</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;backupCount&#39;</span><span class=p>:</span> <span class=mi>10</span><span class=p>,</span>              <span class=c1># æ—¥å¿—æ–‡ä»¶å¤‡ä»½æ•°é‡</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;formatter&#39;</span><span class=p>:</span> <span class=s1>&#39;verbose&#39;</span><span class=p>,</span>         <span class=c1># æ—¥å¿—æ ¼å¼ï¼šè¯¦ç»†</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;encoding&#39;</span><span class=p>:</span> <span class=s1>&#39;utf-8&#39;</span>             <span class=c1># æ–‡ä»¶ç¼–ç æ ¼å¼</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;loggers&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;django&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;handlers&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;console&#39;</span><span class=p>,</span> <span class=s1>&#39;file&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;propagate&#39;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=djangoå°ç™½å¿…ä¼šä¸‰æ¿æ–§>Djangoå°ç™½å¿…ä¼šä¸‰æ¿æ–§</h2><h3 id=httpresponse>HttpResponse</h3><p><strong>HttpResponse ç›´æ¥è¿”å›å­—ç¬¦ä¸²</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.shortcuts</span> <span class=kn>import</span> <span class=n>HttpResponse</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create your views here.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è§†å›¾å‡½æ•°å¿…é¡»è¦æ¥æ”¶ä¸€ä¸ªå½¢å‚ï¼šrequest</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>index</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    :param request: è¯·æ±‚ç›¸å…³çš„æ‰€æœ‰æ•°æ®å¯¹è±¡ æ¯”ä¹‹å‰çš„environæ›´å¥½ç”¨ æ˜¯å¯¹è±¡ ç›´æ¥. å–å±æ€§ æ¯”å­—å…¸å¥½ç”¨
</span></span></span><span class=line><span class=cl><span class=s2>    :return:
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;Hello, Django&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;1&#39;</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;2&#39;</span><span class=p>,</span> <span class=nb>type</span><span class=p>(</span><span class=n>data</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s2>&#34;Hello, Django&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=mi>1</span> <span class=o>&lt;</span><span class=n>HttpResponse</span> <span class=n>status_code</span><span class=o>=</span><span class=mi>200</span><span class=p>,</span> <span class=s2>&#34;text/html; charset=utf-8&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=mi>2</span> <span class=o>&lt;</span><span class=k>class</span> <span class=err>&#39;</span><span class=nc>django</span><span class=o>.</span><span class=n>http</span><span class=o>.</span><span class=n>response</span><span class=o>.</span><span class=n>HttpResponse</span><span class=s1>&#39;&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=render>render</h3><p><strong>render è¿”å›htmlæ–‡ä»¶ ä½¿ç”¨æ¸²æŸ“ä¹‹åçš„æ¨¡æ¿</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.shortcuts</span> <span class=kn>import</span> <span class=n>render</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create your views here.</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>index</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=s1>&#39;myfirst.html&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å‘½ä»¤è¡Œåˆ›å»º éœ€è¦é…ç½®æ¨¡æ¿ç›®å½•</span>
</span></span><span class=line><span class=cl><span class=err>$</span> <span class=n>mkdir</span> <span class=err>$</span><span class=p>{</span><span class=n>root_projects</span><span class=p>}</span><span class=o>/</span><span class=n>templates</span>
</span></span><span class=line><span class=cl><span class=n>TEMPLATES</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;BACKEND&#39;</span><span class=p>:</span> <span class=s1>&#39;django.template.backends.django.DjangoTemplates&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;DIRS&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>BASE_DIR</span><span class=p>,</span> <span class=s1>&#39;templates&#39;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>renderä¸¤ç§ä¼ å€¼æ–¹å¼</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>index</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    1. ç›´æ¥ä¼ ä¸€ä¸ªå­—å…¸ æ¨¡æ¿ä½¿ç”¨keyè¿›è¡Œä½¿ç”¨ ç²¾ç¡®ä¼ å€¼ ä½¿ç”¨å“ªä¸ªä¼ å“ªä¸ª
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    2. local()
</span></span></span><span class=line><span class=cl><span class=s2>    locals() ä¼šå°†æ‰€åœ¨çš„åç§°ç©ºé—´ä¸­æ‰€æœ‰çš„åå­—å…¨éƒ¨ä¼ é€’ç»™HTMLé¡µé¢
</span></span></span><span class=line><span class=cl><span class=s2>    å½“éœ€è¦ä¼ çš„å˜é‡ç‰¹åˆ«å¤šçš„æ—¶å€™ ä½¿ç”¨ locals() ä¼ å€¼
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>user_dict</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;username&#39;</span><span class=p>:</span> <span class=s1>&#39;Minho&#39;</span><span class=p>,</span> <span class=s1>&#39;age&#39;</span><span class=p>:</span> <span class=mi>25</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=c1># render ä¼ å€¼ 1.</span>
</span></span><span class=line><span class=cl>    <span class=c1># return render(request, &#39;myfirst.html&#39;, {&#39;data&#39;: user_dict, &#39;date&#39;: &#39;2021-02-09&#39;})</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># render ä¼ å€¼ 2.</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=s1>&#39;myfirst.html&#39;</span><span class=p>,</span> <span class=nb>locals</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=redirect>redirect</h3><p><strong>é‡å®šå‘</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.shortcuts</span> <span class=kn>import</span> <span class=n>redirect</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create your views here.</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>index</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># return redirect(&#39;https://www.baidu.com/&#39;)  # é‡å®šå‘åˆ°å¤–éƒ¨ç½‘å€</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=s1>&#39;/home/&#39;</span><span class=p>)</span>  <span class=c1># 302é‡å®šå‘åˆ° è‡ªå·±çš„ç½‘ç«™ /home/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>home</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;home&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=ç™»å½•åŠŸèƒ½å®ç°>ç™»å½•åŠŸèƒ½å®ç°</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># ç™»å½•åŠŸèƒ½</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>htmlæ–‡ä»¶ï¼šé»˜è®¤éƒ½æ”¾åœ¨templatesæ–‡ä»¶å¤¹ä¸‹
</span></span></span><span class=line><span class=cl><span class=s2>é™æ€æ–‡ä»¶ï¼šå°†ç½‘ç«™ä½¿ç”¨çš„é™æ€æ–‡ä»¶é»˜è®¤éƒ½æ”¾åœ¨staticæ–‡ä»¶å¤¹ä¸‹
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>é™æ€æ–‡ä»¶ï¼šå‰ç«¯å·²ç»å†™å¥½ èƒ½å¤Ÿç›´æ¥è°ƒç”¨ä½¿ç”¨çš„æ–‡ä»¶
</span></span></span><span class=line><span class=cl><span class=s2>  - ç½‘ç«™å†™å¥½çš„jsæ–‡ä»¶
</span></span></span><span class=line><span class=cl><span class=s2>  - ç½‘ç«™å†™å¥½çš„cssæ–‡ä»¶
</span></span></span><span class=line><span class=cl><span class=s2>  - ç½‘ç«™ç”¨åˆ°çš„å›¾ç‰‡æ–‡ä»¶
</span></span></span><span class=line><span class=cl><span class=s2>  - ç¬¬ä¸‰æ–¹å‰ç«¯æ¡†æ¶
</span></span></span><span class=line><span class=cl><span class=s2>  ...
</span></span></span><span class=line><span class=cl><span class=s2>  æ€»ç»“ï¼šæ‹¿æ¥å°±å¯ä»¥ç›´æ¥ä½¿ç”¨çš„  
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># djangoé»˜è®¤ä¸ä¼šè‡ªåŠ¨åˆ›å»ºstaticæ–‡ä»¶å¤¹ éœ€è¦ä½ æ‰‹åŠ¨åˆ›å»º</span>
</span></span><span class=line><span class=cl><span class=n>ä¸€èˆ¬æƒ…å†µä¸‹</span> <span class=n>æˆ‘ä»¬ä¼šåœ¨staticæ–‡ä»¶å¤¹å†…</span> <span class=n>è¿˜ä¼šåšè¿›ä¸€æ­¥çš„åˆ’åˆ†å¤„ç†</span>
</span></span><span class=line><span class=cl><span class=o>=&gt;</span> <span class=n>è§£è€¦åˆ</span> <span class=n>æ–¹ä¾¿ç®¡ç†</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>static</span>
</span></span><span class=line><span class=cl>    <span class=o>-</span> <span class=n>js</span>
</span></span><span class=line><span class=cl>    <span class=o>-</span> <span class=n>css</span>
</span></span><span class=line><span class=cl>    <span class=o>-</span> <span class=n>img</span>
</span></span><span class=line><span class=cl>    <span class=o>-</span> <span class=n>å…¶ä»–ç¬¬ä¸‰æ–¹æ–‡ä»¶</span>
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>åœ¨æµè§ˆå™¨ä¸­ è¾“å…¥urlèƒ½å¤Ÿçœ‹åˆ°å¯¹åº”çš„èµ„æº
</span></span></span><span class=line><span class=cl><span class=s2>æ˜¯å› ä¸ºåç«¯æå‰å¼€è®¾äº†è¯¥èµ„æºçš„æ¥å£ -- è·¯ç”±åˆ†å‘
</span></span></span><span class=line><span class=cl><span class=s2>å¦‚æœè®¿é—®ä¸åˆ°èµ„æº è¯´æ˜åç«¯æ²¡æœ‰å¼€è®¾è¯¥èµ„æºçš„æ¥å£
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è®¿é—® loginé¡µé¢ æ²¡æœ‰åŠ è½½bootstrapæ ·å¼çš„é—®é¢˜</span>
</span></span><span class=line><span class=cl><span class=n>è®¿é—®</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=mf>127.0.0.1</span><span class=p>:</span><span class=mi>8000</span><span class=o>/</span><span class=n>static</span><span class=o>/</span><span class=n>bootstrap</span><span class=o>-</span><span class=mf>3.3.7</span><span class=o>-</span><span class=n>dist</span><span class=o>/</span><span class=n>css</span><span class=o>/</span><span class=n>bootstrap</span><span class=o>.</span><span class=n>min</span><span class=o>.</span><span class=n>css</span> <span class=n>æŠ¥é”™</span> <span class=n>è¯´æ˜åç«¯æ²¡æœ‰å¼€è®¾è¯¥èµ„æºçš„è¯·æ±‚è·¯ç”±å‡ºæ¥</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># é™æ€æ–‡ä»¶é…ç½® -- é‡ç‚¹</span>
</span></span><span class=line><span class=cl><span class=n>æŒ‰ç…§ä¸‹é¢æ–¹æ³•åœ¨settings</span><span class=o>.</span><span class=n>pyé…ç½®æ–‡ä»¶é…ç½®staticç›¸å…³é™æ€æ–‡ä»¶é…ç½®ä¹‹å</span> <span class=n>å³å¯è®¿é—®å¼•ç”¨çš„æœ¬åœ°staticæ–‡ä»¶å¤¹ä¸‹é¢çš„é™æ€èµ„æº</span> <span class=o>--</span> <span class=n>ç±»ä¼¼äºdjangoè‡ªå·±å¸®æˆ‘ä»¬å¼€è®¾äº†å¯¹åº”çš„è·¯ç”±æ¥å£</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>login.htmlç¤ºä¾‹</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE html&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span> <span class=na>lang</span><span class=o>=</span><span class=s>&#34;en&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>charset</span><span class=o>=</span><span class=s>&#34;UTF-8&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>http-equiv</span><span class=o>=</span><span class=s>&#34;X-UA-Compatible&#34;</span> <span class=na>content</span><span class=o>=</span><span class=s>&#34;IE=edge&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;viewport&#34;</span> <span class=na>content</span><span class=o>=</span><span class=s>&#34;width=device-width, initial-scale=1&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;</span>Login In<span class=p>&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;stylesheet&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;/static/bootstrap-3.3.7-dist/css/bootstrap.min.css&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;/static/bootstrap-3.3.7-dist/js/bootstrap.min.js&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;/static/js/jquery-3.5.1.min.js&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>h1</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;text-center&#34;</span><span class=p>&gt;</span>ç™»å½•<span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=é™æ€æ–‡ä»¶é…ç½®>é™æ€æ–‡ä»¶é…ç½®</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># ç±»ä¼¼äºè®¿é—®é™æ€æ–‡ä»¶çš„ä»¤ç‰Œ</span>
</span></span><span class=line><span class=cl><span class=c1># å¦‚æœä½ æƒ³è¦è®¿é—®é™æ€æ–‡ä»¶ ä½ å°±å¿…é¡»ä»¥staticå¼€å¤´</span>
</span></span><span class=line><span class=cl><span class=c1># åˆ‡è®°ï¼šè¯¥é…ç½® æ˜¯é…ç½®è®¿é—®urlçš„å¼€å¤´çš„å€¼ ä»¤ç‰Œ å¹¶ä¸æ˜¯é™æ€æ–‡ä»¶å­˜æ”¾çš„ç›®å½•</span>
</span></span><span class=line><span class=cl><span class=n>STATIC_URL</span> <span class=o>=</span> <span class=s1>&#39;/static/&#39;</span>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>/static/  -  ä»¤ç‰Œ
</span></span></span><span class=line><span class=cl><span class=s2>å»ä¸‹é¢STATICFILES_DIRSåˆ—è¡¨é‡Œé¢çš„ç›®å½•é‡Œé¢ æŒ‰é¡ºåºæŸ¥æ‰¾å¼•ç”¨çš„æ–‡ä»¶
</span></span></span><span class=line><span class=cl><span class=s2>  eg. bootstrap-3.3.7-dist/css/bootstrap.min.css
</span></span></span><span class=line><span class=cl><span class=s2>  éƒ½æ²¡æœ‰æ‰¾åˆ° åˆ™æŠ¥é”™
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># é™æ€æ–‡ä»¶é…ç½® åˆ—è¡¨ å¯ä»¥æœ‰å¤šä¸ª(ä»¤ç‰ŒæŒæœ‰è€…å¯ä»¥è®¿é—®çš„æ–‡ä»¶è·¯å¾„)</span>
</span></span><span class=line><span class=cl><span class=c1># é™æ€æ–‡ä»¶çœŸæ­£å­˜æ”¾çš„ç›®å½• å¯ä»¥æœ‰å¤šä¸ªç›®å½• æŒ‰é¡ºåºè§£æ</span>
</span></span><span class=line><span class=cl><span class=c1># å‰é¢çš„æ‰¾åˆ°è¯·æ±‚çš„æ–‡ä»¶ä¹‹å ä¸å†å‘åæŸ¥æ‰¾</span>
</span></span><span class=line><span class=cl><span class=n>STATICFILES_DIRS</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>BASE_DIR</span><span class=p>,</span> <span class=s1>&#39;static&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>BASE_DIR</span><span class=p>,</span> <span class=s1>&#39;static1&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æµè§ˆå™¨ è®¾ç½®é¡µé¢ä¸ç¼“å­˜çš„æ–¹æ³•</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>å½“ä½ åœ¨å†™djangoé¡¹ç›®çš„æ—¶å€™ å¯èƒ½ä¼šå‡ºç°åç«¯ä»£ç ä¿®æ”¹äº†ä½†æ˜¯å‰ç«¯é¡µé¢æ²¡æœ‰å˜åŒ–çš„æƒ…å†µ
</span></span></span><span class=line><span class=cl><span class=s2>  1. åœ¨åŒä¸€ä¸ªç«¯å£å¼€äº†å¥½å‡ ä¸ªdjangoé¡¹ç›® ä¸€ç›´åœ¨è·‘çš„æ˜¯ç¬¬ä¸€ä¸ªdjangoé¡¹ç›®
</span></span></span><span class=line><span class=cl><span class=s2>  2. æµè§ˆå™¨ç¼“å­˜çš„é—®é¢˜ æŒ‰ç…§ä¸‹é¢æ–¹æ³•è§£å†³
</span></span></span><span class=line><span class=cl><span class=s2>  å³é”® --&gt; æ£€æŸ¥ --&gt; è®¾ç½®å›¾æ ‡(settings) --&gt; Preferences --&gt; Network --&gt; å‹¾é€‰ä¸Š Disable cache(while Devtools is open)
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>é™æ€æ–‡ä»¶åŠ¨æ€è§£æ</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=c>&lt;!-- é™æ€æ–‡ä»¶åŠ¨æ€è§£æ
</span></span></span><span class=line><span class=cl><span class=c>ä½¿ç”¨æ¨¡æ¿è¯­æ³• ä¼šè‡ªåŠ¨è§£æsetting.pyé‡Œé¢é…ç½®çš„ STATIC_URL ç„¶åè‡ªåŠ¨æ‹¼æ¥url
</span></span></span><span class=line><span class=cl><span class=c>e.g: 
</span></span></span><span class=line><span class=cl><span class=c>STATIC_URL = &#39;/static/&#39;
</span></span></span><span class=line><span class=cl><span class=c>url -&gt; /static/bootstrap-3.3.7-dist/js/bootstrap.min.js
</span></span></span><span class=line><span class=cl><span class=c>
</span></span></span><span class=line><span class=cl><span class=c>or
</span></span></span><span class=line><span class=cl><span class=c>
</span></span></span><span class=line><span class=cl><span class=c>STATIC_URL= &#39;/xxx/&#39;
</span></span></span><span class=line><span class=cl><span class=c>url -&gt; /xxx/bootstrap-3.3.7-dist/js/bootstrap.min.js
</span></span></span><span class=line><span class=cl><span class=c>--&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>{% load static %}
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;stylesheet&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;{% static &#39;bootstrap-3.3.7-dist/css/bootstrap.min.css&#39; %}&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;{% static &#39;bootstrap-3.3.7-dist/js/bootstrap.min.js&#39; %}&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>formè¡¨å•</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># formè¡¨å• é»˜è®¤æ˜¯GETæ–¹æ³•è¯·æ±‚æ•°æ®</span>
</span></span><span class=line><span class=cl><span class=c1># ?åé¢çš„å†…å®¹ä¸ºå‚æ•° ä¸å‚ä¸(ä¸å½±å“)è·¯å¾„åŒ¹é…</span>
</span></span><span class=line><span class=cl><span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=mf>127.0.0.1</span><span class=p>:</span><span class=mi>8000</span><span class=o>/</span><span class=n>login</span><span class=o>/</span><span class=err>?</span><span class=n>username</span><span class=o>=</span><span class=n>minho</span><span class=o>&amp;</span><span class=n>password</span><span class=o>=</span><span class=mi>123131313</span>
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>formè¡¨å•actionå‚æ•°
</span></span></span><span class=line><span class=cl><span class=s2>  1. ä¸å†™ é»˜è®¤å‘å½“å‰æ‰€åœ¨çš„urlæäº¤æ•°æ®
</span></span></span><span class=line><span class=cl><span class=s2>  2. å…¨å†™ æŒ‡åé“å§“
</span></span></span><span class=line><span class=cl><span class=s2>  3. åªå†™åç¼€ /login/
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>formè¡¨å•æäº¤æ–¹æ³• æ”¹ä¸ºpostæäº¤æ•°æ® æäº¤ä¼šæŠ¥é”™
</span></span></span><span class=line><span class=cl><span class=s2>  Forbidden (403)
</span></span></span><span class=line><span class=cl><span class=s2>  CSRF verification failed. Request aborted.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>è§£å†³ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>  åœ¨å‰æœŸ æˆ‘ä»¬ä½¿ç”¨djangoæäº¤postè¯·æ±‚çš„æ—¶å€™ éœ€è¦å»é…ç½®æ–‡ä»¶ä¸­æ³¨é‡Šæ‰ä¸€è¡Œä»£ç 
</span></span></span><span class=line><span class=cl><span class=s2>  æ³¨é‡Šæ‰ ä¸­é—´ä»¶é…ç½®ä¸­çš„ CsrfViewMiddleware
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># settings.py</span>
</span></span><span class=line><span class=cl><span class=n>MIDDLEWARE</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.middleware.security.SecurityMiddleware&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.contrib.sessions.middleware.SessionMiddleware&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.middleware.common.CommonMiddleware&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=c1># &#39;django.middleware.csrf.CsrfViewMiddleware&#39;,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.contrib.auth.middleware.AuthenticationMiddleware&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.contrib.messages.middleware.MessageMiddleware&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.middleware.clickjacking.XFrameOptionsMiddleware&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># views.loginå¤„ç†å‡½æ•°</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>login</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># è¿”å›ä¸€ä¸ªç™»å½•ç•Œé¢</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    GETè¯·æ±‚å’ŒPOSTè¯·æ±‚ åº”è¯¥æœ‰ä¸åŒçš„å¤„ç†æœºåˆ¶ -&gt; å¦‚ä½•å¤„ç†?
</span></span></span><span class=line><span class=cl><span class=s2>    å¼•å…¥ä¸‹é¢ requestå¯¹è±¡æ–¹æ³•åˆå§‹ æ¢ç´¢djangoå°è£…çš„requestå¯¹è±¡
</span></span></span><span class=line><span class=cl><span class=s2>    :param request:
</span></span></span><span class=line><span class=cl><span class=s2>    :return:
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;enter login...&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=s1>&#39;login.html&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=requestå¯¹è±¡æ–¹æ³•åˆè¯†>requestå¯¹è±¡æ–¹æ³•åˆè¯†</h3><ul><li><strong>request.method</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>login</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># è¿”å›ä¸€ä¸ªç™»å½•ç•Œé¢</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    GETè¯·æ±‚å’ŒPOSTè¯·æ±‚ åº”è¯¥æœ‰ä¸åŒçš„å¤„ç†æœºåˆ¶ -&gt; å¦‚ä½•å¤„ç†?
</span></span></span><span class=line><span class=cl><span class=s2>    :param request: è¯·æ±‚ç›¸å…³çš„æ•°æ®å¯¹è±¡ é‡Œé¢æœ‰å¾ˆå¤šç®€æ˜“çš„æ–¹æ³•
</span></span></span><span class=line><span class=cl><span class=s2>    :return:
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># è¿”å›è¯·æ±‚æ–¹å¼ å¹¶ä¸”æ˜¯å…¨å¤§å†™çš„å­—ç¬¦ä¸² &lt;class &#39;str&#39;&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(request.method)  </span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    è¿™ç§æ–¹å¼ 2å±‚é€»è¾‘ æ¨èä¸‹ä¸€ç§
</span></span></span><span class=line><span class=cl><span class=s2>    if request.method == &#39;GET&#39;:
</span></span></span><span class=line><span class=cl><span class=s2>        print(&#39;Method GET&#39;)
</span></span></span><span class=line><span class=cl><span class=s2>        return render(request, &#39;login.html&#39;)
</span></span></span><span class=line><span class=cl><span class=s2>    elif request.method == &#39;POST&#39;:
</span></span></span><span class=line><span class=cl><span class=s2>        return HttpResponse(&#34;æ”¶åˆ°äº† POSTè¯·æ±‚&#34;)
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;POST&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;æ”¶åˆ°POST&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=s1>&#39;login.html&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>request.POST</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># è·å–ç”¨æˆ·postè¯·æ±‚æäº¤çš„æ™®é€šæ•°æ®(Form) ä¸åŒ…å«æ–‡ä»¶</span>
</span></span><span class=line><span class=cl><span class=n>request</span><span class=o>.</span><span class=n>POST</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>request</span><span class=o>.</span><span class=n>PSOT</span><span class=o>.</span><span class=n>get</span><span class=p>()</span>      <span class=c1># åªè·å–åˆ—è¡¨æœ€åä¸€ä¸ªå…ƒç´ </span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=o>.</span><span class=n>getlist</span><span class=p>()</span>  <span class=c1># ç›´æ¥å°†æ•´ä¸ªåˆ—è¡¨å–å‡º</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>request.GET</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># è·å–ç”¨æˆ·getè¯·æ±‚æäº¤çš„æ•°æ®</span>
</span></span><span class=line><span class=cl><span class=c1># getè¯·æ±‚æºå¸¦çš„æ•°æ®æ˜¯æœ‰å¤§å°é™åˆ¶çš„ å¤§æ¦‚åªæœ‰4KBå·¦å³</span>
</span></span><span class=line><span class=cl><span class=c1># è€Œpostè¯·æ±‚åˆ™æ²¡æœ‰é™åˆ¶</span>
</span></span><span class=line><span class=cl><span class=n>request</span><span class=o>.</span><span class=n>GET</span>
</span></span><span class=line><span class=cl>  <span class=c1># è·å–åˆ°çš„æ•°æ®ç±»å‹ æ–¹æ³•çš„ä½¿ç”¨ å’Œ request.POST ä¸€æ¨¡ä¸€æ ·</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>request</span><span class=o>.</span><span class=n>GET</span><span class=o>.</span><span class=n>get</span><span class=p>()</span>      <span class=c1># åªè·å–åˆ—è¡¨æœ€åä¸€ä¸ªå…ƒç´ </span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>request</span><span class=o>.</span><span class=n>GET</span><span class=o>.</span><span class=n>getlist</span><span class=p>()</span>  <span class=c1># ç›´æ¥å°†æ•´ä¸ªåˆ—è¡¨å–å‡º</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>login</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># è¿”å›ä¸€ä¸ªç™»å½•ç•Œé¢</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;POST&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>username</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;username&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;æ”¶åˆ°POST&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># æ³¨æ„get å’Œ getlistæ–¹æ³•åŒºåˆ«</span>
</span></span><span class=line><span class=cl>    <span class=n>hobby</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>GET</span><span class=o>.</span><span class=n>getlist</span><span class=p>(</span><span class=s1>&#39;hobby&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=s1>&#39;login.html&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=orm>ORM</h2><h3 id=djangoæœ¬è´¨>Djangoæœ¬è´¨</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Djangoæœ¬è´¨</span>
</span></span><span class=line><span class=cl>Djangoæœ¬èº«ä¸æ˜¯Server<span class=o>(</span>ä¸æ˜¯ nginx or httpd<span class=o>)</span> åªæ˜¯ä¸ªWSGI App å°±æ˜¯ä¸€ä¸ªå¤§å‡½æ•°
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è¯·æ±‚è¿‡ç¨‹</span>
</span></span><span class=line><span class=cl>æµè§ˆå™¨å‘èµ·ä¸€ä¸ªHTTP RequestæŠ¥æ–‡ åˆ°TCPServer<span class=o>(</span>HTTPServer<span class=o>)</span>
</span></span><span class=line><span class=cl>Serveré»˜è®¤ç›‘å¬80 åªä¸è¿‡è¿™ä¸ªServeræ­£å¥½å®ƒèƒ½æä¾›httpè¯·æ±‚æŠ¥æ–‡çš„è§£æå’ŒHttpå“åº”æŠ¥æ–‡çš„å°è£… å°±æ˜¯è¯´Serveræ˜¯HTTP_Server
</span></span><span class=line><span class=cl>å¾—æœ‰ä¸€ä¸ªè°ƒç”¨è€… è°ƒç”¨Djangoå¾—è¿™ä¸ªå‡½æ•° è°ƒç”¨è€…å°±æ˜¯WSGI_Server
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Nginx æŠŠhttpè¯·æ±‚æŠ¥æ–‡ </span>
</span></span><span class=line><span class=cl><span class=o>==</span>&gt; uwsgiè½¯ä»¶/gunicornè½¯ä»¶<span class=o>(</span>è½¯ä»¶æ˜¯WSGI Server<span class=o>)</span> 
</span></span><span class=line><span class=cl><span class=o>==</span>&gt; è§£ææŠ¥æ–‡å¹¶è°ƒç”¨Django Appå¤§å‡½æ•° 
</span></span><span class=line><span class=cl><span class=o>==</span>&gt; å‡½æ•°è¿”å›å€¼
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># request</span>
</span></span><span class=line><span class=cl>--&gt; uwsgi
</span></span><span class=line><span class=cl>--&gt; wsgi.py
</span></span><span class=line><span class=cl>--&gt; application æ³¨å…¥ä¸¤ä¸ªå‚æ•°è°ƒç”¨
</span></span><span class=line><span class=cl>--&gt; application<span class=o>(</span>environ, start_response<span class=o>)</span>
</span></span><span class=line><span class=cl>--&gt; è¿”å›æ­£æ–‡ç»™wsgiå°è£…ä¸ºresponseæŠ¥æ–‡
</span></span><span class=line><span class=cl>--&gt; å‰ç«¯æ˜¾ç¤º
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å‚è€ƒ Djangoä¸­çš„å®ç°</span>
</span></span><span class=line><span class=cl>uwsgiç­‰è½¯ä»¶ è°ƒç”¨çš„å°±æ˜¯django/flaskçš„wsgi.py å¾—åˆ° application 
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>å…¥å£</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># å…¥å£</span>
</span></span><span class=line><span class=cl><span class=n>æ ¹æ®wsgiçš„åŸç†</span> <span class=n>æˆ‘ä»¬çŸ¥é“Djangoå°±æ˜¯APP</span> <span class=n>å…¥å£æ˜¯é¡¹ç›®çš„wsgi</span><span class=o>.</span><span class=n>pyæ–‡ä»¶</span>
</span></span><span class=line><span class=cl><span class=mf>1.</span> <span class=n>è¯·æ±‚requestæ¥äº†å</span> 
</span></span><span class=line><span class=cl><span class=mf>2.</span> <span class=n>äº¤ç»™application</span><span class=p>(</span><span class=n>WSGIHandlerå®ä¾‹</span><span class=p>)</span> 
</span></span><span class=line><span class=cl><span class=mf>3.</span> <span class=n>application</span><span class=p>(</span><span class=n>environ</span><span class=p>,</span> <span class=n>start_response</span><span class=p>)</span><span class=n>è°ƒç”¨</span> 
</span></span><span class=line><span class=cl><span class=mf>4.</span> <span class=n>è°ƒç”¨start_responseåè¿”å›get_responseè¿”å›çš„å“åº”çš„ç»“æœ</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>Djangoä¸­çš„å®ç°</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># wsgi.py</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.core.wsgi</span> <span class=kn>import</span> <span class=n>get_wsgi_application</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=s1>&#39;DJANGO_SETTINGS_MODULE&#39;</span><span class=p>,</span> <span class=s1>&#39;cmdb.settings&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># application å°±æ˜¯é‚£ä¸ªappå¤§å‡½æ•°</span>
</span></span><span class=line><span class=cl><span class=n>application</span> <span class=o>=</span> <span class=n>get_wsgi_application</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=ormå¿«é€Ÿæµ‹è¯•>ORMå¿«é€Ÿæµ‹è¯•</h3><h4 id=æµ‹è¯•è„šæœ¬>æµ‹è¯•è„šæœ¬</h4><p><strong>æ ¹æ®ä¸Šé¢åŸç†å¾—å‡ºä¸‹é¢è¿™ä¸ªè„šæœ¬</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># django é¡¹ç›®ç»Ÿè®¡ç›®å½•åˆ›å»º xx.py</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>django</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=s1>&#39;DJANGO_SETTINGS_MODULE&#39;</span><span class=p>,</span> <span class=s1>&#39;cmdb.settings&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># åŠ è½½djangoé…ç½®</span>
</span></span><span class=line><span class=cl><span class=c1># åœ¨settings.py é…ç½®å¥½æ•°æ®åº“è¿æ¥å³å¯</span>
</span></span><span class=line><span class=cl><span class=n>django</span><span class=o>.</span><span class=n>setup</span><span class=p>(</span><span class=n>set_prefix</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æˆ‘å°±æ˜¯é‚£ä¸ªappå¤§å‡½æ•°</span>
</span></span><span class=line><span class=cl><span class=c1># è¿”å›ä¸€ä¸ªhandlerç±»çš„å®ä¾‹å¤„ç†æ¯ä¸€ä¸ªè¯·æ±‚</span>
</span></span><span class=line><span class=cl><span class=c1># application = get_wsgi_application()</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=é…ç½®settingspy>é…ç½®<code>settings.py</code></h4><p><strong>è¯¦ç»†é…ç½®å‚è€ƒå®˜ç½‘</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># MySQLæ•°æ®åº“é…ç½®</span>
</span></span><span class=line><span class=cl><span class=n>DATABASES</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;default&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;ENGINE&#39;</span><span class=p>:</span> <span class=s1>&#39;django.db.backends.mysql&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;NAME&#39;</span><span class=p>:</span> <span class=s1>&#39;name&#39;</span><span class=p>,</span>  <span class=c1># è¿æ¥çš„æ•°æ®åº“åç§°</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;USER&#39;</span><span class=p>:</span> <span class=s1>&#39;user&#39;</span><span class=p>,</span>  <span class=c1># è¿æ¥ç”¨æˆ·</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;PASSWORD&#39;</span><span class=p>:</span> <span class=s1>&#39;password&#39;</span><span class=p>,</span>  <span class=c1># è¿æ¥å¯†ç </span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;HOST&#39;</span><span class=p>:</span> <span class=s1>&#39;host&#39;</span><span class=p>,</span>  <span class=c1># ä¸»æœºIP</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;PORT&#39;</span><span class=p>:</span> <span class=s1>&#39;3306&#39;</span><span class=p>,</span>  <span class=c1># ç«¯å£</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;CHARSET&#39;</span><span class=p>:</span> <span class=s1>&#39;utf8&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Django ORMéš¾å­¦ é€šè¿‡æ—¥å¿—çœ‹å¯¹åº”SQL</span>
</span></span><span class=line><span class=cl><span class=c1># res.query æˆ–è€…ç›´æ¥è°ƒç”¨è¿”å›å¯¹è±¡çš„ queryæ–¹æ³• å¯ä»¥ç›´æ¥æ‰“å°SQLè¯­å¥</span>
</span></span><span class=line><span class=cl><span class=c1># å…·ä½“loggingæ¨¡å—è¯¦ç»†ä¿¡æ¯ å‚è€ƒPythonæ ‡å‡†åº“æ–‡æ¡£</span>
</span></span><span class=line><span class=cl><span class=n>LOGGING</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;version&#39;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;disable_existing_loggers&#39;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;handlers&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;console&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;class&#39;</span><span class=p>:</span> <span class=s1>&#39;logging.StreamHandler&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;loggers&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1># æœ¬åœ° django 2.1.4åŠä¹‹å‰çš„ç‰ˆæœ¬ è¯¥é…ç½®æ— æ•ˆ æ— æ³•çœ‹åˆ°å¯¹è±¡çš„SQLè¯­å¥ æ˜¾ç¤ºä¸ºNone</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;django.db.backends&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;handlers&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;console&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;level&#39;</span><span class=p>:</span> <span class=s1>&#39;DEBUG&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;propagate&#39;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>mysqlclient or pymysql</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># å¦‚æœè¦ä½¿ç”¨pymysql åœ¨é¡¹ç›®åŒ…æ–‡ä»¶__init__.pyä¸­åŠ å…¥ä¸‹é¢ä»£ç </span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pymysql</span>
</span></span><span class=line><span class=cl><span class=n>pymysql</span><span class=o>.</span><span class=n>install_as_MySQLdb</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>mysqlcilent</span>  <span class=c1># cè¯­è¨€ç¼–å†™ é€Ÿåº¦å¿« æ¨è</span>
</span></span><span class=line><span class=cl><span class=n>pymsyql</span>      <span class=c1># pythonåŸç”Ÿ å…¼å®¹åº¦é«˜</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å¤‡æ³¨ï¼šä½¿ç”¨pymysql å»é¡¹ç›®é…ç½®æ–‡ä»¶æ‰€åœ¨ç›®å½•çš„__init__.pyæ–‡ä»¶åŠ å…¥ä»¥ä¸‹å†…å®¹</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pymysql</span>
</span></span><span class=line><span class=cl><span class=n>pymysql</span><span class=o>.</span><span class=n>install_as_MySQLdb</span><span class=p>()</span> 
</span></span></code></pre></td></tr></table></div></div><p><strong>è®¾ç½®sql_mode</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># è®¾ç½®sql_mode</span>
</span></span><span class=line><span class=cl><span class=c1># https://docs.djangoproject.com/zh-hans/3.1/ref/databases/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s1>&#39;OPTIONS&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;init_command&#34;</span><span class=p>:</span> <span class=s2>&#34;SET sql_mode=&#39;STRICT_TRANS_TABLES&#39;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=ä¾èµ–>ä¾èµ–</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pip install mysqlclient
</span></span></code></pre></td></tr></table></div></div><h3 id=ormåˆè¯†>ORMåˆè¯†</h3><h4 id=ç®€ä»‹>ç®€ä»‹</h4><p><strong>ORM å¯¹è±¡å…³ç³»æ˜ å°„ å¯¹è±¡å’Œå…³ç³»ä¹‹é—´çš„æ˜ å°„ ä½¿ç”¨é¢å‘å¯¹è±¡çš„æ–¹å¼æ¥æ“ä½œæ•°æ®åº“</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># å…³ç³»æ¨¡å‹å’ŒPythonå¯¹è±¡ä¹‹é—´çš„æ˜ å°„</span>
</span></span><span class=line><span class=cl><span class=n>table</span>  <span class=o>=&gt;</span>  <span class=k>class</span>     <span class=err># </span><span class=nc>è¡¨</span> <span class=n>æ˜ å°„ä¸º</span> <span class=n>ç±»</span>
</span></span><span class=line><span class=cl><span class=n>row</span>    <span class=o>=&gt;</span>  <span class=nb>object</span>    <span class=c1># è¡Œ æ˜ å°„ä¸º å®ä¾‹</span>
</span></span><span class=line><span class=cl><span class=n>column</span> <span class=o>=&gt;</span>  <span class=nb>property</span>  <span class=c1># å­—æ®µ æ˜ å°„ä¸º å±æ€§(ç±»å±æ€§)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ä¸è¶³</span>
</span></span><span class=line><span class=cl><span class=n>å°è£…ç¨‹åº¦å¤ªé«˜</span> <span class=n>æœ‰æ—¶å€™sqlè¯­å¥çš„æ•ˆç‡åä½</span> <span class=n>éœ€è¦ä½ è‡ªå·±å†™SQLè¯­å¥</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>å®ä¾‹</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># æè¿°</span>
</span></span><span class=line><span class=cl><span class=n>è¡¨å</span><span class=err>ï¼š</span><span class=n>student</span>
</span></span><span class=line><span class=cl><span class=n>å­—æ®µ</span><span class=o>-</span><span class=n>ç±»å‹</span><span class=err>ï¼š</span>
</span></span><span class=line><span class=cl> <span class=o>-</span> <span class=nb>id</span><span class=o>-</span><span class=nb>int</span>  
</span></span><span class=line><span class=cl> <span class=o>-</span> <span class=n>name</span><span class=o>-</span><span class=n>varchar</span> 
</span></span><span class=line><span class=cl> <span class=o>-</span> <span class=n>age</span><span class=o>-</span><span class=nb>int</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=c1># åˆ°Pythonæ˜ å°„</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Student</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>id</span> <span class=o>=</span> <span class=err>?</span><span class=n>æŸå­—æ®µç±»å‹</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span> <span class=o>=</span> <span class=err>?</span><span class=n>æŸå­—æ®µç±»å‹</span>
</span></span><span class=line><span class=cl>    <span class=n>age</span> <span class=o>=</span> <span class=err>?</span><span class=n>æŸå­—æ®µç±»å‹</span>
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl><span class=c1># æœ€ç»ˆå¾—åˆ°çš„å®ä¾‹</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Student</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>id</span> <span class=o>=</span> <span class=err>?</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=err>?</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>age</span> <span class=o>=</span> <span class=err>?</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=åˆ›å»ºmodelç±»>åˆ›å»ºmodelç±»</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># å»åº”ç”¨ä¸‹é¢çš„ models.py æ–‡ä»¶</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.db</span> <span class=kn>import</span> <span class=n>models</span>
</span></span><span class=line><span class=cl><span class=c1># Create your models here.</span>
</span></span><span class=line><span class=cl><span class=c1># modelç±» ç¼–å†™</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>User</span><span class=p>(</span><span class=n>models</span><span class=o>.</span><span class=n>Model</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>id</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>AutoField</span><span class=p>(</span><span class=n>primary_key</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>  <span class=c1># id int primary_key auto_increment</span>
</span></span><span class=line><span class=cl>    <span class=n>username</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span><span class=o>=</span><span class=mi>32</span><span class=p>)</span>  <span class=c1># username varchar(32)</span>
</span></span><span class=line><span class=cl>    <span class=n>password</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>IntegerField</span><span class=p>()</span>  <span class=c1># password int</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Author</span><span class=p>(</span><span class=n>models</span><span class=o>.</span><span class=n>Model</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    django ormå½“ä½ ä¸å®šä¹‰ä¸»é”®å­—æ®µçš„æ—¶å€™ ormä¼šè‡ªåŠ¨å¸®ä½ åˆ›å»ºä¸€ä¸ªåä¸ºidçš„ä¸»é”®å­—æ®µ
</span></span></span><span class=line><span class=cl><span class=s2>    åç»­æˆ‘ä»¬åœ¨åˆ›å»ºæ¨¡å‹è¡¨çš„æ—¶å€™ å¦‚æœä¸»é”®å­—æ®µåæ²¡æœ‰é¢å¤–çš„å«æ³• é‚£ä¹ˆä¸»é”®å­—æ®µå¯ä»¥çœç•¥ä¸å†™ ormå¸®æˆ‘ä»¬è¡¥
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>username</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span><span class=o>=</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>password</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>IntegerField</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=æ•°æ®åº“è¿ç§»>æ•°æ®åº“è¿ç§»</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># æ•°æ®åº“è¿ç§»å‘½ä»¤</span>
</span></span><span class=line><span class=cl><span class=c1># åªè¦ä½ ä¿®æ”¹äº†models.pyä¸­è·Ÿ **æ•°æ®åº“** ç›¸å…³çš„ä»£ç  å°±å¿…é¡»é‡æ–°æ‰§è¡Œä¸‹é¢ä¸¤æ¡å‘½ä»¤</span>
</span></span><span class=line><span class=cl>$ python manage.py makemigrations    <span class=c1># å°†æ“ä½œè®°å½•åŸºç¡€å‡ºæ¥(migrationsæ–‡ä»¶å¤¹)</span>
</span></span><span class=line><span class=cl>$ python manage.py migrate  <span class=c1># å°†æ“ä½œçœŸæ­£çš„åŒæ­¥åˆ°æ•°æ®åº“ä¸­</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=å­—æ®µç±»å‹>å­—æ®µç±»å‹</h4><p><a class=link href=https://docs.djangoproject.com/zh-hans/3.1/ref/models/fields/ target=_blank rel=noopener>DjangoORMå­—æ®µç±»å‹å‚è€ƒ</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>CharField</span>     <span class=c1># å¿…é¡»è¦æŒ‡å®š max_lengthå‚æ•° ä¸æŒ‡å®šä¼šç›´æ¥æŠ¥é”™</span>
</span></span><span class=line><span class=cl><span class=n>verbose_name</span>  <span class=c1># è¯¥å‚æ•°æ˜¯æ‰€æœ‰å­—æ®µéƒ½æœ‰çš„ ç”¨æ¥å¯¹å­—æ®µçš„è§£é‡Š</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=å­—æ®µçš„å¢åˆ æ”¹æŸ¥>å­—æ®µçš„å¢åˆ æ”¹æŸ¥</h3><h4 id=å­—æ®µçš„å¢åŠ >å­—æ®µçš„å¢åŠ </h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># ç»™è¡¨å¢åŠ å­—æ®µçš„æ—¶å€™ è¡¨é‡Œé¢å·²ç»æœ‰æ•°æ®çš„æƒ…å†µ</span>
</span></span><span class=line><span class=cl><span class=c1># **å¢åŠ å¤–é”®å­—æ®µçš„æ—¶å€™ ç»™çš„é»˜è®¤å€¼ éœ€è¦å…ˆåœ¨å¯¹åº”è¡¨ä¸­å­˜åœ¨ å¦åˆ™è¿ç§»æŠ¥é”™**</span>
</span></span><span class=line><span class=cl><span class=mf>1.</span> <span class=n>å¯ä»¥åœ¨ç»ˆç«¯å†…ç›´æ¥ç»™å‡ºé»˜è®¤å€¼</span> <span class=n>djangoå‘½ä»¤è¡Œä¼šåœ¨ç»ˆç«¯ç»™å‡ºé€‰æ‹©</span>
</span></span><span class=line><span class=cl>    <span class=err>$</span> <span class=n>You</span> <span class=n>are</span> <span class=n>trying</span> <span class=n>to</span> <span class=n>add</span> <span class=n>a</span> <span class=n>non</span><span class=o>-</span><span class=n>nullable</span> <span class=n>field</span> <span class=s1>&#39;age&#39;</span> <span class=n>to</span> <span class=n>user</span> <span class=n>without</span> <span class=n>a</span> <span class=n>default</span><span class=p>;</span> <span class=n>we</span> <span class=n>can</span><span class=s1>&#39;t do that (the database needs something to populate exi</span>
</span></span><span class=line><span class=cl>    <span class=n>sting</span> <span class=n>rows</span><span class=p>)</span><span class=o>.</span>
</span></span><span class=line><span class=cl>    <span class=err>$</span> <span class=n>Please</span> <span class=n>select</span> <span class=n>a</span> <span class=n>fix</span><span class=p>:</span>
</span></span><span class=line><span class=cl>     <span class=mi>1</span><span class=p>)</span> <span class=n>Provide</span> <span class=n>a</span> <span class=n>one</span><span class=o>-</span><span class=n>off</span> <span class=n>default</span> <span class=n>now</span> <span class=p>(</span><span class=n>will</span> <span class=n>be</span> <span class=nb>set</span> <span class=n>on</span> <span class=nb>all</span> <span class=n>existing</span> <span class=n>rows</span> <span class=k>with</span> <span class=n>a</span> <span class=n>null</span> <span class=n>value</span> <span class=k>for</span> <span class=n>this</span> <span class=n>column</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=mi>2</span><span class=p>)</span> <span class=n>Quit</span><span class=p>,</span> <span class=ow>and</span> <span class=n>let</span> <span class=n>me</span> <span class=n>add</span> <span class=n>a</span> <span class=n>default</span> <span class=ow>in</span> <span class=n>models</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>2.</span> <span class=n>è®¾ç½®è¯¥å­—æ®µå¯ä»¥ä¸ºç©º</span><span class=p>(</span><span class=n>æ ¹æ®å®é™…æƒ…å†µè€ƒè™‘</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>info</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span> <span class=n>verbose_name</span><span class=o>=</span><span class=s1>&#39;ä¸ªäººç®€ä»‹&#39;</span><span class=p>,</span> <span class=n>null</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=mf>3.</span> <span class=n>ç›´æ¥ç»™å­—æ®µè®¾ç½®é»˜è®¤å€¼</span>
</span></span><span class=line><span class=cl>    <span class=n>hobby</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span> <span class=n>verbose_name</span><span class=o>=</span><span class=s1>&#39;çˆ±å¥½&#39;</span><span class=p>,</span> <span class=n>null</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=s1>&#39;study&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=å­—æ®µçš„ä¿®æ”¹>å­—æ®µçš„ä¿®æ”¹</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># models.py ä¿®æ”¹å ç›´æ¥æ‰§è¡Œè¿ç§»å‘½ä»¤å³å¯ï¼š</span>
</span></span><span class=line><span class=cl>$ python manage.py makemigrations
</span></span><span class=line><span class=cl>$ python manage.py migrate
</span></span></code></pre></td></tr></table></div></div><h4 id=å­—æ®µçš„åˆ é™¤>å­—æ®µçš„åˆ é™¤</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># ç›´æ¥æ³¨é‡Šå¯¹åº”çš„å­—æ®µ ç„¶åç›´æ¥æ‰§è¡Œè¿ç§»å‘½ä»¤å³å¯</span>
</span></span><span class=line><span class=cl><span class=err>$</span> <span class=n>python</span> <span class=n>manage</span><span class=o>.</span><span class=n>py</span> <span class=n>makemigrations</span>
</span></span><span class=line><span class=cl><span class=err>$</span> <span class=n>python</span> <span class=n>manage</span><span class=o>.</span><span class=n>py</span> <span class=n>migrate</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ¯”è¾ƒä¸¥é‡çš„é—®é¢˜</span>
</span></span><span class=line><span class=cl><span class=n>è¿ç§»å‘½ä»¤æ‰§è¡Œå®Œæ¯•ä¹‹å</span> <span class=n>æ•°æ®åº“å¯¹åº”çš„æ•°æ®ä¹Ÿä¼šè¢«åˆ é™¤</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># **æ³¨æ„**</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>åœ¨æ“ä½œmodels.pyçš„æ—¶å€™ ä¸€å®šè¦ç»†å¿ƒ
</span></span></span><span class=line><span class=cl><span class=s2>  - åƒä¸‡ä¸è¦éšæ„æ³¨é‡Šä¸€äº›å­—æ®µ
</span></span></span><span class=line><span class=cl><span class=s2>  - æ‰§è¡Œè¿ç§»å‘½ä»¤ä¹‹å‰ æœ€å¥½å…ˆæ£€æŸ¥ä¸‹è‡ªå·±å†™çš„ä»£ç 
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ä¸ªäººå»ºè®®ï¼š å½“ä½ ç¦»å¼€ä½ çš„è®¡ç®—æœºä¹‹å ä¸€å®šè¦é”å±</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ•°æ®çš„å¢åˆ æ”¹æŸ¥>æ•°æ®çš„å¢åˆ æ”¹æŸ¥</h3><p><a class=link href=https://docs.djangoproject.com/zh-hans/3.1/ref/models/querysets/ target=_blank rel=noopener>QuerySet API å‚è€ƒ</a></p><h4 id=æŸ¥>æŸ¥</h4><p><a class=link href=https://docs.djangoproject.com/zh-hans/3.1/ref/models/querysets/#filter target=_blank rel=noopener>QuerySet.filter</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># æŸ¥</span>
</span></span><span class=line><span class=cl><span class=n>models</span><span class=o>.</span><span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>username</span><span class=o>=</span><span class=n>username</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>è¿”å›å€¼å¯ä»¥å…ˆçœ‹æˆæ˜¯åˆ—è¡¨å¥—æ•°æ®å¯¹è±¡çš„æ ¼å¼
</span></span></span><span class=line><span class=cl><span class=s2>å®ƒä¹Ÿæ”¯æŒç´¢å¼•å–å€¼ åˆ‡ç‰‡æ“ä½œ ä½†æ˜¯ä¸æ”¯æŒè´Ÿç´¢å¼•
</span></span></span><span class=line><span class=cl><span class=s2>å®ƒä¹Ÿä¸æ¨èä½ ä½¿ç”¨ç´¢å¼•çš„æ–¹å¼å–å€¼
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>models.User.objects.filter(username=username)[0]
</span></span></span><span class=line><span class=cl><span class=s2>models.User.objects.filter(username=username).first()
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ç®€å•ç™»å½•åŠŸèƒ½å®ç° ä½¿ç”¨ ORM æŸ¥è¯¢</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>login</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;POST&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># è·å–ç”¨æˆ·æäº¤çš„ç”¨æˆ·åå’Œå¯†ç  åˆ©ç”¨orm æ ¡éªŒæ•°æ®</span>
</span></span><span class=line><span class=cl>        <span class=n>username</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;username&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>password</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;password&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># å»æ•°æ®åº“æŸ¥è¯¢æ•°æ®</span>
</span></span><span class=line><span class=cl>        <span class=kn>from</span> <span class=nn>app01</span> <span class=kn>import</span> <span class=n>models</span>
</span></span><span class=line><span class=cl>        <span class=n>user_obj</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>username</span><span class=o>=</span><span class=n>username</span><span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>user_obj</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># æ¯”å¯¹å¯†ç æ˜¯å¦ä¸€è‡´</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>password</span> <span class=o>==</span> <span class=n>user_obj</span><span class=o>.</span><span class=n>password</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;Login Success&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;Login Failed, Password Error&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;ç”¨æˆ·ä¸å­˜åœ¨&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=s1>&#39;login.html&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=å¢>å¢</h4><p><a class=link href=https://docs.djangoproject.com/zh-hans/3.1/ref/models/querysets/#create target=_blank rel=noopener>QuerySet.create</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># create è¿”å›å½“å‰è¢«åˆ›å»ºçš„å¯¹è±¡æœ¬èº«</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>create</span><span class=p>(</span><span class=n>username</span><span class=o>=</span><span class=n>username</span><span class=p>,</span> <span class=n>password</span><span class=o>=</span><span class=n>password</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å®ä¾‹åŒ–å¯¹è±¡ è°ƒç”¨saveæ–¹æ³•</span>
</span></span><span class=line><span class=cl><span class=n>user_obj</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>User</span><span class=p>(</span><span class=n>username</span><span class=o>=</span><span class=n>username</span><span class=p>,</span> <span class=n>password</span><span class=o>=</span><span class=n>password</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>user_obj</span><span class=o>.</span><span class=n>save</span><span class=p>()</span>  <span class=c1># ä¿å­˜æ•°æ®</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=æ”¹>æ”¹</h4><p><a class=link href=https://docs.djangoproject.com/zh-hans/3.1/ref/models/querysets/#django.db.models.query.QuerySet.update target=_blank rel=noopener>QuerySet.update</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># å…ˆå°†æ•°æ®åº“ä¸­çš„æ•°æ®å…¨éƒ¨å±•ç¤ºåˆ°å‰ç«¯ ç„¶åç»™æ¯ä¸€ä¸ªæ•°æ®2ä¸ªæŒ‰é’® ä¸€ä¸ªç¼–è¾‘ä¸€ä¸ªåˆ é™¤</span>
</span></span><span class=line><span class=cl><span class=n>ef</span> <span class=n>userlist</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># æŸ¥è¯¢ç”¨æˆ·è¡¨é‡Œé¢ æ‰€æœ‰çš„æ•°æ®</span>
</span></span><span class=line><span class=cl>    <span class=c1># æ–¹å¼1 ä¸æ¨è</span>
</span></span><span class=line><span class=cl>    <span class=c1># data = models.User.objects.filter()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># æ–¹å¼2</span>
</span></span><span class=line><span class=cl>    <span class=n>user_queryset</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>all</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=s1>&#39;userlist.html&#39;</span><span class=p>,</span> <span class=p>{</span><span class=s1>&#39;user_info&#39;</span><span class=p>:</span> <span class=n>user_queryset</span><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ç¼–è¾‘åŠŸèƒ½</span>
</span></span><span class=line><span class=cl>  <span class=mf>1.</span> <span class=n>ç‚¹å‡»ç¼–è¾‘æŒ‰é’®æœåç«¯å‘é€ç¼–è¾‘æ•°æ®çš„è¯·æ±‚</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>  Q: å¦‚ä½•å‘Šè¯‰åç«¯ ç”¨æˆ·æƒ³è¦ç¼–è¾‘å“ªæ¡æ•°æ®?
</span></span></span><span class=line><span class=cl><span class=s2>  A: å°†ç¼–è¾‘æŒ‰é’®æ‰€åœ¨çš„å“ªä¸€è¡Œæ•°æ®çš„ ä¸»é”®å€¼ å‘é€ç»™åç«¯ -- å”¯ä¸€ç¡®å®šå€¼
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>  Q: å¦‚ä½•å‘é€ä¸»é”®å€¼?
</span></span></span><span class=line><span class=cl><span class=s2>  A: &lt;a&gt; href=&#34;/edit_user/?user_id={{ user.id }}&#34; &lt;/a&gt;
</span></span></span><span class=line><span class=cl><span class=s2>     åˆ©ç”¨urlé—®å·åé¢æºå¸¦å‚æ•°çš„æ–¹å¼ ä¼ ä¸»é”®å€¼ç»™åç«¯è·å–
</span></span></span><span class=line><span class=cl><span class=s2>  &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=mf>2.</span> <span class=n>åç«¯æŸ¥è¯¢å‡ºç”¨æˆ·æƒ³è¦ç¼–è¾‘çš„æ•°æ®å¯¹è±¡</span> <span class=n>å±•ç¤ºåˆ°å‰ç«¯é¡µé¢ä¾›ç”¨æˆ·æŸ¥çœ‹å’Œç¼–è¾‘</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=c1># view ä»£ç å®ç°</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>userlist</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># æŸ¥è¯¢ç”¨æˆ·è¡¨é‡Œé¢ æ‰€æœ‰çš„æ•°æ®</span>
</span></span><span class=line><span class=cl>    <span class=c1># æ–¹å¼1 ä¸æ¨è</span>
</span></span><span class=line><span class=cl>    <span class=c1># data = models.User.objects.filter()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># æ–¹å¼2</span>
</span></span><span class=line><span class=cl>    <span class=n>user_queryset</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>all</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=s1>&#39;userlist.html&#39;</span><span class=p>,</span> <span class=p>{</span><span class=s1>&#39;user_info&#39;</span><span class=p>:</span> <span class=n>user_queryset</span><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>edit_user</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># è·å–urlé—®å·åé¢æºå¸¦çš„å‚æ•° href=&#34;/edit_user/?user_id={{ user.id }}&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>user_id</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>GET</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;user_id&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># æŸ¥è¯¢å½“å‰ç”¨æˆ·æƒ³è¦ç¼–è¾‘çš„æ•°æ®å¯¹è±¡</span>
</span></span><span class=line><span class=cl>    <span class=n>user_obj</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=nb>id</span><span class=o>=</span><span class=n>user_id</span><span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;POST&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>username</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;username&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>password</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;password&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># å¦‚æœæ˜¯postæäº¤ å»æ•°æ®åº“ä¿®æ”¹å¯¹è±¡çš„æ•°æ®å†…å®¹</span>
</span></span><span class=line><span class=cl>        <span class=c1># ä¿®æ”¹æ–¹å¼1</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        å°†filteræŸ¥è¯¢å‡ºæ¥çš„åˆ—è¡¨ä¸­æ‰€æœ‰çš„å¯¹è±¡å…¨éƒ¨æ›´æ–° æ‰¹é‡æ›´æ–°æ“ä½œ
</span></span></span><span class=line><span class=cl><span class=s2>        åªä¼šä¿®æ”¹è¢«ä¿®æ”¹çš„å­—æ®µ
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># models.User.objects.filter(id=user_id).update(username=username, password=password)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># ä¿®æ”¹æ–¹å¼2</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        è¯¥æ–¹å¼ å½“å­—æ®µéå¸¸å¤šçš„æ—¶å€™ æ•ˆç‡ä¼šç‰¹åˆ«çš„ä½
</span></span></span><span class=line><span class=cl><span class=s2>        ä»å¤´åˆ°å°¾å°†æ•°æ®çš„æ‰€æœ‰å­—æ®µå…¨éƒ¨æ›´æ–°ä¸€é æ— è®ºè¯¥å­—æ®µæ˜¯å¦è¢«ä¿®æ”¹
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>user_obj</span><span class=o>.</span><span class=n>username</span> <span class=o>=</span> <span class=n>username</span>
</span></span><span class=line><span class=cl>        <span class=n>user_obj</span><span class=o>.</span><span class=n>password</span> <span class=o>=</span> <span class=n>password</span>
</span></span><span class=line><span class=cl>        <span class=n>user_obj</span><span class=o>.</span><span class=n>save</span><span class=p>()</span>  <span class=c1># å†…éƒ¨è‡ªåŠ¨è¯†åˆ« ä¸æ˜¯ä¿å­˜ è€Œä¸”æ›´æ–°</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># è·³è½¬åˆ°æ•°æ®çš„å±•ç¤ºé¡µé¢</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=s1>&#39;/userlist/&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># å°†æ•°æ®å¯¹è±¡å±•ç¤ºåˆ°é¡µé¢ä¸Š</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=s1>&#39;edit_user.html&#39;</span><span class=p>,</span> <span class=p>{</span><span class=s1>&#39;user_info&#39;</span><span class=p>:</span> <span class=n>user_obj</span><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=åˆ >åˆ </h4><p><a class=link href=https://docs.djangoproject.com/zh-hans/3.1/ref/models/querysets/#django.db.models.query.QuerySet.delete target=_blank rel=noopener>QeurySet.delete</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># åˆ é™¤åŠŸèƒ½</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>è·Ÿç¼–è¾‘åŠŸèƒ½é€»è¾‘ç±»ä¼¼
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>del_user</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># è·å–ç”¨æˆ·æƒ³è¦åˆ é™¤çš„æ•°æ®idå€¼</span>
</span></span><span class=line><span class=cl>    <span class=n>user_id</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>GET</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;user_id&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># ç›´æ¥å»æ•°æ®åº“ä¸­æ‰¾åˆ°å¯¹åº”çš„æ•°æ® åˆ é™¤å³å¯</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;delete æ‰¹é‡åˆ é™¤&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>models</span><span class=o>.</span><span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=nb>id</span><span class=o>=</span><span class=n>user_id</span><span class=p>)</span><span class=o>.</span><span class=n>delete</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=c1># è·³è½¬åˆ°å±•ç¤ºé¡µé¢</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=s1>&#39;/userlist/&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ•°æ®åˆ é™¤ æœ€å¥½ä¸è¦çœŸæ­£çš„åˆ é™¤ æ·»åŠ  is_deleteå­—æ®µ</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>çœŸæ­£çš„åˆ é™¤åŠŸèƒ½ éœ€è¦äºŒæ¬¡ç¡®è®¤
</span></span></span><span class=line><span class=cl><span class=s2>åˆ é™¤æ•°æ®å†…éƒ¨å…¶å®å¹¶ä¸æ˜¯çœŸæ­£çš„åˆ é™¤ æˆ‘ä»¬ä¼šè¢«æ•°æ®æ·»åŠ ä¸€ä¸ªæ ‡è¯†å­—æ®µ ç”¨æ¥è¡¨ç¤ºå½“å‰æ•°æ®æ˜¯å¦è¢«åˆ é™¤ 
</span></span></span><span class=line><span class=cl><span class=s2>å¦‚æœæ•°æ®è¢«åˆ é™¤ ä»…ä»…æ˜¯å°†å­—æ®µä¿®æ”¹ä¸€ä¸‹çŠ¶æ€
</span></span></span><span class=line><span class=cl><span class=s2>å±•ç¤ºçš„æ—¶å€™ ç­›é€‰ä¸€ä¸‹è¯¥å­—æ®µå³å¯
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>username    password    is_delete
</span></span></span><span class=line><span class=cl><span class=s2>minho        123         0
</span></span></span><span class=line><span class=cl><span class=s2>karubin      123         1
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>æ•°æ®å€¼é’± åˆ é™¤å±é™©ä¸”æµªè´¹ ä¸€èˆ¬æƒ…å†µä¸‹ åˆ‡è®°ä¸è¦çœŸæ­£çš„å»åˆ é™¤æ•°æ®
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=ormåˆ›å»ºè¡¨å…³ç³»>ormåˆ›å»ºè¡¨å…³ç³»</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>è¡¨ä¸è¡¨ä¹‹é—´çš„å…³ç³»
</span></span></span><span class=line><span class=cl><span class=s2>  - ä¸€å¯¹å¤š
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>  - å¤šå¯¹å¤š
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>  - ä¸€å¯¹ä¸€
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>åˆ¤æ–­è¡¨å…³ç³»çš„æ–¹æ³•ï¼šæ¢ä½æ€è€ƒ
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>e</span><span class=o>.</span><span class=n>g</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=n>å›¾ä¹¦è¡¨</span> <span class=n>book</span>
</span></span><span class=line><span class=cl><span class=nb>id</span>    <span class=n>title</span>    <span class=n>price</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>     <span class=n>django</span>   <span class=mf>213.12</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>     <span class=n>flask</span>    <span class=mf>123.33</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>     <span class=n>c</span><span class=o>++</span>      <span class=mf>89.08</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>å‡ºç‰ˆç¤¾è¡¨</span> <span class=n>publish</span>
</span></span><span class=line><span class=cl><span class=nb>id</span>      <span class=n>name</span>     <span class=n>address</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>     <span class=n>ä¸Šæµ·å‡ºç‰ˆç¤¾</span>   <span class=n>ä¸Šæµ·</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>     <span class=n>åŒ—äº¬å‡ºç‰ˆç¤¾</span>   <span class=n>åŒ—äº¬</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ä½œè€…è¡¨</span> <span class=n>author</span>
</span></span><span class=line><span class=cl><span class=nb>id</span>    <span class=n>name</span>    <span class=n>age</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>     <span class=n>minho</span>   <span class=mi>25</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>     <span class=n>kimi</span>    <span class=mi>37</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>book2author</span>
</span></span><span class=line><span class=cl><span class=nb>id</span>  <span class=n>book_id</span>  <span class=n>author_id</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>    <span class=mi>1</span>            <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>    <span class=mi>1</span>            <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>    <span class=mi>2</span>            <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>    <span class=mi>3</span>            <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>å›¾ä¹¦å’Œå‡ºç‰ˆç¤¾ ä¸€å¯¹å¤šçš„å…³ç³» å¤–é”®å­—æ®µå»ºåœ¨å¤šçš„é‚£ä¸€æ–¹-book
</span></span></span><span class=line><span class=cl><span class=s2>å›¾ä¹¦å’Œä½œè€…   å¤šå¯¹å¤šå…³ç³»  åˆ›å»ºç¬¬ä¸‰å¼ è¡¨æ¥ä¸“é—¨å­˜å‚¨-book2author
</span></span></span><span class=line><span class=cl><span class=s2>ä¸€å¯¹ä¸€ åº”ç”¨åœºæ™¯ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>  - æ‹†è¡¨ (ä½œè€…è¡¨ ä¸ ä½œè€…è¯¦æƒ…è¡¨æ˜¯ä¸€å¯¹ä¸€)
</span></span></span><span class=line><span class=cl><span class=s2>    - ä½œè€…è¡¨
</span></span></span><span class=line><span class=cl><span class=s2>    - ä½œè€…è¯¦æƒ…è¡¨
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p><a class=link href=https://docs.djangoproject.com/zh-hans/3.1/ref/models/fields/#django.db.models.ForeignKey target=_blank rel=noopener>ä¸€å¯¹å¤šForeignKey</a></p><p><a class=link href=https://docs.djangoproject.com/zh-hans/3.1/ref/models/fields/#manytomanyfield target=_blank rel=noopener>å¤šå¯¹å¤šManyToManyField</a></p><p><a class=link href=https://docs.djangoproject.com/zh-hans/3.1/ref/models/fields/#onetoonefield target=_blank rel=noopener>ä¸€å¯¹ä¸€OneToOneField</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.db</span> <span class=kn>import</span> <span class=n>models</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create your models here.</span>
</span></span><span class=line><span class=cl><span class=c1># åˆ›å»ºè¡¨å…³ç³» å…ˆå°†åŸºè¡¨åˆ›å»ºå‡ºæ¥ ç„¶åå†æ·»åŠ å¤–é”®å­—æ®µ</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Book</span><span class=p>(</span><span class=n>models</span><span class=o>.</span><span class=n>Model</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>title</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span><span class=o>=</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>price</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>DecimalField</span><span class=p>(</span><span class=n>max_digits</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span> <span class=n>decimal_places</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>  <span class=c1># å°æ•°æ€»å…±8ä½ å°æ•°ç‚¹åé¢å 2ä½</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    å›¾ä¹¦å’Œå‡ºç‰ˆç¤¾æ˜¯ä¸€å¯¹å¤š å¹¶ä¸”ä¹¦æ˜¯å¤šçš„ä¸€æ–¹ æ‰€ä»¥å¤–é”®å­—æ®µæ”¾åœ¨bookè¡¨é‡Œé¢
</span></span></span><span class=line><span class=cl><span class=s2>    å¦‚æœå­—æ®µå¯¹åº”çš„æ˜¯ForeignKey é‚£ä¹ˆORMä¼šè‡ªåŠ¨åœ¨å­—æ®µåé¢åŠ _id -&gt; publish_id
</span></span></span><span class=line><span class=cl><span class=s2>    åé¢å®šä¹‰ForeignKeyçš„æ—¶å€™ ä¸è¦è‡ªå·±åŠ _id
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>publish</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>ForeignKey</span><span class=p>(</span><span class=n>to</span><span class=o>=</span><span class=s1>&#39;Publish&#39;</span><span class=p>)</span>  <span class=c1># é»˜è®¤å°±æ˜¯ä¸å‡ºç‰ˆç¤¾è¡¨çš„ä¸»é”®å­—æ®µåšå¤–é”®å…³è” å¯ä»¥é€šè¿‡to_fieldè®¾ç½®</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    å›¾ä¹¦å’Œä½œè€…æ˜¯å¤šå¯¹å¤šå…³ç³» å¤–é”®å­—æ®µå»ºåœ¨ä»»æ„ä¸€æ–¹å‡å¯ ä½†æ˜¯æ¨èåˆ›å»ºå†æŸ¥è¯¢é¢‘ç‡è¾ƒé«˜çš„ä¸€æ–¹ (æŸ¥è¯¢æ–¹ä¾¿)
</span></span></span><span class=line><span class=cl><span class=s2>    authorsæ˜¯ä¸€ä¸ªè™šæ‹Ÿå­—æ®µ ä¸»è¦æ˜¯ç”¨æ¥é«˜é€ŸORM ä¹¦ç±è¡¨ å’Œ ä½œè€…è¡¨ æ˜¯å¤šå¯¹å¤šå…³ç³» è®©ORMè‡ªåŠ¨å¸®ä½ åˆ›å»ºç¬¬ä¸‰å¼ è¡¨å…³ç³»
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    django 1.x è‡ªåŠ¨çº§è”æ›´æ–°åˆ é™¤ 2.x 3.xéœ€è¦åŠ å‚æ•°
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>authors</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>ManyToManyField</span><span class=p>(</span><span class=n>to</span><span class=o>=</span><span class=s1>&#39;Author&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Publish</span><span class=p>(</span><span class=n>models</span><span class=o>.</span><span class=n>Model</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span><span class=o>=</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>address</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span><span class=o>=</span><span class=mi>64</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Author</span><span class=p>(</span><span class=n>models</span><span class=o>.</span><span class=n>Model</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span><span class=o>=</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>age</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>IntegerField</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    ä½œè€…ä¸ä½œè€…è¯¦æƒ…æ˜¯ä¸€å¯¹ä¸€å…³ç³» å¤–é”®å­—æ®µå»ºåœ¨ä»»æ„ä¸€æ–¹éƒ½å¯ä»¥ ä½†æ˜¯æ¨èåˆ›å»ºåœ¨æŸ¥è¯¢é¢‘ç‡è¾ƒé«˜çš„è¡¨ä¸­
</span></span></span><span class=line><span class=cl><span class=s2>    OneToOneField ä¹Ÿä¼šè‡ªåŠ¨ç»™å­—æ®µåŠ _idåç¼€
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>author_detail</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>OneToOneField</span><span class=p>(</span><span class=n>to</span><span class=o>=</span><span class=s1>&#39;AuthorDetail&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>AuthorDetail</span><span class=p>(</span><span class=n>models</span><span class=o>.</span><span class=n>Model</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>phone</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>BigIntegerField</span><span class=p>()</span>  <span class=c1># æ‰‹æœºå· æˆ–è€…ç›´æ¥ç”¨å­—ç¬¦ç±»å‹</span>
</span></span><span class=line><span class=cl>    <span class=n>address</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span><span class=o>=</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>ORMä¸­å¦‚ä½•å®šä¹‰ä¸‰ç§å…³ç³»
</span></span></span><span class=line><span class=cl><span class=s2>  ä¸€å¯¹å¤šï¼špublish = models.ForeignKey(to=&#39;Publish&#39;)
</span></span></span><span class=line><span class=cl><span class=s2>  å¤šå¯¹å¤šï¼šauthors = models.ManyToManyField(to=&#39;Author&#39;)
</span></span></span><span class=line><span class=cl><span class=s2>  ä¸€å¯¹ä¸€ï¼šauthor_detail = models.OneToOneField(to=&#39;AuthorDetail&#39;)
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>  ForeignKey å’Œ OneToOneFieldå…³ç³»å­—æ®µ ä¼šè‡ªåŠ¨åœ¨å­—æ®µåé¢åŠ _idåç¼€
</span></span></span><span class=line><span class=cl><span class=s2>  ManyToManyFieldå…³ç³»å­—æ®µ ä¼šè‡ªåŠ¨åˆ›å»ºç¬¬ä¸‰å¼ å…³ç³»å¯¹åº”è¡¨ æ— éœ€æˆ‘ä»¬æ‰‹åŠ¨åˆ›å»º
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ³¨æ„</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>1. åœ¨django1.xç‰ˆæœ¬ä¸­ å¤–é”®é»˜è®¤éƒ½æ˜¯çº§è”æ›´æ–°åˆ é™¤çš„
</span></span></span><span class=line><span class=cl><span class=s2>2. å¤šå¯¹å¤šçš„è¡¨å…³ç³»å¯ä»¥æœ‰å¥½å‡ ç§(ä¸‰ç§)åˆ›å»ºæ–¹å¼ è¿™é‡Œåªæ˜¯å…¶ä¸­ä¸€ç§
</span></span></span><span class=line><span class=cl><span class=s2>3. é’ˆå¯¹å¤–é”®å­—æ®µé‡Œé¢çš„å…¶ä»–å‚æ•° æš‚æ—¶ä¸åšè€ƒè™‘ è¯¦æƒ…å¯ä»¥å‚è€ƒä¸Šé¢å®˜ç½‘é“¾æ¥
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=å¤šå¯¹å¤šçš„ä¸‰ç§åˆ›å»ºå…³ç³»>å¤šå¯¹å¤šçš„ä¸‰ç§åˆ›å»ºå…³ç³»</h4><p><strong>éœ€è¦æŒæ¡ å…¨è‡ªåŠ¨ å’Œ åŠè‡ªåŠ¨(æ‰©å±•æ€§å¾ˆé«˜ ä¸€èˆ¬æƒ…å†µä¸‹éƒ½é‡‡ç”¨åŠè‡ªåŠ¨)</strong></p><ul><li><strong>å…¨è‡ªåŠ¨</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># åˆ©ç”¨ORM è‡ªåŠ¨å¸®æˆ‘ä»¬åˆ›å»ºç¬¬ä¸‰å¼ å…³ç³»è¡¨</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Book</span><span class=p>(</span><span class=n>models</span><span class=o>.</span><span class=n>Model</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span><span class=o>=</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>authors</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>ManyToManyField</span><span class=p>(</span><span class=n>to</span><span class=o>=</span><span class=s1>&#39;Author&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Author</span><span class=p>(</span><span class=n>models</span><span class=o>.</span><span class=n>Model</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span><span class=o>=</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>ä¼˜ç‚¹ï¼š 
</span></span></span><span class=line><span class=cl><span class=s2>  - ç¬¬ä¸‰å¼ å…³ç³»è¡¨çš„modelä»£ç  ä¸éœ€è¦è‡ªå·±å†™
</span></span></span><span class=line><span class=cl><span class=s2>  - æ”¯æŒORMæä¾›æ“ä½œç¬¬ä¸‰å¼ å…³ç³»è¡¨çš„æ–¹æ³•(add clear remove æ­£åå‘æŸ¥è¯¢...)
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>ç¼ºç‚¹ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>  -  ç¬¬ä¸‰å¼ å…³ç³»è¡¨çš„æ‹“å±•æ€§æå·® æ²¡æœ‰åŠæ³•é¢å¤–æ·»åŠ å­—æ®µ
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl> 
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>çº¯æ‰‹åŠ¨</strong></li></ul><p><strong>ä¸å»ºè®®ä½¿ç”¨è¯¥æ–¹å¼</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># è‡ªå·±ä¹¦å†™ ç¬¬ä¸‰å¼ å…³ç³»è¡¨</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Book</span><span class=p>(</span><span class=n>models</span><span class=o>.</span><span class=n>Model</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span><span class=o>=</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Author</span><span class=p>(</span><span class=n>models</span><span class=o>.</span><span class=n>Model</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span><span class=o>=</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Book2Author</span><span class=p>(</span><span class=n>models</span><span class=o>.</span><span class=n>Model</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>book</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>ForeignKey</span><span class=p>(</span><span class=n>to</span><span class=o>=</span><span class=s1>&#39;Book&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>author</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>ForeignKey</span><span class=p>(</span><span class=n>to</span><span class=o>=</span><span class=s1>&#39;Author&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>ä¼˜ç‚¹ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>  - ç¬¬ä¸‰å¼ è¡¨å®Œå…¨å–å†³äºä½ è‡ªå·± è¿›è¡Œé¢å¤–æ‰©å±•
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>ç¼ºç‚¹ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>  - éœ€è¦è‡ªå·±å†™ç¬¬ä¸‰å¼ å…³ç³»è¡¨çš„modelä»£ç 
</span></span></span><span class=line><span class=cl><span class=s2>  - ä¸èƒ½å¤Ÿå†ä½¿ç”¨ORMæä¾›çš„ç®€å•æ–¹æ³•
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>åŠè‡ªåŠ¨</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># è¿˜æ˜¯æ‰‹åŠ¨åˆ›å»ºç¬¬ä¸‰å¼ å…³ç³»è¡¨</span>
</span></span><span class=line><span class=cl><span class=c1># ç„¶åé€šè¿‡å­—æ®µå‚æ•° è§£å†³å…¨æ‰‹åŠ¨åˆ›å»ºå¸¦æ¥çš„ç¼ºç‚¹ æ— æ³•ä½¿ç”¨ORMæä¾›çš„æ–¹æ³•</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Book</span><span class=p>(</span><span class=n>models</span><span class=o>.</span><span class=n>Model</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span><span class=o>=</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># åˆ©ç”¨é¢å¤–å‚æ•° å‘Šè¯‰ORM ç¬¬ä¸‰å¼ å…³ç³»è¡¨æˆ‘å·²ç»æ‰‹åŠ¨åˆ›å»º ä½ å‚è€ƒå°±è¡Œ ä¸å¿…å†è‡ªåŠ¨åˆ›å»º</span>
</span></span><span class=line><span class=cl>    <span class=c1># å¤šå¯¹å¤šå¤–é”®å­—æ®µ å¯ä»¥å†™åœ¨ä»»æ„ä¸€æ–¹ è¿™é‡Œå†™åœ¨å“ªä¸€è¾¹ ä¼šå½±å“åˆ°through_fieldså‚æ•°çš„å­—æ®µé¡ºåº</span>
</span></span><span class=line><span class=cl>    <span class=c1># å†™åœ¨bookè¡¨ through_fields=(&#39;book&#39;, &#39;author&#39;)</span>
</span></span><span class=line><span class=cl>    <span class=n>author</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>ManyToManyField</span><span class=p>(</span><span class=n>to</span><span class=o>=</span><span class=s1>&#39;Author&#39;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                                    <span class=n>through</span><span class=o>=</span><span class=s1>&#39;Book2Author&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                    <span class=n>through_fields</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;book&#39;</span><span class=p>,</span> <span class=s1>&#39;author&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                   <span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Author</span><span class=p>(</span><span class=n>models</span><span class=o>.</span><span class=n>Model</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span><span class=o>=</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># OR å†™åœ¨authorè¡¨ through_fields=(&#39;author&#39;, &#39;book&#39;)</span>
</span></span><span class=line><span class=cl>    <span class=c1># author = models.ManyToManyField(to=&#39;Author&#39;, </span>
</span></span><span class=line><span class=cl>    <span class=c1>#                                 through=&#39;Book2Author&#39;,</span>
</span></span><span class=line><span class=cl>    <span class=c1>#                                 through_fields=(&#39;author&#39;, &#39;book&#39;)</span>
</span></span><span class=line><span class=cl>    <span class=c1>#                                )</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Book2Author</span><span class=p>(</span><span class=n>models</span><span class=o>.</span><span class=n>Model</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>book</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>ForeignKey</span><span class=p>(</span><span class=n>to</span><span class=o>=</span><span class=s1>&#39;Book&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>author</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>ForeignKey</span><span class=p>(</span><span class=n>to</span><span class=o>=</span><span class=s1>&#39;Author&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>through_fields=(&#39;xx&#39;, &#39;oo&#39;)
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>through_fieldså­—æ®µå…ˆåé¡ºåºï¼š
</span></span></span><span class=line><span class=cl><span class=s2>  æœ¬è´¨ï¼šç”±ç¬¬ä¸‰å¼ å…³ç³»è¡¨ æŸ¥è¯¢å¤–é”®æ‰€åœ¨è¡¨ é€šè¿‡(ç¬¬ä¸‰å¼ è¡¨)å“ªä¸ªå­—æ®µ å°±æŠŠè¯¥å­—æ®µæ”¾åœ¨å‰é¢ä¸€ä¸ªå‚æ•°
</span></span></span><span class=line><span class=cl><span class=s2>  æ€»ç»“ï¼šç®€åŒ–åˆ¤æ–­ -&gt; å½“å‰è¡¨(å¤–é”®å­—æ®µæ‰€åœ¨çš„è¡¨)æ˜¯è° å°±æŠŠå¯¹åº”çš„å…³è”å­—æ®µæ”¾å‰é¢
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>åŠè‡ªåŠ¨ä¸è¶³ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>  å¯ä»¥ä½¿ç”¨ormçš„æ­£åå‘æŸ¥è¯¢ ä½†æ˜¯æ²¡æ³•ä½¿ç”¨ add set remove clearè¿™4ä¸ªæ–¹æ³•
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=modelå…ƒç¼–ç¨‹>Modelå…ƒç¼–ç¨‹</h3><p><strong>Django Model èƒŒåçš„æ•…äº‹ &ndash; å…ƒç¼–ç¨‹</strong></p><h4 id=æµ‹è¯•ç¯å¢ƒ>æµ‹è¯•ç¯å¢ƒ</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ../project_dir
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å®‰è£…django</span>
</span></span><span class=line><span class=cl>pip install django
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># åˆ›å»ºé¡¹ç›®</span>
</span></span><span class=line><span class=cl>django-admin startproject cmdb
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># é…ç½®ä¿®æ”¹å‚è€ƒä¸Šæ–‡</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># åˆ›å»ºuseråŒ…</span>
</span></span><span class=line><span class=cl>python manage.py startapp user
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ³¨å†Œ </span>
</span></span><span class=line><span class=cl>ä¸€å®šè¦åœ¨settings.py INSTALLED_APPS æ³¨å†Œuser å¦åˆ™ä¸èƒ½è¿ç§»
</span></span></code></pre></td></tr></table></div></div><h4 id=modelæ•°æ®åº“æ¨¡å‹>Modelæ•°æ®åº“æ¨¡å‹</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># user/models.py</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.db</span> <span class=kn>import</span> <span class=n>models</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create your models here.</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>User</span><span class=p>(</span><span class=n>models</span><span class=o>.</span><span class=n>Model</span><span class=p>):</span>  <span class=c1># ç»§æ‰¿çš„ç›®å½• ä»£ç å¤ç”¨</span>
</span></span><span class=line><span class=cl>    <span class=k>class</span> <span class=nc>Meta</span><span class=p>:</span>  <span class=c1># å…ƒæ•°æ®</span>
</span></span><span class=line><span class=cl>        <span class=n>db_table</span> <span class=o>=</span> <span class=s1>&#39;user&#39;</span>  <span class=c1># æŒ‡å®šmysqlä¸­çš„è¡¨å å¦åˆ™é»˜è®¤ä¸ºmodule_class.__name__</span>
</span></span><span class=line><span class=cl>    <span class=c1># å­—æ®µå®šä¹‰</span>
</span></span><span class=line><span class=cl>    <span class=nb>id</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>AutoField</span><span class=p>(</span><span class=n>primary_key</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>  <span class=c1># è‡ªå¢ åŒæ—¶æ˜¯ä¸»é”® Djangoåªæ”¯æŒå•ä¸€ä¸»é”®</span>
</span></span><span class=line><span class=cl>    <span class=c1># å…ƒç¼–ç¨‹ä¼šåœ¨æ²¡æœ‰ä¸»é”®çš„è¯·å†µä¸‹ å»ºç«‹ä¸€ä¸ªå­—æ®µåä¸º:id çš„è‡ªå¢ä¸»é”®</span>
</span></span><span class=line><span class=cl>    <span class=n>username</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>null</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>password</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span><span class=o>=</span><span class=mi>128</span><span class=p>,</span> <span class=n>null</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>  <span class=c1># passwd å¯†æ–‡ hash</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__repr__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;&lt;User </span><span class=si>{}</span><span class=s2>ï¼Œ </span><span class=si>{}</span><span class=s2>&gt;&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>username</span><span class=p>)</span>  <span class=c1># self.id == self.pk ä¸»é”®</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=fm>__str__</span> <span class=o>=</span> <span class=fm>__repr__</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è¿ç§»ï¼šModelç±»ç”Ÿæˆæ•°æ®åº“ä¸­çš„è¡¨å’Œå­—æ®µ</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=å…ƒç±»>å…ƒç±»</h4><ul><li><strong>ç±»å®šä¹‰</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>A</span><span class=p>:</span>  <span class=c1># è¯­æ³•å®šä¹‰</span>
</span></span><span class=line><span class=cl>    <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># typeå‡½æ•°é—®ä»€ä¹ˆ é—®ä½ æ˜¯è°çš„å®ä¾‹</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># typeè¯´æ˜ä»€ä¹ˆï¼Ÿ Aæ˜¯typeçš„å®ä¾‹ Aç§°ä¸ºç±»å¯¹è±¡ ç”±typeæ„é€ å‡ºæ¥çš„å®ä¾‹</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=nb>type</span><span class=p>(</span><span class=n>A</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1># classæ„é€ å‡ºæ¥çš„æ˜¯ç±» typeæ˜¯æ„é€ ç±»çš„ç±»</span>
</span></span><span class=line><span class=cl><span class=c1># å…ƒç±»ï¼š  ç”¨æ¥æ„é€ ç±»çš„ç±»å‹</span>
</span></span><span class=line><span class=cl><span class=c1># å…ƒç¼–ç¨‹: ç”¨ç¼–ç¨‹çš„æ–¹æ³•æ¥ç¼–ç¨‹</span>
</span></span><span class=line><span class=cl><span class=c1># å…ƒæ•°æ®: ç”¨æ¥æè¿°æ•°æ®çš„æ•°æ®</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>type</span><span class=p>(</span><span class=nb>type</span><span class=p>))</span>  <span class=c1># type</span>
</span></span><span class=line><span class=cl><span class=c1># å…ƒç±» ç”¨æ¥æ„é€ ç±»å¯¹è±¡ ä¸æ˜¯ç”¨æ¥ç»§æ‰¿çš„</span>
</span></span><span class=line><span class=cl><span class=c1># class Model(metaclass=ModelBase) ä½¿ç”¨metaclasså‚æ•°æ”¹å˜å…ƒç±»</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># __new__ ä¸¤ä¸ªä½œç”¨</span>
</span></span><span class=line><span class=cl><span class=c1># 1. ç”¨æ¥å®ä¾‹åŒ–</span>
</span></span><span class=line><span class=cl><span class=c1># 2. ç”¨åœ¨å…ƒç¼–ç¨‹ä¸­</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;=&#39;</span> <span class=o>*</span> <span class=mi>30</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=n>A</span><span class=p>()</span>  <span class=c1># aæ˜¯Aç±»çš„å®ä¾‹</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=nb>type</span><span class=p>(</span><span class=n>a</span><span class=p>))</span>  <span class=c1># A, aæ˜¯ç”±Aæ„é€ å‡ºæ¥çš„å®ä¾‹</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>django model ä»¿å†™</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Field</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>primary_key</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>null</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>pk</span> <span class=o>=</span> <span class=n>primary_key</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=n>name</span>  <span class=c1># ï¼Ÿ</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>null</span> <span class=o>=</span> <span class=n>null</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__str__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;&lt;Field </span><span class=si>{}</span><span class=s2>&gt;&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=fm>__repr__</span> <span class=o>=</span> <span class=fm>__str__</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Manager</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># typeæ˜¯Pythonæä¾›çš„åŸå§‹å…ƒç±»</span>
</span></span><span class=line><span class=cl><span class=c1># ä¸çŸ¥é“æ€ä¹ˆæ„å»ºå…ƒç±» ç»§æ‰¿è‡ªtypeè§£å†³(å› ä¸ºtypeæ˜¯å…ƒç±»)</span>
</span></span><span class=line><span class=cl><span class=c1># å¯¹æ¯”ï¼šæ™®é€šç±»æœ€ç»ˆç»§æ‰¿è‡ªobject</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ModelBase</span><span class=p>(</span><span class=nb>type</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># å…ƒç±»ç¼–ç¨‹ä¸­ï¼šæ„å»ºç±»å¯¹è±¡çš„</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__new__</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>name</span><span class=p>,</span> <span class=n>bases</span><span class=p>,</span> <span class=n>attrs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;=&#39;</span> <span class=o>*</span> <span class=mi>30</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=bp>cls</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># name, bases, attrs = args</span>
</span></span><span class=line><span class=cl>        <span class=c1># ä¸‰å…ƒç»„ (name: æ„é€ ç±»çš„name, bases:æ„é€ å‡ºæ¥ç±»çš„ ç»§æ‰¿ç±», attrs:æ„é€ å‡ºæ¥ç±»çš„ç±»å±æ€§)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=n>bases</span><span class=p>,</span> <span class=n>attrs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># attrs[&#39;id&#39;] = &#39;abc&#39;</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>attrs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>pks</span> <span class=o>=</span> <span class=p>[]</span>  <span class=c1># ä¸»é”®ä»¬</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>k</span><span class=p>,</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>attrs</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=c1># k, v =&gt; &#39;username&#39;, Fieldå¯¹è±¡</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>v</span><span class=p>,</span> <span class=n>Field</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>v</span><span class=o>.</span><span class=n>pk</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>pks</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>v</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=ow>not</span> <span class=n>v</span><span class=o>.</span><span class=n>name</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>v</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=n>k</span>
</span></span><span class=line><span class=cl>        <span class=n>attrs</span><span class=p>[</span><span class=s1>&#39;pks&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pks</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># åˆ¤æ–­ä¸»é”®ä¸å­˜åœ¨ è´¼é»˜è®¤åˆ›å»ºidä¸»é”®</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>pks</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>id</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>primary_key</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=s1>&#39;id&#39;</span><span class=p>,</span> <span class=n>null</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>pks</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>attrs</span><span class=p>[</span><span class=s1>&#39;pks&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pks</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;=&#39;</span> <span class=o>*</span> <span class=mi>30</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># return None  # åº”è¯¥è¿”å›ç±»å¯¹è±¡ è€Œä¸æ˜¯None or å…¶ä»–</span>
</span></span><span class=line><span class=cl>        <span class=c1># return super().__new__(cls, name, bases, attrs)</span>
</span></span><span class=line><span class=cl>        <span class=n>new_class</span> <span class=o>=</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__new__</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>name</span><span class=p>,</span> <span class=n>bases</span><span class=p>,</span> <span class=n>attrs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># çœç•¥1000è¡Œ</span>
</span></span><span class=line><span class=cl>        <span class=c1># åˆ¤æ–­objects æŒ‚objectså¯¹è±¡</span>
</span></span><span class=line><span class=cl>        <span class=nb>setattr</span><span class=p>(</span><span class=n>new_class</span><span class=p>,</span> <span class=s1>&#39;objects&#39;</span><span class=p>,</span> <span class=n>Manager</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>new_class</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ”¹æ¨¡å­ ç”±typeæ”¹ä¸ºä½¿ç”¨ModelBaseä¸ºå…ƒç±»</span>
</span></span><span class=line><span class=cl><span class=c1># ç”¨ModelBaseçš„__new__æ–¹æ³•æ„é€ Modelç±»</span>
</span></span><span class=line><span class=cl><span class=c1># æœ¬æ¥æ‰¾typeçš„ æŒ‡å®šmetaclassæ”¹å˜</span>
</span></span><span class=line><span class=cl><span class=c1># class Model(list, metaclass=ModelBase):</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Model</span><span class=p>(</span><span class=n>metaclass</span><span class=o>=</span><span class=n>ModelBase</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># m = Model()  # None() =&gt; TypeError</span>
</span></span><span class=line><span class=cl><span class=c1># print(*Model.__dict__.items(), sep=&#39;\n&#39;)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Userç»§æ‰¿è‡ªModel Modelç±»ç”±ModelBaseæ„é€  é‚£ä¹ˆUserä¹Ÿæ˜¯ç”±ModelBaseæ„é€ </span>
</span></span><span class=line><span class=cl><span class=c1># ä¸ç”¨æ˜¾ç¤ºå†™ï¼šmetaclass=ModelBase</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>User</span><span class=p>(</span><span class=n>Model</span><span class=p>):</span>  <span class=c1># ç”±å…ƒç±»æ„é€ </span>
</span></span><span class=line><span class=cl>    <span class=n>username</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>null</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>password</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>null</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>User</span><span class=o>.</span><span class=n>pks</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># python manage.py runserver  # æµ‹è¯•ç”¨çš„wsgi server</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=è·¯ç”±å±‚>è·¯ç”±å±‚</h2><h3 id=è·¯ç”±åŒ¹é…>è·¯ç”±åŒ¹é…</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># è·¯ç”±åŒ¹é…</span>
</span></span><span class=line><span class=cl><span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;test&#39;</span><span class=p>,</span> <span class=n>views</span><span class=o>.</span><span class=n>test</span><span class=p>),</span>       
</span></span><span class=line><span class=cl><span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;testadd&#39;</span><span class=p>,</span> <span class=n>views</span><span class=o>.</span><span class=n>testadd</span><span class=p>),</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>http://127.0.0.1:8000/testadd  æ°¸è¿œè®¿é—®ä¸åˆ° æ°¸è¿œè®¿é—®çš„æ˜¯views.testè§†å›¾å‡½æ•°
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>urlæ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ­£åˆ™è¡¨è¾¾å¼
</span></span></span><span class=line><span class=cl><span class=s2>åªè¦ç¬¬ä¸€ä¸ªå‚æ•°æ­£åˆ™è¡¨è¾¾å¼èƒ½å¤ŸåŒ¹é…åˆ°å†…å®¹ å°±ä¼šç«‹åˆ»åœæ­¢å¾€ä¸‹åŒ¹é… ç›´æ¥æ‰§è¡Œå¯¹åº”çš„è§†å›¾å‡½æ•°
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># åŠ æ–œæ / djangoåŒ¹é…çš„æ—¶å€™ä¼šè‡ªåŠ¨åŠ æ–œæ å»åŒ¹é…</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>http://127.0.0.1:8000/testadd  ç¬¬ä¸€æ¬¡åŒ¹é… åŒ¹é…ä¸åˆ° - 301
</span></span></span><span class=line><span class=cl><span class=s2>djangoä¼šè‡ªåŠ¨åœ¨æœ«å°¾åŠ ä¸€ä¸ªæ–œæ  è¿›è¡Œç¬¬äºŒæ¬¡åŒ¹é… - 200 OK
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>djangoå†…éƒ¨å¸®ä½ åšçš„é‡å®šå‘
</span></span></span><span class=line><span class=cl><span class=s2>  - ä¸€æ¬¡åŒ¹é…ä¸è¡Œ
</span></span></span><span class=line><span class=cl><span class=s2>  - urlæœ«å°¾åŠ æ–œæ  å†æ¥ä¸€æ¬¡
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;test/&#39;</span><span class=p>,</span> <span class=n>views</span><span class=o>.</span><span class=n>test</span><span class=p>),</span>       
</span></span><span class=line><span class=cl><span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;testadd/&#39;</span><span class=p>,</span> <span class=n>views</span><span class=o>.</span><span class=n>testadd</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl><span class=c1># è‡ªåŠ¨åŠ æ–œæ åŠŸèƒ½å¯ä»¥å–æ¶ˆ é…ç½®settings.py</span>
</span></span><span class=line><span class=cl><span class=n>APPEND_SLASH</span> <span class=o>=</span> <span class=kc>False</span>  <span class=c1># å–æ¶ˆè‡ªåŠ¨åŠ æ–œæ  é»˜è®¤ä¸ºTrue ä¸å»ºè®®ä¿®æ”¹</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># QA</span>
</span></span><span class=line><span class=cl><span class=n>Q</span><span class=p>:</span> <span class=n>GET</span> <span class=o>/</span><span class=n>msafbsvfbtest</span><span class=o>/</span> <span class=n>å¯ä»¥åŒ¹é…åˆ°</span> <span class=n>test</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=n>A</span><span class=p>:</span> <span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^test/&#39;</span><span class=p>,</span> <span class=n>v2</span><span class=o>.</span><span class=n>test</span><span class=p>)</span>   <span class=c1># ^ è§£å†³   </span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=n>Q</span><span class=p>:</span> <span class=n>GET</span> <span class=o>/</span><span class=n>test</span><span class=o>/</span><span class=n>sdanakvdbkaadad</span><span class=o>/</span><span class=n>daskndakjd</span> <span class=n>å¯ä»¥åŒ¹é…åˆ°</span> <span class=n>test</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=n>A</span><span class=p>:</span> <span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^test/$&#39;</span><span class=p>,</span> <span class=n>v2</span><span class=o>.</span><span class=n>test</span><span class=p>)</span>  <span class=c1># ^test$ æ­£åˆ™ç²¾ç¡® test</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=n>Q</span><span class=err>ï¼š</span><span class=n>å¦‚ä½•å†™é¦–é¡µURL</span>
</span></span><span class=line><span class=cl><span class=n>A</span><span class=p>:</span> <span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^$&#39;</span><span class=p>,</span> <span class=n>v2</span><span class=o>.</span><span class=n>home</span><span class=p>)</span>  <span class=c1># é¦–é¡µåŒ¹é… ä¸èƒ½å†™æˆurl(r&#39;&#39;, v2.home)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=n>Q</span><span class=p>:</span> <span class=n>å°¾é¡µ</span><span class=p>(</span><span class=mi>404</span><span class=n>é¡µé¢</span> <span class=n>æ‰€æœ‰é¡µé¢éƒ½æ²¡æ‰¾åˆ°</span><span class=p>)</span> <span class=n>éœ€è¦æ”¾åœ¨æœ€å</span>
</span></span><span class=line><span class=cl><span class=n>A</span><span class=p>:</span> <span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>v2</span><span class=o>.</span><span class=n>error</span><span class=p>)</span>  <span class=c1># äº†è§£å³å¯ ä¸è¿™æ ·å†™</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=urlåˆ†ç»„>URLåˆ†ç»„</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>åˆ†ç»„ï¼šå°±æ˜¯ç»™æŸä¸€æ®µæ­£åˆ™è¡¨è¾¾å¼ç”¨å°æ‹¬å·æ‹¬èµ·æ¥
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^test/\d+$&#39;</span><span class=p>,</span> <span class=n>v2</span><span class=o>.</span><span class=n>test</span><span class=p>)</span>  <span class=c1># æ­£å¸¸è®¿é—®</span>
</span></span><span class=line><span class=cl><span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^test/(\d+$)&#39;</span><span class=p>,</span> <span class=n>v2</span><span class=o>.</span><span class=n>test</span><span class=p>)</span>  <span class=c1># åˆ†ç»„å æŠ¥é”™TypeError test() takes 1 positional argument but 2 were given</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=æ— ååˆ†ç»„>æ— ååˆ†ç»„</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^test/(\d+$)&#39;</span><span class=p>,</span> <span class=n>v2</span><span class=o>.</span><span class=n>test</span><span class=p>)</span>  
</span></span><span class=line><span class=cl><span class=c1># åˆ†ç»„å æŠ¥é”™TypeError ç¼ºå°‘ä½ç½®å‚æ•°</span>
</span></span><span class=line><span class=cl><span class=c1># test() takes 1 positional argument but 2 were given</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ä¿®æ”¹è§†å›¾å‡½æ•°æ¥æ”¶åˆ†ç»„ä¼ é€’çš„å‚æ•°</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>test</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=n>args</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>args</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;test&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>æ— ååˆ†ç»„ å°±æ˜¯å°†æ‹¬å·å†…æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…åˆ°çš„å†…å®¹å½“ä½œ ä½ç½®å‚æ•° ä¼ é€’ç»™åé¢çš„è§†å›¾å‡½æ•°
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=æœ‰ååˆ†ç»„>æœ‰ååˆ†ç»„</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>(?P&lt;name&gt;) å¯ä»¥ç»™æ­£åˆ™è¡¨è¾¾å¼ åˆ†ç»„å¹¶èµ·ä¸€ä¸ªåˆ«å
</span></span></span><span class=line><span class=cl><span class=s2>æœ‰ååˆ†ç»„ å°±æ˜¯å°†æ‹¬å·å†…æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…åˆ°çš„å†…å®¹å½“ä½œ å…³é”®å­—å‚æ•° ä¼ é€’ç»™åé¢çš„è§†å›¾å‡½æ•°
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^testadd/(?P&lt;year&gt;\d+)&#39;</span><span class=p>,</span> <span class=n>v2</span><span class=o>.</span><span class=n>testadd</span><span class=p>)</span> 
</span></span><span class=line><span class=cl><span class=c1># èµ·åˆ«åå æŠ¥é”™ TypeError ç¼ºå°‘å…³é”®å­—å‚æ•°</span>
</span></span><span class=line><span class=cl><span class=c1># testadd() got an unexpected keyword argument &#39;year&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å¢åŠ å…³é”®å­—å¯¹åº”çš„å½¢å‚</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>testadd</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=n>years</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>years</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;testadd&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=ä¸èƒ½æ··ç”¨>ä¸èƒ½æ··ç”¨</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^index/(\d+)/(?P&lt;year&gt;\d+)/&#39;</span><span class=p>,</span> <span class=n>v2</span><span class=o>.</span><span class=n>index</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>index</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=n>args</span><span class=p>,</span> <span class=n>year</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>args</span><span class=p>,</span> <span class=n>year</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s2>&#34;index&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=ne>TypeError</span> <span class=n>at</span> <span class=o>/</span><span class=n>index</span><span class=o>/</span><span class=mi>12313</span><span class=o>/</span><span class=mi>32131313</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>index</span><span class=p>()</span> <span class=n>missing</span> <span class=mi>1</span> <span class=n>required</span> <span class=n>positional</span> <span class=n>argument</span><span class=p>:</span> <span class=s1>&#39;args&#39;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=c1># æ€»ç»“ï¼š ä¸èƒ½æ··ç”¨ ä½†æ˜¯ åŒä¸€ä¸ªåˆ†ç»„å¯ä»¥ä½¿ç”¨Nå¤šæ¬¡</span>
</span></span><span class=line><span class=cl><span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^index/(\d+)/(\d+)/(\d+)/&#39;</span><span class=p>,</span> <span class=n>views</span><span class=o>.</span><span class=n>index</span><span class=p>),</span>
</span></span><span class=line><span class=cl><span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^index/(?P&lt;year&gt;\d+)/(?P&lt;month&gt;\d+)/(?P&lt;day&gt;\d+)/&#39;</span><span class=p>,</span> <span class=n>views</span><span class=o>.</span><span class=n>index</span><span class=p>),</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>index</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>args</span><span class=p>)</span>    <span class=c1># (&#39;12&#39;, &#39;3123&#39;, &#39;42341&#39;)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>kwargs</span><span class=p>)</span>  <span class=c1># {&#39;year&#39;: &#39;12&#39;, &#39;month&#39;: &#39;3123&#39;, &#39;day&#39;: &#39;42341&#39;}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s2>&#34;&lt;h1&gt;index&lt;/h1&gt;&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=åå‘è§£æ>åå‘è§£æ</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>æœ¬è´¨ï¼šé€šè¿‡ä¸€äº›æ–¹æ³•å¾—åˆ°ä¸€ä¸ªç»“æœ è¯¥ç»“æœå¯ä»¥è®¿é—®åˆ°å¯¹åº”çš„url ä»è€Œè§¦å‘å¯¹åº”è§†å›¾å‡½æ•°çš„è¿è¡Œ
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>æ­¥éª¤ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>  1. å…ˆç»™è·¯ç”±ä¸è§†å›¾å‡½æ•°èµ·ä¸€ä¸ªåˆ«å
</span></span></span><span class=line><span class=cl><span class=s2>  url(r&#39;^func_minho/&#39;, views.func, name=&#39;alias_func&#39;),
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>  2. åå‘è§£æ
</span></span></span><span class=line><span class=cl><span class=s2>    2.1 åç«¯åå‘è§£æ
</span></span></span><span class=line><span class=cl><span class=s2>    from django.shortcuts import reverse, HttpResponseRedirect
</span></span></span><span class=line><span class=cl><span class=s2>    url = reverse(&#39;alias_func&#39;)
</span></span></span><span class=line><span class=cl><span class=s2>    return HttpResponseRedirect(url)
</span></span></span><span class=line><span class=cl><span class=s2>        
</span></span></span><span class=line><span class=cl><span class=s2>    2.2 å‰ç«¯åå‘è§£æ (æ¨¡æ¿è¯­æ³•)
</span></span></span><span class=line><span class=cl><span class=s2>    &lt;a href=&#34;{</span><span class=si>% u</span><span class=s2>rl &#39;alias_func&#39; %}&#34;&gt;111&lt;/a&gt;
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>æœ€ç®€å•çš„è¯·å†µ urlç¬¬ä¸€ä¸ªå‚æ•°é‡Œé¢æ²¡ç”¨æ­£åˆ™ç¬¦å·</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># url</span>
</span></span><span class=line><span class=cl><span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^home/&#39;</span><span class=p>,</span> <span class=n>views</span><span class=o>.</span><span class=n>home</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=s1>&#39;home_page&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>ç»™urlå‡½æ•°æ·»åŠ ä¸€ä¸ª nameå‚æ•°(**å”¯ä¸€**) èµ·ä¸€ä¸ªåå­— ç±»ä¼¼äºåˆ«å 
</span></span></span><span class=line><span class=cl><span class=s2>æ³¨æ„: **åˆ«åå”¯ä¸€ åˆ«åä¸èƒ½å†²çª**
</span></span></span><span class=line><span class=cl><span class=s2>æˆ‘å¯ä»¥è®¿é—®åˆ°è¿™ä¸ªåå­—(urlæ­£åˆ™å¯ä»¥éšæ„ä¿®æ”¹) ç„¶åè·å–åˆ°å¯¹åº”çš„url ä»è€Œè§¦å‘è§†å›¾å‡½æ•°çš„è¿è¡Œ
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>1. å‰ç«¯
</span></span></span><span class=line><span class=cl><span class=s2>  {</span><span class=si>% u</span><span class=s2>rl &#39;alias_name&#39; %}    
</span></span></span><span class=line><span class=cl><span class=s2>  alias_nameå¯¹åº”urlå‡½æ•°é‡Œé¢çš„ nameå‚æ•°å¯¹åº”çš„å­—ç¬¦ä¸²
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>2. åç«¯
</span></span></span><span class=line><span class=cl><span class=s2>   reverse()
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>æ— ååˆ†ç»„åå‘è§£æ</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># url</span>
</span></span><span class=line><span class=cl><span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^index/(\d+)/&#39;</span><span class=p>,</span> <span class=n>views</span><span class=o>.</span><span class=n>index</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=s1>&#39;alias_index&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å‰ç«¯</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>a</span> <span class=n>href</span><span class=o>=</span><span class=s2>&#34;{</span><span class=si>% u</span><span class=s2>rl &#39;alias_index&#39; 123 %}&#34;</span><span class=o>&gt;</span><span class=mi>111</span><span class=o>&lt;/</span><span class=n>a</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># åç«¯</span>
</span></span><span class=line><span class=cl><span class=n>reverse</span><span class=p>(</span><span class=s1>&#39;alias_index&#39;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=p>(</span><span class=mi>1</span><span class=p>,))</span>  <span class=c1># /index/1/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>è¿™ä¸ªæ•°å­—å†™ä»£ç çš„æ—¶å€™åº”è¯¥æ”¾ä»€ä¹ˆ?
</span></span></span><span class=line><span class=cl><span class=s2>  - æ•°å­— ä¸€èˆ¬æƒ…å†µä¸‹æ”¾çš„æ˜¯æ•°æ®çš„ä¸»é”®å€¼ æ¥åšæ•°æ®çš„ç¼–è¾‘å’Œåˆ é™¤
</span></span></span><span class=line><span class=cl><span class=s2>  # urls.py
</span></span></span><span class=line><span class=cl><span class=s2>  url(r&#39;^edit/(\d+)/&#39;, views.edit, name=&#39;xxx&#39;)
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>  # views.py
</span></span></span><span class=line><span class=cl><span class=s2>  def edit(request, edit_id):
</span></span></span><span class=line><span class=cl><span class=s2>      reverse(&#39;xxx&#39;, args=(edit_id,))
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>  # html
</span></span></span><span class=line><span class=cl><span class=s2>  {</span><span class=si>% f</span><span class=s2>or user in user_queryset %}
</span></span></span><span class=line><span class=cl><span class=s2>  &lt;a href=&#39;{</span><span class=si>% u</span><span class=s2>rl &#39;xxx&#39; user.id %}&#39;&gt;ç¼–è¾‘&lt;/a&gt;
</span></span></span><span class=line><span class=cl><span class=s2>  {</span><span class=si>% e</span><span class=s2>ndfor %}
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>æœ‰ååˆ†ç»„åå‘è§£æ</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># url</span>
</span></span><span class=line><span class=cl><span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^func/(?P&lt;year&gt;\d+)&#39;</span><span class=p>,</span> <span class=n>views</span><span class=o>.</span><span class=n>func</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=s1>&#39;alias_func&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å‰ç«¯</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>a</span> <span class=n>href</span><span class=o>=</span><span class=s2>&#34;{</span><span class=si>% u</span><span class=s2>rl &#39;alias_func&#39; year=2009 %}&#34;</span><span class=o>&gt;</span><span class=mi>111</span><span class=o>&lt;/</span><span class=n>a</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>a</span> <span class=n>href</span><span class=o>=</span><span class=s2>&#34;{</span><span class=si>% u</span><span class=s2>rl &#39;alias_func&#39; 2021 %}&#34;</span><span class=o>&gt;</span><span class=mi>222</span><span class=o>&lt;/</span><span class=n>a</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># åç«¯</span>
</span></span><span class=line><span class=cl><span class=mf>1.</span> <span class=n>æœ‰ååˆ†ç»„å†™æ³•ä¸€</span>
</span></span><span class=line><span class=cl><span class=n>reverse</span><span class=p>(</span><span class=s1>&#39;alias_func&#39;</span><span class=p>,</span> <span class=n>kwargs</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;year&#39;</span><span class=p>:</span> <span class=mi>2010</span><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>2.</span> <span class=n>æœ‰ååˆ†ç»„</span> <span class=n>ç®€ä¾¿å†™æ³•</span>
</span></span><span class=line><span class=cl><span class=n>reverse</span><span class=p>(</span><span class=s1>&#39;alias_func&#39;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=p>(</span><span class=mi>2021</span><span class=p>,))</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=è·¯ç”±åˆ†å‘>è·¯ç”±åˆ†å‘</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>ç‰¹ç‚¹ï¼šdjango æ¯ä¸€ä¸ªåº”ç”¨ éƒ½å¯ä»¥æœ‰è‡ªå·±çš„templatesæ–‡ä»¶å¤¹ urls.py staticæ–‡ä»¶å¤¹
</span></span></span><span class=line><span class=cl><span class=s2>  æ­£æ˜¯åŸºäºä¸Šè¿°ç‰¹ç‚¹ djangoèƒ½å¤Ÿéå¸¸å¥½çš„åšåˆ°åˆ†ç»„å¼€å‘(æ¯ä¸ªäººåªå†™è‡ªå·±çš„app)
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>  å¤šäººå¼€å‘å®Œä¹‹å åªéœ€è¦å°†æ¯ä¸ªäººä¹¦å†™çš„appå…¨éƒ¨æ‹·è´åˆ°ä¸€ä¸ªæ–°çš„djangoé¡¹ç›®ä¸­ ç„¶ååœ¨é…ç½®æ–‡ä»¶é‡Œé¢æ³¨å†Œæ‰€æœ‰çš„app å†åˆ©ç”¨è·¯ç”±åˆ†å‘çš„ç‰¹ç‚¹å°†æ‰€æœ‰çš„appæ•´åˆèµ·æ¥
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>  å½“ä¸€ä¸ªdjangoé¡¹ç›®ä¸­çš„urlç‰¹åˆ«å¤šçš„æ—¶å€™ æ€»è·¯ç”±urls.pyä»£ç éå¸¸å†—ä½™ ä¸å¥½ç»´æŠ¤
</span></span></span><span class=line><span class=cl><span class=s2>  è§£å†³: åˆ©ç”¨è·¯ç”±åˆ†å‘æ¥å‡è½»æ€»è·¯ç”±çš„å‹åŠ›
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è·¯ç”±åˆ†å‘</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>åˆ©ç”¨è·¯ç”±åˆ†å‘ä¹‹å æ€»è·¯ç”±ä¸åœ¨å¤„ç† è·¯ç”±ä¸è§†å›¾å‡½æ•°çš„ç›´æ¥å¯¹åº”å…³ç³» è€Œæ˜¯åšä¸€ä¸ªåˆ†å‘å¤„ç†
</span></span></span><span class=line><span class=cl><span class=s2>å¤„ç†ï¼šè¯†åˆ«å½“å‰urlæ˜¯å±äºå“ªä¸ªåº”ç”¨ä¸‹çš„ ç„¶åç›´æ¥åˆ†å‘ç»™å¯¹åº”çš„åº”ç”¨å¤„ç†
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>è·¯ç”±åˆ†å‘å®ç°</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.conf.urls</span> <span class=kn>import</span> <span class=n>url</span><span class=p>,</span> <span class=n>include</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>app01</span> <span class=kn>import</span> <span class=n>urls</span> <span class=k>as</span> <span class=n>app01_urls</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>app02</span> <span class=kn>import</span> <span class=n>urls</span> <span class=k>as</span> <span class=n>app02_urls</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ€»è·¯ç”±</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>åªè¦urlæ˜¯app01å¼€å¤´å°±ä¼šè‡ªåŠ¨å°†urlä¸­app01åé¢çš„è·¯å¾„äº¤ç»™ app01ä¸‹çš„urls.pyå»åšåŒ¹é…
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>urlpatterns</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=c1># è·¯ç”±åˆ†å‘</span>
</span></span><span class=line><span class=cl>    <span class=c1># åªè¦urlå‰ç¼€æ˜¯app01å¼€å¤´çš„ å…¨éƒ¨äº¤ç»™app01å¤„ç†</span>
</span></span><span class=line><span class=cl>    <span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^app01/&#39;</span><span class=p>,</span> <span class=n>include</span><span class=p>(</span><span class=n>app01_urls</span><span class=p>)),</span> 
</span></span><span class=line><span class=cl>    <span class=c1># åªè¦urlå‰ç¼€æ˜¯app02å¼€å¤´çš„ å…¨éƒ¨äº¤ç»™app02å¤„ç†</span>
</span></span><span class=line><span class=cl>    <span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^app02/&#39;</span><span class=p>,</span> <span class=n>include</span><span class=p>(</span><span class=n>app02_urls</span><span class=p>)),</span>  
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å­è·¯ç”± app01.urls</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.conf.urls</span> <span class=kn>import</span> <span class=n>url</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>app01</span> <span class=kn>import</span> <span class=n>views</span>
</span></span><span class=line><span class=cl><span class=n>urlpatterns</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^reg/&#39;</span><span class=p>,</span> <span class=n>views</span><span class=o>.</span><span class=n>reg</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å­è·¯ç”± app02.urls</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.conf.urls</span> <span class=kn>import</span> <span class=n>url</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>app02</span> <span class=kn>import</span> <span class=n>views</span>
</span></span><span class=line><span class=cl><span class=n>urlpatterns</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^reg/&#39;</span><span class=p>,</span> <span class=n>views</span><span class=o>.</span><span class=n>reg</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ€»è·¯ç”± æ¨èå†™æ³• ç®€ä¾¿</span>
</span></span><span class=line><span class=cl><span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^app01/&#39;</span><span class=p>,</span> <span class=n>include</span><span class=p>(</span><span class=s1>&#39;app01.urls&#39;</span><span class=p>)),</span>
</span></span><span class=line><span class=cl><span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^app02/&#39;</span><span class=p>,</span> <span class=n>include</span><span class=p>(</span><span class=s1>&#39;app02.urls&#39;</span><span class=p>)),</span>
</span></span><span class=line><span class=cl><span class=c1># æ³¨æ„äº‹é¡¹ï¼šæ€»è·¯ç”±çš„url åƒä¸‡ä¸èƒ½åŠ $ç»“å°¾ åŠ äº†ä¹‹å æ— æ³•ç»§ç»­å‘ä¸‹åŒ¹é…</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=åç§°ç©ºé—´>åç§°ç©ºé—´</h3><p><strong>è§£å†³urlåˆ«å å‘½åå†²çªçš„é—®é¢˜ äº†è§£å³å¯ å¯ä»¥ä¸ç”¨ ä¿è¯åˆ«åä¸åŒå³å¯</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># å½“å¤šä¸ªåº”ç”¨å‡ºç°äº†ç›¸åŒçš„åˆ«å åå‘è§£ææ˜¯å¦ä¼šè‡ªåŠ¨è¯†åˆ«å¯¹åº”çš„å‰ç¼€</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>æ­£å¸¸è¯·å†µä¸‹çš„åå‘è§£æ æ˜¯æ²¡æœ‰åŠæ³•è‡ªåŠ¨è¯†åˆ«å‰ç¼€çš„
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è§£å†³ï¼šåˆ©ç”¨åç§°ç©ºé—´</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ€»è·¯ç”±åŠ åç§°ç©ºé—´ï¼šnamespace</span>
</span></span><span class=line><span class=cl><span class=n>urlpatterns</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^app01/&#39;</span><span class=p>,</span> <span class=n>include</span><span class=p>(</span><span class=s1>&#39;app01.urls&#39;</span><span class=p>,</span> <span class=n>namespace</span><span class=o>=</span><span class=s1>&#39;app01&#39;</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>    <span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^app02/&#39;</span><span class=p>,</span> <span class=n>include</span><span class=p>(</span><span class=s1>&#39;app02.urls&#39;</span><span class=p>,</span> <span class=n>namespace</span><span class=o>=</span><span class=s1>&#39;app02&#39;</span><span class=p>)),</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å­è·¯ç”± åˆ«åä¸€è‡´</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2># app01.urls
</span></span></span><span class=line><span class=cl><span class=s2>urlpatterns = [url(r&#39;^reg/&#39;, views.reg, name=&#39;reg&#39;)]
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2># app02.urls
</span></span></span><span class=line><span class=cl><span class=s2>urlpatterns = [url(r&#39;^reg/&#39;, views.reg, name=&#39;reg&#39;)]
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è§£æçš„æ—¶å€™</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>å‰ç«¯</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=n>a</span> <span class=n>href</span><span class=o>=</span><span class=s2>&#34;{</span><span class=si>% u</span><span class=s2>rl &#39;app01:reg&#39; %}&#34;</span><span class=o>&gt;</span><span class=mi>111</span><span class=o>&lt;/</span><span class=n>a</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=n>a</span> <span class=n>href</span><span class=o>=</span><span class=s2>&#34;{</span><span class=si>% u</span><span class=s2>rl &#39;app02:reg&#39; %}&#34;</span><span class=o>&gt;</span><span class=mi>222</span><span class=o>&lt;/</span><span class=n>a</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>åç«¯</span>
</span></span><span class=line><span class=cl>    <span class=n>reverse</span><span class=p>(</span><span class=s1>&#39;app01:reg&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>reverse</span><span class=p>(</span><span class=s1>&#39;app02:reg&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>æ€»ç»“ï¼šå…¶å®åªè¦ä¿è¯åˆ«åä¸å†²çª å°±æ²¡æœ‰å¿…è¦ä½¿ç”¨åç§°ç©ºé—´</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>ä¸€èˆ¬æƒ…å†µä¸‹ æœ‰å¤šä¸ªappçš„æ—¶å€™ æˆ‘ä»¬åœ¨èµ·åˆ«åçš„æ—¶å€™ ä¼šåŠ ä¸Šå¯¹åº”appçš„å‰ç¼€
</span></span></span><span class=line><span class=cl><span class=s2>è¿™æ ·çš„è¯ å°±èƒ½å¤Ÿç¡®ä¿å¤šä¸ªappä¹‹å‰åå­—ä¸å†²çªçš„é—®é¢˜
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=ä¼ªé™æ€>ä¼ªé™æ€</h3><p><strong>äº†è§£å³å¯</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>é™æ€ç½‘é¡µ
</span></span></span><span class=line><span class=cl><span class=s2>  æ•°æ®æ˜¯å†™æ­»çš„ ä¸‡å¹´ä¸å˜
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>ä¼ªé™æ€
</span></span></span><span class=line><span class=cl><span class=s2>  å°†ä¸€ä¸ªåŠ¨æ€ç½‘é¡µ ä¼ªè£…ä¸ºé™æ€ç½‘é¡µ
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>  ä¸ºä»€ä¹ˆè¦ä¼ªè£…å‘¢?
</span></span></span><span class=line><span class=cl><span class=s2>    e.g.: åšå®¢å›­
</span></span></span><span class=line><span class=cl><span class=s2>    ä¼ªè£…çš„ç›®çš„ 
</span></span></span><span class=line><span class=cl><span class=s2>      - åœ¨äºå¢å¤§æœ¬ç½‘ç«™çš„seoæŸ¥è¯¢åŠ›åº¦ 
</span></span></span><span class=line><span class=cl><span class=s2>      - å¹¶ä¸”å¢åŠ æœç´¢å¼•æ“æ”¶è—æœ¬ç½‘ç«™çš„æ¦‚ç‡
</span></span></span><span class=line><span class=cl><span class=s2>      
</span></span></span><span class=line><span class=cl><span class=s2>  æœç´¢å¼•æ“ï¼šæœ¬è´¨å°±æ˜¯ä¸€ä¸ªå·¨å¤§çš„çˆ¬è™«ç¨‹åº
</span></span></span><span class=line><span class=cl><span class=s2>  æ€»ç»“ï¼šæ— è®ºæ€ä¹ˆä¼˜åŒ– è¿˜æ˜¯æä¸è¿‡æœç´¢ç«ä»·
</span></span></span><span class=line><span class=cl><span class=s2> 
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># å®ç° æŠŠurlè®¾ç½®ä¸º.htmlç»“å°¾ ä¹ä¸€çœ‹ ä»¥ä¸ºæ˜¯é™æ€(ä¼ªé™æ€)</span>
</span></span><span class=line><span class=cl><span class=n>urlpatterns</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^reg.html/&#39;</span><span class=p>,</span> <span class=n>views</span><span class=o>.</span><span class=n>reg</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=s1>&#39;app01_reg&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=è§†å›¾å±‚>è§†å›¾å±‚</h2><p><strong>è§†å›¾å‡½æ•°å¿…é¡»è¿”å›HttpResponseå¯¹è±¡</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># å¦åˆ™æŠ¥é”™</span>
</span></span><span class=line><span class=cl><span class=n>The</span> <span class=n>view</span> <span class=n>app01</span><span class=o>.</span><span class=n>views</span><span class=o>.</span><span class=n>index</span> <span class=n>didn</span><span class=s1>&#39;t return an HttpResponse object. It returned None instead.</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=ä¸‰æ¿æ–§>ä¸‰æ¿æ–§</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># HttpResponse</span>
</span></span><span class=line><span class=cl><span class=n>è¿”å›å­—ç¬¦ä¸²ç±»å‹</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>HttpResponse</span><span class=p>(</span><span class=n>HttpResponseBase</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># render</span>
</span></span><span class=line><span class=cl><span class=n>è¿”å›htmlé¡µé¢</span> <span class=n>å¹¶ä¸”è¿”å›ä¹‹å‰è¿˜å¯ä»¥ç»™htmlæ–‡ä»¶ä¼ å€¼</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>render</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=n>template_name</span><span class=p>,</span> <span class=n>context</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>content_type</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>status</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>using</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Returns a HttpResponse whose content is filled with the result of calling
</span></span></span><span class=line><span class=cl><span class=s2>    django.template.loader.render_to_string() with the passed arguments.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>content</span> <span class=o>=</span> <span class=n>loader</span><span class=o>.</span><span class=n>render_to_string</span><span class=p>(</span><span class=n>template_name</span><span class=p>,</span> <span class=n>context</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>using</span><span class=o>=</span><span class=n>using</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=n>content</span><span class=p>,</span> <span class=n>content_type</span><span class=p>,</span> <span class=n>status</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># redirect</span>
</span></span><span class=line><span class=cl><span class=n>é‡å®šå‘</span> <span class=n>ä¹Ÿæ˜¯ç»§æ‰¿çš„HttpResponse</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=renderç®€å•çš„å†…éƒ¨åŸç†>renderç®€å•çš„å†…éƒ¨åŸç†</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>index</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=kn>from</span> <span class=nn>django.template</span> <span class=kn>import</span> <span class=n>Template</span><span class=p>,</span> <span class=n>Context</span>
</span></span><span class=line><span class=cl>    <span class=n>res</span> <span class=o>=</span> <span class=n>Template</span><span class=p>(</span><span class=s1>&#39;&lt;h1&gt;{{ user }}&lt;/h1&gt;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>con</span> <span class=o>=</span> <span class=n>Context</span><span class=p>({</span><span class=s1>&#39;user&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;username&#39;</span><span class=p>:</span> <span class=s1>&#39;minho&#39;</span><span class=p>,</span> <span class=s1>&#39;password&#39;</span><span class=p>:</span> <span class=mi>123</span><span class=p>}})</span>
</span></span><span class=line><span class=cl>    <span class=n>ret</span> <span class=o>=</span> <span class=n>res</span><span class=o>.</span><span class=n>render</span><span class=p>(</span><span class=n>con</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=n>ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=o>&lt;</span><span class=n>h1</span><span class=o>&gt;</span><span class=p>{</span><span class=o>&amp;</span><span class=c1>#39;username&amp;#39;: &amp;#39;minho&amp;#39;, &amp;#39;password&amp;#39;: 123}&lt;/h1&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=jsonresponse>JsonResponse</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>Q: jsonæ ¼å¼çš„æ•°æ®æœ‰ä»€ä¹ˆç”¨?
</span></span></span><span class=line><span class=cl><span class=s2>A: å‰åç«¯æ•°æ®äº¤äº’éœ€è¦ä½¿ç”¨åˆ°jsonä½œä¸ºè¿‡æ¸¡ å®ç°è·¨è¯­è¨€ä¼ è¾“æ•°æ®
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>å‰ç«¯åºåˆ—åŒ–ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>  - JSON.stringify()      json.dumps()
</span></span></span><span class=line><span class=cl><span class=s2>  - JSON.parse()          json.loads()
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ä»»åŠ¡ï¼šç»™å‰ç«¯æµè§ˆå™¨è¿”å›ä¸€ä¸ªjsonæ ¼å¼çš„å­—ç¬¦ä¸²</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>åŸç”Ÿjsonæ¨¡å—å®ç°</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># åŸç”Ÿjsonæ¨¡å—å®ç°</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>ab_json</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>user_dict</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;username&#39;</span><span class=p>:</span> <span class=s1>&#39;Minhoè¿™æ˜¯ä¸­æ–‡&#39;</span><span class=p>,</span> <span class=s1>&#39;password&#39;</span><span class=p>:</span> <span class=s1>&#39;123123&#39;</span><span class=p>,</span> <span class=s1>&#39;hobby&#39;</span><span class=p>:</span> <span class=s1>&#39;study&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=c1># å…ˆè½¬æˆjsonæ ¼å¼å­—ç¬¦ä¸²</span>
</span></span><span class=line><span class=cl>    <span class=n>json_str</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>user_dict</span><span class=p>,</span> <span class=n>ensure_ascii</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=n>json_str</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>JsonResponseå®ç°</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.http</span> <span class=kn>import</span> <span class=n>JsonResponse</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>ab_json</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>user_dict</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;username&#39;</span><span class=p>:</span> <span class=s1>&#39;Minhoè¿™æ˜¯ä¸­æ–‡&#39;</span><span class=p>,</span> <span class=s1>&#39;password&#39;</span><span class=p>:</span> <span class=s1>&#39;123123&#39;</span><span class=p>,</span> <span class=s1>&#39;hobby&#39;</span><span class=p>:</span> <span class=s1>&#39;study&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>lst</span> <span class=o>=</span> <span class=p>[</span><span class=mi>111</span><span class=p>,</span> <span class=mi>222</span><span class=p>,</span> <span class=mi>333</span><span class=p>,</span> <span class=mi>444</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># è¯»æºç  æŒæ¡ç”¨æ³• å¦‚ä½•ä¼ å‚</span>
</span></span><span class=line><span class=cl>    <span class=c1># åºåˆ—åŒ– å­—å…¸</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>JsonResponse</span><span class=p>(</span><span class=n>user_dict</span><span class=p>,</span> <span class=n>json_dumps_params</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;ensure_ascii&#39;</span><span class=p>:</span> <span class=kc>False</span><span class=p>})</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># åºåˆ—åŒ–éå­—å…¸å¯¹è±¡ éœ€è¦åŠ safeå‚æ•° é€šè¿‡æŠ¥é”™ä¿¡æ¯å¾—çŸ¥</span>
</span></span><span class=line><span class=cl>    <span class=c1># In order to allow non-dict objects to be serialized set the safe parameter to False</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>JsonResponse</span><span class=p>(</span><span class=n>lst</span><span class=p>,</span> <span class=n>safe</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># JsonResponse é»˜è®¤åªèƒ½åºåˆ—åŒ–å­—å…¸ åºåˆ—åŒ–å…¶ä»–æ•°æ®(å…¶ä»–å¯ä»¥è¢«åºåˆ—åŒ–çš„æ•°æ® ä¸æ˜¯æ‰€æœ‰çš„æ•°æ®éƒ½èƒ½è¢«åºåˆ—åŒ–) éœ€è¦åŠ safeå‚æ•°</span>
</span></span></code></pre></td></tr></table></div></div><hr><h3 id=djangoè‡ªå¸¦çš„åºåˆ—åŒ–ç»„ä»¶>Djangoè‡ªå¸¦çš„åºåˆ—åŒ–ç»„ä»¶</h3><p><strong>DRFé“ºå«</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># éœ€æ±‚ï¼šåœ¨å‰ç«¯ç»™æˆ‘è·å–åˆ°åç«¯ç”¨æˆ·è¡¨é‡Œé¢çš„æ‰€æœ‰æ•°æ® éœ€è¦æ˜¯åˆ—è¡¨å¥—å­—å…¸</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># jsonæ ¼å¼åŒ–æ ¡éªŒ </span>
</span></span><span class=line><span class=cl><span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>www</span><span class=o>.</span><span class=n>bejson</span><span class=o>.</span><span class=n>com</span><span class=o>/</span>  
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>JsonResponse</strong></li></ul><p><strong>json.dumps ä¸å†æ¼”ç¤º</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>app02</span> <span class=kn>import</span> <span class=n>models</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>user_ser</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># è¿”å› [{}, {}, {}, {}]</span>
</span></span><span class=line><span class=cl>    <span class=n>user_queryset</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>values</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=c1># data = [user for user in user_queryset]</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>user_queryset</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=n>JsonResponse</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>safe</span><span class=o>=</span><span class=kc>False</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># OR è‡ªå®šæ„é€ å­—å…¸ç»“æ„</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>app02</span> <span class=kn>import</span> <span class=n>models</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>user_ser</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># è¿”å› [{}, {}, {}, {}]</span>
</span></span><span class=line><span class=cl>    <span class=n>user_queryset</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>all</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>user_obj</span> <span class=ow>in</span> <span class=n>user_queryset</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;pk&#39;</span><span class=p>:</span> <span class=n>user_obj</span><span class=o>.</span><span class=n>pk</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=n>user_obj</span><span class=o>.</span><span class=n>name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;age&#39;</span><span class=p>:</span> <span class=n>user_obj</span><span class=o>.</span><span class=n>age</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;gender&#39;</span><span class=p>:</span> <span class=n>user_obj</span><span class=o>.</span><span class=n>get_gender_display</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>tmp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=n>JsonResponse</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>safe</span><span class=o>=</span><span class=kc>False</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>å‰åç«¯åˆ†ç¦»çš„é¡¹ç›®ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>  - ä½œä¸ºåç«¯ åªéœ€è¦å†™ä»£ç å°†æ•°æ®å¤„ç†å¥½
</span></span></span><span class=line><span class=cl><span class=s2>  - åºåˆ—åŒ–è¿”å›ç»™å‰ç«¯å³å¯
</span></span></span><span class=line><span class=cl><span class=s2>  - å†å†™ä¸€ä¸ªæ¥å£æ–‡æ¡£ å‘Šè¯‰å‰ç«¯æ¯ä¸ªå­—æ®µä»£è¡¨çš„æ„æ€
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>serializers</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>app02</span> <span class=kn>import</span> <span class=n>models</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.core</span> <span class=kn>import</span> <span class=n>serializers</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>user_ser</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>user_queryset</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>all</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    ä¼šè‡ªåŠ¨å¸®ä½ å°†æ•°æ®å˜æˆjsonæ ¼å¼çš„å­—ç¬¦ä¸² å¹¶ä¸”å†…éƒ¨éå¸¸çš„å…¨é¢
</span></span></span><span class=line><span class=cl><span class=s2>    å†™æ¥å£ å°±æ˜¯åˆ©ç”¨åºåˆ—åŒ–ç»„ä»¶æ¸²æŸ“æ•°æ® ç„¶åå†™ä¸€ä¸ªæ¥å£æ–‡æ¡£
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>res</span> <span class=o>=</span> <span class=n>serializers</span><span class=o>.</span><span class=n>serialize</span><span class=p>(</span><span class=s1>&#39;json&#39;</span><span class=p>,</span> <span class=n>user_queryset</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>ä½¿ç”¨åºåˆ—åŒ–ç»„ä»¶ å°è£…ç¨‹åº¦æ›´é«˜ éœ€è¦ä½ å†™çš„ä»£ç æ›´å°‘
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=formè¡¨å•ä¸Šä¼ æ–‡ä»¶åŠåç«¯å¦‚ä½•æ“ä½œ>Formè¡¨å•ä¸Šä¼ æ–‡ä»¶åŠåç«¯å¦‚ä½•æ“ä½œ</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>formè¡¨å•ä¸Šä¼ æ–‡ä»¶ç±»å‹çš„æ•°æ®
</span></span></span><span class=line><span class=cl><span class=s2>  1. methodå¿…é¡»æŒ‡å®šæˆpost
</span></span></span><span class=line><span class=cl><span class=s2>  2. enctypeå¿…é¡»æ¢æˆformdata
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>ab_file</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;POST&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(request.POST)  # åªèƒ½è·å–æ™®é€šé”®å€¼å¯¹æ•°æ® æ–‡ä»¶ä¸è¡Œ</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(request.FILES)  # &lt;MultiValueDict: {&#39;file&#39;: [&lt;TemporaryUploadedFile: python-3.8.7-amd64.exe (application/x-msdownload)&gt;]}&gt;</span>
</span></span><span class=line><span class=cl>        <span class=n>file_obj</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>FILES</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;file&#39;</span><span class=p>)</span>  <span class=c1># æ–‡ä»¶å¯¹è±¡</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>file_obj</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>file_obj</span><span class=o>.</span><span class=n>name</span><span class=p>,</span> <span class=s1>&#39;wb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>file_obj</span><span class=o>.</span><span class=n>chunks</span><span class=p>():</span>  <span class=c1># æ¨èåŠ ä¸Šchunks</span>
</span></span><span class=line><span class=cl>                <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=s1>&#39;form.html&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=requestå¯¹è±¡æ–¹æ³•>requestå¯¹è±¡æ–¹æ³•</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>request.method
</span></span></span><span class=line><span class=cl><span class=s2>request.POST
</span></span></span><span class=line><span class=cl><span class=s2>request.GET
</span></span></span><span class=line><span class=cl><span class=s2>request.FILES
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>request.path
</span></span></span><span class=line><span class=cl><span class=s2>request.path_info
</span></span></span><span class=line><span class=cl><span class=s2>request.get_full_path()  # èƒ½è·å–å®Œæ•´çš„rulåŠé—®å·åé¢çš„å‚æ•°
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>URL</span><span class=p>:</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=mf>127.0.0.1</span><span class=p>:</span><span class=mi>8000</span><span class=o>/</span><span class=n>app01</span><span class=o>/</span><span class=n>ab_file</span><span class=o>/</span><span class=err>?</span><span class=n>username</span><span class=o>=</span><span class=n>minho</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl><span class=n>requesst</span><span class=o>.</span><span class=n>path</span>           <span class=o>-&gt;</span> <span class=o>/</span><span class=n>app01</span><span class=o>/</span><span class=n>ab_file</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=n>request</span><span class=o>.</span><span class=n>path_info</span>       <span class=o>-&gt;</span> <span class=o>/</span><span class=n>app01</span><span class=o>/</span><span class=n>ab_file</span><span class=o>/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ—¢èƒ½æ‹¿è·¯ç”± ä¹Ÿèƒ½æ‹¿å‚æ•° ä¸Šé¢ä¸¤ä¸ªæ–¹æ³•ä¸èƒ½æ‹¿å‚æ•°</span>
</span></span><span class=line><span class=cl><span class=n>request</span><span class=o>.</span><span class=n>get_full_path</span><span class=p>()</span> <span class=o>-&gt;</span> <span class=o>/</span><span class=n>app01</span><span class=o>/</span><span class=n>ab_file</span><span class=o>/</span><span class=err>?</span><span class=n>username</span><span class=o>=</span><span class=n>minho</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>request.body  # åŸç”Ÿçš„ æµè§ˆå™¨å‘è¿‡æ¥çš„äºŒè¿›åˆ¶æ•°æ®
</span></span></span><span class=line><span class=cl><span class=s2>  - GET      b&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s2>  - POST      
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=fbvä¸cbv>FBVä¸CBV</h3><p><strong>è§†å›¾å‡½æ•°æ—¢å¯ä»¥æ˜¯å‡½æ•°ä¹Ÿå¯ä»¥æ˜¯ç±»</strong></p><h4 id=fbv>FBV</h4><p><strong>åŸºäºå‡½æ•°çš„è§†å›¾</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># FBV</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>index</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;index&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=cbv>CBV</h4><ul><li><strong>åŸºäºç±»çš„è§†å›¾</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># CBVè·¯ç”± urls.pyå†™æ³•</span>
</span></span><span class=line><span class=cl><span class=c1># as_view() CBVè·¯ç”±å†™æ³•å’ŒFBVæœ‰ç‚¹ä¸ä¸€æ ·(å…¶å®æœ¬è´¨ç›¸åŒ)</span>
</span></span><span class=line><span class=cl><span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^login/&#39;</span><span class=p>,</span> <span class=n>views</span><span class=o>.</span><span class=n>MyLogin</span><span class=o>.</span><span class=n>as_view</span><span class=p>()),</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ç±»è§†å›¾</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.views</span> <span class=kn>import</span> <span class=n>View</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>MyLogin</span><span class=p>(</span><span class=n>View</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;åªè¦æ˜¯å¤„ç†ä¸šåŠ¡é€»è¾‘çš„è§†å›¾å‡½æ•° å½¢å‚é‡Œé¢è‚¯å®šè¦æœ‰request&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>render</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=s1>&#39;form.html&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>post</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;postæ–¹æ³•&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>FBVå’ŒCBVå„æœ‰åƒç§‹
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>CBVç‰¹ç‚¹ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>  èƒ½å¤Ÿç›´æ¥æ ¹æ®è¯·æ±‚æ–¹å¼çš„ä¸åŒ ç›´æ¥åŒ¹é…åˆ°å¯¹åº”çš„æ–¹æ³•æ‰§è¡Œ
</span></span></span><span class=line><span class=cl><span class=s2> 
</span></span></span><span class=line><span class=cl><span class=s2>  æ€è€ƒï¼šå†…éƒ¨å¦‚ä½•å®ç°çš„?  -- **éå¸¸é‡è¦** å­¦ä¹ DRFå¿…å¤‡çš„çŸ¥è¯†ç‚¹
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>CBVæºç å‰–æ</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># åƒä¸‡ä¸è¦éšæ„ä¿®æ”¹æºç  å‡ºBUGå¾ˆéš¾æ‰¾</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>çªç ´å£</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># CBVæºç å‰–æ çªç ´å£åœ¨urls.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.conf.urls</span> <span class=kn>import</span> <span class=n>url</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>app02</span> <span class=kn>import</span> <span class=n>views</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>urlpatterns</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^index/&#39;</span><span class=p>,</span> <span class=n>views</span><span class=o>.</span><span class=n>index</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^login/&#39;</span><span class=p>,</span> <span class=n>views</span><span class=o>.</span><span class=n>LoginView</span><span class=o>.</span><span class=n>as_view</span><span class=p>()),</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>å‡½æ•°/æ–¹æ³• åŠ æ‹¬å·æ‰§è¡Œä¼˜å…ˆçº§æœ€é«˜ 
</span></span></span><span class=line><span class=cl><span class=s2>as_view() ç«‹å³æ‰§è¡Œ
</span></span></span><span class=line><span class=cl><span class=s2>çŒœæµ‹ as_view()å¯ä»¥é€šè¿‡æˆ‘ä»¬è‡ªå®šä¹‰çš„ç±»LoginViewç±»ç›´æ¥è°ƒç”¨ å¯èƒ½æ˜¯ä¸‹é¢2ç§æƒ…å†µ
</span></span></span><span class=line><span class=cl><span class=s2>  - 1. @staticmethod ä¿®é¥°çš„é™æ€æ–¹æ³•
</span></span></span><span class=line><span class=cl><span class=s2>  - 2. @classmethod ä¿®é¥°çš„ç±»æ–¹æ³•
</span></span></span><span class=line><span class=cl><span class=s2> 
</span></span></span><span class=line><span class=cl><span class=s2>1. as_view()æœ¬è´¨
</span></span></span><span class=line><span class=cl><span class=s2>  url(r&#39;^login/&#39;, views.LoginView.as_view())
</span></span></span><span class=line><span class=cl><span class=s2>  ä¸Šè¿°ä»£ç åœ¨å¯åŠ¨djangoçš„æ—¶å€™å°±ä¼šç«‹åˆ»æ‰§è¡Œas_view()æ–¹æ³•
</span></span></span><span class=line><span class=cl><span class=s2>  as_view()æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªå‡½æ•° view
</span></span></span><span class=line><span class=cl><span class=s2>  =&gt; url(^&#39;^login/&#39;, views.view)  =&gt; å˜å½¢å å’ŒFBVä¸€æ ·
</span></span></span><span class=line><span class=cl><span class=s2>  CBVä¸FBVåœ¨è·¯ç”±åŒ¹é…ä¸Š æœ¬è´¨æ˜¯ä¸€æ ·çš„ éƒ½æ˜¯è·¯ç”± å¯¹åº” å‡½æ•°(å‡½æ•°å†…å­˜åœ°å€)
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>2. æµè§ˆå™¨è®¿é—®/login/ è§¦å‘views.view viewå…·ä½“åšäº†ä»€ä¹ˆ? 
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>as_view()æœ¬è´¨</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@classonlymethod</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>as_view</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=o>**</span><span class=n>initkwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>view</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span> <span class=o>=</span> <span class=bp>cls</span><span class=p>(</span><span class=o>**</span><span class=n>initkwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># clsæ˜¯æˆ‘ä»¬è‡ªå·±å†™çš„ç±» è°ƒç”¨çš„æ—¶å€™è‡ªåŠ¨æ³¨å…¥</span>
</span></span><span class=line><span class=cl>        <span class=c1># self = LoginView(**initkwargs) äº§ç”Ÿä¸€ä¸ªæˆ‘ä»¬è‡ªå·±å†™çš„ç±»çš„å®ä¾‹</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=s1>&#39;get&#39;</span><span class=p>)</span> <span class=ow>and</span> <span class=ow>not</span> <span class=nb>hasattr</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=s1>&#39;head&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>head</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>request</span> <span class=o>=</span> <span class=n>request</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>args</span> <span class=o>=</span> <span class=n>args</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>kwargs</span> <span class=o>=</span> <span class=n>kwargs</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>dispatch</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        ä»¥å ç»å¸¸ä¼šéœ€è¦çœ‹æºç  ä½†æ˜¯åœ¨çœ‹Pythonæºç çš„æ—¶å€™ ä¸€å®šè¦æ—¶åˆ»æé†’è‡ªå·± é¢å‘å¯¹è±¡å±æ€§æ–¹æ³•æŸ¥æ‰¾é¡ºåº mro
</span></span></span><span class=line><span class=cl><span class=s2>        æ€»ç»“ï¼šçœ‹æºç  åªè¦çœ‹åˆ°äº†self.xxx ä¸€å®šè¦é—®è‡ªå·± å½“å‰è¿™ä¸ªselfåˆ°åº•æ˜¯è°
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>view</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>dispatch CBVç²¾é«“</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># CBVçš„ç²¾é«“</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>dispatch</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># Try to dispatch to the right method; if a method doesn&#39;t exist,</span>
</span></span><span class=line><span class=cl>    <span class=c1># defer to the error handler. Also defer to the error handler if the</span>
</span></span><span class=line><span class=cl>    <span class=c1># request method isn&#39;t on the approved list.</span>
</span></span><span class=line><span class=cl>    <span class=c1># è·å–å½“å‰è¯·æ±‚çš„å°å†™æ ¼å¼ ç„¶åæ¯”å¯¹å½“å‰è¯·æ±‚æ–¹å¼æ˜¯å¦åˆæ³•</span>
</span></span><span class=line><span class=cl>    <span class=c1># getè¯·æ±‚ä¸ºä¾‹</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>http_method_names</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>       åå°„ï¼šé€šè¿‡å­—ç¬¦ä¸²æ¥æ“ä½œå¯¹è±¡çš„å±æ€§æˆ–æ–¹æ³• è¿è¡Œæ—¶è·å–ç±»å‹å®šä¹‰ä¿¡æ¯
</span></span></span><span class=line><span class=cl><span class=s2>       handler = getattr(è‡ªå·±å†™çš„ç±»äº§ç”Ÿçš„å¯¹è±¡, &#39;get&#39;, å½“æ‰¾ä¸åˆ°getå±æ€§æˆ–è€…æ–¹æ³•çš„æ—¶å€™å°±ä¼šç”¨ç¬¬ä¸‰ä¸ªå‚æ•°)
</span></span></span><span class=line><span class=cl><span class=s2>       handler = æˆ‘ä»¬è‡ªå·±å†™çš„ç±»é‡Œé¢çš„getæ–¹æ³•
</span></span></span><span class=line><span class=cl><span class=s2>       &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>handler</span> <span class=o>=</span> <span class=nb>getattr</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span><span class=o>.</span><span class=n>lower</span><span class=p>(),</span> <span class=bp>self</span><span class=o>.</span><span class=n>http_method_not_allowed</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>handler</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>http_method_not_allowed</span>
</span></span><span class=line><span class=cl>    <span class=c1># è‡ªåŠ¨è°ƒç”¨getæ–¹æ³•</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>handler</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>åå°„è¡¥å……</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>è¿è¡Œæ—¶</span><span class=err>ï¼š</span><span class=n>runtime</span> <span class=n>åŒºåˆ«äºç¼–è¯‘æ—¶</span> <span class=n>æŒ‡çš„æ˜¯ç¨‹åºè¢«åŠ è½½åˆ°å†…å­˜ä¸­æ‰§è¡Œçš„æ—¶å€™</span>
</span></span><span class=line><span class=cl><span class=n>åå°„</span><span class=err>ï¼š</span><span class=n>reflection</span> <span class=n>æ‰§è¡Œæ˜¯è¿è¡Œæ˜¯è·å–ç±»å‹å®šä¹‰ä¿¡æ¯</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>ä¸€ä¸ªå¯¹è±¡èƒ½å¤Ÿåœ¨è¿è¡Œæ—¶ åƒç…§é•œå­ä¸€æ · åå°„å‡ºå…¶ç±»å‹ä¿¡æ¯
</span></span></span><span class=line><span class=cl><span class=s2>ç®€å•è¯´ åœ¨Pythonä¸­ èƒ½å¤Ÿé€šè¿‡ä¸€ä¸ªå¯¹è±¡ æ‰¾å‡ºå…¶type class attributeæˆ–methodçš„èƒ½åŠ› æˆä¸ºåå°„æˆ–è€…è‡ªçœ
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>Pythonæºç é‡Œ ä½¿ç”¨æœ€é¢‘ç¹çš„å…¶å®å°±æ˜¯åå°„
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>å…·æœ‰åå°„èƒ½åŠ›çš„å‡½æ•°æœ‰</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=nb>type</span><span class=p>()</span> 
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=nb>isinstance</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>callable</span><span class=p>()</span> 
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=nb>dir</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=nb>getattr</span><span class=p>()</span> <span class=n>ç­‰ç­‰</span><span class=o>...</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=n>åå°„ç›¸å…³çš„é­”æœ¯æ–¹æ³•</span><span class=err>ï¼š</span>
</span></span><span class=line><span class=cl><span class=fm>__getattr__</span>
</span></span><span class=line><span class=cl><span class=fm>__setattr__</span>
</span></span><span class=line><span class=cl><span class=fm>__delattr__</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=fm>__getattribute__</span>  <span class=c1># ç‰¹æ®Š å°½é‡ä¸ç”¨</span>
</span></span></code></pre></td></tr></table></div></div><div class=table-wrapper><table><thead><tr><th>å†…å»ºå‡½æ•°</th><th>æ„ä¹‰</th></tr></thead><tbody><tr><td>getattr(object, name[, default])</td><td>é€šè¿‡nameè¿”å›objectçš„å±æ€§å€¼ å½“å±æ€§ä¸å­˜åœ¨ å°†ä½¿ç”¨defaultè¿”å› å¦‚æœæ²¡æœ‰default åˆ™æŠ›å‡ºAttributeError nameå¿…é¡»ä¸º<strong>å­—ç¬¦ä¸²</strong></td></tr><tr><td>setattr(object, name, value)</td><td>objectçš„å±æ€§å­˜åœ¨åˆ™è¦†ç›– ä¸å­˜åœ¨åˆ™æ–°å¢</td></tr><tr><td>hasattr(object, name)</td><td>åˆ¤æ–­å¯¹è±¡æ˜¯å¦å…·æœ‰è¿™ä¸ªåå­—çš„å±æ€§ nameå¿…é¡»ä¸º<strong>å­—ç¬¦ä¸²</strong></td></tr></tbody></table></div><h3 id=cbvå¦‚ä½•æ·»åŠ è£…é¥°å™¨>CBVå¦‚ä½•æ·»åŠ è£…é¥°å™¨</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>CBVä¸­</span> <span class=n>djangoä¸å»ºè®®ä½ ç›´æ¥ç»™ç±»çš„æ–¹æ³•åŠ è£…é¥°å™¨</span>
</span></span><span class=line><span class=cl><span class=n>æ— è®ºè¯¥è£…é¥°å™¨èƒ½å¦æ­£å¸¸å·¥ä½œ</span> <span class=n>éƒ½ä¸å»ºè®®å¢åŠ </span>
</span></span></code></pre></td></tr></table></div></div><h4 id=åŠ åœ¨cbvè§†å›¾çš„å…·ä½“æ–¹æ³•ä¸Š>åŠ åœ¨CBVè§†å›¾çš„å…·ä½“æ–¹æ³•ä¸Š</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.views</span> <span class=kn>import</span> <span class=n>View</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.utils.decorators</span> <span class=kn>import</span> <span class=n>method_decorator</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>MyLogin</span><span class=p>(</span><span class=n>View</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    CBVä¸­ djangoä¸å»ºè®®ä½ ç›´æ¥ç»™ç±»çš„æ–¹æ³•åŠ è£…é¥°å™¨
</span></span></span><span class=line><span class=cl><span class=s2>    æ— è®ºè¯¥è£…é¥°å™¨èƒ½å¦æ­£å¸¸å·¥ä½œ éƒ½ä¸å»ºè®®å¢åŠ 
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># @login_auth  # ä¸èƒ½ç›´æ¥ä½¿ç”¨è£…é¥°å™¨</span>
</span></span><span class=line><span class=cl>    <span class=nd>@method_decorator</span><span class=p>(</span><span class=n>login_auth</span><span class=p>)</span>  <span class=c1># æ–¹å¼1: æŒ‡åé“å§“</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;GETè¯·æ±‚&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nd>@method_decorator</span><span class=p>(</span><span class=n>login_auth</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>post</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;POSTè¯·æ±‚&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=åŠ åœ¨ç±»è§†å›¾ä¸Š>åŠ åœ¨ç±»è§†å›¾ä¸Š</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.views</span> <span class=kn>import</span> <span class=n>View</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.utils.decorators</span> <span class=kn>import</span> <span class=n>method_decorator</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ–¹å¼2 å¯ä»¥æ·»åŠ å¤šä¸ª é’ˆå¯¹ä¸åŒçš„æ–¹æ³•åŠ ä¸åŒçš„è£…é¥°å™¨</span>
</span></span><span class=line><span class=cl><span class=nd>@method_decorator</span><span class=p>(</span><span class=n>login_auth</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=s1>&#39;get&#39;</span><span class=p>)</span>  
</span></span><span class=line><span class=cl><span class=nd>@method_decorator</span><span class=p>(</span><span class=n>login_auth</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=s1>&#39;post&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>MyLogin</span><span class=p>(</span><span class=n>View</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    CBVä¸­ djangoä¸å»ºè®®ä½ ç›´æ¥ç»™ç±»çš„æ–¹æ³•åŠ è£…é¥°å™¨
</span></span></span><span class=line><span class=cl><span class=s2>    æ— è®ºè¯¥è£…é¥°å™¨èƒ½å¦æ­£å¸¸å·¥ä½œ éƒ½ä¸å»ºè®®å¢åŠ 
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;GETè¯·æ±‚&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>post</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;POSTè¯·æ±‚&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=åŠ åœ¨dispathæ–¹æ³•ä¸Š>åŠ åœ¨dispathæ–¹æ³•ä¸Š</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.views</span> <span class=kn>import</span> <span class=n>View</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.utils.decorators</span> <span class=kn>import</span> <span class=n>method_decorator</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>MyLogin</span><span class=p>(</span><span class=n>View</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    CBVä¸­ djangoä¸å»ºè®®ä½ ç›´æ¥ç»™ç±»çš„æ–¹æ³•åŠ è£…é¥°å™¨
</span></span></span><span class=line><span class=cl><span class=s2>    æ— è®ºè¯¥è£…é¥°å™¨èƒ½å¦æ­£å¸¸å·¥ä½œ éƒ½ä¸å»ºè®®å¢åŠ 
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># çœ‹CBVæºç å¯ä»¥å¾—å‡º CBVé‡Œé¢çš„æ‰€æœ‰æ–¹æ³•åœ¨æ‰§è¡Œä¹‹å‰éƒ½éœ€è¦å…ˆç»è¿‡dispathæ–¹æ³•(è¯¥æ–¹æ³•ä½ å¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªåˆ†å‘æ–¹æ³•)</span>
</span></span><span class=line><span class=cl>    <span class=c1># æ–¹å¼3: é‡å†™dispathæ–¹æ³• ç»™dispathæ–¹æ³•è£… ä¼šç›´æ¥ä½œç”¨äºå½“å‰ç±»é‡Œé¢æ‰€æœ‰çš„æ–¹æ³•</span>
</span></span><span class=line><span class=cl>    <span class=nd>@method_decorator</span><span class=p>(</span><span class=n>login_auth</span><span class=p>)</span>  
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>dispatch</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>dispatch</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;GETè¯·æ±‚&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>post</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;POSTè¯·æ±‚&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=æ¨¡æ¿å±‚>æ¨¡æ¿å±‚</h2><h3 id=æ¨¡æ¿è¯­æ³•>æ¨¡æ¿è¯­æ³•</h3><h4 id=ä¼ å€¼>ä¼ å€¼</h4><p><strong>æ¨¡æ¿è¯­æ³•ä¼ å€¼</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>{# #}    # æ³¨é‡Š
</span></span><span class=line><span class=cl>{{ }}    # å˜é‡ç›¸å…³
</span></span><span class=line><span class=cl>{% %}    # é€»è¾‘ç›¸å…³
</span></span></code></pre></td></tr></table></div></div><p><strong>åç«¯ä¼ å€¼ç¤ºä¾‹</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>index</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># æ¨¡æ¿è¯­æ³•å¯ä»¥ä¼ é€’çš„åç«¯Pythonæ•°æ®ç±»å‹</span>
</span></span><span class=line><span class=cl>    <span class=n>n</span> <span class=o>=</span> <span class=mi>123</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span> <span class=o>=</span> <span class=mf>11.11</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=s1>&#39;name is minho&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>lst</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;kimi&#39;</span><span class=p>,</span> <span class=s1>&#39;huahua&#39;</span><span class=p>,</span> <span class=s1>&#39;minho&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>tup</span> <span class=o>=</span> <span class=p>(</span><span class=s1>&#39;11&#39;</span><span class=p>,</span> <span class=s1>&#39;22&#39;</span><span class=p>,</span> <span class=mi>33</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>dic</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;username&#39;</span><span class=p>:</span> <span class=s1>&#39;minho&#39;</span><span class=p>,</span> <span class=s1>&#39;age&#39;</span><span class=p>:</span><span class=mi>20</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>se</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;æŒ‰çº§åˆ«çš„&#39;</span><span class=p>,</span> <span class=s1>&#39;å¯†ç &#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>func</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;æˆ‘è¢«æ‰§è¡Œäº†&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;func return res&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>class</span> <span class=nc>MyClass</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>def</span> <span class=nf>get_self</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=s1>&#39;self&#39;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nd>@staticmethod</span>
</span></span><span class=line><span class=cl>        <span class=k>def</span> <span class=nf>get_static</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=s1>&#39;static method&#39;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nd>@classmethod</span>
</span></span><span class=line><span class=cl>        <span class=k>def</span> <span class=nf>get_cls</span><span class=p>(</span><span class=bp>cls</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=s1>&#39;cls&#39;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># å¯¹è±¡è¢«å±•ç¤ºåˆ°htmlé¡µé¢ä¸Š å°±ç±»ä¼¼äºæ‰§è¡Œäº†æ‰“å°æ“ä½œä¹Ÿä¼šè§¦å‘__str__æ–¹æ³•</span>
</span></span><span class=line><span class=cl>        <span class=k>def</span> <span class=fm>__str__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=s1>&#39;MyClass obj&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>obj</span> <span class=o>=</span> <span class=n>MyClass</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=s1>&#39;index.html&#39;</span><span class=p>,</span> <span class=nb>locals</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>å‰ç«¯å±•ç¤º</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&lt;p&gt;æ•´å‹ï¼š{{ n }} &lt;/p&gt;
</span></span><span class=line><span class=cl>&lt;p&gt;æµ®ç‚¹å‹ï¼š{{ f }} &lt;/p&gt;
</span></span><span class=line><span class=cl>&lt;p&gt;å­—ç¬¦ä¸²ï¼š{{ s }} &lt;/p&gt;
</span></span><span class=line><span class=cl>&lt;p&gt;å¸ƒå°”å€¼ï¼š{{ b }} &lt;/p&gt;
</span></span><span class=line><span class=cl>&lt;p&gt;åˆ—è¡¨ï¼š{{ lst }}&lt;/p&gt;
</span></span><span class=line><span class=cl>&lt;p&gt;å…ƒç»„ï¼š{{ tup }}&lt;/p&gt;
</span></span><span class=line><span class=cl>&lt;p&gt;å­—å…¸ï¼š{{ dic }}&lt;/p&gt;
</span></span><span class=line><span class=cl>&lt;p&gt;é›†åˆï¼š{{ se }}&lt;/p&gt;
</span></span><span class=line><span class=cl>{# ä¼ é€’å‡½æ•°åä¼šè‡ªåŠ¨åŠ æ‹¬å·è°ƒç”¨ ä½†æ˜¯æ¨¡æ¿è¯­æ³•ä¸æ”¯æŒç»™å‡½æ•°ä¼ é¢å¤–çš„å‚æ•° å¦‚æœæœ‰å‚æ•° ä¸æ‰§è¡Œä¹Ÿä¸æŠ¥é”™ #}
</span></span><span class=line><span class=cl>&lt;p&gt;å‡½æ•°ï¼š{{ func }}&lt;/p&gt;
</span></span><span class=line><span class=cl>{# ä¼ ç±»åçš„æ—¶å€™ä¹Ÿä¼šè‡ªåŠ¨åŠ æ‹¬å·è°ƒç”¨(å®ä¾‹åŒ–) #}
</span></span><span class=line><span class=cl>&lt;p&gt;ç±»ï¼š{{ MyClass }}&lt;/p&gt;
</span></span><span class=line><span class=cl>&lt;p&gt;ç±»å¯¹è±¡(ins)ï¼š{{ obj }}&lt;/p&gt;
</span></span><span class=line><span class=cl>{# Djangoæ¨¡æ¿è¯­æ³• èƒ½å¤Ÿè‡ªåŠ¨åˆ¤æ–­å‡ºå½“å‰çš„å˜é‡åæ˜¯å¦å¯ä»¥åŠ æ‹¬å·è°ƒç”¨ å¦‚æœå¯ä»¥å°±ä¼šè‡ªåŠ¨æ‰§è¡Œ é’ˆå¯¹çš„æ˜¯å‡½æ•°åå’Œç±»å #}
</span></span><span class=line><span class=cl>&lt;p&gt;æ™®é€šæ–¹æ³•ï¼š{{ obj.get_self }}&lt;/p&gt;
</span></span><span class=line><span class=cl>&lt;p&gt;é™æ€æ–¹æ³•ï¼š{{ obj.get_static }}&lt;/p&gt;
</span></span><span class=line><span class=cl>&lt;p&gt;ç±»æ–¹æ³•ï¼š{{ obj.get_cls }}&lt;/p&gt;
</span></span></code></pre></td></tr></table></div></div><h4 id=å–å€¼>å–å€¼</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>djangoæ¨¡æ¿è¯­æ³•çš„å–å€¼ æ˜¯å›ºå®šçš„æ ¼å¼ åªèƒ½ç”¨&#34;å¥ç‚¹ç¬¦&#34; .
</span></span><span class=line><span class=cl>å³å¯ç‚¹é”® ä¹Ÿå¯ä»¥ç‚¹ç´¢å¼•  ä¹Ÿå¯ä»¥ä¸¤è€…æ··ç”¨
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>username: {{ dic.username }}<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>listå–å€¼: {{ lst.0 }}<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>info: {{ dic.hobby.3.info}}<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=è¿‡æ»¤å™¨>è¿‡æ»¤å™¨</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># è¿‡æ»¤å™¨ å°±ç±»ä¼¼äºæ˜¯æ¨¡æ¿è¯­æ³•å†…ç½®çš„ å†…ç½®æ–¹æ³•</span>
</span></span><span class=line><span class=cl><span class=c1># djangoå†…ç½®æœ‰60å¤šä¸ªè¿‡æ»¤å™¨ äº†è§£10ä¸ªå·¦å³å°±å·®ä¸å¤š åé¢é‡åˆ°å†å»äº†è§£</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>åŸºæœ¬è¯­æ³•</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>{{ æ•°æ®|è¿‡æ»¤å™¨:å‚æ•° }}
</span></span></code></pre></td></tr></table></div></div><ul><li>å¸¸ç”¨è¿‡æ»¤å™¨</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&lt;h1&gt;è¿‡æ»¤å™¨&lt;/h1&gt;
</span></span><span class=line><span class=cl>&lt;p&gt;ç»Ÿè®¡é•¿åº¦ï¼š{{ s|length }}&lt;/p&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>{# ç¬¬ä¸€ä¸ªå‚æ•°å¸ƒå°”å€¼ä¸ºTrue å°±å±•ç¤ºç¬¬ä¸€ä¸ªå‚æ•°çš„å€¼ å¦åˆ™ä½¿ç”¨defaultçš„å€¼ ç±»ä¼¼ dict.get(d, default) #}
</span></span><span class=line><span class=cl>&lt;p&gt;é»˜è®¤å€¼ï¼š{{ b|default:&#39;å•¥ä¹Ÿä¸æ˜¯&#39; }}&lt;/p&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;p&gt;æ–‡ä»¶å¤§å°ï¼š{{ file_size|filesizeformat }}&lt;/p&gt;
</span></span><span class=line><span class=cl>&lt;p&gt;æ—¥æœŸæ ¼å¼åŒ–ï¼š{{ current_time|date:&#39;Y-m-d H:i:s&#39; }}&lt;/p&gt;
</span></span><span class=line><span class=cl>&lt;p&gt;åˆ‡ç‰‡æ“ä½œ(æ”¯æŒæ­¥é•¿)ï¼š{{ lst|slice:&#39;0:4:3&#39; }}&lt;/p&gt;
</span></span><span class=line><span class=cl>&lt;p&gt;åˆ‡å–å­—ç¬¦(åŒ…å«3ä¸ª.)ï¼š{{ info|truncatechars:9 }}&lt;/p&gt;
</span></span><span class=line><span class=cl>&lt;p&gt;åˆ‡å–å•è¯(ä¸åŒ…å«3ä¸ª. åªæŒ‰ç…§ç©ºæ ¼åˆ‡)ï¼š{{ eng|truncatewords:5 }}&lt;/p&gt;
</span></span><span class=line><span class=cl>&lt;p&gt;ç§»é™¤ç‰¹å®šçš„å­—ç¬¦ï¼š{{ eng|cut:&#39;model&#39; }}&lt;/p&gt;
</span></span><span class=line><span class=cl>&lt;p&gt;æ‹¼æ¥æ“ä½œï¼š{{ lst|join:&#39;$&#39; }}&lt;/p&gt;
</span></span><span class=line><span class=cl>&lt;p&gt;æ‹¼æ¥æ“ä½œ(åŠ æ³•): {{ n|add:&#39;10&#39; }}&lt;/p&gt;
</span></span><span class=line><span class=cl>&lt;p&gt;æ‹¼æ¥æ“ä½œ(åŠ æ³•): {{ s|add:eng }}&lt;/p&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>{# hhhé»˜è®¤ä¸è½¬ä¹‰æ ‡ç­¾ ä¸ºäº†å®‰å…¨ ä¸æ‰§è¡Œæ¶æ„scriptsä»£ç #}
</span></span><span class=line><span class=cl>&lt;p&gt;è½¬ä¹‰ï¼š{{ hhh|safe }}&lt;/p&gt;
</span></span><span class=line><span class=cl>&lt;p&gt;è½¬ä¹‰ï¼š{{ sss|safe }}&lt;/p&gt;
</span></span><span class=line><span class=cl>&lt;p&gt;è½¬ä¹‰ï¼š{{ res }}&lt;/p&gt;
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>è½¬ä¹‰</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># æ¨¡æ¿è¯­æ³• é»˜è®¤ä¸è½¬ä¹‰æ ‡ç­¾ ä¸ºäº†å®‰å…¨ ä¸æ‰§è¡Œæ¶æ„scriptsä»£ç </span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è½¬ä¹‰æ ‡ç­¾ç”¨æ³• safeå‚æ•°</span>
</span></span><span class=line><span class=cl><span class=c1># å‰ç«¯</span>
</span></span><span class=line><span class=cl><span class=p>{{</span> <span class=n>var</span><span class=o>|</span><span class=n>safe</span> <span class=p>}}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># åç«¯</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.utils.safestring</span> <span class=kn>import</span> <span class=n>mark_safe</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>mark_safe</span><span class=p>(</span><span class=s1>&#39;&lt;h1&gt;æ–°æ–°&lt;/h1&gt;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>ä»¥åä½ åœ¨å†™å…¨æ ˆé¡¹ç›®çš„æ—¶å€™ å‰ç«¯ä»£ç ä¸ä¸€å®šéè¦åœ¨å‰ç«¯é¡µé¢ä¹¦å†™
</span></span></span><span class=line><span class=cl><span class=s2>ä¹Ÿå¯ä»¥å…ˆåœ¨åç«¯å†™å¥½ ç„¶åå†ä¼ é€’ç»™å‰ç«¯é¡µé¢
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=æ ‡ç­¾>æ ‡ç­¾</h4><p><strong>ä¸è¦è¢«åå­—å¹²æ‰° æ ‡ç­¾å°±æ˜¯ä¸€å †é€»è¾‘</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>{# forå¾ªç¯ #}
</span></span><span class=line><span class=cl>{% for l in lst %}
</span></span><span class=line><span class=cl>    &lt;p&gt;{{ forloop }}&lt;/p&gt;
</span></span><span class=line><span class=cl>    &lt;p&gt;{{ item }}&lt;/p&gt;    # ä¸€ä¸ªä¸ªå…ƒç´ 
</span></span><span class=line><span class=cl>{% endfor %}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>{# forloopéœ€è¦æŒæ¡å®ƒçš„å‚æ•° #}
</span></span><span class=line><span class=cl>{
</span></span><span class=line><span class=cl>&#39;parentloop&#39;: {}, 
</span></span><span class=line><span class=cl>&#39;counter0&#39;: 0, 
</span></span><span class=line><span class=cl>&#39;counter&#39;: 1, 
</span></span><span class=line><span class=cl>&#39;revcounter&#39;: 6, 
</span></span><span class=line><span class=cl>&#39;revcounter0&#39;: 5, 
</span></span><span class=line><span class=cl>&#39;first&#39;: True, 
</span></span><span class=line><span class=cl>&#39;last&#39;: False
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>{# ifåˆ¤æ–­ #}
</span></span><span class=line><span class=cl>{% if b %}
</span></span><span class=line><span class=cl>    &lt;p&gt;True res&lt;/p&gt;
</span></span><span class=line><span class=cl>{% elif s %}
</span></span><span class=line><span class=cl>    &lt;p&gt;elif res&lt;/p&gt;
</span></span><span class=line><span class=cl>{% else %}
</span></span><span class=line><span class=cl>    &lt;p&gt;False res&lt;/p&gt;
</span></span><span class=line><span class=cl>{% endif %}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>{# for ifæ··åˆä½¿ç”¨ #}
</span></span><span class=line><span class=cl>{% for item in lst_empty %}
</span></span><span class=line><span class=cl>    {% if forloop.first %}
</span></span><span class=line><span class=cl>        &lt;p&gt;ç¬¬ä¸€æ¬¡å¾ªç¯&lt;/p&gt;
</span></span><span class=line><span class=cl>    {% elif forloop.last %}
</span></span><span class=line><span class=cl>        &lt;p&gt;æœ€åä¸€æ¬¡å¾ªç¯&lt;/p&gt;
</span></span><span class=line><span class=cl>    {% else %}
</span></span><span class=line><span class=cl>        &lt;p&gt;{{ item }}&lt;/p&gt;
</span></span><span class=line><span class=cl>    {% endif %}
</span></span><span class=line><span class=cl>    {% empty %}
</span></span><span class=line><span class=cl>        &lt;p&gt;forå¾ªç¯çš„å¯è¿­ä»£å¯¹è±¡ å†…éƒ¨æ²¡æœ‰å…ƒç´  æ ¹æœ¬æ²¡æ³•å¾ªç¯&lt;/p&gt;
</span></span><span class=line><span class=cl>{% endfor %}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>{# å¯ä»¥ä½¿ç”¨å­—å…¸çš„æ–¹æ³• #}
</span></span><span class=line><span class=cl>{% for item in dic.keys %}
</span></span><span class=line><span class=cl>    &lt;p&gt;{{ item }}&lt;/p&gt;
</span></span><span class=line><span class=cl>{% endfor %}
</span></span><span class=line><span class=cl>{% for item in dic.items %}
</span></span><span class=line><span class=cl>    &lt;p&gt;{{ item }}&lt;/p&gt;
</span></span><span class=line><span class=cl>{% endfor %}
</span></span><span class=line><span class=cl>{% for value in dic.values %}
</span></span><span class=line><span class=cl>    &lt;p&gt;{{ value }}&lt;/p&gt;
</span></span><span class=line><span class=cl>{% endfor %}
</span></span><span class=line><span class=cl>{% for item in lst %}
</span></span><span class=line><span class=cl>    &lt;p&gt;{{ item }}&lt;/p&gt;
</span></span><span class=line><span class=cl>{% endfor %}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>{# withèµ·åˆ«å #}
</span></span><span class=line><span class=cl>{% with dic.hobby.3.info as nb %}
</span></span><span class=line><span class=cl>    {# åœ¨withè¯­æ³•å†… å°±å¯ä»¥é€šè¿‡asåé¢çš„åˆ«åå¿«é€Ÿçš„ä½¿ç”¨åˆ°å‰é¢éå¸¸å¤æ‚è·å–æ•°æ®çš„æ–¹å¼ #}
</span></span><span class=line><span class=cl>    &lt;p&gt;{{ nb }}&lt;/p&gt;
</span></span><span class=line><span class=cl>{% endwith %}
</span></span></code></pre></td></tr></table></div></div><h3 id=è‡ªå®šä¹‰>è‡ªå®šä¹‰</h3><p><strong>è¿‡æ»¤å™¨/æ ‡ç­¾åŠinclusion_tag</strong></p><ul><li><strong>è‡ªå®šä¹‰è¿‡æ»¤å™¨</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>å…ˆä¸‰æ­¥èµ°ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>  1. åœ¨åº”ç”¨ä¸‹åˆ›å»ºä¸€ä¸ªåå­—**å¿…é¡»**å« templatetagsæ–‡ä»¶å¤¹
</span></span></span><span class=line><span class=cl><span class=s2>  2. åœ¨è¯¥æ–‡ä»¶å¤¹å†… åˆ›å»ºä»»æ„åç§°çš„pyæ–‡ä»¶ e.g: mytag.py
</span></span></span><span class=line><span class=cl><span class=s2>  3. åœ¨è¯¥pyæ–‡ä»¶å†… **å¿…é¡»**å…ˆä¹¦å†™ä¸‹é¢ä¸¤å¥å›ºå®šçš„ä»£ç  (å•è¯ä¸€ä¸ªéƒ½ä¸èƒ½é”™)
</span></span></span><span class=line><span class=cl><span class=s2>    form django import template
</span></span></span><span class=line><span class=cl><span class=s2>    register = template.Library()
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django</span> <span class=kn>import</span> <span class=n>template</span>
</span></span><span class=line><span class=cl><span class=n>register</span> <span class=o>=</span> <span class=n>template</span><span class=o>.</span><span class=n>Library</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1># è‡ªå®šä¹‰è¿‡æ»¤å™¨(å‚æ•°æœ€å¤šåªæœ‰2ä¸ª)</span>
</span></span><span class=line><span class=cl><span class=c1># ä¸»è¦ä½¿ç”¨ name=&#34;&#34; åé¢çš„åå­— ä¹Ÿå°±æ˜¯è¿‡æ»¤å™¨åå­— å‡½æ•°çš„åå­—æ— æ‰€è°“ éšä¾¿å–</span>
</span></span><span class=line><span class=cl><span class=nd>@register.filter</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s1>&#39;myfilter&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>my_sum</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>x</span> <span class=o>+</span> <span class=n>y</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># htmlä½¿ç”¨</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>h1</span><span class=o>&gt;</span><span class=n>è‡ªå®šä¹‰çš„ä½¿ç”¨</span><span class=p>(</span><span class=n>è¿‡æ»¤å™¨</span> <span class=n>æœ€å¤šåªèƒ½æœ‰2ä¸ªå‚æ•°</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>h1</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=o>%</span> <span class=n>load</span> <span class=n>mytags</span> <span class=o>%</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>p</span><span class=o>&gt;</span><span class=p>{{</span> <span class=n>n</span><span class=o>|</span><span class=n>myfilter</span><span class=p>:</span><span class=mi>666</span> <span class=p>}}</span><span class=o>&lt;/</span><span class=n>p</span><span class=o>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>è‡ªå®šä¹‰æ ‡ç­¾</strong></li></ul><p><strong>ç±»ä¼¼è‡ªå®šä¹‰å‡½æ•°</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># è‡ªå®šä¹‰æ ‡ç­¾(å‚æ•°å¯ä»¥æœ‰å¤šä¸ª)</span>
</span></span><span class=line><span class=cl><span class=nd>@register.simple_tag</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s1>&#39;plus&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>index</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>c</span><span class=p>,</span> <span class=n>d</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s2>&#34;</span><span class=si>{}</span><span class=s2>-</span><span class=si>{}</span><span class=s2>-</span><span class=si>{}</span><span class=s2>-</span><span class=si>{}</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>c</span><span class=p>,</span> <span class=n>d</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ä½¿ç”¨</span>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=o>%</span> <span class=n>load</span> <span class=n>mytags</span> <span class=o>%</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=c1># æ ‡ç­¾å¤šä¸ªå‚æ•°ä¹‹é—´ ç©ºæ ¼éš”å¼€ #}</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>p</span><span class=o>&gt;</span><span class=p>{</span><span class=o>%</span> <span class=n>plus</span> <span class=s1>&#39;minho&#39;</span> <span class=mi>123</span> <span class=mi>123</span> <span class=mi>9988</span> <span class=o>%</span><span class=p>}</span><span class=o>&lt;/</span><span class=n>p</span><span class=o>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>è‡ªå®šä¹‰inclusion_tag</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>å†…éƒ¨åŸç†ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>  - å…ˆå®šä¹‰ä¸€ä¸ªæ–¹æ³•
</span></span></span><span class=line><span class=cl><span class=s2>  - åœ¨é¡µé¢ä¸Šè°ƒç”¨è¯¥æ–¹æ³• å¹¶ä¸”å¯ä»¥ä¼ å€¼
</span></span></span><span class=line><span class=cl><span class=s2>  - è¯¥æ–¹æ³•ä¼šç”Ÿæˆä¸€äº›æ•°æ® ç„¶åä¼ é€’ç»™ä¸€ä¸ªhtmlé¡µé¢
</span></span></span><span class=line><span class=cl><span class=s2>  - ä¹‹å å°†æ¸²æŸ“å¥½çš„ç»“æœæ”¾åˆ°è°ƒç”¨çš„ä½ç½®
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>&#34;è‡ªåŠ¨ç”ŸæˆæŸä¸€ä¸ªé¡µé¢çš„å±€éƒ¨éƒ¨åˆ†&#34;
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># è‡ªå®šä¹‰inclusion_tag</span>
</span></span><span class=line><span class=cl><span class=nd>@register.inclusion_tag</span><span class=p>(</span><span class=s1>&#39;left_menu.html&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>left</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;ç¬¬</span><span class=si>{}</span><span class=s1>é¡¹&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=c1># inclusion_tag ä¸¤ç§ç»™ä½œç”¨é¡µé¢ä¼ å€¼çš„æ–¹å¼</span>
</span></span><span class=line><span class=cl>    <span class=c1># ç¬¬ä¸€ç§</span>
</span></span><span class=line><span class=cl>    <span class=c1># return {&#39;data&#39;: data}</span>
</span></span><span class=line><span class=cl>    <span class=c1># ç¬¬äºŒç§</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>locals</span><span class=p>()</span>  <span class=c1># å°†dataä¼ é€’ç»™left_menu.html</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å±€éƒ¨é¡µé¢å†…å®¹</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>ul</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=o>%</span> <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>data</span> <span class=o>%</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=n>li</span><span class=o>&gt;</span><span class=p>{{</span> <span class=n>item</span> <span class=p>}}</span><span class=o>&lt;/</span><span class=n>li</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=o>%</span> <span class=n>endfor</span> <span class=o>%</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>ul</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ä½¿ç”¨</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>æ€»ç»“ï¼šå½“htmlé¡µé¢æŸä¸€ä¸ªåœ°æ–¹çš„é¡µé¢éœ€è¦ä¼ å‚æ•°æ‰èƒ½å¤ŸåŠ¨æ€çš„æ¸²æŸ“å‡ºæ¥ å¹¶ä¸”åœ¨å¤šä¸ªé¡µé¢ä¸Šéƒ½éœ€è¦ä½¿ç”¨åˆ°è¯¥å±€éƒ¨ é‚£ä¹ˆå°±è€ƒè™‘å°†è¯¥å±€éƒ¨é¡µé¢åšæˆinclusion_tagå½¢å¼
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=o>%</span> <span class=n>load</span> <span class=n>mytags</span> <span class=o>%</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=o>%</span> <span class=n>left</span> <span class=mi>5</span> <span class=o>%</span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ¨¡æ¿ç»§æ‰¿>æ¨¡æ¿ç»§æ‰¿</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>æœ‰ä¸€äº›ç½‘ç«™ è¿™äº›ç½‘ç«™é¡µé¢æ•´ä½“éƒ½å¤§å·®ä¸å·® åªæ˜¯æŸä¸€äº›å±€éƒ¨åœ¨åšå˜åŒ–
</span></span></span><span class=line><span class=cl><span class=s2>åŒä¸€ä¸ªhtmlé¡µé¢ æƒ³é‡å¤ä½¿ç”¨å¤§éƒ¨åˆ†æ ·å¼ åªæ˜¯å±€éƒ¨çš„ä¿®æ”¹
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ¨¡æ¿çš„ç»§æ‰¿ ä½ è‡ªå·±å…ˆé€‰å¥½ä¸€ä¸ªä½ æƒ³è¦ç»§æ‰¿çš„æ¨¡æ¿é¡µé¢</span>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=o>%</span> <span class=n>extends</span> <span class=s1>&#39;home.html&#39;</span> <span class=o>%</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ç»§æ‰¿äº†ä¹‹å å­é¡µé¢è·Ÿæ¨¡æ¿é¡µé¢é•¿çš„ä¸€æ‘¸ä¸€æ ·çš„ ä½ éœ€è¦åœ¨æ¨¡æ¿é¡µé¢ä¸Šæå‰åˆ’å®šå¯ä»¥è¢«ä¿®æ”¹çš„åŒºåŸŸ</span>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=o>%</span> <span class=n>block</span> <span class=n>content</span> <span class=o>%</span><span class=p>}</span>
</span></span><span class=line><span class=cl>   <span class=n>æ¨¡æ¿å†…å®¹</span>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=o>%</span> <span class=n>endblock</span> <span class=o>%</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å­é¡µé¢ å°±å¯ä»¥å£°æ˜æƒ³è¦ä¿®æ”¹å“ªå—åˆ’å®šçš„åŒºåŸŸ</span>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=o>%</span> <span class=n>block</span> <span class=n>content</span> <span class=o>%</span><span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>å­é¡µé¢å†…å®¹</span>
</span></span><span class=line><span class=cl>  <span class=n>å­é¡µé¢é™¤äº†å¯ä»¥è‡ªå·±å†™è‡ªå·±çš„ä¹‹å¤–</span> <span class=n>è¿˜å¯ä»¥ç»§ç»­ä½¿ç”¨æ¨¡æ¿çš„å†…å®¹</span>
</span></span><span class=line><span class=cl>  <span class=p>{{</span> <span class=n>block</span><span class=o>.</span><span class=n>super</span> <span class=p>}}</span>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=o>%</span> <span class=n>endblock</span> <span class=o>%</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ä¸€èˆ¬æƒ…å†µä¸‹ æ¨¡æ¿é¡µé¢ä¸Šåº”è¯¥è‡³å°‘æœ‰ä¸‰å—å¯ä»¥è¢«ä¿®æ”¹çš„åŒºåŸŸ</span>
</span></span><span class=line><span class=cl><span class=c1># è¿™æ ·åˆ’åˆ†ä¹‹å æ¯ä¸€ä¸ªå­é¡µé¢ å°±éƒ½å¯ä»¥æœ‰è‡ªå·±ç‹¬æœ‰çš„cssä»£ç  htmlä»£ç  jsä»£ç </span>
</span></span><span class=line><span class=cl>  <span class=mf>1.</span> <span class=n>htmlåŒºåŸŸ</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=o>%</span> <span class=n>block</span> <span class=n>content</span> <span class=o>%</span><span class=p>}</span>
</span></span><span class=line><span class=cl>     <span class=n>å­é¡µé¢è‡ªå·±çš„htmlå†…å®¹</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=o>%</span> <span class=n>endblock</span> <span class=o>%</span><span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=mf>2.</span> <span class=n>cssåŒºåŸŸ</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=o>%</span> <span class=n>block</span> <span class=n>css</span> <span class=o>%</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=n>å­é¡µé¢è‡ªå·±çš„css</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=o>%</span> <span class=n>endblock</span> <span class=o>%</span><span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=mf>3.</span> <span class=n>jsåŒºåŸŸ</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=o>%</span> <span class=n>block</span> <span class=n>js</span> <span class=o>%</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=n>å­é¡µé¢è‡ªå·±çš„js</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=o>%</span> <span class=n>endblock</span> <span class=o>%</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>ä¸€èˆ¬æƒ…å†µä¸‹ æ¨¡æ¿çš„é¡µé¢ä¸Š åˆ’å®šçš„åŒºåŸŸè¶Šå¤š é‚£ä¹ˆè¯¥æ¨¡æ¿çš„æ‰©å±•æ€§å°±è¶Šé«˜
</span></span></span><span class=line><span class=cl><span class=s2>ä½†æ˜¯å¦‚æœå¤ªå¤š é‚£è¿˜ä¸å¦‚è‡ªå·±å†™(æ²¡å¿…è¦åˆ’åˆ†å¤ªå¤š)
</span></span></span><span class=line><span class=cl><span class=s2>åˆ©ç”¨æ¨¡æ¿çš„ç»§æ‰¿ èƒ½å¤Ÿè®©è‡ªå·±çš„é¡µé¢æ›´åŠ çš„å¥½ç»´æŠ¤
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ¨¡æ¿å¯¼å…¥>æ¨¡æ¿å¯¼å…¥</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>å°†é¡µé¢çš„æŸä¸€ä¸ªå±€éƒ¨(e.gï¼šä¸€ä¸ªå¥½çœ‹çš„è¡¨å•/å¯¼èˆªæ ç­‰ç­‰) å½“æˆæ¨¡å—çš„å½¢å¼
</span></span></span><span class=line><span class=cl><span class=s2>å“ªä¸ªåœ°æ–¹éœ€è¦å°±å¯ä»¥ç›´æ¥å¯¼å…¥ä½¿ç”¨å³å¯
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=o>%</span> <span class=n>include</span> <span class=s1>&#39;ok.html&#39;</span> <span class=o>%</span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=æ¨¡å‹å±‚>æ¨¡å‹å±‚</h2><p><strong>é‡è¦ï¼šè·Ÿæ•°æ®æ‰“äº¤é“</strong></p><h3 id=æµ‹è¯•è„šæœ¬-1>æµ‹è¯•è„šæœ¬</h3><p><strong>å‚è€ƒORMéƒ¨åˆ†å¾—å‡ºçš„æµ‹è¯•è„šæœ¬</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>django</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=s1>&#39;DJANGO_SETTINGS_MODULE&#39;</span><span class=p>,</span> <span class=s1>&#39;cmdb.settings&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># åŠ è½½djangoé…ç½®</span>
</span></span><span class=line><span class=cl><span class=n>django</span><span class=o>.</span><span class=n>setup</span><span class=p>(</span><span class=n>set_prefix</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># åœ¨ä¸‹é¢ç»§ç»­å†™ä»£ç  å°±å¯ä»¥æµ‹è¯•djangoé‡Œé¢çš„å•ä¸ªpyæ–‡ä»¶</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>app.model</span> <span class=kn>import</span> <span class=n>User</span>  <span class=c1># ä¸èƒ½æ‹¿åˆ°æœ€ä¸Šé¢ æ‰€æœ‰çš„ä»£ç éƒ½å¿…é¡»ç­‰å¾…ç¯å¢ƒå‡†å¤‡å®Œæ¯•ä¹‹åæ‰èƒ½ä¹¦å†™</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=å•è¡¨æŸ¥è¯¢>å•è¡¨æŸ¥è¯¢</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># djangoè‡ªå¸¦çš„sqlite3æ•°æ®åº“å¯¹æ—¥æœŸæ ¼å¼ä¸æ˜¯å¾ˆæ•æ„Ÿ å¤„ç†çš„æ—¶å€™ å®¹æ˜“å‡ºé”™</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å•è¡¨ç¯å¢ƒå‡†å¤‡ modes.py</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>User</span><span class=p>(</span><span class=n>models</span><span class=o>.</span><span class=n>Model</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span><span class=o>=</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>age</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>IntegerField</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>reg_time</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>DateField</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    DateField
</span></span></span><span class=line><span class=cl><span class=s2>    DateTimeField
</span></span></span><span class=line><span class=cl><span class=s2>    è¿™2ä¸ªå­—æ®µæœ‰2ä¸ªé‡è¦å‚æ•°ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>      auto_now: æ¯æ¬¡æ“ä½œæ•°æ®çš„æ—¶å€™ è¯¥å­—æ®µä¼šè‡ªåŠ¨å°†å½“å‰æ—¶é—´æ›´æ–°
</span></span></span><span class=line><span class=cl><span class=s2>      auto_now_add: åœ¨æ¯æ¬¡åˆ›å»ºæ•°æ®çš„æ—¶å€™ ä¼šè‡ªåŠ¨å°†å½“å‰åˆ›å»ºæ—¶é—´è®°å½•ä¸‹æ¥ ä¹‹ååªè¦ä¸äººä¸ºçš„ä¿®æ”¹ é‚£ä¹ˆå°±ä¸€ç›´ä¸å˜
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=å¢-1>å¢</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 1. create() æ¨è </span>
</span></span><span class=line><span class=cl><span class=c1># createæ–¹æ³• è¿”å›å½“å‰å¢åŠ å¯¹è±¡æœ¬èº«</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>create</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s1>&#39;minhooo&#39;</span><span class=p>,</span> <span class=n>age</span><span class=o>=</span><span class=s1>&#39;18&#39;</span><span class=p>,</span> <span class=n>register_time</span><span class=o>=</span><span class=s1>&#39;2002-10-20&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. save()</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>datetime</span>
</span></span><span class=line><span class=cl><span class=n>ctime</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span>  
</span></span><span class=line><span class=cl><span class=c1># æ—¥æœŸå­—æ®µå¯ä»¥æ¥å—å­—ç¬¦ä¸² ä¹Ÿå¯ä»¥æ¥å—datatimeå¯¹è±¡</span>
</span></span><span class=line><span class=cl><span class=n>user_obj</span> <span class=o>=</span> <span class=n>User</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s1>&#39;kimi&#39;</span><span class=p>,</span> <span class=n>age</span><span class=o>=</span><span class=mi>25</span><span class=p>,</span> <span class=n>register_time</span><span class=o>=</span><span class=n>ctime</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>user_obj</span><span class=o>.</span><span class=n>save</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=åˆ -1>åˆ </h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># åˆ </span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>pkä¼šè‡ªåŠ¨æŸ¥æ‰¾åˆ°å½“å‰è¡¨çš„ä¸»é”®å­—æ®µ æŒ‡ä»£çš„å°±æ˜¯å½“å‰è¡¨çš„ä¸»é”®å­—æ®µ
</span></span></span><span class=line><span class=cl><span class=s2>ç”¨äº†pkä¹‹å ä½ å°±ä¸éœ€è¦æŒ‡å®šå½“å‰è¡¨çš„ä¸»é”®å­—æ®µåˆ°åº•å«ä»€ä¹ˆ
</span></span></span><span class=line><span class=cl><span class=s2>e.g: uid pid sid ...
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># 1. delete() æ¨è</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span><span class=o>.</span><span class=n>delete</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. user_objçš„delete() å…ˆæŸ¥å†åˆ  ä¸¤æ¡sqlè¯­å¥</span>
</span></span><span class=line><span class=cl><span class=n>user_obj</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>6</span><span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>user_obj</span><span class=o>.</span><span class=n>delete</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=æ”¹-1>æ”¹</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># æ”¹ </span>
</span></span><span class=line><span class=cl><span class=c1># 1. update()</span>
</span></span><span class=line><span class=cl><span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s1>&#39;lomen&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è·å–user_obj ç„¶åä¿®æ”¹å±æ€§ è°ƒç”¨save()æ›´æ–°</span>
</span></span><span class=line><span class=cl><span class=n>user_obj</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span>  <span class=c1># ä¸æ¨èä½¿ç”¨get</span>
</span></span><span class=line><span class=cl><span class=n>user_obj</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>6</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>user_obj</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>user_obj</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=s1>&#39;pomno&#39;</span>
</span></span><span class=line><span class=cl><span class=n>user_obj</span><span class=o>.</span><span class=n>save</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>getæ–¹æ³•è¿”å›çš„ç›´æ¥å°±æ˜¯å½“å‰æ•°æ®å¯¹è±¡
</span></span></span><span class=line><span class=cl><span class=s2>ä½†æ˜¯ä¸æ¨èä½¿ç”¨è¯¥æ–¹æ³•:
</span></span></span><span class=line><span class=cl><span class=s2>  - get() ä¸€æ—¦æ•°æ®ä¸å­˜åœ¨ è¯¥æ–¹æ³•ä¼šç›´æ¥æŠ¥é”™
</span></span></span><span class=line><span class=cl><span class=s2>  - filter() ä¸ä¼šæŠ¥é”™ è¿”å›ç©ºQuerySet è¿˜æ˜¯ä½¿ç”¨filter
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=å¿…çŸ¥å¿…ä¼š13æ¡>å¿…çŸ¥å¿…ä¼š13æ¡</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=mf>1.</span> <span class=nb>all</span><span class=p>()</span>         <span class=c1># æŸ¥è¯¢æ‰€æœ‰æ•°æ®</span>
</span></span><span class=line><span class=cl><span class=mf>2.</span> <span class=nb>filter</span><span class=p>()</span>      <span class=c1># å¸¦æœ‰è¿‡æ»¤æ¡ä»¶çš„æŸ¥è¯¢   WHERE</span>
</span></span><span class=line><span class=cl><span class=mf>3.</span> <span class=n>get</span><span class=p>()</span>         <span class=c1># ç›´æ¥æ‹¿æ•°æ®å¯¹è±¡ ä½†æ˜¯æ¡ä»¶ä¸å­˜åœ¨ç›´æ¥æŠ¥é”™</span>
</span></span><span class=line><span class=cl><span class=mf>4.</span> <span class=n>first</span><span class=p>()</span>       <span class=c1># æ‹¿QuerySetå¯¹è±¡çš„ç¬¬ä¸€ä¸ªå…ƒç´ </span>
</span></span><span class=line><span class=cl><span class=mf>5.</span> <span class=n>last</span><span class=p>()</span>        <span class=c1># æ‹¿QuerySetå¯¹è±¡çš„æœ€åä¸€ä¸ªå…ƒç´ </span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 6 7 é‡è¦ ç»å¸¸ä½¿ç”¨</span>
</span></span><span class=line><span class=cl><span class=mf>6.</span> <span class=n>values</span><span class=p>()</span>  <span class=c1># æŒ‡å®šè·å–æ•°æ®å­—æ®µ select name, age from ...</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>values</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>,</span> <span class=s1>&#39;age&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>   <span class=c1># è¿”å›å€¼ç±»ä¼¼ åˆ—è¡¨å¥—å­—å…¸</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=o>&lt;</span><span class=n>QuerySet</span> <span class=p>[{</span><span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Minho&#39;</span><span class=p>,</span> <span class=s1>&#39;age&#39;</span><span class=p>:</span> <span class=mi>18</span><span class=p>},</span> <span class=p>{</span><span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;pomno&#39;</span><span class=p>,</span> <span class=s1>&#39;age&#39;</span><span class=p>:</span> <span class=mi>29</span><span class=p>}]</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>7.</span> <span class=n>values_list</span><span class=p>()</span>  <span class=c1># ç”¨æ³•åŒvalues è¿”å›å€¼ç±»ä¼¼ åˆ—è¡¨å¥—å…ƒç»„</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>8.</span> <span class=n>distinct</span><span class=p>()</span>  <span class=c1># å»é‡</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>values</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>distinct</span><span class=p>(</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>å»é‡ä¸€å®šè¦æ˜¯ä¸€æ¨¡ä¸€æ ·çš„æ•°æ® å¦‚æœå¸¦æœ‰ä¸»é”® é‚£ä¹ˆè‚¯å®šä¸ä¸€æ ·
</span></span></span><span class=line><span class=cl><span class=s2>ä½ åœ¨å¾€åçš„æŸ¥è¯¢ä¸­ ä¸€å®šä¸è¦å¿½ç•¥ä¸»é”®
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>9.</span> <span class=n>order_by</span><span class=p>()</span>  <span class=c1># æ’åº</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>order_by</span><span class=p>(</span><span class=s1>&#39;age&#39;</span><span class=p>)</span>  <span class=c1># é»˜è®¤å‡åº</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>order_by</span><span class=p>(</span><span class=s1>&#39;-age&#39;</span><span class=p>)</span>  <span class=c1># å‰é¢åŠ - é™åº</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>10.</span> <span class=n>reverse</span><span class=p>()</span>  <span class=c1># åè½¬ åè½¬çš„å‰ææ˜¯ æ•°æ®å·²ç»æ’è¿‡åº</span>
</span></span><span class=line><span class=cl><span class=c1># éœ€è¦ç”¨åœ¨order_byä¹‹å æ‰€ä»¥ç”¨çš„ä¸å¤š</span>
</span></span><span class=line><span class=cl><span class=n>res1</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>order_by</span><span class=p>(</span><span class=s1>&#39;age&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>reverse</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=mf>11.</span> <span class=n>count</span><span class=p>()</span>  <span class=c1># ç»Ÿè®¡</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>count</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=mf>12.</span> <span class=n>exclude</span><span class=p>()</span>  <span class=c1># æ’é™¤åœ¨å¤– WHERE NOT</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>exclude</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s1>&#39;Minho&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=mf>13.</span> <span class=n>exists</span><span class=p>()</span>  <span class=c1># åŸºæœ¬ç”¨ä¸åˆ° è¿”å›å¸ƒå°”å€¼</span>
</span></span><span class=line><span class=cl><span class=c1># ç›´æ¥æ‹¿å‰é¢çš„æ•°æ®å°±å¯ä»¥è¿›è¡Œå¸ƒå°”åˆ¤æ–­ éšæ„åŸºæœ¬ç”¨ä¸åˆ°</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span><span class=o>.</span><span class=n>exists</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>æŸ¥çœ‹å†…éƒ¨å°è£…çš„SQLè¯­å¥çš„æ–¹å¼
</span></span></span><span class=line><span class=cl><span class=s2>  - æ–¹å¼1ï¼šQuerySet_obj.query åªèƒ½ç”¨äºquerysetå¯¹è±¡
</span></span></span><span class=line><span class=cl><span class=s2>  - æ–¹å¼2ï¼šæ‰€æœ‰çš„sqlè¯­å¥éƒ½èƒ½æŸ¥çœ‹ é…ç½®æ–‡ä»¶é…ç½® è¯¦è§å‚è€ƒä¸Šé¢ORMè¯¦è§£
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=åŒä¸‹åˆ’çº¿æŸ¥è¯¢>åŒä¸‹åˆ’çº¿æŸ¥è¯¢</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># age å¤§äº35 __gt</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>age__gt</span><span class=o>=</span><span class=mi>35</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># age å°äº35 __lt</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>age__lt</span><span class=o>=</span><span class=mi>35</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å°äºç­‰äº__lte å¤§äºç­‰äº__gte</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>age__lte</span><span class=o>=</span><span class=mi>29</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>age__gte</span><span class=o>=</span><span class=mi>29</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æˆå‘˜æŸ¥è¯¢ ageæ˜¯ 18 or 29 or 55 </span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>age__in</span><span class=o>=</span><span class=p>[</span><span class=mi>18</span><span class=p>,</span> <span class=mi>29</span><span class=p>,</span> <span class=mi>55</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># èŒƒå›´æŸ¥è¯¢ ageæ˜¯18åˆ°40ä¹‹é—´ é¦–å°¾éƒ½è¦</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>age__range</span><span class=o>=</span><span class=p>[</span><span class=mi>18</span><span class=p>,</span> <span class=mi>55</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æŸ¥è¯¢åå­—é‡Œé¢å«æœ‰nçš„æ•°æ® æ¨¡ç³ŠæŸ¥è¯¢</span>
</span></span><span class=line><span class=cl><span class=c1># __contains LIKE BINARY</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>name__contains</span><span class=o>=</span><span class=s1>&#39;n&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å¿½ç•¥å¤§å°å†™ __contains LIKE</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>name__icontains</span><span class=o>=</span><span class=s1>&#39;N&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># __startswith __endswith</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>name__startswith</span><span class=o>=</span><span class=s1>&#39;M&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>name__endswith</span><span class=o>=</span><span class=s1>&#39;o&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æŸ¥è¯¢å‡ºæ³¨å†Œæ—¶é—´æ˜¯ 2020.1æœˆä»½çš„æ•°æ®</span>
</span></span><span class=line><span class=cl><span class=c1># æŒ‰ç…§æœˆä»½ æˆ–è€…å¹´ä»½ ç­‰ æŸ¥æ‰¾æ•°æ®</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>reg_time__month</span><span class=o>=</span><span class=s1>&#39;1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>reg_time__year</span><span class=o>=</span><span class=s1>&#39;2020&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=å¤šè¡¨æ“ä½œ>å¤šè¡¨æ“ä½œ</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># models.py æ¨¡å‹å‡†å¤‡</span>
</span></span><span class=line><span class=cl><span class=c1># åˆ›å»ºè¡¨å…³ç³» å…ˆå°†åŸºè¡¨åˆ›å»ºå‡ºæ¥ ç„¶åå†æ·»åŠ å¤–é”®å­—æ®µ</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Book</span><span class=p>(</span><span class=n>models</span><span class=o>.</span><span class=n>Model</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>title</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span><span class=o>=</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>price</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>DecimalField</span><span class=p>(</span><span class=n>max_digits</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span> <span class=n>decimal_places</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>  <span class=c1># å°æ•°æ€»å…±8ä½ å°æ•°ç‚¹åé¢å 2ä½</span>
</span></span><span class=line><span class=cl>    <span class=n>publish_date</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>DateTimeField</span><span class=p>(</span><span class=n>auto_now_add</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    å›¾ä¹¦å’Œå‡ºç‰ˆç¤¾æ˜¯ä¸€å¯¹å¤š å¹¶ä¸”ä¹¦æ˜¯å¤šçš„ä¸€æ–¹ æ‰€ä»¥å¤–é”®å­—æ®µæ”¾åœ¨bookè¡¨é‡Œé¢
</span></span></span><span class=line><span class=cl><span class=s2>    å¦‚æœå­—æ®µå¯¹åº”çš„æ˜¯ForeignKey é‚£ä¹ˆORMä¼šè‡ªåŠ¨åœ¨å­—æ®µåé¢åŠ _id -&gt; publish_id
</span></span></span><span class=line><span class=cl><span class=s2>    åé¢å®šä¹‰ForeignKeyçš„æ—¶å€™ ä¸è¦è‡ªå·±åŠ _id
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>publish</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>ForeignKey</span><span class=p>(</span><span class=n>to</span><span class=o>=</span><span class=s1>&#39;Publish&#39;</span><span class=p>,</span> <span class=n>on_delete</span><span class=o>=</span><span class=n>models</span><span class=o>.</span><span class=n>CASCADE</span><span class=p>)</span>  <span class=c1># é»˜è®¤å°±æ˜¯ä¸å‡ºç‰ˆç¤¾è¡¨çš„ä¸»é”®å­—æ®µåšå¤–é”®å…³è” å¯ä»¥é€šè¿‡to_fieldè®¾ç½®</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    å›¾ä¹¦å’Œä½œè€…æ˜¯å¤šå¯¹å¤šå…³ç³» å¤–é”®å­—æ®µå»ºåœ¨ä»»æ„ä¸€æ–¹å‡å¯ ä½†æ˜¯æ¨èåˆ›å»ºå†æŸ¥è¯¢é¢‘ç‡è¾ƒé«˜çš„ä¸€æ–¹
</span></span></span><span class=line><span class=cl><span class=s2>    authorsæ˜¯ä¸€ä¸ªè™šæ‹Ÿå­—æ®µ ä¸»è¦æ˜¯ç”¨æ¥é«˜é€ŸORM ä¹¦ç±è¡¨ å’Œ ä½œè€…è¡¨ æ˜¯å¤šå¯¹å¤šå…³ç³» è®©ORMè‡ªåŠ¨å¸®ä½ åˆ›å»ºç¬¬ä¸‰å¼ è¡¨å…³ç³»
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    django 1.x è‡ªåŠ¨çº§è”æ›´æ–°åˆ é™¤ 2.x 3.xéœ€è¦åŠ å‚æ•°
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>authors</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>ManyToManyField</span><span class=p>(</span><span class=n>to</span><span class=o>=</span><span class=s1>&#39;Author&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Publish</span><span class=p>(</span><span class=n>models</span><span class=o>.</span><span class=n>Model</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span><span class=o>=</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>address</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span><span class=o>=</span><span class=mi>64</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>email</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>EmailField</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=c1># æœ¬è´¨è¿˜æ˜¯varchar(254) è¯¥å­—æ®µç±»å‹ä¸æ˜¯ç»™modelsçœ‹çš„ è€Œæ˜¯ç»™æˆ‘ä»¬åé¢ä¼šå­¦åˆ°çš„æ ¡éªŒå‹ç»„ä»¶çœ‹çš„</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__str__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;&lt;Publish </span><span class=si>{}</span><span class=s2>&gt;&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Author</span><span class=p>(</span><span class=n>models</span><span class=o>.</span><span class=n>Model</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span><span class=o>=</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>age</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>IntegerField</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    ä½œè€…ä¸ä½œè€…è¯¦æƒ…æ˜¯ä¸€å¯¹ä¸€å…³ç³» å¤–é”®å­—æ®µå»ºåœ¨ä»»æ„ä¸€æ–¹éƒ½å¯ä»¥ ä½†æ˜¯æ¨èåˆ›å»ºåœ¨æŸ¥è¯¢é¢‘ç‡è¾ƒé«˜çš„è¡¨ä¸­
</span></span></span><span class=line><span class=cl><span class=s2>    OneToOneField ä¹Ÿä¼šè‡ªåŠ¨ç»™å­—æ®µåŠ _idåç¼€
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>author_detail</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>OneToOneField</span><span class=p>(</span><span class=n>to</span><span class=o>=</span><span class=s1>&#39;AuthorDetail&#39;</span><span class=p>,</span> <span class=n>on_delete</span><span class=o>=</span><span class=n>models</span><span class=o>.</span><span class=n>CASCADE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>AuthorDetail</span><span class=p>(</span><span class=n>models</span><span class=o>.</span><span class=n>Model</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>phone</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>BigIntegerField</span><span class=p>()</span>  <span class=c1># ç”µè¯å·ç ç”¨BigIntergerFieldæˆ–è€…ç›´æ¥ç”¨CharField</span>
</span></span><span class=line><span class=cl>    <span class=n>address</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span><span class=o>=</span><span class=mi>32</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=ä¸€å¯¹å¤š>ä¸€å¯¹å¤š</h4><p><strong>ä¸€å¯¹ä¸€ ä¸€å¯¹å¤šå¤–é”®çš„å¢åˆ æ”¹æŸ¥</strong></p><ul><li><strong>å¢</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 1. ç›´æ¥å†™å¤–é”®å®é™…å­—æ®µ æ”¾fk_id</span>
</span></span><span class=line><span class=cl><span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>create</span><span class=p>(</span><span class=n>title</span><span class=o>=</span><span class=s1>&#39;ä¸‰å›½æ¼”ä¹‰&#39;</span><span class=p>,</span> <span class=n>price</span><span class=o>=</span><span class=mf>123.23</span><span class=p>,</span> <span class=n>publish_id</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. è™šæ‹Ÿå­—æ®µ æ”¾å¯¹è±¡</span>
</span></span><span class=line><span class=cl><span class=n>publish_obj</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Publish</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>create</span><span class=p>(</span><span class=n>title</span><span class=o>=</span><span class=s1>&#39;çº¢æ¥¼æ¢¦&#39;</span><span class=p>,</span> <span class=n>price</span><span class=o>=</span><span class=mf>666.32</span><span class=p>,</span> <span class=n>publish</span><span class=o>=</span><span class=n>publish_obj</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>åˆ </strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># åˆ </span>
</span></span><span class=line><span class=cl><span class=n>models</span><span class=o>.</span><span class=n>Publish</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>delete</span><span class=p>()</span>  <span class=c1># django 1.x é»˜è®¤çº§è”åˆ é™¤</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>æ”¹</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># ä¿®æ”¹</span>
</span></span><span class=line><span class=cl><span class=c1># 1. åŒå¢åŠ </span>
</span></span><span class=line><span class=cl><span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>publish_id</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. åŒå¢åŠ </span>
</span></span><span class=line><span class=cl><span class=n>publish_obj</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Publish</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>publish</span><span class=o>=</span><span class=n>publish_obj</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=å¤šå¯¹å¤š>å¤šå¯¹å¤š</h4><p><strong>å¤šå¯¹å¤šçš„ å¢åˆ æ”¹æŸ¥ å°±æ˜¯åœ¨æ“ä½œç¬¬ä¸‰å¼ è¡¨</strong></p><ul><li><strong>å¢</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># å¦‚ä½•ç»™ä¹¦ç±æ·»åŠ ä½œè€…</span>
</span></span><span class=line><span class=cl><span class=n>book_obj</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>book_obj</span><span class=o>.</span><span class=n>authors</span><span class=p>)</span>  
</span></span><span class=line><span class=cl><span class=c1># ç¬¬ä¸‰å¼ è¡¨ä¸æ˜¯æˆ‘ä»¬åˆ›å»º æ— æ³•è·å–model</span>
</span></span><span class=line><span class=cl><span class=c1># book_obj.authors å°±ç±»ä¼¼äºä½ å·²ç»å–åˆ°äº†ç¬¬ä¸‰å¼ è¡¨</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># add() ä¼ ä¸»é”®id</span>
</span></span><span class=line><span class=cl><span class=n>book_obj</span><span class=o>.</span><span class=n>authors</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>   <span class=c1># ä¹¦ç±IDä¸º2çš„ä¹¦ç± ç»‘å®šä¸€ä¸ªä¸»é”®ä¸º1çš„ä½œè€…</span>
</span></span><span class=line><span class=cl><span class=n>book_obj</span><span class=o>.</span><span class=n>authors</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>   <span class=c1># æ·»åŠ å¤šä¸ªä½œè€…</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># add() ä¼ å¯¹è±¡</span>
</span></span><span class=line><span class=cl><span class=n>author_obj</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Author</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>author_obj2</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Author</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>author_obj3</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Author</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>book_obj</span><span class=o>.</span><span class=n>authors</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>author_obj2</span><span class=p>,</span> <span class=n>author_obj3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>addç»™ç¬¬ä¸‰å¼ å…³ç³»è¡¨æ·»åŠ æ•°æ®
</span></span></span><span class=line><span class=cl><span class=s2>æ‹¬å·å†… æ—¢å¯ä»¥ä¼ å¯¹è±¡ ä¹Ÿå¯ä»¥ä¼ æ•°å­—(id) å¹¶ä¸”éƒ½æ”¯æŒä¼ å¤šä¸ªå€¼
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>åˆ </strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># åˆ </span>
</span></span><span class=line><span class=cl><span class=n>book_obj</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ä¼ id</span>
</span></span><span class=line><span class=cl><span class=n>book_obj</span><span class=o>.</span><span class=n>authors</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>book_obj</span><span class=o>.</span><span class=n>authors</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ä¼ å¯¹è±¡</span>
</span></span><span class=line><span class=cl><span class=n>author_obj</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Author</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>author_obj2</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Author</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>book_obj</span><span class=o>.</span><span class=n>authors</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=n>author_obj</span><span class=p>,</span> <span class=n>author_obj2</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>æ”¹</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># æ”¹</span>
</span></span><span class=line><span class=cl><span class=n>book_obj</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ä¼ id</span>
</span></span><span class=line><span class=cl><span class=n>book_obj</span><span class=o>.</span><span class=n>authors</span><span class=o>.</span><span class=n>set</span><span class=p>((</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>))</span>  <span class=c1># æ‹¬å·å†…å¿…é¡»ç»™ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡</span>
</span></span><span class=line><span class=cl><span class=n>book_obj</span><span class=o>.</span><span class=n>authors</span><span class=o>.</span><span class=n>set</span><span class=p>((</span><span class=mi>3</span><span class=p>,))</span>  <span class=c1># å…ˆåˆ é™¤æ•°æ® å†å¢åŠ </span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ä¼ å¯¹è±¡</span>
</span></span><span class=line><span class=cl><span class=n>author_obj</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Author</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>author_obj2</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Author</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>book_obj</span><span class=o>.</span><span class=n>authors</span><span class=o>.</span><span class=n>set</span><span class=p>([</span><span class=n>author_obj</span><span class=p>,</span> <span class=n>author_obj2</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>set()
</span></span></span><span class=line><span class=cl><span class=s2>  æ‹¬å·å†…å¿…é¡»ä¼ ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ è¯¥å¯è¿­ä»£å¯¹è±¡å†… æ—¢å¯ä»¥ä¼ å¯¹è±¡ ä¹Ÿå¯ä»¥ä¼ æ•°å­—(id) éƒ½æ”¯æŒå¤šä¸ª
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>æ¸…ç©º</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># æ¸…ç©º</span>
</span></span><span class=line><span class=cl><span class=c1># åœ¨ç¬¬ä¸‰å¼ å…³ç³»è¡¨ä¸­ æ¸…ç©ºæŸä¸ªä¹¦ç±ä¸ä½œè€…çš„ç»‘å®šå…³ç³»</span>
</span></span><span class=line><span class=cl><span class=c1># DELETE FROM `app02_book_authors` WHERE `app02_book_authors`.`book_id` = 2</span>
</span></span><span class=line><span class=cl><span class=n>book_obj</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>book_obj</span><span class=o>.</span><span class=n>authors</span><span class=o>.</span><span class=n>clear</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>clear()
</span></span></span><span class=line><span class=cl><span class=s2>  æ‹¬å·å†…ä¸è¦åŠ ä»»ä½•å‚æ•°
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=è·¨è¡¨æŸ¥è¯¢é‡ç‚¹>è·¨è¡¨æŸ¥è¯¢(é‡ç‚¹)</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># æ­£åå‘çš„æ¦‚å¿µ</span>
</span></span><span class=line><span class=cl><span class=n>çœ‹å¤–é”®å­—æ®µåœ¨å“ªå„¿</span>
</span></span><span class=line><span class=cl><span class=n>å¤–é”®å­—æ®µåœ¨æˆ‘æ‰‹ä¸Š</span> <span class=n>æˆ‘æŸ¥ä½ å°±æ˜¯æ­£å‘</span>
</span></span><span class=line><span class=cl><span class=n>å¦åˆ™</span> <span class=n>å¤–é”®å­—æ®µä¸åœ¨æˆ‘æ‰‹ä¸Š</span> <span class=n>æˆ‘æŸ¥ä½ å°±æ˜¯åå‘</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ­£å‘ åå‘</span>
</span></span><span class=line><span class=cl><span class=n>å‡è®¾</span><span class=err>ï¼š</span>
</span></span><span class=line><span class=cl><span class=n>ä¸€æœ¬ä¹¦å¯¹åº”ä¸€ä¸ªå‡ºç‰ˆç¤¾</span> 
</span></span><span class=line><span class=cl><span class=n>ä¸€ä¸ªå‡ºç‰ˆç¤¾å¯ä»¥å‡ºç‰ˆå¤šæœ¬ä¹¦</span>
</span></span><span class=line><span class=cl><span class=n>é‚£ä¹ˆ</span> <span class=n>å¤–é”®å­—æ®µåœ¨</span> <span class=n>ä¹¦</span> <span class=n>è¿™è¾¹</span>
</span></span><span class=line><span class=cl><span class=n>æ­£å‘</span><span class=err>ï¼š</span><span class=n>ç”±</span> <span class=n>ä¹¦</span> <span class=n>æŸ¥è¯¢</span> <span class=n>å‡ºç‰ˆç¤¾</span>
</span></span><span class=line><span class=cl><span class=n>åå‘</span><span class=err>ï¼š</span><span class=n>ç”±</span> <span class=n>å‡ºç‰ˆç¤¾</span> <span class=n>æŸ¥è¯¢</span> <span class=n>ä¹¦</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>book</span>    <span class=o>&gt;&gt;&gt;</span> <span class=n>å¤–é”®å­—æ®µåœ¨ä¹¦å“ªå„¿</span><span class=p>(</span><span class=n>æ­£å‘</span><span class=p>)</span> <span class=o>&gt;&gt;&gt;</span> <span class=n>publish</span>
</span></span><span class=line><span class=cl><span class=n>publish</span> <span class=o>&gt;&gt;&gt;</span> <span class=n>å¤–é”®å­—æ®µåœ¨ä¹¦å“ªå„¿</span><span class=p>(</span><span class=n>åå‘</span><span class=p>)</span> <span class=o>&gt;&gt;&gt;</span> <span class=n>book</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ä¸€å¯¹ä¸€å’Œå¤šå¯¹å¤šçš„æ­£åå‘åˆ¤æ–­ä¹Ÿæ˜¯å¦‚æ­¤</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>æ­£å‘æŸ¥è¯¢æŒ‰å¤–é”®å­—æ®µ
</span></span></span><span class=line><span class=cl><span class=s2>åå‘æŸ¥è¯¢æŒ‰è¡¨åå°å†™
</span></span></span><span class=line><span class=cl><span class=s2>         _set.all()
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>å¤šè¡¨æ“ä½œ
</span></span></span><span class=line><span class=cl><span class=s2>  1. å­æŸ¥è¯¢  
</span></span></span><span class=line><span class=cl><span class=s2>    ORM --&gt; åŸºäºå¯¹è±¡çš„è·¨è¡¨æŸ¥è¯¢
</span></span></span><span class=line><span class=cl><span class=s2>    - å…ˆæ‹¿åˆ°ä¸€ä¸ªæ•°æ®å¯¹è±¡
</span></span></span><span class=line><span class=cl><span class=s2>    - å¯¹è±¡ç‚¹ç‚¹ç‚¹ å°±èƒ½æ‹¿åˆ°å¯¹åº”çš„å­—æ®µ
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>  2. è”è¡¨æŸ¥è¯¢
</span></span></span><span class=line><span class=cl><span class=s2>    ORM --&gt; åŸºäºåŒä¸‹åˆ’çº¿çš„è·¨è¡¨æŸ¥è¯¢
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    inner join
</span></span></span><span class=line><span class=cl><span class=s2>    left join
</span></span></span><span class=line><span class=cl><span class=s2>    right join
</span></span></span><span class=line><span class=cl><span class=s2>    union
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>1.</span> <span class=n>åŸºäºå¯¹è±¡çš„è·¨è¡¨æŸ¥è¯¢</span>
</span></span><span class=line><span class=cl>  <span class=c1># æ­£å‘ </span>
</span></span><span class=line><span class=cl>  <span class=n>book_obj</span><span class=o>.</span><span class=n>publish</span>
</span></span><span class=line><span class=cl>  <span class=n>book_obj</span><span class=o>.</span><span class=n>authors</span><span class=o>.</span><span class=n>all</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=n>author_obj</span><span class=o>.</span><span class=n>author_detail</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>  <span class=c1># åå‘</span>
</span></span><span class=line><span class=cl>  <span class=n>publish_obj</span><span class=o>.</span><span class=n>book_set</span>  <span class=c1># App01.Book.None</span>
</span></span><span class=line><span class=cl>  <span class=n>publish_obj</span><span class=o>.</span><span class=n>book_set</span><span class=o>.</span><span class=n>all</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=n>author_obj</span><span class=o>.</span><span class=n>book_set</span><span class=o>.</span><span class=n>all</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=n>author_detail_obj</span><span class=o>.</span><span class=n>author</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>2.</span> <span class=n>åŸºäºåŒä¸‹åˆ’çº¿çš„è·¨è¡¨æŸ¥è¯¢</span>
</span></span><span class=line><span class=cl>  <span class=c1># ç­‰ä»·çš„ä¸€å¯¹æ­£å‘å’Œåå‘æŸ¥è¯¢</span>
</span></span><span class=line><span class=cl>  <span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>values</span><span class=p>(</span><span class=s1>&#39;title&#39;</span><span class=p>,</span> <span class=s1>&#39;publish__name&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>models</span><span class=o>.</span><span class=n>Publish</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>book__id</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>values</span><span class=p>(</span><span class=s1>&#39;book__title&#39;</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>  <span class=c1># å…¶ä»–å­—æ®µåŒç†</span>
</span></span><span class=line><span class=cl>  <span class=c1># åˆ©ç”¨åŒä¸‹åˆ’çº¿çš„è·¨è¡¨æŸ¥è¯¢ å¯ä»¥å¸®åŠ©ä½ è·¨Nå¤šå¼ è¡¨ åªè¦æœ‰å¤–é”®å­—æ®µ</span>
</span></span><span class=line><span class=cl>  <span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>values</span><span class=p>(</span><span class=s1>&#39;authors__author_detail__phone&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=å­æŸ¥è¯¢>å­æŸ¥è¯¢</h4><p><strong>åŸºäºå¯¹è±¡çš„è·¨è¡¨æŸ¥è¯¢</strong></p><ul><li><strong>æ­£å‘</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># åŸºäºå¯¹è±¡çš„è·¨è¡¨æŸ¥è¯¢ å…ˆæ‹¿åˆ°å…³ç³»å­—æ®µåœ¨çš„å¯¹è±¡</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1. æŸ¥è¯¢ä¹¦ç±ä¸»é”®ä¸º2çš„å‡ºç‰ˆç¤¾åç§°</span>
</span></span><span class=line><span class=cl><span class=n>book_obj</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1># ä¹¦æŸ¥å‡ºç‰ˆç¤¾ æ­£å‘ æŒ‰å­—æ®µ</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>book_obj</span><span class=o>.</span><span class=n>publish</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>,</span> <span class=n>res</span><span class=o>.</span><span class=n>name</span><span class=p>,</span> <span class=n>res</span><span class=o>.</span><span class=n>address</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. æŸ¥è¯¢ä¹¦ç±ä¸»é”®ä¸º2çš„ä½œè€…</span>
</span></span><span class=line><span class=cl><span class=n>book_obj</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1># ä¹¦æŸ¥ä½œè€… æ­£å‘</span>
</span></span><span class=line><span class=cl><span class=c1># res = book_obj.authors  # app02.Author.None å‘ç°ç»“æœç±»ä¼¼è¿™æ · ORMå¯èƒ½æ²¡é”™ å°‘äº† .all()</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>book_obj</span><span class=o>.</span><span class=n>authors</span><span class=o>.</span><span class=n>all</span><span class=p>()</span>  <span class=c1># &lt;QuerySet [&lt;Author: Author object (2)&gt;, &lt;Author: Author object (3)&gt;]&gt;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. æŸ¥è¯¢ä½œè€…minhoçš„ç”µè¯å·ç </span>
</span></span><span class=line><span class=cl><span class=n>author_obj</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Author</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s1>&#39;minho&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>author_obj</span><span class=o>.</span><span class=n>author_detail</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>,</span> <span class=n>res</span><span class=o>.</span><span class=n>phone</span><span class=p>,</span> <span class=n>res</span><span class=o>.</span><span class=n>address</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>åœ¨ä¹¦å†™ORMè¯­å¥çš„æ—¶å€™ è·Ÿå†™sqlè¯­å¥ä¸€æ ·çš„
</span></span></span><span class=line><span class=cl><span class=s2>ä¸è¦è¯•å›¾ä¸€æ¬¡å°†ormè¯­å¥å†™å®Œ å¦‚æœæ¯”è¾ƒå¤æ‚ å°±å†™ä¸€ç‚¹çœ‹ä¸€ç‚¹
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>æ­£å‘ä»€ä¹ˆæ—¶å€™éœ€è¦åŠ  .all()
</span></span></span><span class=line><span class=cl><span class=s2>  å½“ä½ çš„ç»“æœå¯èƒ½æœ‰å¤šä¸ªçš„æ—¶å€™ å°±éœ€è¦åŠ  .all()
</span></span></span><span class=line><span class=cl><span class=s2>  å¦‚æœæ˜¯ä¸€ä¸ªç»“æœ åˆ™ç›´æ¥èƒ½æ‹¿åˆ°æ•°æ®å¯¹è±¡
</span></span></span><span class=line><span class=cl><span class=s2>    book_obj.publish
</span></span></span><span class=line><span class=cl><span class=s2>    book_obj.authors.all()
</span></span></span><span class=line><span class=cl><span class=s2>    author_obj.author_detail
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>åå‘</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 4. æŸ¥è¯¢å‡ºç‰ˆç¤¾æ˜¯ä¸œæ–¹å‡ºç‰ˆç¤¾å‡ºç‰ˆçš„ä¹¦</span>
</span></span><span class=line><span class=cl><span class=n>publish_obj</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Publish</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s1>&#39;ä¸œæ–¹å‡ºç‰ˆç¤¾&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1># å‡ºç‰ˆç¤¾æŸ¥ä¹¦ åå‘</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>publish_obj</span><span class=o>.</span><span class=n>book_set</span>  <span class=c1># app02.Book.None</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>publish_obj</span><span class=o>.</span><span class=n>book_set</span><span class=o>.</span><span class=n>all</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 5. æŸ¥è¯¢ä½œè€…æ˜¯minhoå†™è¿‡çš„ä¹¦</span>
</span></span><span class=line><span class=cl><span class=n>author_obj</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Author</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s1>&#39;minho&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1># ä½œè€…æŸ¥ä¹¦ åå‘</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>author_obj</span><span class=o>.</span><span class=n>book_set</span>  <span class=c1># app02.Book.None</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>author_obj</span><span class=o>.</span><span class=n>book_set</span><span class=o>.</span><span class=n>all</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 5. æŸ¥è¯¢æ‰‹æœºå·æ˜¯110çš„ä½œè€…å§“å</span>
</span></span><span class=line><span class=cl><span class=n>author_detail_obj</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>AuthorDetail</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>phone</span><span class=o>=</span><span class=s1>&#39;110&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>author_detail_obj</span><span class=o>.</span><span class=n>author</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>,</span> <span class=n>res</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>åŸºäºå¯¹è±¡ åå‘æŸ¥è¯¢çš„æ—¶å€™
</span></span></span><span class=line><span class=cl><span class=s2>  å½“ä½ çš„æŸ¥è¯¢ç»“æœå¯ä»¥æœ‰å¤šä¸ªçš„æ—¶å€™ å°±å¿…é¡»åŠ  _set.all()  ä¸€å¯¹å¤š å¤šå¯¹å¤š åå‘æŸ¥è¯¢
</span></span></span><span class=line><span class=cl><span class=s2>  å½“ä½ çš„ç»“æœåªæœ‰ä¸€ä¸ªçš„æ—¶å€™ ä¸éœ€è¦åŠ  _set.all()  ä¸€å¯¹ä¸€åå‘æŸ¥è¯¢
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=è”è¡¨æŸ¥è¯¢>è”è¡¨æŸ¥è¯¢</h4><p><strong>åŸºäºåŒä¸‹åˆ’çº¿çš„è·¨è¡¨æŸ¥è¯¢</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 1. æŸ¥è¯¢minhoçš„æ‰‹æœºå·</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Author</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s1>&#39;minho&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>values</span><span class=p>(</span><span class=s1>&#39;author_detail__phone&#39;</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># åå‘</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>AuthorDetail</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>author__name</span><span class=o>=</span><span class=s1>&#39;minho&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>values</span><span class=p>(</span><span class=s1>&#39;phone&#39;</span><span class=p>,</span> <span class=s1>&#39;author__name&#39;</span><span class=p>)</span>  <span class=c1># æ‹¿ä½œè€…å§“åæ˜¯minhoçš„ä½œè€…è¯¦æƒ…</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. æŸ¥è¯¢ä¹¦ç±ä¸º2çš„å‡ºç‰ˆç¤¾åç§° å’Œ ä¹¦çš„åç§°</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span><span class=o>.</span><span class=n>values</span><span class=p>(</span><span class=s1>&#39;publish__name&#39;</span><span class=p>,</span> <span class=s1>&#39;title&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># åå‘</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Publish</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>book__id</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span><span class=o>.</span><span class=n>values</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>,</span> <span class=s1>&#39;book__title&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. æŸ¥è¯¢ä¹¦ç±ä¸»é”®ä¸º3çš„ä½œè€…å§“å</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span><span class=o>.</span><span class=n>values</span><span class=p>(</span><span class=s1>&#39;authors__name&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># åå‘</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Author</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>book__id</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span><span class=o>.</span><span class=n>values</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æŸ¥è¯¢ä¹¦ç±ä¸»é”®æ˜¯2çš„ä½œè€…çš„æ‰‹æœºå·</span>
</span></span><span class=line><span class=cl><span class=c1># æ¶‰åŠï¼šbook author authordetail</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span><span class=o>.</span><span class=n>values</span><span class=p>(</span><span class=s1>&#39;authors__author_detail__phone&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>åªè¦æŒæ¡äº†æ­£åå‘çš„æ¦‚å¿µ ä»¥åŠåŒä¸‹åˆ’çº¿æŸ¥è¯¢
</span></span></span><span class=line><span class=cl><span class=s2>é‚£ä¹ˆä½ å°±å¯ä»¥æ— é™åˆ¶çš„è·¨è¡¨
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=èšåˆæŸ¥è¯¢>èšåˆæŸ¥è¯¢</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># åŸç”Ÿï¼šmax min sum count avg</span>
</span></span><span class=line><span class=cl><span class=c1># orm: aggregate</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># èšåˆæŸ¥è¯¢ aggregate</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>èšåˆæŸ¥è¯¢é€šå¸¸æƒ…å†µä¸‹ éƒ½æ˜¯é…åˆåˆ†ç»„ä¸€èµ·ä½¿ç”¨çš„
</span></span></span><span class=line><span class=cl><span class=s2>åªè¦æ˜¯è·Ÿæ•°æ®åº“ç›¸å…³çš„æ¨¡å—
</span></span></span><span class=line><span class=cl><span class=s2>  åŸºæœ¬ä¸Šéƒ½åœ¨ django.db.modelsé‡Œé¢
</span></span></span><span class=line><span class=cl><span class=s2>  å¦‚æœä¸Šè¿°æ²¡æœ‰é‚£ä¹ˆåº”è¯¥åœ¨ django.dbé‡Œé¢
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.db.models</span> <span class=kn>import</span> <span class=n>Max</span><span class=p>,</span> <span class=n>Min</span><span class=p>,</span> <span class=n>Avg</span><span class=p>,</span> <span class=n>Count</span><span class=p>,</span> <span class=n>Sum</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1. ä¹¦çš„å¹³å‡ä»·æ ¼</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>aggregate</span><span class=p>(</span><span class=n>Avg</span><span class=p>(</span><span class=s1>&#39;price&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 2. ä¸Šè¿°æ–¹æ³•ä¸€æ¬¡æ€§ä½¿ç”¨</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>aggregate</span><span class=p>(</span><span class=n>Max</span><span class=p>(</span><span class=s1>&#39;price&#39;</span><span class=p>),</span> <span class=n>Min</span><span class=p>(</span><span class=s1>&#39;price&#39;</span><span class=p>),</span> <span class=n>Sum</span><span class=p>(</span><span class=s1>&#39;price&#39;</span><span class=p>),</span> <span class=n>Count</span><span class=p>(</span><span class=s1>&#39;pk&#39;</span><span class=p>),</span> <span class=n>Avg</span><span class=p>(</span><span class=s1>&#39;price&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=åˆ†ç»„æŸ¥è¯¢>åˆ†ç»„æŸ¥è¯¢</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># åŸç”Ÿï¼šgroup by</span>
</span></span><span class=line><span class=cl><span class=c1># orm: annotate</span>
</span></span><span class=line><span class=cl><span class=c1># åˆ†ç»„æŸ¥è¯¢ annotate</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>MySQLåˆ†ç»„æŸ¥è¯¢éƒ½æœ‰å“ªäº›ç‰¹ç‚¹
</span></span></span><span class=line><span class=cl><span class=s2>  åˆ†ç»„ä¹‹å é»˜è®¤åªèƒ½è·å–åˆ°åˆ†ç»„çš„ä¾æ® ç»„å†…å…¶ä»–å­—æ®µ éƒ½æ— æ³•ç›´æ¥è·å–
</span></span></span><span class=line><span class=cl><span class=s2>  ä¸¥æ ¼æ¨¡å¼ï¼šONLY_FULL_GROUP_BY
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># 1. ç»Ÿè®¡æ¯ä¸€æœ¬ä¹¦çš„ä½œè€…ä¸ªæ•°</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.db.models</span> <span class=kn>import</span> <span class=n>Max</span><span class=p>,</span> <span class=n>Min</span><span class=p>,</span> <span class=n>Avg</span><span class=p>,</span> <span class=n>Count</span><span class=p>,</span> <span class=n>Sum</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>annotate</span><span class=p>()</span>  <span class=c1># modelsåé¢ç‚¹ä»€ä¹ˆ å°±æ˜¯æŒ‰ä»€ä¹ˆåˆ†ç»„</span>
</span></span><span class=line><span class=cl><span class=c1># res = models.Book.objects.annotate(author_num=Count(&#39;authors&#39;)).values(&#39;title&#39;, &#39;author_num&#39;)   # ä¸ä¸‹é¢ç­‰ä»· ä¸ç”¨åŠ __id</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>annotate</span><span class=p>(</span><span class=n>author_num</span><span class=o>=</span><span class=n>Count</span><span class=p>(</span><span class=s1>&#39;authors__id&#39;</span><span class=p>))</span><span class=o>.</span><span class=n>values</span><span class=p>(</span><span class=s1>&#39;title&#39;</span><span class=p>,</span> <span class=s1>&#39;author_num&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>author_num æ˜¯æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„å­—æ®µ(åˆ«å) ç”¨æ¥å­˜å‚¨ç»Ÿè®¡å‡ºæ¥çš„æ¯æœ¬ä¹¦å¯¹åº”çš„ä½œè€…ä¸ªæ•°
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. ç»Ÿè®¡æ¯ä¸ªå‡ºç‰ˆç¤¾å–å¾—æœ€ä¾¿å®œçš„ä¹¦çš„ä»·æ ¼</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Publish</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>annotate</span><span class=p>(</span><span class=n>min_price</span><span class=o>=</span><span class=n>Min</span><span class=p>(</span><span class=s1>&#39;book__price&#39;</span><span class=p>))</span><span class=o>.</span><span class=n>values</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>,</span> <span class=s1>&#39;min_price&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. ç»Ÿè®¡ä¸æ­¢ä¸€ä¸ªä½œè€…çš„å›¾ä¹¦</span>
</span></span><span class=line><span class=cl><span class=c1># å…ˆæŒ‰ç€å›¾ä¹¦åˆ†ç»„ ç„¶åè¿‡æ»¤å‡ºä¸æ­¢ä¸€ä¸ªä½œè€…çš„å›¾ä¹¦</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>annotate</span><span class=p>(</span><span class=n>author_num</span><span class=o>=</span><span class=n>Count</span><span class=p>(</span><span class=s1>&#39;authors&#39;</span><span class=p>))</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>author_num__gt</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>values</span><span class=p>(</span><span class=s1>&#39;title&#39;</span><span class=p>,</span> <span class=s1>&#39;author_num&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>åªè¦ä½ çš„ormè¯­å¥å¾—å‡ºçš„ç»“æœ è¿˜æ˜¯ä¸€ä¸ªquerysetå¯¹è±¡
</span></span></span><span class=line><span class=cl><span class=s2>é‚£ä¹ˆå®ƒå°±å¯ä»¥ç»§ç»­æ— é™åˆ¶çš„ä½¿ç”¨ç‚¹querysetå¯¹è±¡å°è£…çš„æ–¹æ³•
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 4. æŸ¥è¯¢æ¯ä¸ªä½œè€…å‡ºçš„ä¹¦çš„æ€»ä»·æ ¼</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Author</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>annotate</span><span class=p>(</span><span class=n>sum_price</span><span class=o>=</span><span class=n>Sum</span><span class=p>(</span><span class=s1>&#39;book__price&#39;</span><span class=p>))</span><span class=o>.</span><span class=n>values</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>,</span> <span class=s1>&#39;sum_price&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>å¦‚æœæˆ‘æƒ³æŒ‰ç…§æŒ‡å®šçš„å­—æ®µåˆ†ç»„ è¯¥å¦‚ä½•å¤„ç†?
</span></span></span><span class=line><span class=cl><span class=s2>  models.Book.objects.values(&#39;price&#39;).annotate()
</span></span></span><span class=line><span class=cl><span class=s2>  å¦‚æœ annotate()æ–¹æ³•å‰é¢ æœ‰valuesæŒ‡å®šå­—æ®µ é‚£ä¹ˆå°±æŒ‰ç…§æŒ‡å®šå­—æ®µåˆ†ç»„
</span></span></span><span class=line><span class=cl><span class=s2>  å¦åˆ™ æŒ‰ç…§modelsåé¢æŒ‡å®šçš„è¡¨åˆ†ç»„
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>  å¦‚æœå‡ºç°åˆ†ç»„æŸ¥è¯¢æŠ¥é”™çš„æƒ…å†µ ä½ éœ€è¦ä¿®æ”¹æ•°æ®åº“ä¸¥æ ¼æ¨¡å¼
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=fä¸qæŸ¥è¯¢>Fä¸QæŸ¥è¯¢</h3><ul><li><strong>FæŸ¥è¯¢</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 1. æŸ¥è¯¢å–å‡ºæ•°å¤§äºåº“å­˜æ•°çš„ä¹¦ç±</span>
</span></span><span class=line><span class=cl><span class=c1># FæŸ¥è¯¢</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>èƒ½å¤Ÿå¸®åŠ©ä½ ç›´æ¥è·å–åˆ°è¡¨ä¸­æŸä¸ªå­—æ®µå¯¹åº”çš„æ•°æ® å½“ä½œæŸ¥è¯¢æ¡ä»¶
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.db.models</span> <span class=kn>import</span> <span class=n>F</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>maichu__gt</span><span class=o>=</span><span class=n>F</span><span class=p>(</span><span class=s1>&#39;kucun&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. å°†æ‰€æœ‰ä¹¦ç±çš„ä»·æ ¼æå‡50å—</span>
</span></span><span class=line><span class=cl><span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>price</span><span class=o>=</span><span class=n>F</span><span class=p>(</span><span class=s1>&#39;price&#39;</span><span class=p>)</span> <span class=o>+</span> <span class=mi>500</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. å°†æ‰€æœ‰ä¹¦çš„åç§°åé¢åŠ ä¸Šçˆ†æ¬¾ä¸¤ä¸ªå­—</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>åœ¨æ“ä½œå­—ç¬¦ç±»å‹çš„æ•°æ®çš„æ—¶å€™ Fä¸èƒ½å¤Ÿç›´æ¥åšåˆ°å­—ç¬¦ä¸²çš„æ‹¼æ¥
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.db.models.functions</span> <span class=kn>import</span> <span class=n>Concat</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.db.models</span> <span class=kn>import</span> <span class=n>Value</span>
</span></span><span class=line><span class=cl><span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>title</span><span class=o>=</span><span class=n>Concat</span><span class=p>(</span><span class=n>F</span><span class=p>(</span><span class=s1>&#39;title&#39;</span><span class=p>),</span> <span class=n>Value</span><span class=p>(</span><span class=s1>&#39;çˆ†æ¬¾&#39;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=c1># models.Book.objects.update(title=F(&#39;title&#39;) + &#39;çˆ†æ¬¾&#39;)  # æ‰€æœ‰çš„åç§°ä¼šå…¨éƒ¨å˜ä¸ºç©ºç™½</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>QæŸ¥è¯¢</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Q å®ç°æŸ¥è¯¢çš„ä¸ æˆ– é</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># QæŸ¥è¯¢</span>
</span></span><span class=line><span class=cl><span class=c1># 1. æŸ¥è¯¢å–å‡ºæ•°å¤§äº100æˆ–è€…ä»·æ ¼å°äº400çš„ä¹¦ç±</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>filteræ‹¬å·å†… å¤šä¸ªå‚æ•°æ˜¯andå…³ç³»
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>maichu__gt</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>price__lt</span><span class=o>=</span><span class=mi>400</span><span class=p>)</span>  <span class=c1># filter å¤šä¸ªå‚æ•°é»˜è®¤æ˜¯ANDå…³ç³»</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.db.models</span> <span class=kn>import</span> <span class=n>Q</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>Q</span><span class=p>(</span><span class=n>maichu__gt</span><span class=o>=</span><span class=mi>100</span><span class=p>),</span> <span class=n>Q</span><span class=p>(</span><span class=n>price__lt</span><span class=o>=</span><span class=mi>400</span><span class=p>))</span>  <span class=c1># QåŒ…è£¹ é€—å·åˆ†å‰² è¿˜æ˜¯ANDå…³ç³»</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>Q</span><span class=p>(</span><span class=n>maichu__gt</span><span class=o>=</span><span class=mi>100</span><span class=p>)</span> <span class=o>|</span> <span class=n>Q</span><span class=p>(</span><span class=n>price__lt</span><span class=o>=</span><span class=mi>400</span><span class=p>))</span>  <span class=c1># | ORå…³ç³»</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=o>~</span><span class=n>Q</span><span class=p>(</span><span class=n>maichu__gt</span><span class=o>=</span><span class=mi>100</span><span class=p>)</span> <span class=o>|</span> <span class=n>Q</span><span class=p>(</span><span class=n>price__lt</span><span class=o>=</span><span class=mi>400</span><span class=p>))</span>  <span class=c1># ~ NOTå…³ç³»</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Qçš„é«˜é˜¶ç”¨æ³• èƒ½å¤Ÿå°†æŸ¥è¯¢æ¡ä»¶çš„å·¦è¾¹ä¹Ÿå˜æˆå­—ç¬¦ä¸²çš„å½¢å¼ è€Œä¸æ˜¯å˜é‡</span>
</span></span><span class=line><span class=cl><span class=n>q</span> <span class=o>=</span> <span class=n>Q</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>q</span><span class=o>.</span><span class=n>connector</span> <span class=o>=</span> <span class=s1>&#39;or&#39;</span>  <span class=c1># Qå¯¹è±¡é“¾æ¥ children é»˜è®¤æ˜¯ANDå…³ç³» .connectorä¿®æ”¹</span>
</span></span><span class=line><span class=cl><span class=n>q</span><span class=o>.</span><span class=n>children</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=s1>&#39;maichu__gt&#39;</span><span class=p>,</span> <span class=mi>100</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>q</span><span class=o>.</span><span class=n>children</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=s1>&#39;maichu__lt&#39;</span><span class=p>,</span> <span class=mi>600</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>q</span><span class=p>)</span>  <span class=c1># filteræ‹¬å·å†…æ”¯æŒç›´æ¥æ”¾Qå¯¹è±¡ é»˜è®¤è¿˜æ˜¯ANDå…³ç³» å¯ä»¥ä¿®æ”¹</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=djangoä¸­å¦‚ä½•å¼€å¯äº‹åŠ¡>djangoä¸­å¦‚ä½•å¼€å¯äº‹åŠ¡</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>äº‹åŠ¡ ACID
</span></span></span><span class=line><span class=cl><span class=s2>  A åŸå­æ€§
</span></span></span><span class=line><span class=cl><span class=s2>    ä¸å¯åˆ†å‰²çš„æœ€å°å•ä½
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>  C ä¸€è‡´æ€§
</span></span></span><span class=line><span class=cl><span class=s2>    è·ŸåŸå­æ€§æ˜¯ç›¸è¾…ç›¸æˆçš„
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>  I éš”ç¦»æ€§
</span></span></span><span class=line><span class=cl><span class=s2>    äº‹åŠ¡ä¹‹é—´æˆ·å‹ä¸å¹²æ‰°
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>  D æŒä¹…æ€§
</span></span></span><span class=line><span class=cl><span class=s2>    äº‹åŠ¡ä¸€æ—¦ç¡®è®¤æ°¸ä¹…ç”Ÿæ•ˆ
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>äº‹åŠ¡çš„å›æ»š
</span></span></span><span class=line><span class=cl><span class=s2>  rollback
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>äº‹åŠ¡çš„ç¡®è®¤
</span></span></span><span class=line><span class=cl><span class=s2>  commit
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Djangoä¸­å¦‚ä½•ç®€å•çš„å¼€å¯äº‹åŠ¡</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.db</span> <span class=kn>import</span> <span class=n>transaction</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=n>transaction</span><span class=o>.</span><span class=n>atomic</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=c1># sql1</span>
</span></span><span class=line><span class=cl>        <span class=c1># sql2</span>
</span></span><span class=line><span class=cl>        <span class=o>...</span>
</span></span><span class=line><span class=cl>        <span class=c1># åœ¨withä»£ç å—å†…ä¹¦å†™çš„æ‰€æœ‰ormæ“ä½œ éƒ½æ˜¯åŒä¸€ä¸ªäº‹åŠ¡</span>
</span></span><span class=line><span class=cl>        <span class=n>orm</span><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>err</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;æ‰§è¡Œå…¶ä»–æ“ä½œ&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=ormä¸­å¸¸ç”¨å­—æ®µåŠå‚æ•°>ormä¸­å¸¸ç”¨å­—æ®µåŠå‚æ•°</h3><p><a class=link href=https://docs.djangoproject.com/zh-hans/3.1/ref/models/fields/ target=_blank rel=noopener>DjangoORMå­—æ®µç±»å‹å‚è€ƒ</a></p><p><a class=link href=https://www.cnblogs.com/Dominic-Ji/p/9203990.html target=_blank rel=noopener>åšå®¢å‚è€ƒ</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>AutoField</span>
</span></span><span class=line><span class=cl>  <span class=n>ä¸»é”®å­—æ®µ</span> <span class=n>primary_key</span><span class=o>=</span><span class=kc>True</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=n>CharField</span>  <span class=o>-&gt;</span>  <span class=n>varchar</span>
</span></span><span class=line><span class=cl>  <span class=n>verbose_name</span>  <span class=c1># å­—æ®µçš„æ³¨é‡Š</span>
</span></span><span class=line><span class=cl>  <span class=n>max_length</span>    <span class=c1># é•¿åº¦ å¿…é¡»æä¾›</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>InterField</span>  <span class=o>-&gt;</span>  <span class=nb>int</span>
</span></span><span class=line><span class=cl><span class=n>BigInterField</span>   <span class=o>-&gt;</span>  <span class=n>bigint</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>DecimalField</span>
</span></span><span class=line><span class=cl>  <span class=n>max_digits</span><span class=o>=</span><span class=mi>8</span>      <span class=c1># 8ä½æ•°å­—</span>
</span></span><span class=line><span class=cl>  <span class=n>decimal_places</span><span class=o>=</span><span class=mi>2</span>  <span class=c1># 2ä½å°æ•°</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>EmailField</span>  <span class=o>-&gt;</span>  <span class=n>varchar</span><span class=p>(</span><span class=mi>254</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>DateField</span>  <span class=o>-&gt;</span>  <span class=n>date</span>
</span></span><span class=line><span class=cl><span class=n>DateTimeField</span>  <span class=o>-&gt;</span>  <span class=n>datetime</span>
</span></span><span class=line><span class=cl>  <span class=n>auto_now</span>      <span class=c1># æ¯æ¬¡ä¿®æ”¹æ•°æ®çš„æ—¶å€™ éƒ½ä¼šè‡ªåŠ¨æ›´æ–°å½“å‰æ—¶é—´</span>
</span></span><span class=line><span class=cl>  <span class=n>auto_now_add</span>  <span class=c1># åªåœ¨åˆ›å»ºæ•°æ®çš„æ—¶å€™è®°å½•åˆ›å»ºæ—¶é—´ åç»­ä¸ä¼šè‡ªåŠ¨ä¿®æ”¹</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>BooleanField</span><span class=p>(</span><span class=n>Field</span><span class=p>)</span> <span class=o>-</span> <span class=n>å¸ƒå°”å€¼ç±»å‹</span>
</span></span><span class=line><span class=cl>  <span class=n>è¯¥å­—æ®µä¼ å¸ƒå°”å€¼</span><span class=p>(</span><span class=kc>False</span><span class=o>/</span><span class=kc>True</span><span class=p>)</span> <span class=n>æ•°æ®åº“é‡Œé¢å­˜0</span><span class=o>/</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>TextField</span><span class=p>(</span><span class=n>Field</span><span class=p>)</span> <span class=o>-</span> <span class=n>æ–‡æœ¬ç±»å‹</span>
</span></span><span class=line><span class=cl>  <span class=n>è¯¥å­—æ®µå¯ä»¥ç”¨æ¥å­˜å¤§æ®µå†…å®¹</span><span class=p>(</span><span class=n>æ–‡ç« </span> <span class=n>åšå®¢</span><span class=p>)</span> <span class=n>æ²¡æœ‰å­—æ•°é™åˆ¶</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl><span class=n>FileField</span><span class=p>(</span><span class=n>Field</span><span class=p>)</span> <span class=o>-</span> <span class=n>å­—ç¬¦ç±»å‹</span>
</span></span><span class=line><span class=cl>  <span class=n>upload_to</span> <span class=o>=</span> <span class=s2>&#34;/data&#34;</span>  <span class=c1># ç»™è¯¥å­—æ®µä¼ ä¸€ä¸ªæ–‡ä»¶å¯¹è±¡ ä¼šè‡ªåŠ¨å°†æ–‡ä»¶ä¿å­˜åˆ°/dataç›®å½•ä¸‹ ç„¶åå°†æ–‡ä»¶è·¯å¾„ä¿å­˜åˆ°æ•°æ®åº“ä¸­ /data/a.txt</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å¤–é”®å­—æ®µåŠå‚æ•°</span>
</span></span><span class=line><span class=cl><span class=c1># ä½ åœ¨ç”¨ForeingKey(unique=True)å­—æ®µåˆ›å»ºä¸€å¯¹ä¸€å…³ç³» ormä¼šæœ‰ä¸€ä¸ªæç¤º ormæ¨èä½ ä½¿ç”¨OneToOneField()</span>
</span></span><span class=line><span class=cl><span class=n>unique</span><span class=o>=</span><span class=kc>True</span>
</span></span><span class=line><span class=cl>  <span class=n>ForeignKey</span><span class=p>(</span><span class=n>unique</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span> <span class=o>==</span> <span class=n>OneToOneField</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=n>db_index</span>
</span></span><span class=line><span class=cl>  <span class=n>å¦‚æœdb_index</span><span class=o>=</span><span class=kc>True</span> <span class=n>åˆ™ä»£è¡¨ä¸ºæ­¤å­—æ®µè®¾ç½®</span><span class=o>**</span><span class=n>ç´¢å¼•</span><span class=o>**</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=n>to_field</span>
</span></span><span class=line><span class=cl>  <span class=n>è¦å…³è”çš„è¡¨çš„å­—æ®µ</span> <span class=n>é»˜è®¤ä¸å†™å…³è”çš„å°±æ˜¯å¦å¤–ä¸€å¼ è¡¨çš„ä¸»é”®å­—æ®µ</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>on_delete</span>
</span></span><span class=line><span class=cl>  <span class=n>å½“åˆ é™¤å…³è”è¡¨ä¸­çš„æ•°æ®æ—¶</span> <span class=n>å½“å‰è¡¨ä¸å…¶å…³è”çš„è¡Œçš„è¡Œä¸º</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>  django2.xåŠä»¥ä¸Šç‰ˆæœ¬æ—¶ éœ€è¦ä½ è‡ªå·±æŒ‡å®šå¤–é”®å­—æ®µçš„çº§è”æ›´æ–° çº§è”åˆ é™¤
</span></span></span><span class=line><span class=cl><span class=s2>  &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>db_constraint</span>
</span></span><span class=line><span class=cl>  <span class=n>æ˜¯å¦åœ¨æ•°æ®åº“ä¸­åˆ›å»ºå¤–é”®çº¦æŸ</span> <span class=n>é»˜è®¤ä¸ºTrue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=c1># djangoé™¤äº†ç»™ä½ æä¾›äº†å¾ˆå¤šå­—æ®µç±»å‹ä¹‹å¤– è¿˜æ”¯æŒä½ è‡ªå®šä¹‰å­—æ®µ</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>è‡ªå®šä¹‰å­—æ®µ</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># è‡ªå®šä¹‰</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>MyCharField</span><span class=p>(</span><span class=n>models</span><span class=o>.</span><span class=n>Field</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>max_length</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>max_length</span> <span class=o>=</span> <span class=n>max_length</span>
</span></span><span class=line><span class=cl>        <span class=c1># ä¸€å®šè¦æ˜¯å…³é”®å­—ä¼ å‚ æŒ‰ä½ç½®ä¼ å‚ä¼šå‡ºé”™(çœ‹æºç )</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>max_length</span><span class=o>=</span><span class=n>max_length</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>db_type</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>connection</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        è¿”å›çœŸæ­£çš„æ•°æ®ç±»å‹åŠå„ç§çº¦æŸæ¡ä»¶
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;char(</span><span class=si>{}</span><span class=s1>)&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>max_length</span>
</span></span><span class=line><span class=cl>                                 
</span></span><span class=line><span class=cl><span class=c1># ä½¿ç”¨</span>
</span></span><span class=line><span class=cl><span class=n>myfield</span> <span class=o>=</span> <span class=n>MyCharField</span><span class=p>(</span><span class=n>max_length</span><span class=o>=</span><span class=mi>16</span><span class=p>,</span> <span class=n>null</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=choiceså‚æ•°>choiceså‚æ•°</h3><p><strong>æ•°æ®åº“å­—æ®µè®¾è®¡å¸¸è§</strong></p><p><strong>choicescå‚æ•° åœ¨å®é™…é¡¹ç›®ä¸­ ä½¿ç”¨åœºæ™¯æ˜¯éå¸¸å¹¿æ³›çš„</strong></p><p><a class=link href=https://docs.djangoproject.com/zh-hans/3.1/ref/models/fields/#choices target=_blank rel=noopener>Field.choices</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>ç”¨æˆ·è¡¨
</span></span></span><span class=line><span class=cl><span class=s2>  - æ€§åˆ«
</span></span></span><span class=line><span class=cl><span class=s2>  - å­¦å†
</span></span></span><span class=line><span class=cl><span class=s2>  - å·¥ä½œç»éªŒ
</span></span></span><span class=line><span class=cl><span class=s2>  - æ˜¯å¦ç»“å©š
</span></span></span><span class=line><span class=cl><span class=s2>  - å®¢æˆ·æ¥æº
</span></span></span><span class=line><span class=cl><span class=s2>  ...
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>é’ˆå¯¹æŸä¸ªå¯ä»¥åˆ—ä¸¾å®Œå…¨çš„å¯èƒ½æ€§å­—æ®µ æˆ‘ä»¬åº”è¯¥å¦‚ä½•å­˜å‚¨?
</span></span></span><span class=line><span class=cl><span class=s2>æ€»ç»“ï¼šåªè¦æŸä¸ªå­—æ®µçš„å¯èƒ½æ€§æ˜¯å¯ä»¥åˆ—ä¸¾å®Œå…¨çš„ é‚£ä¹ˆä¸€èˆ¬æƒ…å†µä¸‹ éƒ½ä¼šé‡‡ç”¨choiceså‚æ•°
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>score_choices</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;ä¼˜ç§€&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;è‰¯å¥½&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=s1>&#39;C&#39;</span><span class=p>,</span> <span class=s1>&#39;åŠæ ¼&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=s1>&#39;D&#39;</span><span class=p>,</span> <span class=s1>&#39;ä¸åŠæ ¼&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=c1># ä¿è¯å­—æ®µç±»å‹ è·Ÿåˆ—ä¸¾å‡ºæ¥çš„å…ƒç»„çš„ç¬¬ä¸€ä¸ªæ•°æ®ç±»å‹ä¸€è‡´å³å¯</span>
</span></span><span class=line><span class=cl><span class=n>score</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>choices</span><span class=o>=</span><span class=n>score_choices</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>modelå‡†å¤‡</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># modelå‡†å¤‡</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>User</span><span class=p>(</span><span class=n>models</span><span class=o>.</span><span class=n>Model</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span><span class=o>=</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>age</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>IntegerField</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=c1># æ€§åˆ«å­—æ®µ</span>
</span></span><span class=line><span class=cl>    <span class=c1># å­˜å¸ƒå°”å€¼ ä¸æ˜¯ç‰¹åˆ«åˆç† æ²¡æœ‰å¯¹åº”å…³ç³» True/Flaseåˆ†åˆ«å¯¹åº”ä»€ä¹ˆæ€§åˆ«?</span>
</span></span><span class=line><span class=cl>    <span class=c1># gender = models.BooleanField()</span>
</span></span><span class=line><span class=cl>    <span class=n>gender_choices</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;ç”·&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;å¥³&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;å…¶ä»–&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>gender</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>IntegerField</span><span class=p>(</span><span class=n>choices</span><span class=o>=</span><span class=n>gender_choices</span><span class=p>)</span>  <span class=c1># çœ‹choicesé‡Œé¢å…ƒç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ä»€ä¹ˆç±»å‹ å°±æ˜¯ä»€ä¹ˆå­—æ®µ</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    è¯¥genderå­—æ®µå­˜çš„è¿˜æ˜¯æ•°å­— ä½†æ˜¯å¦‚æœå­˜çš„æ•°å­—åœ¨ä¸Šé¢å…ƒç»„åˆ—ä¸¾çš„èŒƒå›´ä¹‹å†…
</span></span></span><span class=line><span class=cl><span class=s2>    é‚£ä¹ˆå°±å¯ä»¥éå¸¸è½»æ¾çš„è·å–åˆ°æ•°å­—å¯¹åº”çš„çœŸæ­£çš„å†…å®¹
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    1. genderå­—æ®µå­˜çš„æ•°å­— ä¸åœ¨ä¸Šè¿°å…ƒç»„åˆ—ä¸¾çš„èŒƒå›´å†…å®¹?
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    2. å¦‚æœåœ¨ å¦‚ä½•è·å–å¯¹åº”çš„ä¸­æ–‡ä¿¡æ¯?
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__str__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;&lt;User </span><span class=si>{}</span><span class=s2>&gt;&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>æµ‹è¯•</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># å¢</span>
</span></span><span class=line><span class=cl><span class=c1># å­˜çš„æ—¶å€™ æ²¡åœ¨choicesåˆ—ä¸¾çš„èŒƒå›´ä¹‹å†…çš„æ•°å­— ä¹Ÿèƒ½å­˜è¿›å»</span>
</span></span><span class=line><span class=cl><span class=c1># å­˜çš„æ•°æ®èŒƒå›´ è¿˜æ˜¯æŒ‰ç…§å­—æ®µç±»å‹å†³å®š IntegerField</span>
</span></span><span class=line><span class=cl><span class=n>models</span><span class=o>.</span><span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>create</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s1>&#39;mm&#39;</span><span class=p>,</span> <span class=n>age</span><span class=o>=</span><span class=mi>18</span><span class=p>,</span> <span class=n>gender</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>register_time</span><span class=o>=</span><span class=s1>&#39;2020-10-1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>models</span><span class=o>.</span><span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>create</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s1>&#39;nn&#39;</span><span class=p>,</span> <span class=n>age</span><span class=o>=</span><span class=mi>67</span><span class=p>,</span> <span class=n>gender</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>register_time</span><span class=o>=</span><span class=s1>&#39;2020-10-1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>models</span><span class=o>.</span><span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>create</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s1>&#39;bb&#39;</span><span class=p>,</span> <span class=n>age</span><span class=o>=</span><span class=mi>22</span><span class=p>,</span> <span class=n>gender</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>register_time</span><span class=o>=</span><span class=s1>&#39;2020-10-1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>models</span><span class=o>.</span><span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>create</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s1>&#39;vv&#39;</span><span class=p>,</span> <span class=n>age</span><span class=o>=</span><span class=mi>9</span><span class=p>,</span> <span class=n>gender</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>register_time</span><span class=o>=</span><span class=s1>&#39;2020-10-1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å–</span>
</span></span><span class=line><span class=cl><span class=n>user_obj</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1># print(user_obj.gender)</span>
</span></span><span class=line><span class=cl><span class=c1># åªè¦æ˜¯choiceså‚æ•°çš„å­—æ®µ å¦‚æœä½ æƒ³è¦è·å–å¯¹åº”ä¿¡æ¯ å›ºå®šå†™æ³•: get_å­—æ®µå_display()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>user_obj</span><span class=o>.</span><span class=n>get_gender_display</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å¦‚æœæ²¡æœ‰å¯¹åº”å…³ç³» å­—æ®µæ˜¯ä»€ä¹ˆè¿˜æ˜¯å±•ç¤ºä»€ä¹ˆ</span>
</span></span><span class=line><span class=cl><span class=n>user_obj</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>user_obj</span><span class=o>.</span><span class=n>get_gender_display</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–>æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>ORMè¯­å¥çš„ç‰¹ç‚¹ï¼šæƒ°æ€§æŸ¥è¯¢
</span></span></span><span class=line><span class=cl><span class=s2>  å¦‚æœä½ ä»…ä»…åªæ˜¯ä¹¦å†™äº†ORMè¯­å¥ åœ¨åé¢æ ¹æœ¬æ²¡æœ‰ç”¨åˆ°è¯¥è¯­å¥æŸ¥è¯¢å‡ºæ¥çš„å‚æ•°
</span></span></span><span class=line><span class=cl><span class=s2>  é‚£ä¹ˆORMä¼šè‡ªåŠ¨è¯†åˆ« ç›´æ¥ä¸æ‰§è¡Œ
</span></span></span><span class=line><span class=cl><span class=s2>  è¦ç”¨åˆ°æ•°æ®çš„æ—¶å€™ æ‰ä¼šèµ°æ•°æ®åº“
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># only ä¸ defer</span>
</span></span><span class=line><span class=cl><span class=c1># select_related ä¸ prefetch_related</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=onlyä¸defer>onlyä¸defer</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># only</span>
</span></span><span class=line><span class=cl><span class=c1># è·å–userè¡¨ä¸­ æ‰€æœ‰ç”¨æˆ·çš„åå­—</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>values</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>d</span> <span class=ow>in</span> <span class=n>res</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>d</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å®ç° è·å–åˆ°çš„æ˜¯ä¸€ä¸ªæ•°æ®å¯¹è±¡ ç„¶å ç‚¹nameå°±èƒ½æ‹¿åˆ°åå­— å¹¶ä¸”æ²¡æœ‰å…¶ä»–å­—æ®µ</span>
</span></span><span class=line><span class=cl><span class=c1># onlyä½¿ç”¨</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>only</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>d</span> <span class=ow>in</span> <span class=n>res</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>d</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>  <span class=c1># ç‚¹onlyæ‹¬å·å†…çš„å­—æ®µ ä¸ä¼šèµ°æ•°æ®åº“</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>d</span><span class=o>.</span><span class=n>age</span><span class=p>)</span>   <span class=c1># ç‚¹onlyæ‹¬å·å†…æ²¡æœ‰çš„å­—æ®µ ä¼šé‡æ–°èµ°æ•°æ®åº“å­—æ®µ è€Œall()ä¸éœ€è¦</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=c1># deferä½¿ç”¨</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>defer</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>)</span>  <span class=c1># è¿˜æ˜¯è¿”å›æ•°æ®å¯¹è±¡ é™¤äº†æ²¡æœ‰nameå±æ€§ä¹‹å¤– å…¶ä»–çš„éƒ½æœ‰</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>res</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>i</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>  <span class=c1># 5æ¡SQL</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>i</span><span class=o>.</span><span class=n>age</span><span class=p>)</span>   <span class=c1># 1æ¡SQL</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>deferä¸onlyåˆšå¥½ç›¸å
</span></span></span><span class=line><span class=cl><span class=s2>  deferæ‹¬å·å†…æ”¾çš„å­—æ®µä¸åœ¨æŸ¥è¯¢å‡ºæ¥çš„å¯¹è±¡é‡Œé¢ æŸ¥è¯¢è¯¥å­—æ®µéœ€è¦é‡æ–°èµ°æ•°æ®åº“
</span></span></span><span class=line><span class=cl><span class=s2>  è€Œå¦‚æœæŸ¥è¯¢çš„æ˜¯éæ‹¬å·å†…çš„å­—æ®µ åˆ™ä¸éœ€è¦èµ°æ•°æ®åº“
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>æ€»ç»“ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>  - only  åªä¼šç¼“å­˜æŒ‡å®šå­—æ®µçš„ç»“æœ åé¢å¾ªç¯å»å–æŒ‡å®šå­—æ®µ åªä¼šæœ‰1æ¡SQL å–å…¶ä»–å­—æ®µ Næ¡SQL
</span></span></span><span class=line><span class=cl><span class=s2>  - defer ä¼šç¼“å­˜é™¤æŒ‡å®šå­—æ®µä»¥å¤–çš„å…¨éƒ¨å­—æ®µç»“æœ åé¢å¾ªç¯å–æŒ‡å®šå­—æ®µ Næ¡SQL å–å…¶ä»–å­—æ®µ 1æ¡SQL
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=select_relatedä¸prefetch_related>select_relatedä¸prefetch_related</h4><p><strong>è·Ÿè·¨è¡¨æ“ä½œæœ‰å…³</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>all</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>res</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>i</span><span class=o>.</span><span class=n>publish</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>  <span class=c1># æ¯å¾ªç¯ä¸€æ¬¡ å°±èµ°ä¸€æ¬¡æ•°æ®åº“æŸ¥è¯¢</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># select_related</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>select_related å†…éƒ¨ç›´æ¥å…ˆå°†bookä¸publishè¿èµ·æ¥ 
</span></span></span><span class=line><span class=cl><span class=s2>ç„¶åä¸€æ¬¡æ€§å°†å¤§è¡¨é‡Œé¢çš„æ‰€æœ‰æ•°æ® å…¨éƒ¨å°è£…ç»™æŸ¥è¯¢å‡ºæ¥çš„å¯¹è±¡
</span></span></span><span class=line><span class=cl><span class=s2>è¿™ä¸ªæ—¶å€™å¯¹è±¡æ— è®ºæ˜¯ç‚¹å‡»bookè¡¨çš„æ•°æ® è¿˜æ˜¯publishçš„æ•°æ® éƒ½æ— éœ€å†èµ°æ•°æ®åº“æŸ¥è¯¢äº†
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>æ³¨æ„äº‹é¡¹ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>  select_relatedæ‹¬å·å†… åªèƒ½æ”¾å¤–é”®å­—æ®µï¼š
</span></span></span><span class=line><span class=cl><span class=s2>    - ä¸€å¯¹ä¸€ ä¸€å¯¹å¤š å¯ä»¥
</span></span></span><span class=line><span class=cl><span class=s2>    - å¤šå¯¹å¤š ä¸è¡Œ æŠ›å‡ºå¼‚å¸¸
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>select_related</span><span class=p>(</span><span class=s1>&#39;publish&#39;</span><span class=p>)</span>  <span class=c1># INNER JOIN è”è¡¨</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>res</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>i</span><span class=o>.</span><span class=n>publish</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=c1># prefetch_related </span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>prefetch_related</span><span class=p>(</span><span class=s1>&#39;publish&#39;</span><span class=p>)</span>  <span class=c1># å­æŸ¥è¯¢</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>prefetch_related è¯¥æ–¹æ³•å†…éƒ¨å…¶å®å°±æ˜¯å­æŸ¥è¯¢
</span></span></span><span class=line><span class=cl><span class=s2>  å°†å­æŸ¥è¯¢æŸ¥è¯¢å‡ºæ¥çš„æ‰€æœ‰ç»“æœä¹Ÿç»™ä½ å°è£…åˆ°å¯¹è±¡ä¸­
</span></span></span><span class=line><span class=cl><span class=s2>  ç»™ä½ çš„æ„Ÿè§‰å¥½åƒä¹Ÿæ˜¯ä¸€æ¬¡æ€§æå®šçš„
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>res</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>i</span><span class=o>.</span><span class=n>publish</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=c1># select_relatedä¸prefetch_relatedå„æœ‰ä¼˜ç¼ºç‚¹ ä¸ä¸€å®šè°ä¸€å®šå¥½ æ ¹æ®å®é™…è¯·å†µæ¥çœ‹</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ‰¹é‡æ’å…¥æ•°æ®>æ‰¹é‡æ’å…¥æ•°æ®</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># å¾ªç¯ä¸€æ¬¡æ¬¡æ’å…¥æ•°æ®</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>.</span> <span class=kn>import</span> <span class=n>models</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>ab_pl</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># å…ˆç»™bookæ’å…¥10000æ¡æ•°æ®</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>create</span><span class=p>(</span><span class=n>title</span><span class=o>=</span><span class=s1>&#39;ç¬¬</span><span class=si>{}</span><span class=s1>æœ¬ä¹¦&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=c1># å†å°†æ‰€æœ‰çš„æ•°æ®æŸ¥è¯¢å¹¶å±•ç¤ºåˆ°å‰ç«¯é¡µé¢</span>
</span></span><span class=line><span class=cl>    <span class=n>book_queryset</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>all</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=s1>&#39;ab_pl.html&#39;</span><span class=p>,</span> <span class=nb>locals</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># è¿™ä¸ªæ—¶å€™è®¿é—®æŒ‡å‘è¯¥è§†å›¾å‡½æ•°çš„urlçš„æ—¶å€™ é¡µé¢ä¼šä¸€è‡´è½¬åœˆ å¡é¡¿å¾ˆä¹…(æ ¹æ®æ•°æ®é‡å†³å®š) - æ…¢ ç”šè‡³è¶…æ—¶</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>ab_pl</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    å½“ä½ æƒ³è¦æ‰¹é‡æ’å…¥æ•°æ®çš„æ—¶å€™ ä½¿ç”¨ormç»™ä½ æä¾›çš„bulk_createèƒ½å¤Ÿå¤§å¤§çš„å‡å°‘æ“ä½œæ—¶é—´
</span></span></span><span class=line><span class=cl><span class=s2>    INSERT INTO `app01_book` (`title`) VALUES (&#39;ç¬¬0æœ¬ä¹¦&#39;), (&#39;ç¬¬1æœ¬ä¹¦&#39;), ...
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># æ‰¹é‡æ’å…¥ æå¿«</span>
</span></span><span class=line><span class=cl>    <span class=n>book_list</span> <span class=o>=</span> <span class=p>[</span><span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=p>(</span><span class=n>title</span><span class=o>=</span><span class=s2>&#34;ç¬¬</span><span class=si>{}</span><span class=s2>æœ¬ä¹¦&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>))</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10000</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>bulk_create</span><span class=p>(</span><span class=n>book_list</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>book_queryset</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>Book</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>all</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=s1>&#39;ab_pl.html&#39;</span><span class=p>,</span> <span class=nb>locals</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=formsç»„ä»¶>Formsç»„ä»¶</h2><p><a class=link href=https://docs.djangoproject.com/zh-hans/3.1/topics/forms/ target=_blank rel=noopener>ä½¿ç”¨è¡¨å•</a></p><h3 id=å‰æˆ>å‰æˆ</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>å†™ä¸€ä¸ªæ³¨å†ŒåŠŸèƒ½
</span></span></span><span class=line><span class=cl><span class=s2>  è·å–ç”¨æˆ·åå’Œå¯†ç  åˆ©ç”¨formè¡¨å•æäº¤æ•°æ®
</span></span></span><span class=line><span class=cl><span class=s2>  åœ¨åç«¯åˆ¤æ–­ç”¨æˆ·åå’Œå¯†ç  æ˜¯å¦ç¬¦åˆä¸€å®šçš„æ¡ä»¶
</span></span></span><span class=line><span class=cl><span class=s2>    - åå­—ä¸­ä¸èƒ½å«æœ‰ é‡‘ç“¶æ¢…
</span></span></span><span class=line><span class=cl><span class=s2>    - å¯†ç ä¸èƒ½å°‘äºä¸‰ä½
</span></span></span><span class=line><span class=cl><span class=s2>  å¦‚æœç¬¦åˆæ¡ä»¶ éœ€è¦ä½ å°†æç¤ºä¿¡æ¯å±•ç¤ºåˆ°å‰sç«¯é¡µé¢
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>V1ç‰ˆæœ¬ è‡ªå·±å®ç°</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># VIEW</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>ab_form</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>back_dic</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;username&#39;</span><span class=p>:</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=s1>&#39;password&#39;</span><span class=p>:</span> <span class=s1>&#39;&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    æ— è®ºæ˜¯postè¯·æ±‚è¿˜æ˜¯getè¯·æ±‚ é¡µé¢éƒ½èƒ½å¤Ÿè·å–åˆ°å­—å…¸
</span></span></span><span class=line><span class=cl><span class=s2>    åªä¸è¿‡getè¯·æ±‚æ¥çš„æ—¶å€™ å­—å…¸å€¼éƒ½æ˜¯ç©ºçš„
</span></span></span><span class=line><span class=cl><span class=s2>    è€Œpostè¯·æ±‚æ¥ä¹‹å å­—å…¸å¯èƒ½æœ‰å€¼
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;POST&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>username</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;username&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>password</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;password&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s1>&#39;é‡‘ç“¶æ¢…&#39;</span> <span class=ow>in</span> <span class=n>username</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>back_dic</span><span class=p>[</span><span class=s1>&#39;username&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;ä¸ç¬¦åˆç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚&#39;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>password</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mi>3</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>back_dic</span><span class=p>[</span><span class=s1>&#39;password&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;å¯†ç ä¸èƒ½å¤ªçŸ­&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=s1>&#39;ab_form.html&#39;</span><span class=p>,</span> <span class=nb>locals</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># HTML</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>form</span> <span class=n>action</span><span class=o>=</span><span class=s2>&#34;&#34;</span> <span class=n>method</span><span class=o>=</span><span class=s2>&#34;post&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=n>p</span><span class=o>&gt;</span><span class=n>username</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=nb>input</span> <span class=nb>type</span><span class=o>=</span><span class=s2>&#34;text&#34;</span> <span class=n>name</span><span class=o>=</span><span class=s2>&#34;username&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>style</span><span class=o>=</span><span class=s2>&#34;color: red&#34;</span><span class=o>&gt;</span><span class=p>{{</span> <span class=n>back_dic</span><span class=o>.</span><span class=n>username</span> <span class=p>}}</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;/</span><span class=n>p</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=n>p</span><span class=o>&gt;</span><span class=n>password</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=nb>input</span> <span class=nb>type</span><span class=o>=</span><span class=s2>&#34;password&#34;</span> <span class=n>name</span><span class=o>=</span><span class=s2>&#34;password&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>style</span><span class=o>=</span><span class=s2>&#34;color: red&#34;</span><span class=o>&gt;</span><span class=p>{{</span> <span class=n>back_dic</span><span class=o>.</span><span class=n>password</span> <span class=p>}}</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;/</span><span class=n>p</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=nb>input</span> <span class=nb>type</span><span class=o>=</span><span class=s2>&#34;submit&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>form</span><span class=o>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>V2ç‰ˆæœ¬ ä½¿ç”¨formç»„ä»¶</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>V1ç‰ˆæœ¬ä¸­ éœ€è¦è‡ªå·±åšä¸‹é¢ä¸‰ä»¶äº‹æƒ…
</span></span></span><span class=line><span class=cl><span class=s2>  1. æ‰‹åŠ¨ä¹¦å†™å‰ç«¯è·å–ç”¨æˆ·æ•°æ®çš„htmlä»£ç   -&gt; æ¸²æŸ“htmlä»£ç 
</span></span></span><span class=line><span class=cl><span class=s2>  2. åç«¯å¯¹ç”¨æˆ·æ•°æ®è¿›è¡Œæ ¡éªŒ            -&gt; æ ¡éªŒæ•°æ®
</span></span></span><span class=line><span class=cl><span class=s2>  3. å¯¹ä¸ç¬¦åˆè¦æ±‚çš„æ•°æ®è¿›è¡Œå‰ç«¯æç¤º      -&gt; å±•ç¤ºæç¤ºä¿¡æ¯
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>è€Œformç»„ä»¶ å¯ä»¥æŠŠè¿™ä¸‰ä»¶äº‹æƒ… å…¨éƒ¨æå®š
</span></span></span><span class=line><span class=cl><span class=s2>  - æ ¡éªŒè§„åˆ™ å¯ä»¥ç›´æ¥ç”±formç»„ä»¶å®Œæˆ ä¸éœ€è¦é¢‘ç¹è¯·æ±‚åç«¯
</span></span></span><span class=line><span class=cl><span class=s2>  - æŠŠæ ¡éªŒè§„åˆ™ æå‰å‘Šè¯‰formç»„ä»¶
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>ä¸ºä»€ä¹ˆæ•°æ®æ ¡éªŒéè¦å»åç«¯ ä¸èƒ½åœ¨å‰ç«¯åˆ©ç”¨jsç›´æ¥å®Œæˆå‘¢?
</span></span></span><span class=line><span class=cl><span class=s2>  - æ•°æ®æ ¡éªŒ å‰ç«¯å¯æœ‰å¯æ—  ä½†æ˜¯åç«¯å¿…é¡»è¦æœ‰
</span></span></span><span class=line><span class=cl><span class=s2>  - å‰ç«¯çš„æ ¡éªŒæ˜¯å¼±ä¸ç¦é£çš„ ä½ å¯ä»¥ç›´æ¥ä¿®æ”¹ æˆ–è€…åˆ©ç”¨çˆ¬è™«ç¨‹åºç»•è¿‡å‰ç«¯é¡µé¢ç›´æ¥æœåç«¯æäº¤æ•°æ®
</span></span></span><span class=line><span class=cl><span class=s2> 
</span></span></span><span class=line><span class=cl><span class=s2>  e.g:
</span></span></span><span class=line><span class=cl><span class=s2>    è´­ç‰©ç½‘ç«™ - é€‰å–è´§ç‰©ä¹‹å è®¡ç®—ä¸€ä¸ªä»·æ ¼å‘é€ç»™åç«¯ å¦‚æœåç«¯ä¸åšä»·æ ¼æ ¡éªŒ
</span></span></span><span class=line><span class=cl><span class=s2>      å®é™…æ˜¯è·å–ç”¨æˆ·é€‰æ‹©çš„æ‰€æœ‰å•†å“çš„ä¸»é”®å€¼ ç„¶ååœ¨åç«¯æŸ¥è¯¢å‡ºæ‰€æœ‰å•†å“çš„ä»·æ ¼ å†æ¬¡è®¡ç®—ä¸€é
</span></span></span><span class=line><span class=cl><span class=s2>      å¦‚æœè·Ÿå‰ç«¯ä¸€è‡´ å®Œæˆæ”¯ä»˜ å¦‚æœä¸ä¸€è‡´ç›´æ¥æ‹’ç»
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=åŸºæœ¬ä½¿ç”¨>åŸºæœ¬ä½¿ç”¨</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django</span> <span class=kn>import</span> <span class=n>forms</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>MyForm</span><span class=p>(</span><span class=n>forms</span><span class=o>.</span><span class=n>Form</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># usernameå­—ç¬¦ä¸²æœ€å°3ä½ æœ€å¤§8ä½</span>
</span></span><span class=line><span class=cl>    <span class=n>username</span> <span class=o>=</span> <span class=n>forms</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>min_length</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>max_length</span><span class=o>=</span><span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># passwordå­—ç¬¦ä¸²æœ€å°3ä½ æœ€å¤§8ä½</span>
</span></span><span class=line><span class=cl>    <span class=n>password</span> <span class=o>=</span> <span class=n>forms</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>min_length</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>max_length</span><span class=o>=</span><span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># emailå­—æ®µå¿…é¡»ç¬¦åˆé‚®ç®±æ ¼å¼</span>
</span></span><span class=line><span class=cl>    <span class=n>email</span> <span class=o>=</span> <span class=n>forms</span><span class=o>.</span><span class=n>EmailField</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ ¡éªŒæ•°æ®>æ ¡éªŒæ•°æ®</h3><p><strong>ç¯å¢ƒå‡†å¤‡åŠåŸºæœ¬ä½¿ç”¨</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>1. æµ‹è¯•ç¯å¢ƒçš„å‡†å¤‡ å¯ä»¥è‡ªå·±æ‹·è´ä»£ç å‡†å¤‡
</span></span></span><span class=line><span class=cl><span class=s2>2. å…¶å®åœ¨pycharmé‡Œé¢å·²ç»å¸®ä½ å‡†å¤‡äº†ä¸€ä¸ªæµ‹è¯•ç¯å¢ƒ
</span></span></span><span class=line><span class=cl><span class=s2>    - ç›´æ¥ç‚¹å‡»pycharmåº•éƒ¨çš„ PythonConsole å®ƒä¼šå¸®ä½ å‡†å¤‡æµ‹è¯•ç¯å¢ƒ å¯¼å…¥ç›¸å…³æ¨¡å—
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=kn>from</span> <span class=nn>app02</span> <span class=kn>import</span> <span class=n>views</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1. å°†å¾…æ ¡éªŒçš„æ•°æ®ç»„ç»‡æˆå­—å…¸çš„å½¢å¼ä¼ å…¥(ä¼ é€’ç»™éœ€è¦éªŒè¯çš„Form)</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>form_obj</span> <span class=o>=</span> <span class=n>views</span><span class=o>.</span><span class=n>MyForm</span><span class=p>({</span><span class=s1>&#39;username&#39;</span><span class=p>:</span><span class=s1>&#39;minho&#39;</span><span class=p>,</span> <span class=s1>&#39;password&#39;</span><span class=p>:</span><span class=s1>&#39;123&#39;</span><span class=p>,</span> <span class=s1>&#39;email&#39;</span><span class=p>:</span><span class=s1>&#39;123&#39;</span><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. éªŒè¯æ•°æ®æ˜¯å¦åˆæ³• è¯¥æ–¹æ³•åªæœ‰åœ¨æ‰€æœ‰æ•°æ®å…¨éƒ¨åˆæ³•çš„è¯·å†µä¸‹æ‰ä¼šè¿”å›True</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>form_obj</span><span class=o>.</span><span class=n>is_valid</span><span class=p>()</span>    
</span></span><span class=line><span class=cl><span class=kc>False</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. æŸ¥çœ‹æ‰€æœ‰æ ¡éªŒé€šè¿‡çš„æ•°æ®</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>form_obj</span><span class=o>.</span><span class=n>cleaned_data</span>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=s1>&#39;username&#39;</span><span class=p>:</span> <span class=s1>&#39;minho&#39;</span><span class=p>,</span> <span class=s1>&#39;password&#39;</span><span class=p>:</span> <span class=s1>&#39;123&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 4. æŸ¥çœ‹æ‰€æœ‰ä¸ç¬¦åˆæ ¡éªŒè§„åˆ™ä»¥åŠä¸ç¬¦åˆçš„åŸå› </span>
</span></span><span class=line><span class=cl><span class=c1># è¿”å›å­—å…¸ key:éªŒè¯å­—æ®µ value:åˆ—è¡¨(æŠ¥é”™ä¿¡æ¯ä¸å”¯ä¸€ å¯èƒ½æœ‰å¤šä¸ª)</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>form_obj</span><span class=o>.</span><span class=n>errors</span>    
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;email&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Enter a valid email address.&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 5. æ ¡éªŒæ•°æ®åªæ ¡éªŒç±»ä¸­å‡ºç°çš„å­—æ®µ å¤šä¼ ä¸å½±å“ å¤šä¼ å­—æ®µç›´æ¥å¿½ç•¥</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>form_obj</span> <span class=o>=</span> <span class=n>views</span><span class=o>.</span><span class=n>MyForm</span><span class=p>({</span><span class=s1>&#39;username&#39;</span><span class=p>:</span><span class=s1>&#39;minho&#39;</span><span class=p>,</span> <span class=s1>&#39;password&#39;</span><span class=p>:</span><span class=s1>&#39;123&#39;</span><span class=p>,</span> <span class=s1>&#39;email&#39;</span><span class=p>:</span><span class=s1>&#39;123@qq.com&#39;</span><span class=p>,</span> <span class=s1>&#39;hobby&#39;</span><span class=p>:</span><span class=s1>&#39;study&#39;</span><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>form_obj</span><span class=o>.</span><span class=n>is_valid</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=kc>True</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>form_obj</span><span class=o>.</span><span class=n>errors</span>
</span></span><span class=line><span class=cl><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 6. æ ¡éªŒæ•°æ® é»˜è®¤è¯·å†µä¸‹ ç±»é‡Œé¢æ‰€æœ‰çš„å­—æ®µéƒ½å¿…é¡»ä¼ å€¼</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>form_obj</span> <span class=o>=</span> <span class=n>views</span><span class=o>.</span><span class=n>MyForm</span><span class=p>({</span><span class=s1>&#39;username&#39;</span><span class=p>:</span><span class=s1>&#39;minho&#39;</span><span class=p>,</span> <span class=s1>&#39;password&#39;</span><span class=p>:</span><span class=s1>&#39;123&#39;</span><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>form_obj</span><span class=o>.</span><span class=n>is_valid</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=kc>False</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>form_obj</span><span class=o>.</span><span class=n>errors</span>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=s1>&#39;email&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;This field is required.&#39;</span><span class=p>]}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>æ ¡éªŒæ•°æ®çš„æ—¶å€™ é»˜è®¤æƒ…å†µä¸‹ï¼šæ•°æ®å¯ä»¥å¤šä¼ ä½†æ˜¯ç»ä¸èƒ½å°‘ä¼ 
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ¸²æŸ“æ ‡ç­¾>æ¸²æŸ“æ ‡ç­¾</h3><p><strong>formsç»„ä»¶åªä¼šè‡ªåŠ¨å¸®ä½ æ¸²æŸ“ç”¨æˆ·è¾“å…¥çš„æ ‡ç­¾(input select radio checkbox) ä¸ä¼šå¸®ä½ æ¸²æŸ“æäº¤æŒ‰é’®</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># view</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>index</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 1. å…ˆäº§ç”Ÿä¸€ä¸ªç©ºå¯¹è±¡</span>
</span></span><span class=line><span class=cl>    <span class=n>form_obj</span> <span class=o>=</span> <span class=n>MyForm</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=c1># 2. ç›´æ¥å°†è¯¥ç©ºå¯¹è±¡ä¼ é€’ç»™htmlé¡µé¢</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=s1>&#39;index.html&#39;</span><span class=p>,</span> <span class=nb>locals</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å‰ç«¯åˆ©ç”¨ç©ºå¯¹è±¡åšæ“ä½œ</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>form</span> <span class=n>action</span><span class=o>=</span><span class=s2>&#34;&#34;</span> <span class=n>method</span><span class=o>=</span><span class=s2>&#34;post&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=n>p</span><span class=o>&gt;</span><span class=n>ç¬¬1ç§æ¸²æŸ“æ–¹å¼</span><span class=p>:</span> <span class=n>ä»£ç ä¹¦å†™æå°‘</span> <span class=n>å°è£…ç¨‹åº¦å¤ªé«˜</span> <span class=n>ä¸ä¾¿äºåç»­æ‰©å±•</span> <span class=n>ä¸€èˆ¬æƒ…å†µä¸‹åªåœ¨æœ¬åœ°æµ‹è¯•ä½¿ç”¨</span><span class=o>&lt;/</span><span class=n>p</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>{{</span> <span class=n>form_obj</span><span class=o>.</span><span class=n>as_p</span> <span class=p>}}</span>
</span></span><span class=line><span class=cl>    <span class=p>{{</span> <span class=n>form_obj</span><span class=o>.</span><span class=n>as_ul</span> <span class=p>}}</span>
</span></span><span class=line><span class=cl>    <span class=p>{{</span> <span class=n>form_obj</span><span class=o>.</span><span class=n>as_table</span> <span class=p>}}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=n>p</span><span class=o>&gt;</span><span class=n>ç¬¬2ç§æ¸²æŸ“æ–¹å¼</span><span class=err>ï¼š</span><span class=n>å¯æ‰©å±•æ€§å¾ˆå¼º</span> <span class=n>ä½†æ˜¯ä¹¦å†™ä»£ç å¤ªå¤š</span> <span class=n>ä¸€èˆ¬æƒ…å†µä¸‹ä¸ç”¨</span><span class=o>&lt;/</span><span class=n>p</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=n>p</span><span class=o>&gt;</span><span class=p>{{</span> <span class=n>form_obj</span><span class=o>.</span><span class=n>username</span><span class=o>.</span><span class=n>label</span> <span class=p>}}:</span> <span class=p>{{</span> <span class=n>form_obj</span><span class=o>.</span><span class=n>username</span> <span class=p>}}</span><span class=o>&lt;/</span><span class=n>p</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=n>p</span><span class=o>&gt;</span><span class=p>{{</span> <span class=n>form_obj</span><span class=o>.</span><span class=n>password</span><span class=o>.</span><span class=n>label</span> <span class=p>}}:</span> <span class=p>{{</span> <span class=n>form_obj</span><span class=o>.</span><span class=n>password</span> <span class=p>}}</span><span class=o>&lt;/</span><span class=n>p</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=n>p</span><span class=o>&gt;</span><span class=p>{{</span> <span class=n>form_obj</span><span class=o>.</span><span class=n>email</span><span class=o>.</span><span class=n>label</span> <span class=p>}}:</span> <span class=p>{{</span> <span class=n>form_obj</span><span class=o>.</span><span class=n>email</span> <span class=p>}}</span><span class=o>&lt;/</span><span class=n>p</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=n>p</span><span class=o>&gt;</span><span class=n>ç¬¬3ç§æ¸²æŸ“æ–¹å¼</span><span class=err>ï¼š</span><span class=n>æ¨èä½¿ç”¨</span> <span class=n>ä»£ç ä¹¦å†™ç®€å•</span> <span class=n>å¹¶ä¸”æ‰©å±•æ€§ä¹Ÿé«˜</span><span class=o>&lt;/</span><span class=n>p</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=o>%</span> <span class=k>for</span> <span class=n>form</span> <span class=ow>in</span> <span class=n>form_obj</span> <span class=o>%</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=n>p</span><span class=o>&gt;</span><span class=p>{{</span> <span class=n>form</span><span class=o>.</span><span class=n>label</span> <span class=p>}}:{{</span> <span class=n>form</span> <span class=p>}}</span><span class=o>&lt;/</span><span class=n>p</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=o>%</span> <span class=n>endfor</span> <span class=o>%</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>form</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>labelå±æ€§é»˜è®¤å±•ç¤ºçš„æ˜¯Formç±»ä¸­å­—æ®µé¦–å­—æ¯å¤§å†™çš„å½¢å¼
</span></span></span><span class=line><span class=cl><span class=s2>ä¹Ÿå¯ä»¥è‡ªå·±ä¿®æ”¹ ç›´æ¥ç»™å­—æ®µå¯¹è±¡åŠ labelå±æ€§å³å¯
</span></span></span><span class=line><span class=cl><span class=s2>  username = forms.CharField(min_length=3, max_length=8, label=&#39;ç”¨æˆ·å&#39;)
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=å±•ç¤ºæç¤ºä¿¡æ¯>å±•ç¤ºæç¤ºä¿¡æ¯</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>æµè§ˆå™¨ä¼šè‡ªåŠ¨å¸®ä½ æ ¡éªŒæ•°æ® ä½†æ˜¯å‰ç«¯çš„æ ¡éªŒå¼±ä¸ç¦é£
</span></span></span><span class=line><span class=cl><span class=s2>å¦‚ä½•è®©æµè§ˆå™¨ä¸åšæ ¡éªŒ?
</span></span></span><span class=line><span class=cl><span class=s2>  - formæ ‡ç­¾åŠ ä¸€ä¸ª novalidateå±æ€§
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># view</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>index</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 1. å…ˆäº§ç”Ÿä¸€ä¸ªç©ºå¯¹è±¡</span>
</span></span><span class=line><span class=cl>    <span class=n>form_obj</span> <span class=o>=</span> <span class=n>MyForm</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;POST&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 2. è·å–ç”¨æˆ·æ•°æ®å¹¶æ£€éªŒ</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        1. æ•°æ®è·å–ç¹ç
</span></span></span><span class=line><span class=cl><span class=s2>        2. æ ¡éªŒæ•°æ®éœ€è¦æ„é€ æˆå­—å…¸çš„æ ¼å¼ä¼ å…¥æ‰è¡Œ
</span></span></span><span class=line><span class=cl><span class=s2>        æ³¨æ„ï¼šrequest.POSTå¯ä»¥çœ‹æˆå°±æ˜¯ä¸€ä¸ªå­—å…¸
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 3. æ ¡éªŒæ•°æ®</span>
</span></span><span class=line><span class=cl>        <span class=n>form_obj</span> <span class=o>=</span> <span class=n>MyForm</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># 4. åˆ¤æ–­æ•°æ®æ˜¯å¦åˆæ³•</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>form_obj</span><span class=o>.</span><span class=n>is_valid</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=c1># 5. å¦‚æœåˆæ³• æ“ä½œæ•°æ®åº“å­˜å‚¨æ•°æ®åº“</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;ok&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># 5. ä¸åˆæ³• æœ‰é”™è¯¯</span>
</span></span><span class=line><span class=cl>    <span class=c1># 2. ç›´æ¥å°†è¯¥ç©ºå¯¹è±¡ä¼ é€’ç»™htmlé¡µé¢</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=s1>&#39;index.html&#39;</span><span class=p>,</span> <span class=nb>locals</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># html</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>form</span> <span class=n>action</span><span class=o>=</span><span class=s2>&#34;&#34;</span> <span class=n>method</span><span class=o>=</span><span class=s2>&#34;post&#34;</span> <span class=n>novalidate</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=o>%</span> <span class=k>for</span> <span class=n>form</span> <span class=ow>in</span> <span class=n>form_obj</span> <span class=o>%</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=n>p</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>{{</span> <span class=n>form</span><span class=o>.</span><span class=n>label</span> <span class=p>}}:{{</span> <span class=n>form</span> <span class=p>}}</span>
</span></span><span class=line><span class=cl>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>style</span><span class=o>=</span><span class=s2>&#34;color: red&#34;</span><span class=o>&gt;</span><span class=p>{{</span> <span class=n>form</span><span class=o>.</span><span class=n>errors</span><span class=mf>.0</span> <span class=p>}}</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;/</span><span class=n>p</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=o>%</span> <span class=n>endfor</span> <span class=o>%</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=nb>input</span> <span class=nb>type</span><span class=o>=</span><span class=s2>&#34;submit&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>form</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>1. å¿…å¤‡çš„æ¡ä»¶ getè¯·æ±‚å’Œpostè¯·æ±‚ ä¼ ç»™htmlé¡µé¢çš„å¯¹è±¡å˜é‡åå¿…é¡»ä¸€æ ·
</span></span></span><span class=line><span class=cl><span class=s2>2. formç»„ä»¶å½“ä½ çš„æ•°æ®ä¸åˆæ³•çš„æƒ…å†µä¸‹ ä¼šä¿ç•™ä½ ä¸Šæ¬¡çš„æ•°æ® è®©ä½ åŸºäºä¹‹å‰çš„ç»“æœè¿›è¡Œä¿®æ”¹ æ›´åŠ çš„äººæ€§åŒ–
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è‡ªå®šä¹‰é”™è¯¯æç¤ºä¿¡æ¯ error_messageså‚æ•°</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>MyForm</span><span class=p>(</span><span class=n>forms</span><span class=o>.</span><span class=n>Form</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>username</span> <span class=o>=</span> <span class=n>forms</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>min_length</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>max_length</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;ç”¨æˆ·å&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                               <span class=n>error_messages</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>                                   <span class=s1>&#39;min_length&#39;</span><span class=p>:</span> <span class=s1>&#39;ç”¨æˆ·åæœ€å°‘3ä½&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                   <span class=s1>&#39;max_length&#39;</span><span class=p>:</span> <span class=s1>&#39;ç”¨æˆ·åæœ€å¤§8ä½&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                   <span class=s1>&#39;required&#39;</span><span class=p>:</span> <span class=s1>&#39;ç”¨æˆ·åä¸èƒ½ä¸ºç©º&#39;</span>
</span></span><span class=line><span class=cl>                               <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=n>password</span> <span class=o>=</span> <span class=n>forms</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>min_length</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>max_length</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;å¯†ç &#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                               <span class=n>error_messages</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>                                   <span class=s1>&#39;min_length&#39;</span><span class=p>:</span> <span class=s1>&#39;å¯†ç æœ€å°‘3ä½&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                   <span class=s1>&#39;max_length&#39;</span><span class=p>:</span> <span class=s1>&#39;å¯†ç æœ€å¤§8ä½&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                   <span class=s1>&#39;required&#39;</span><span class=p>:</span> <span class=s1>&#39;å¯†ç ä¸èƒ½ä¸ºç©º&#39;</span>
</span></span><span class=line><span class=cl>                               <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=n>email</span> <span class=o>=</span> <span class=n>forms</span><span class=o>.</span><span class=n>EmailField</span><span class=p>(</span><span class=n>label</span><span class=o>=</span><span class=s1>&#39;é‚®ç®±&#39;</span><span class=p>,</span> <span class=n>error_messages</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;invalid&#39;</span><span class=p>:</span> <span class=s1>&#39;é‚®ç®±æ ¼å¼ä¸æ­£ç¡®&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;required&#39;</span><span class=p>:</span> <span class=s1>&#39;é‚®ç®±ä¸èƒ½ä¸ºç©º&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=é’©å­å‡½æ•°hook>é’©å­å‡½æ•°(hook)</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>åœ¨ç‰¹å®šçš„èŠ‚ç‚¹è‡ªåŠ¨è§¦å‘å®Œæˆå“åº”æ“ä½œ
</span></span></span><span class=line><span class=cl><span class=s2>é’©å­å‡½æ•°åœ¨formç»„ä»¶ä¸­ å°±ç±»ä¼¼äºç¬¬äºŒé“å…³å¡ èƒ½å¤Ÿè®©æˆ‘ä»¬è‡ªå®šä¹‰æ ¡éªŒè§„åˆ™
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>åœ¨formsç»„ä»¶ä¸­æœ‰2ç±»é’©å­
</span></span></span><span class=line><span class=cl><span class=s2>  1. å±€éƒ¨é’©å­
</span></span></span><span class=line><span class=cl><span class=s2>    å½“ä½ éœ€è¦ç»™å•ä¸ªå­—æ®µå¢åŠ æ ¡éªŒè§„åˆ™çš„æ—¶å€™å¯ä»¥ä½¿ç”¨
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>  2. å…¨å±€é’©å­
</span></span></span><span class=line><span class=cl><span class=s2>    å½“ä½ éœ€è¦ç»™å¤šä¸ªå­—æ®µå¢åŠ æ ¡éªŒè§„åˆ™çš„æ—¶å€™å¯ä»¥ä½¿ç”¨
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å®é™…æ¡ˆä¾‹</span>
</span></span><span class=line><span class=cl><span class=mf>1.</span> <span class=n>æ ¡éªŒç”¨æˆ·åä¸­ä¸èƒ½å«æœ‰666</span>    <span class=c1># åªæ˜¯æ ¡éªŒusernameå­—æ®µ å±€éƒ¨é’©å­</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>2.</span> <span class=n>æ£€éªŒå¯†ç å’Œç¡®è®¤å¯†ç æ˜¯å¦ä¸€è‡´</span>  <span class=c1># password confirmä¸¤ä¸ªå­—æ®µ å…¨å±€é’©å­</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># é’©å­å‡½æ•° åœ¨ç±»é‡Œé¢ä¹¦å†™æ–¹æ³•å³å¯</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>MyForm</span><span class=p>(</span><span class=n>forms</span><span class=o>.</span><span class=n>Form</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>username</span> <span class=o>=</span> <span class=n>forms</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=o>...</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>password</span> <span class=o>=</span> <span class=n>forms</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=o>...</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>confirm_password</span> <span class=o>=</span> <span class=n>forms</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=o>...</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>email</span> <span class=o>=</span> <span class=n>forms</span><span class=o>.</span><span class=n>EmailField</span><span class=p>(</span><span class=o>...</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># é’©å­å‡½æ•°</span>
</span></span><span class=line><span class=cl>    <span class=c1># å±€éƒ¨é’©å­</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>clean_username</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># è·å–åˆ°ç”¨æˆ·å</span>
</span></span><span class=line><span class=cl>        <span class=n>username</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>cleaned_data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;username&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s1>&#39;666&#39;</span> <span class=ow>in</span> <span class=n>username</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># å±•ç¤ºé”™è¯¯ä¿¡æ¯</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>add_error</span><span class=p>(</span><span class=s1>&#39;username&#39;</span><span class=p>,</span> <span class=s1>&#39;ä¸èƒ½åŒ…å«666&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># å°†é’©å­å‡½æ•°é’©å‡ºå»çš„æ•°æ®(å•ä¸ªæ•°æ®)å†æ”¾å›å»</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>username</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># å…¨å±€é’©å­</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>clean</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>password</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>cleaned_data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;password&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>confirm_password</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>cleaned_data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;confirm_password&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>password</span> <span class=o>==</span> <span class=n>confirm_password</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>add_error</span><span class=p>(</span><span class=s1>&#39;confirm_password&#39;</span><span class=p>,</span> <span class=s1>&#39;ä¸¤æ¬¡å¯†ç ä¸ä¸€è‡´&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># å°†é’©å­å‡½æ•°é’©å‡ºå»çš„æ•°æ®(å…¨éƒ¨æ•°æ®)å†æ”¾å›å»</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>cleaned_data</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=é‡è¦å‚æ•°>é‡è¦å‚æ•°</h3><p><a class=link href=https://docs.djangoproject.com/zh-hans/3.1/ref/forms/fields/ target=_blank rel=noopener>Djangoå®˜ç½‘è¡¨å•å­—æ®µè¯¦è§£</a></p><p><strong>formsç»„ä»¶ å…¶ä»–å‚æ•°åŠè¡¥å……çŸ¥è¯†ç‚¹</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>label</span>              <span class=n>è‡ªå®šä¹‰å­—æ®µå</span>
</span></span><span class=line><span class=cl><span class=n>error_messages</span>     <span class=n>è‡ªå®šä¹‰æŠ¥é”™ä¿¡æ¯</span>
</span></span><span class=line><span class=cl><span class=n>initial</span>            <span class=n>é»˜è®¤å€¼</span>
</span></span><span class=line><span class=cl><span class=n>required</span>           <span class=n>æ˜¯å¦å¿…å¡«</span> <span class=n>é»˜è®¤æ˜¯True</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>é—®é¢˜ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>1. å­—æ®µæ²¡æœ‰æ ·å¼
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>2. é’ˆå¯¹ä¸åŒç±»å‹çš„inputå¦‚ä½•ä¿®æ”¹
</span></span></span><span class=line><span class=cl><span class=s2>  - text
</span></span></span><span class=line><span class=cl><span class=s2>  - password
</span></span></span><span class=line><span class=cl><span class=s2>  - date
</span></span></span><span class=line><span class=cl><span class=s2>  - radio
</span></span></span><span class=line><span class=cl><span class=s2>  - checkbox
</span></span></span><span class=line><span class=cl><span class=s2>  ...
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2># å¤„ç†æ–‡æœ¬è¾“å…¥çš„éƒ¨ä»¶ widgetå‚æ•°è§£å†³
</span></span></span><span class=line><span class=cl><span class=s2>https://docs.djangoproject.com/zh-hans/3.1/ref/forms/widgets/
</span></span></span><span class=line><span class=cl><span class=s2>  widget=forms.PasswordInput
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2># è°ƒæ•´æ ·å¼ attrså‚æ•°è§£å†³
</span></span></span><span class=line><span class=cl><span class=s2># å¤šä¸ªå±æ€§å€¼ ç›´æ¥ç©ºæ ¼éš”å¼€å³å¯
</span></span></span><span class=line><span class=cl><span class=s2>https://docs.djangoproject.com/zh-hans/3.1/ref/forms/widgets/#django.forms.Widget.attrs
</span></span></span><span class=line><span class=cl><span class=s2>  widget=forms.TextInput(attrs={&#39;class&#39;:&#39;form-contral c1 c2&#39;})
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>validators</span>      <span class=n>ç¬¬ä¸€é“å…³å¡è¿˜æ”¯æŒæ­£åˆ™æ ¡éªŒ</span>
</span></span><span class=line><span class=cl><span class=n>å‚è€ƒ</span><span class=err>ï¼š</span><span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>docs</span><span class=o>.</span><span class=n>djangoproject</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=n>zh</span><span class=o>-</span><span class=n>hans</span><span class=o>/</span><span class=mf>3.1</span><span class=o>/</span><span class=n>ref</span><span class=o>/</span><span class=n>validators</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=n>validators</span><span class=o>=</span><span class=p>[</span><span class=n>RegexValidator</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^[0-9]+$&#39;</span><span class=p>,</span> <span class=s1>&#39;è¯·è¾“å…¥æ•°å­—&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>RegexValidator</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^159[0-9]+$&#39;</span><span class=p>,</span> <span class=s1>&#39;æ•°å­—å¿…é¡»ä»¥159å¼€å¤´&#39;</span><span class=p>)]</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=å…¶ä»–å­—æ®µç±»å‹>å…¶ä»–å­—æ®µç±»å‹</h3><p><a class=link href=https://docs.djangoproject.com/zh-hans/3.1/ref/forms/widgets/#selector-and-checkbox-widgets target=_blank rel=noopener>é€‰æ‹©å™¨å’Œå¤é€‰æ¡†éƒ¨ä»¶</a></p><h3 id=formsç»„ä»¶æºç >Formsç»„ä»¶æºç </h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>åˆ‡å…¥ç‚¹ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>  form_obj.is_valid()
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>is_valid</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Return True if the form has no errors, or False otherwise.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>is_bound</span> <span class=ow>and</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>errors</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    å¦‚æœis_vaildè¦è¿”å›Trueçš„è¯ é‚£ä¹ˆï¼š
</span></span></span><span class=line><span class=cl><span class=s2>      - self.is_bound()è¦ä¸ºTrue
</span></span></span><span class=line><span class=cl><span class=s2>      - self.errors()è¦ä¸ºFalse
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=c1># åªè¦ä¼ å€¼ é‚£ä¹ˆself.is_boundå°±ä¸ºTrue</span>
</span></span><span class=line><span class=cl><span class=bp>self</span><span class=o>.</span><span class=n>is_bound</span> <span class=o>=</span> <span class=n>data</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>or</span> <span class=n>files</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@property</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>errors</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Return an ErrorDict for the data provided for the form.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_errors</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>full_clean</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_errors</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># formsç»„ä»¶æ‰€æœ‰çš„åŠŸèƒ½åŸºæœ¬éƒ½å‡ºè‡ªäºè¯¥æ–¹æ³•</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>full_clean</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Clean all of self.data and populate self._errors and self.cleaned_data.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>_errors</span> <span class=o>=</span> <span class=n>ErrorDict</span><span class=p>()</span>  <span class=c1># åˆ›å»ºç±»ç©ºå­—å…¸</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>is_bound</span><span class=p>:</span>  <span class=c1># Stop further processing.</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>cleaned_data</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=c1># If the form is permitted to be empty, and none of the form data has</span>
</span></span><span class=line><span class=cl>    <span class=c1># changed from the initial data, short circuit any validation.</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>empty_permitted</span> <span class=ow>and</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>has_changed</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># è¿™ä¸‰è¡Œ æ•´ä¸ªformsç»„ä»¶ç²¾é«“æ‰€åœ¨</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>_clean_fields</span><span class=p>()</span>    <span class=c1># æ£€éªŒå­—æ®µæºç  + å±€éƒ¨é’©å­</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>_clean_form</span><span class=p>()</span>      <span class=c1># å…¨å±€é’©å­</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>_post_clean</span><span class=p>()</span>      <span class=c1># An internal hook</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ ¡éªŒå­—æ®µå±€éƒ¨é’©å­æºç è§£è¯»>æ ¡éªŒå­—æ®µ/å±€éƒ¨é’©å­æºç è§£è¯»</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>_clean_fields</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>field</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>fields</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=c1># value_from_datadict() gets the data from the data dictionaries.</span>
</span></span><span class=line><span class=cl>        <span class=c1># Each widget type knows how to retrieve its own data, because some</span>
</span></span><span class=line><span class=cl>        <span class=c1># widgets split data over several HTML fields.</span>
</span></span><span class=line><span class=cl>        <span class=c1># è·å–å­—æ®µå¯¹åº”çš„ç”¨æˆ·æ•°æ®</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>field</span><span class=o>.</span><span class=n>disabled</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>value</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_initial_for_field</span><span class=p>(</span><span class=n>field</span><span class=p>,</span> <span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>value</span> <span class=o>=</span> <span class=n>field</span><span class=o>.</span><span class=n>widget</span><span class=o>.</span><span class=n>value_from_datadict</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>files</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>add_prefix</span><span class=p>(</span><span class=n>name</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>field</span><span class=p>,</span> <span class=n>FileField</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=n>initial</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_initial_for_field</span><span class=p>(</span><span class=n>field</span><span class=p>,</span> <span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>value</span> <span class=o>=</span> <span class=n>field</span><span class=o>.</span><span class=n>clean</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=n>initial</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>value</span> <span class=o>=</span> <span class=n>field</span><span class=o>.</span><span class=n>clean</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>cleaned_data</span><span class=p>[</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=n>value</span>  <span class=c1># å°†åˆæ³•çš„å­—æ®µæ·»åŠ åˆ°cleaned_data</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=s1>&#39;clean_</span><span class=si>%s</span><span class=s1>&#39;</span> <span class=o>%</span> <span class=n>name</span><span class=p>):</span>  <span class=c1># åˆ©ç”¨åå°„è·å–å±€éƒ¨é’©å­å‡½æ•°</span>
</span></span><span class=line><span class=cl>                <span class=n>value</span> <span class=o>=</span> <span class=nb>getattr</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=s1>&#39;clean_</span><span class=si>%s</span><span class=s1>&#39;</span> <span class=o>%</span> <span class=n>name</span><span class=p>)()</span>  <span class=c1># ()è°ƒç”¨ å±€éƒ¨é’©å­å‡½æ•°éœ€è¦æœ‰è¿”å›å€¼</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>cleaned_data</span><span class=p>[</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=n>value</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=n>ValidationError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>add_error</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=n>e</span><span class=p>)</span>  <span class=c1># æ·»åŠ æç¤ºæŠ¥é”™ä¿¡æ¯</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl><span class=c1># å¾—å‡ºé’©å­å‡½æ•°ç¬¬äºŒç§éªŒè¯å­—æ®µä¸é€šè¿‡çš„æŠ¥é”™æ–¹å¼</span>
</span></span><span class=line><span class=cl><span class=c1># å±€éƒ¨é’©å­</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>clean_username</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># è·å–åˆ°ç”¨æˆ·å</span>
</span></span><span class=line><span class=cl>    <span class=n>username</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>cleaned_data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;username&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=s1>&#39;666&#39;</span> <span class=ow>in</span> <span class=n>username</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># å±•ç¤ºé”™è¯¯ä¿¡æ¯</span>
</span></span><span class=line><span class=cl>        <span class=c1># æŠ¥é”™æ–¹å¼1</span>
</span></span><span class=line><span class=cl>        <span class=c1># self.add_error(&#39;username&#39;, &#39;ä¸èƒ½åŒ…å«666&#39;)</span>
</span></span><span class=line><span class=cl>        <span class=c1># æŠ¥é”™æ–¹å¼2 çœ‹æºç å¾—å‡º è¾ƒä¸ºç¹çä¸€èˆ¬ä¸ç”¨</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=n>ValidationError</span><span class=p>(</span><span class=s1>&#39;ä¸èƒ½åŒ…å«æœªå…è®¸çš„æ•°å­—&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># å°†é’©å­å‡½æ•°é’©å‡ºå»çš„æ•°æ®(å•ä¸ªæ•°æ®)å†æ”¾å›å»</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>username</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=å…¨å±€é’©å­æºç è§£è¯»>å…¨å±€é’©å­æºç è§£è¯»</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>_clean_form</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>cleaned_data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>clean</span><span class=p>()</span>  <span class=c1># å…¨å±€é’©å­éœ€è¦ä¸€ä¸ªè¿”å›å€¼ self.cleaned_data</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=n>ValidationError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>add_error</span><span class=p>(</span><span class=kc>None</span><span class=p>,</span> <span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>cleaned_data</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>cleaned_data</span> <span class=o>=</span> <span class=n>cleaned_data</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=_post_clean>_post_clean</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;å†…éƒ¨é¢„ç•™é’©å­ An internal hook&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>_post_clean</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    An internal hook for performing additional cleaning after form cleaning
</span></span></span><span class=line><span class=cl><span class=s2>    is complete. Used for model validation in model forms.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>pass</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=cookieå’Œsession>Cookieå’ŒSession</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>å‘å±•å²ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>  1. ç½‘ç«™éƒ½æ²¡æœ‰ä¿å­˜ç”¨æˆ·åŠŸèƒ½çš„éœ€æ±‚ æ‰€æœ‰ç”¨æˆ·è®¿é—®è¿”å›çš„ç»“æœéƒ½æ˜¯ä¸€æ ·çš„
</span></span></span><span class=line><span class=cl><span class=s2>    e.g: æ–°é—» åšå®¢ æ–‡ç«  ...
</span></span></span><span class=line><span class=cl><span class=s2>   
</span></span></span><span class=line><span class=cl><span class=s2>  2. å‡ºç°äº†ä¸€äº›éœ€è¦ä¿å­˜ç”¨æˆ·ä¿¡æ¯çš„ç½‘ç«™
</span></span></span><span class=line><span class=cl><span class=s2>    e.g: æ·˜å® æ”¯ä»˜å® äº¬ä¸œ ...  (éœ€è¦çŸ¥é“ä½ æ˜¯è°)
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    ä»¥ç™»é™†åŠŸèƒ½ä¸ºä¾‹ï¼šå¦‚æœä¸ä¿å­˜ç”¨æˆ·ç™»é™†çŠ¶æ€ ä¹Ÿå°±æ„å‘³ç€ç”¨æˆ·æ¯æ¬¡è®¿é—®ç½‘ç«™éƒ½éœ€è¦é‡å¤çš„è¾“å…¥ç”¨æˆ·åå’Œå¯†ç (ä½ è§‰å¾—è¿™æ ·çš„ç½‘ç«™ ä½ è¿˜æƒ³ç”¨å—?)  
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    å½“ç”¨æˆ·ç¬¬ä¸€æ¬¡ç™»é™†æˆåŠŸä¹‹å å°†ç”¨æˆ·çš„ ç”¨æˆ·åå¯†ç  è¿”å›ç»™ç”¨æˆ·æµè§ˆå™¨ è®©ç”¨æˆ·æµè§ˆå™¨ä¿å­˜åœ¨æœ¬åœ° ä¹‹åè®¿é—®ç½‘ç«™çš„æ—¶å€™æµè§ˆå™¨è‡ªåŠ¨å°†ä¿å­˜åœ¨æµè§ˆå™¨ä¸Šçš„ç”¨æˆ·åå’Œå¯†ç å‘é€ç»™æœåŠ¡ç«¯ æœåŠ¡ç«¯è·å–ä¹‹åè‡ªåŠ¨æ ¡éªŒ
</span></span></span><span class=line><span class=cl><span class=s2>    æ—©æœŸè¿™ç§æ–¹å¼å…·æœ‰éå¸¸å¤§çš„å®‰å…¨éšæ‚£(èƒ½å¤Ÿç›´æ¥çœ‹åˆ°)
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    ä¼˜åŒ–ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>      å½“ç”¨æˆ·ç™»é™†æˆåŠŸä¹‹å æœåŠ¡ç«¯äº§ç”Ÿä¸€ä¸ªéšæœºå­—ç¬¦ä¸²(åœ¨æœåŠ¡ç«¯ä¿å­˜æ•°æ® ç”¨K:Vé”®å€¼å¯¹çš„å½¢å¼) äº¤ç”±å®¢æˆ·ç«¯æµè§ˆå™¨ä¿å­˜
</span></span></span><span class=line><span class=cl><span class=s2>      éšæœºå­—ç¬¦ä¸²1ï¼šç”¨æˆ·1ç›¸å…³ä¿¡æ¯
</span></span></span><span class=line><span class=cl><span class=s2>      éšæœºå­—ç¬¦ä¸²2ï¼šç”¨æˆ·2ç›¸å…³ä¿¡æ¯
</span></span></span><span class=line><span class=cl><span class=s2>      éšæœºå­—ç¬¦ä¸²3ï¼šç”¨æˆ·3ç›¸å…³ä¿¡æ¯
</span></span></span><span class=line><span class=cl><span class=s2>      ...
</span></span></span><span class=line><span class=cl><span class=s2>      ä¹‹åè®¿é—®æœåŠ¡ç«¯çš„æ—¶å€™ éƒ½å¸¦ç€è¯¥éšæœºå­—ç¬¦ä¸² æœåŠ¡ç«¯å»æ•°æ®åº“ä¸­æ¯”å¯¹æ˜¯å¦æœ‰å¯¹åº”çš„éšæœºå­—ç¬¦ä¸²ä»è€Œè·å–åˆ°å¯¹åº”çš„ç”¨æˆ·ä¿¡æ¯
</span></span></span><span class=line><span class=cl><span class=s2>      ä½†æ˜¯å¦‚æœä½ æ‹¿åˆ°äº†(æˆªè·)è¯¥éšæœºå­—ç¬¦ä¸² é‚£ä¹ˆä½ å°±å¯ä»¥å†’å……å½“å‰ç”¨æˆ· çœŸå®è¿˜æ˜¯æœ‰å®‰å…¨éšæ‚£çš„
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>**åœ¨WEBé¢†åŸŸ æ²¡æœ‰ç»å¯¹çš„å®‰å…¨ ä¹Ÿæ²¡æœ‰ç»å¯¹çš„ä¸å®‰å…¨**
</span></span></span><span class=line><span class=cl><span class=s2>  åŸºæœ¬ä¸Šé˜²å¾¡æªæ–½éƒ½éœ€è¦ç¨‹åºå‘˜è‡ªå·±å†™ä»£ç å®Œå–„ å¹¶ä¸”åªèƒ½å®Œå–„ æ²¡æ³•æœç»
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># cookie</span>
</span></span><span class=line><span class=cl><span class=n>æ¦‚å¿µ</span><span class=err>ï¼š</span><span class=n>æœåŠ¡ç«¯è®¾ç½®ä¿å­˜åœ¨å®¢æˆ·ç«¯æµè§ˆå™¨ä¸Šçš„é”®å€¼å¯¹</span><span class=p>(</span><span class=n>åªè¦ç¬¦åˆå‰é¢å®šä¹‰çš„éƒ½å¯ä»¥å«cookie</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>æœåŠ¡ç«¯ä¿å­˜åœ¨å®¢æˆ·ç«¯æµè§ˆå™¨ä¸Šçš„ä¿¡æ¯éƒ½å¯ä»¥ç§°ä¹‹ä¸ºcookie</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>å®ƒçš„è¡¨ç°å½¢å¼ä¸€èˆ¬éƒ½æ˜¯K</span><span class=p>:</span><span class=n>Vé”®å€¼å¯¹</span><span class=p>(</span><span class=n>å¯ä»¥æœ‰å¤šä¸ª</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>æµè§ˆå™¨å¯ä»¥é€‰æ‹©ä¸ä¿å­˜</span><span class=p>(</span><span class=n>ä½†æ˜¯ä¼šå¯¼è‡´ç½‘é¡µæ— æ³•å·¥ä½œ</span> <span class=n>æ¯”å¦‚æ— æ³•ç™»å½•</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=c1># session</span>
</span></span><span class=line><span class=cl><span class=n>æ¦‚å¿µ</span><span class=err>ï¼š</span><span class=n>å­˜å‚¨åœ¨æœåŠ¡ç«¯ä¸Šçš„é”®å€¼å¯¹</span><span class=p>(</span><span class=n>ä¸€èˆ¬æƒ…å†µéƒ½è·Ÿç”¨æˆ·ä¿¡æ¯æœ‰å…³</span> <span class=n>ç”¨æ¥æ ‡è¯†å½“å‰ç”¨æˆ·</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>æ•°æ®æ˜¯ä¿å­˜åœ¨æœåŠ¡ç«¯çš„</span> 
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>å¹¶ä¸”å®ƒçš„è¡¨ç°å½¢å¼ä¸€èˆ¬ä¹Ÿæ˜¯K</span><span class=p>:</span><span class=n>Vé”®å€¼å¯¹</span><span class=p>(</span><span class=n>å¯ä»¥æœ‰å¤šä¸ª</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>éœ€è¦åŸºäºcookieæ‰èƒ½å·¥ä½œ</span><span class=p>(</span><span class=n>å…¶å®å¤§éƒ¨åˆ†çš„ä¿å­˜çŠ¶æ€çš„å®ç°éƒ½éœ€è¦åŸºäºcookieæ¥åš</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># token</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>sessionè™½ç„¶æ˜¯ä¿å­˜åœ¨æœåŠ¡ç«¯çš„</span> <span class=n>ä½†æ˜¯ç»ä¸ä½æ•°æ®é‡å¤§</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>æœåŠ¡ç«¯ä¸å†ä¿å­˜æ•°æ®</span> 
</span></span><span class=line><span class=cl>    <span class=o>-</span> <span class=n>ç™»é™†æˆåŠŸä¹‹å</span> <span class=n>å°†ä¸€æ®µä¿¡æ¯ç”¨è‡ªå·±å®šåˆ¶çš„åŠ å¯†æ–¹å¼</span><span class=p>(</span><span class=n>åŠ å¯†ç®—æ³•åˆ«äººä¸çŸ¥é“</span><span class=p>)</span><span class=n>å¯¹å†…å®¹è¿›è¡ŒåŠ å¯†å¤„ç†</span> 
</span></span><span class=line><span class=cl>    <span class=o>-</span> <span class=n>ç„¶åå°†åŠ å¯†ç»“æœæ‹¼æ¥åœ¨è¿™æ®µä¿¡æ¯åé¢</span> <span class=n>æ•´ä½“è¿”å›ç»™ç”¨æˆ·æµè§ˆå™¨ä¿å­˜</span> <span class=p>[[</span><span class=n>ä¿¡æ¯å†…å®¹</span><span class=p>][</span><span class=n>åŠ å¯†å†…å®¹</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>    <span class=o>-</span> <span class=n>æµè§ˆå™¨ä¸‹æ¬¡è®¿é—®çš„æ—¶å€™å¸¦ç€è¯¥ä¿¡æ¯</span> <span class=n>æœåŠ¡ç«¯è‡ªåŠ¨åˆ‡å»å‰é¢ä¸€æ®µä¿¡æ¯å†æ¬¡ä½¿ç”¨è‡ªå·±çš„åŠ å¯†ç®—æ³•</span> <span class=n>è·Ÿæµè§ˆå™¨å°¾éƒ¨çš„å¯†æ–‡è¿›è¡Œæ¯”å¯¹</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=c1># jwtè®¤è¯</span>
</span></span><span class=line><span class=cl>  <span class=n>ä¸‰æ®µä¿¡æ¯</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=n>æ€»ç»“</span><span class=err>ï¼š</span>
</span></span><span class=line><span class=cl>  <span class=mf>1.</span> <span class=n>cookieå°±æ˜¯ä¿å­˜åœ¨å®¢æˆ·ç«¯æµè§ˆå™¨ä¸Šçš„ä¿¡æ¯</span>
</span></span><span class=line><span class=cl>  <span class=mf>2.</span> <span class=n>sessionå°±æ˜¯ä¿å­˜åœ¨æœåŠ¡ç«¯ä¸Šçš„ä¿¡æ¯</span>
</span></span><span class=line><span class=cl>  <span class=mf>3.</span> <span class=n>sessionæ˜¯åŸºäºcookieå·¥ä½œçš„</span><span class=p>(</span><span class=n>å…¶å®å¤§éƒ¨åˆ†çš„ä¿å­˜ç”¨æˆ·çŠ¶æ€çš„æ“ä½œ</span> <span class=n>éƒ½éœ€è¦ä½¿ç”¨åˆ°cookie</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=cookieæ“ä½œ>Cookieæ“ä½œ</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>è™½ç„¶cookieæ˜¯æœåŠ¡ç«¯å‘Šè¯‰å®¢æˆ·ç«¯æµè§ˆå™¨éœ€è¦ä¿å­˜çš„å†…å®¹ ä½†æ˜¯å®¢æˆ·ç«¯æµè§ˆå™¨å¯ä»¥é€‰æ‹©æ‹’ç»ä¿å­˜ å¦‚æœç¦æ­¢æ‰ é‚£ä¹ˆåªè¦æ˜¯éœ€è¦è®°å½•ç”¨æˆ·çŠ¶æ€çš„ç½‘ç«™ ç™»é™†åŠŸèƒ½éƒ½æ— æ³•ä½¿ç”¨
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è§†å›¾å‡½æ•°çš„è¿”å›å€¼</span>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=n>HttpResponse</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=n>render</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=n>redirect</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å¦‚æœä½ æƒ³è¦æ“ä½œcookie ä½ å°±ä¸å¾—ä¸åˆ©ç”¨HttpResponseå¯¹è±¡</span>
</span></span><span class=line><span class=cl><span class=n>obj1</span> <span class=o>=</span> <span class=n>HttpResponse</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>æ“ä½œcookie</span>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=n>obj1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>obj2</span> <span class=o>=</span> <span class=n>render</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>æ“ä½œcookie</span>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=n>obj2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>obj3</span> <span class=o>=</span> <span class=n>redirect</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>æ“ä½œcookie</span>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=n>obj3</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=è®¾ç½®cookie>è®¾ç½®cookie</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># obj in [obj1, obj2, obj3]</span>
</span></span><span class=line><span class=cl>  <span class=n>obj</span><span class=o>.</span><span class=n>set_cookie</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># åœ¨è®¾ç½®cookieçš„æ—¶å€™ å¯ä»¥æ·»åŠ ä¸€ä¸ªè¶…æ—¶æ—¶é—´</span>
</span></span><span class=line><span class=cl><span class=n>obj</span><span class=o>.</span><span class=n>set_cookie</span><span class=p>(</span><span class=s1>&#39;username&#39;</span><span class=p>,</span> <span class=s1>&#39;minho123123&#39;</span><span class=p>,</span> <span class=n>max_age</span><span class=o>=</span><span class=mi>5</span><span class=o>/</span><span class=n>expires</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>max_age</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>expires</span>
</span></span><span class=line><span class=cl>  <span class=n>è¿™ä¸¤ä¸ªå‚æ•°éƒ½æ˜¯è®¾ç½®è¶…æ—¶æ—¶é—´çš„</span> <span class=n>å¹¶ä¸”éƒ½æ˜¯ä»¥ç§’ä¸ºå•ä½</span>
</span></span><span class=line><span class=cl>  <span class=n>éœ€è¦æ³¨æ„çš„æ˜¯</span> <span class=n>é’ˆå¯¹IEæµè§ˆå™¨</span> <span class=n>éœ€è¦ä½¿ç”¨expires</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è®¾ç½®é”®å€¼å¯¹çš„æ—¶å€™ å¯ä»¥åŠ ç›å¤„ç†</span>
</span></span><span class=line><span class=cl><span class=n>obj</span><span class=o>.</span><span class=n>set_signed_cokkie</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>value</span><span class=p>,</span> <span class=n>salt</span><span class=o>=</span><span class=s1>&#39;ç›&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=è·å–cookie>è·å–cookie</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># obj in [obj1, obj2, obj3]</span>
</span></span><span class=line><span class=cl>  <span class=n>request</span><span class=o>.</span><span class=n>COOKIES</span>
</span></span><span class=line><span class=cl>  <span class=n>request</span><span class=o>.</span><span class=n>COOKIES</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è·å–åŠ ç›cookie</span>
</span></span><span class=line><span class=cl><span class=n>request</span><span class=o>.</span><span class=n>get_signed_cookie</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>salt</span><span class=o>=</span><span class=s1>&#39;ç›&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=åˆ é™¤cookie>åˆ é™¤cookie</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># å¦‚ä½•ä¸»åŠ¨åˆ é™¤cookie - é€€å‡ºç™»å½•|æ³¨é”€</span>
</span></span><span class=line><span class=cl><span class=nd>@login_auth</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>logout</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>obj</span> <span class=o>=</span> <span class=n>redirect</span><span class=p>(</span><span class=s1>&#39;/app03/login/&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>obj</span><span class=o>.</span><span class=n>delete_cookie</span><span class=p>(</span><span class=s1>&#39;username&#39;</span><span class=p>)</span>  <span class=c1># åˆ é™¤cookie å®ç°é€€å‡ºç™»å½•æ³¨é”€åŠŸèƒ½</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>obj</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=cookieç‰ˆç™»å½•éªŒè¯>cookieç‰ˆç™»å½•éªŒè¯</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.shortcuts</span> <span class=kn>import</span> <span class=n>render</span><span class=p>,</span> <span class=n>HttpResponse</span><span class=p>,</span> <span class=n>redirect</span><span class=p>,</span> <span class=n>reverse</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>login</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;POST&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>username</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;username&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>password</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;password&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>username</span> <span class=o>==</span> <span class=s1>&#39;minho&#39;</span> <span class=ow>and</span> <span class=n>password</span> <span class=o>==</span> <span class=s1>&#39;123&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># ä¿å­˜ç”¨æˆ·ç™»é™†çŠ¶æ€</span>
</span></span><span class=line><span class=cl>            <span class=n>obj</span> <span class=o>=</span> <span class=n>redirect</span><span class=p>(</span><span class=n>reverse</span><span class=p>(</span><span class=s1>&#39;app03_home&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=c1># è®©æµè§ˆå™¨è®°å½•cookie</span>
</span></span><span class=line><span class=cl>            <span class=n>obj</span><span class=o>.</span><span class=n>set_cookie</span><span class=p>(</span><span class=s1>&#39;username&#39;</span><span class=p>,</span> <span class=s1>&#39;minho123123&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>            æµè§ˆå™¨ä¸å•å•ä¼šå¸®ä½ å­˜
</span></span></span><span class=line><span class=cl><span class=s2>            è€Œä¸”åé¢æ¯æ¬¡è®¿é—®ä½ çš„æ—¶å€™ è¿˜ä¼šå¸¦ç€å®ƒè¿‡æ¥
</span></span></span><span class=line><span class=cl><span class=s2>            &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>            <span class=c1># è·³è½¬åˆ°ä¸€ä¸ªéœ€è¦ç”¨æˆ·ç™»é™†ä¹‹åå†èƒ½çœ‹çš„ç•Œé¢</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>obj</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=s1>&#39;login.html&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>home</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># è·å–cookieä¿¡æ¯ åˆ¤æ–­ä½ æœ‰æ²¡æœ‰</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>COOKIES</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;username&#39;</span><span class=p>)</span> <span class=o>==</span> <span class=s1>&#39;minho123123&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;æˆ‘æ˜¯homeé¡µé¢ åªæœ‰ç™»é™†çš„ç”¨æˆ·æ‰èƒ½è¿›æ¥&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># æ²¡æœ‰ç™»é™†åº”è¯¥è·³è½¬åˆ°ç™»é™†é¡µé¢</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=n>reverse</span><span class=p>(</span><span class=s1>&#39;app03_login&#39;</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>ç™»é™†æ£€éªŒç®€å•è£…é¥°å™¨</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>é—®é¢˜1ï¼šå¦‚æœéœ€è¦éªŒè¯ç™»é™†çš„è§†å›¾æœ‰éå¸¸å¤š è¿™æ ·å†™å¾ˆå†—ä½™ -&gt; è£…é¥°å™¨
</span></span></span><span class=line><span class=cl><span class=s2>è§£å†³ï¼šæ ¡éªŒç”¨æˆ·æ˜¯å¦ç™»é™†çš„ç®€å•è£…é¥°å™¨
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>login_auth</span><span class=p>(</span><span class=n>wrapped</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>wrapper</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>COOKIES</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;username&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>wrapped</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=n>reverse</span><span class=p>(</span><span class=s1>&#39;app03_login&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>wrapper</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>å®Œæ•´ç™»é™†ä»£ç ç¤ºä¾‹</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>é—®é¢˜2ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>  æœ‰ä¸‹é¢å¤šä¸ªè§†å›¾çš„æƒ…å†µä¸‹ æˆ‘è®¿é—®/index ä¼šè¢«é‡å®šå‘åˆ°/login
</span></span></span><span class=line><span class=cl><span class=s2>  ä½†æ˜¯ æˆ‘è¾“å…¥ç”¨æˆ·åå¯†ç ç™»é™†ä¹‹å è‡ªåŠ¨è·³è½¬åˆ°/home è€Œä¸æ˜¯æˆ‘æƒ³è®¿é—®çš„/index/
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>  ç”¨æˆ·å¦‚æœåœ¨æ²¡æœ‰ç™»é™†çš„æƒ…å†µä¸‹ æƒ³è®¿é—®ä¸€ä¸ªéœ€è¦ç™»é™†çš„é¡µé¢
</span></span></span><span class=line><span class=cl><span class=s2>  é‚£ä¹ˆå…ˆè·³è½¬åˆ°ç™»é™†é¡µé¢ å½“ç”¨æˆ·è¾“å…¥æ­£ç¡®çš„ç”¨æˆ·åå’Œå¯†ç ä¹‹å
</span></span></span><span class=line><span class=cl><span class=s2>  åº”è¯¥è·³è½¬åˆ°ç”¨æˆ·ä¹‹å‰æƒ³è¦è®¿é—®çš„é¡µé¢å» è€Œä¸æ˜¯ç›´æ¥å†™æ­»
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>è§£å†³ï¼šè§ä¸‹é¢ç¨å¾®å®Œæ•´çš„ç™»é™†ç¤ºä¾‹ä»£ç 
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>functools</span> <span class=kn>import</span> <span class=n>wraps</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.shortcuts</span> <span class=kn>import</span> <span class=n>render</span><span class=p>,</span> <span class=n>HttpResponse</span><span class=p>,</span> <span class=n>redirect</span><span class=p>,</span> <span class=n>reverse</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>login_auth</span><span class=p>(</span><span class=n>wrapped</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nd>@wraps</span><span class=p>(</span><span class=n>wrapped</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>wrapper</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(request.path)</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(request.get_full_path())  # èƒ½å¤Ÿè·å–åˆ°ç”¨æˆ·ä¸Šä¸€æ¬¡æƒ³è¦è®¿é—®çš„url</span>
</span></span><span class=line><span class=cl>        <span class=n>target_url</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>get_full_path</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>COOKIES</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;username&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>wrapped</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># return redirect(&#39;/login/?next={}&#39;.format(target_url))</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=n>reverse</span><span class=p>(</span><span class=s1>&#39;app03_login&#39;</span><span class=p>)</span> <span class=o>+</span> <span class=s1>&#39;?next=</span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>target_url</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>wrapper</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>login</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;POST&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>username</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;username&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>password</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;password&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>username</span> <span class=o>==</span> <span class=s1>&#39;minho&#39;</span> <span class=ow>and</span> <span class=n>password</span> <span class=o>==</span> <span class=s1>&#39;123&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># è·å–ç”¨æˆ·ä¸Šä¸€æ¬¡æƒ³è¦è®¿é—®çš„url</span>
</span></span><span class=line><span class=cl>            <span class=n>target_url</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>GET</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;next&#39;</span><span class=p>)</span>  <span class=c1># å¯èƒ½ä¸ºNone - ç”¨æˆ·ç›´æ¥è®¿é—®/loginçš„æƒ…å†µ</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>target_url</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>obj</span> <span class=o>=</span> <span class=n>redirect</span><span class=p>(</span><span class=n>target_url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1># ä¿å­˜ç”¨æˆ·ç™»é™†çŠ¶æ€</span>
</span></span><span class=line><span class=cl>                <span class=n>obj</span> <span class=o>=</span> <span class=n>redirect</span><span class=p>(</span><span class=n>reverse</span><span class=p>(</span><span class=s1>&#39;app03_home&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=c1># è®©æµè§ˆå™¨è®°å½•cookie</span>
</span></span><span class=line><span class=cl>            <span class=n>obj</span><span class=o>.</span><span class=n>set_cookie</span><span class=p>(</span><span class=s1>&#39;username&#39;</span><span class=p>,</span> <span class=s1>&#39;minho123123&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>            æµè§ˆå™¨ä¸å•å•ä¼šå¸®ä½ å­˜
</span></span></span><span class=line><span class=cl><span class=s2>            è€Œä¸”åé¢æ¯æ¬¡è®¿é—®ä½ çš„æ—¶å€™ è¿˜ä¼šå¸¦ç€å®ƒè¿‡æ¥
</span></span></span><span class=line><span class=cl><span class=s2>            &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>            <span class=c1># è·³è½¬åˆ°ä¸€ä¸ªéœ€è¦ç”¨æˆ·ç™»é™†ä¹‹åå†èƒ½çœ‹çš„ç•Œé¢</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>obj</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=s1>&#39;login.html&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@login_auth</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>home</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;æˆ‘æ˜¯homeé¡µé¢ åªæœ‰ç™»é™†çš„ç”¨æˆ·æ‰èƒ½è¿›æ¥&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@login_auth</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>index</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;Index Page, Need Login&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@login_auth</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>users</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;Users Page, Need Login&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=sessionæ“ä½œ>Sessionæ“ä½œ</h3><p><a class=link href=https://docs.djangoproject.com/zh-hans/3.1/topics/http/sessions/ target=_blank rel=noopener>å¦‚ä½•ä½¿ç”¨ä¼šè¯</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>sessionæ•°æ®æ˜¯ä¿å­˜åœ¨æœåŠ¡ç«¯çš„(å­˜åˆ°å“ªå„¿? æ•°æ®åº“ -&gt; sessionè¡¨) ç»™å®¢æˆ·ç«¯è¿”å›çš„æ˜¯ä¸€ä¸ªéšæœºå­—ç¬¦ä¸²
</span></span></span><span class=line><span class=cl><span class=s2>  å®¢æˆ·ç«¯cookie -&gt; sessionid:éšæœºå­—ç¬¦ä¸²
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>1. åœ¨é»˜è®¤æƒ…å†µä¸‹æ“ä½œsessionçš„æ—¶å€™ éœ€è¦ä¸€å¼ è¡¨æ¥å­˜ djangoé»˜è®¤æä¾›ä¸€å¼ django_sessionè¡¨
</span></span></span><span class=line><span class=cl><span class=s2>   djangoä¼šé»˜è®¤åˆ›å»ºå¾ˆå¤šå¼ è¡¨ django_sessionå°±æ˜¯å…¶ä¸­ä¸€å¼ (No such table:django_session)
</span></span></span><span class=line><span class=cl><span class=s2>   
</span></span></span><span class=line><span class=cl><span class=s2>2. djangoé»˜è®¤sessionçš„è¿‡æœŸæ—¶é—´æ˜¯14å¤©
</span></span></span><span class=line><span class=cl><span class=s2>   ä½†æ˜¯ä½ ä¹Ÿå¯ä»¥äººä¸ºçš„ä¿®æ”¹å®ƒ
</span></span></span><span class=line><span class=cl><span class=s2>   
</span></span></span><span class=line><span class=cl><span class=s2>3. django_sessionè¡¨ä¸­çš„æ•°æ®æ˜¯å–å†³äºæµè§ˆå™¨çš„
</span></span></span><span class=line><span class=cl><span class=s2>   åŒä¸€ä¸ªè®¡ç®—æœºä¸Š(IPåœ°å€) åŒä¸€ä¸ªæµè§ˆå™¨ åªä¼šæœ‰ä¸€æ¡æ•°æ®ç”Ÿæ•ˆ(å½“sessionè¿‡æœŸçš„æ—¶å€™ å¯èƒ½ä¼šå‡ºç°å¤šæ¡æ•°æ®å¯¹åº”ä¸€ä¸ªæµè§ˆå™¨ ä½†æ˜¯è¿™ä¸ªæ•°æ®æ²¡æ„ä¹‰- æ— æ•ˆæ•°æ®;ä½†æ˜¯è¯¥ç°è±¡ä¸ä¼šæŒç»­å¾ˆä¹… å†…éƒ¨ä¼šè‡ªåŠ¨è¯†åˆ«è¿‡æœŸçš„æ•°æ®æ¸…é™¤ ä½ ä¹Ÿå¯ä»¥é€šè¿‡ä»£ç è¯·é™¤) 
</span></span></span><span class=line><span class=cl><span class=s2>   ç›®çš„ -&gt; ä¸»è¦ä¸ºäº†èŠ‚çœæœåŠ¡ç«¯èµ„æº
</span></span></span><span class=line><span class=cl><span class=s2>   
</span></span></span><span class=line><span class=cl><span class=s2>   é€šè¿‡ä¸€ä¸ªå”¯ä¸€çš„cookieID æœåŠ¡ç«¯å°±çŸ¥é“æ¥çš„ç”¨æˆ·æ˜¯è° ç„¶åæœåŠ¡ç«¯æ ¹æ®ä¸åŒçš„cookieID åœ¨æœåŠ¡ç«¯ä¸Šä¿å­˜ä¸€æ®µæ—¶é—´çš„ç§å¯†èµ„æ–™(å¦‚è´¦å·å¯†ç ç­‰) è¿™å°±æ˜¯æœåŠ¡ç«¯sessionä¿å­˜
</span></span></span><span class=line><span class=cl><span class=s2>   
</span></span></span><span class=line><span class=cl><span class=s2>4. sessionæ˜¯ä¿å­˜åœ¨æœåŠ¡ç«¯çš„ ä½†æ˜¯sessionçš„ä¿å­˜ä½ç½®å¯ä»¥æœ‰å¤šç§é€‰æ‹©
</span></span></span><span class=line><span class=cl><span class=s2>   4.1 MySQL
</span></span></span><span class=line><span class=cl><span class=s2>   4.2 æ–‡ä»¶
</span></span></span><span class=line><span class=cl><span class=s2>   4.3 redis/memcache...ç¼“å­˜
</span></span></span><span class=line><span class=cl><span class=s2>   4.4 å…¶ä»–
</span></span></span><span class=line><span class=cl><span class=s2>   ...
</span></span></span><span class=line><span class=cl><span class=s2>   
</span></span></span><span class=line><span class=cl><span class=s2>5. sessionè¿˜å¯ä»¥å¯¹ä¿å­˜çš„éšæœºå­—ç¬¦ä¸²åšåŠ ç›å¤„ç†
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>è®¾ç½®session
</span></span></span><span class=line><span class=cl><span class=s2>  - sessionå¯ä»¥è®¾ç½®å¤šä¸ª ä½†æ˜¯å‚è€ƒä¸Šé¢ç¬¬3ç‚¹
</span></span></span><span class=line><span class=cl><span class=s2>  - sessionä¹Ÿå¯ä»¥è®¾ç½®è¿‡æœŸæ—¶é—´
</span></span></span><span class=line><span class=cl><span class=s2>  request.session[&#39;key&#39;] = value    # æŠŠrequest.sessionå½“ä½œä¸€ä¸ªå­—å…¸
</span></span></span><span class=line><span class=cl><span class=s2>   
</span></span></span><span class=line><span class=cl><span class=s2>è·å–session
</span></span></span><span class=line><span class=cl><span class=s2>  request.session.get(&#39;key&#39;)
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>æ¸…é™¤session
</span></span></span><span class=line><span class=cl><span class=s2>  request.session.delete()    # åªåˆ æœåŠ¡ç«¯å½“å‰session
</span></span></span><span class=line><span class=cl><span class=s2>  request.session.flush()     # æµè§ˆå™¨å’ŒæœåŠ¡ç«¯éƒ½æ¸…ç©º(æ¨èä½¿ç”¨)
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=è®¾ç½®session>è®¾ç½®session</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># views.py</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>set_session</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    è®¾ç½®sessionå†…éƒ¨å‘ç”Ÿäº†å“ªäº›äº‹ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>      1. djangoå†…éƒ¨ä¼šè‡ªåŠ¨å¸®ä½ ç”Ÿæˆä¸€ä¸ªéšæœºå­—ç¬¦ä¸²
</span></span></span><span class=line><span class=cl><span class=s2>      2. djangoå†…éƒ¨è‡ªåŠ¨å°†éšæœºå­—ç¬¦ä¸²å’Œå¯¹åº”çš„æ•°æ®å­˜å‚¨åˆ°django_sessionè¡¨ä¸­ è¿™ä¸€æ­¥ä¸æ˜¯ç›´æ¥ç”Ÿæ•ˆçš„ åˆ†ä¸ºä¸‹é¢ä¸¤æ­¥
</span></span></span><span class=line><span class=cl><span class=s2>        2.1 å…ˆåœ¨å†…å­˜ä¸­äº§ç”Ÿæ“ä½œæ•°æ®çš„ç¼“å­˜
</span></span></span><span class=line><span class=cl><span class=s2>        2.2 åœ¨å“åº”ç»“æœç»è¿‡djangoä¸­é—´ä»¶çš„æ—¶å€™ æ‰çœŸæ­£æ“ä½œæ•°æ®åº“
</span></span></span><span class=line><span class=cl><span class=s2>      3. å°†äº§ç”Ÿçš„éšæœºå­—ç¬¦ä¸²è¿”å›ç»™å®¢æˆ·ç«¯æµè§ˆå™¨ä¿å­˜(è®¾ç½®cookie) 
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>request</span><span class=o>.</span><span class=n>session</span><span class=p>[</span><span class=s1>&#39;hobby&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;girl&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;Session Set&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># sessionè®¾ç½®è¿‡æœŸæ—¶é—´</span>
</span></span><span class=line><span class=cl><span class=n>request</span><span class=o>.</span><span class=n>session</span><span class=o>.</span><span class=n>set_expire</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=n>æ‹¬å·å†…å¯ä»¥æ”¾4ç§ç±»å‹çš„å‚æ•°</span>
</span></span><span class=line><span class=cl>    <span class=mf>1.</span> <span class=n>æ•´æ•°</span>                            <span class=n>å¤šå°‘ç§’åªä¼šå¤±æ•ˆ</span>
</span></span><span class=line><span class=cl>    <span class=mf>2.</span> <span class=n>æ—¥æœŸå¯¹è±¡</span><span class=p>(</span><span class=n>datetime</span><span class=o>/</span><span class=n>timedelta</span><span class=p>)</span>     <span class=n>åˆ°æŒ‡å®šæ—¥æœŸä¹‹åå¤±æ•ˆ</span>
</span></span><span class=line><span class=cl>    <span class=mf>3.</span> <span class=mi>0</span>                               <span class=n>ä¸€æ—¦å½“å‰æµè§ˆå™¨å…³é—­ç«‹åˆ»å¤±æ•ˆ</span>
</span></span><span class=line><span class=cl>    <span class=mf>4.</span> <span class=kc>None</span>                            <span class=n>å¤±æ•ˆæ—¶é—´å–å†³äºdjangoå†…éƒ¨å…¨å±€sessioné»˜è®¤çš„å¤±æ•ˆæ—¶é—´</span><span class=p>(</span><span class=mi>14</span><span class=n>å¤©</span><span class=p>)</span>  
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=c1># æµ‹è¯•è¿‡æœŸæ˜¯å¦æ˜¯ç”Ÿæ•ˆ</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>set_session</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>request</span><span class=o>.</span><span class=n>session</span><span class=p>[</span><span class=s1>&#39;hobby&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;girl&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>request</span><span class=o>.</span><span class=n>session</span><span class=p>[</span><span class=s1>&#39;hobby1&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;girl1&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>request</span><span class=o>.</span><span class=n>session</span><span class=p>[</span><span class=s1>&#39;hobby2&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;girl2&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>request</span><span class=o>.</span><span class=n>session</span><span class=o>.</span><span class=n>set_expiry</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;Session Set&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_session</span><span class=p>(</span><span class=n>r</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(request.session.get(&#39;hobby&#39;))</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>r</span><span class=o>.</span><span class=n>session</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;hobby&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>session</span><span class=p>)</span>  <span class=c1># å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ &lt;django.contrib.sessions.backends.db.SessionStore object at 0x...&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>session</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;hobby1&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>session</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;hobby2&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;Session Get&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;No Session&#39;</span><span class=p>)</span>  <span class=c1># æµè§ˆå™¨å…³é—­å é‡æ–°æ‰“å¼€åˆ™å¤±æ•ˆ</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>django_session Tableæ•°æ®</strong></li></ul><div class=table-wrapper><table><thead><tr><th>session_key</th><th>session_data</th><th>expire_date</th></tr></thead><tbody><tr><td>0mzz5pprookey7rjd4m3pl6onoa5jdtm</td><td>NjRhZjljYzM1NDNkNzhkNmVkOWVkM2QzZGY2MGE1OWNhYzQwODBmNTp7ImhvYmJ5IjoiZ2lybCJ9</td><td>2021-03-10 01:59:31</td></tr></tbody></table></div><ul><li><strong>å®¢æˆ·ç«¯cookie</strong></li></ul><div class=table-wrapper><table><thead><tr><th>Name</th><th>Value</th></tr></thead><tbody><tr><td>sessionid</td><td>0mzz5pprookey7rjd4m3pl6onoa5jdtm</td></tr></tbody></table></div><h4 id=è·å–session>è·å–session</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_session</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    è·å–sessionå†…éƒ¨å‘ç”Ÿäº†é‚£äº›äº‹ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>      1. è‡ªåŠ¨ä»æµè§ˆå™¨è¯·æ±‚ä¸­è·å–sessionidå¯¹åº”çš„éšæœºå­—ç¬¦ä¸²
</span></span></span><span class=line><span class=cl><span class=s2>      2. æ‹¿ç€è¯¥éšæœºå­—ç¬¦ä¸²å»django_sessionä¸­æŸ¥æ‰¾å¯¹åº”çš„æ•°æ®
</span></span></span><span class=line><span class=cl><span class=s2>      3. æ¯”å¯¹æ•°æ®
</span></span></span><span class=line><span class=cl><span class=s2>        3.1 å¦‚æœæ¯”å¯¹ä¸Š åˆ™å°†å¯¹åº”å¾—æ•°æ®å–å‡ºå¹¶ä»¥å­—å…¸å¾—å½¢å¼å°è£…åˆ°request.sessionä¸­
</span></span></span><span class=line><span class=cl><span class=s2>        3.2 å¦‚æœæ¯”å¯¹ä¸ä¸Š åˆ™request.session.get()è¿”å›çš„æ˜¯None - dict.get()æ–¹æ³•è·å–ä¸åˆ°key é»˜è®¤è¿”å›None
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>session</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;hobby&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;Session Get&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=æ¸…é™¤session>æ¸…é™¤session</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>del_session</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>request</span><span class=o>.</span><span class=n>session</span><span class=o>.</span><span class=n>delete</span><span class=p>()</span>    <span class=c1># åªåˆ é™¤æœåŠ¡ç«¯çš„æœ‰æ•ˆsession</span>
</span></span><span class=line><span class=cl>    <span class=n>request</span><span class=o>.</span><span class=n>session</span><span class=o>.</span><span class=n>flush</span><span class=p>()</span>     <span class=c1># æœåŠ¡ç«¯å’Œæµè§ˆå™¨éƒ½åˆ (æ¨èä½¿ç”¨)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;Session Delete&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=djangoä¸­sessioné…ç½®>djangoä¸­sessioné…ç½®</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=mf>1.</span> <span class=n>æ•°æ®åº“Session</span>
</span></span><span class=line><span class=cl><span class=n>SESSION_ENGINE</span> <span class=o>=</span> <span class=s1>&#39;django.contrib.sessions.backends.db&#39;</span>   <span class=c1># å¼•æ“ï¼ˆé»˜è®¤ï¼‰</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>2.</span> <span class=n>ç¼“å­˜Session</span>
</span></span><span class=line><span class=cl><span class=n>SESSION_ENGINE</span> <span class=o>=</span> <span class=s1>&#39;django.contrib.sessions.backends.cache&#39;</span>  <span class=c1># å¼•æ“</span>
</span></span><span class=line><span class=cl><span class=n>SESSION_CACHE_ALIAS</span> <span class=o>=</span> <span class=s1>&#39;default&#39;</span>                            <span class=c1># ä½¿ç”¨çš„ç¼“å­˜åˆ«åï¼ˆé»˜è®¤å†…å­˜ç¼“å­˜ï¼Œä¹Ÿå¯ä»¥æ˜¯memcacheï¼‰ï¼Œæ­¤å¤„åˆ«åä¾èµ–ç¼“å­˜çš„è®¾ç½®</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>3.</span> <span class=n>æ–‡ä»¶Session</span>
</span></span><span class=line><span class=cl><span class=n>SESSION_ENGINE</span> <span class=o>=</span> <span class=s1>&#39;django.contrib.sessions.backends.file&#39;</span>    <span class=c1># å¼•æ“</span>
</span></span><span class=line><span class=cl><span class=n>SESSION_FILE_PATH</span> <span class=o>=</span> <span class=kc>None</span>                                    <span class=c1># ç¼“å­˜æ–‡ä»¶è·¯å¾„ï¼Œå¦‚æœä¸ºNoneï¼Œåˆ™ä½¿ç”¨tempfileæ¨¡å—è·å–ä¸€ä¸ªä¸´æ—¶åœ°å€tempfile.gettempdir() </span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>4.</span> <span class=n>ç¼“å­˜</span><span class=o>+</span><span class=n>æ•°æ®åº“</span>
</span></span><span class=line><span class=cl><span class=n>SESSION_ENGINE</span> <span class=o>=</span> <span class=s1>&#39;django.contrib.sessions.backends.cached_db&#39;</span>        <span class=c1># å¼•æ“</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>5.</span> <span class=n>åŠ å¯†Cookie</span> <span class=n>Session</span>
</span></span><span class=line><span class=cl><span class=n>SESSION_ENGINE</span> <span class=o>=</span> <span class=s1>&#39;django.contrib.sessions.backends.signed_cookies&#39;</span>   <span class=c1># å¼•æ“</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>å…¶ä»–å…¬ç”¨è®¾ç½®é¡¹</span><span class=err>ï¼š</span>
</span></span><span class=line><span class=cl><span class=n>SESSION_COOKIE_NAME</span> <span class=err>ï¼</span> <span class=s2>&#34;sessionid&#34;</span>                       <span class=c1># Sessionçš„cookieä¿å­˜åœ¨æµè§ˆå™¨ä¸Šæ—¶çš„keyï¼Œå³ï¼šsessionidï¼éšæœºå­—ç¬¦ä¸²ï¼ˆé»˜è®¤ï¼‰</span>
</span></span><span class=line><span class=cl><span class=n>SESSION_COOKIE_PATH</span> <span class=err>ï¼</span> <span class=s2>&#34;/&#34;</span>                               <span class=c1># Sessionçš„cookieä¿å­˜çš„è·¯å¾„ï¼ˆé»˜è®¤ï¼‰</span>
</span></span><span class=line><span class=cl><span class=n>SESSION_COOKIE_DOMAIN</span> <span class=o>=</span> <span class=kc>None</span>                             <span class=c1># Sessionçš„cookieä¿å­˜çš„åŸŸåï¼ˆé»˜è®¤ï¼‰</span>
</span></span><span class=line><span class=cl><span class=n>SESSION_COOKIE_SECURE</span> <span class=o>=</span> <span class=kc>False</span>                            <span class=c1># æ˜¯å¦Httpsä¼ è¾“cookieï¼ˆé»˜è®¤ï¼‰</span>
</span></span><span class=line><span class=cl><span class=n>SESSION_COOKIE_HTTPONLY</span> <span class=o>=</span> <span class=kc>True</span>                           <span class=c1># æ˜¯å¦Sessionçš„cookieåªæ”¯æŒhttpä¼ è¾“ï¼ˆé»˜è®¤ï¼‰</span>
</span></span><span class=line><span class=cl><span class=n>SESSION_COOKIE_AGE</span> <span class=o>=</span> <span class=mi>1209600</span>                             <span class=c1># Sessionçš„cookieå¤±æ•ˆæ—¥æœŸï¼ˆ2å‘¨ï¼‰ï¼ˆé»˜è®¤ï¼‰</span>
</span></span><span class=line><span class=cl><span class=n>SESSION_EXPIRE_AT_BROWSER_CLOSE</span> <span class=o>=</span> <span class=kc>False</span>                  <span class=c1># æ˜¯å¦å…³é—­æµè§ˆå™¨ä½¿å¾—Sessionè¿‡æœŸï¼ˆé»˜è®¤ï¼‰</span>
</span></span><span class=line><span class=cl><span class=n>SESSION_SAVE_EVERY_REQUEST</span> <span class=o>=</span> <span class=kc>False</span>                       <span class=c1># æ˜¯å¦æ¯æ¬¡è¯·æ±‚éƒ½ä¿å­˜Sessionï¼Œé»˜è®¤ä¿®æ”¹ä¹‹åæ‰ä¿å­˜ï¼ˆé»˜è®¤ï¼‰</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=sessionç‰ˆç™»å½•éªŒè¯>sessionç‰ˆç™»å½•éªŒè¯</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>functools</span> <span class=kn>import</span> <span class=n>wraps</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>check_login</span><span class=p>(</span><span class=n>func</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nd>@wraps</span><span class=p>(</span><span class=n>func</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>inner</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>next_url</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>get_full_path</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>session</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;user&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>func</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=s2>&#34;/login/?next=</span><span class=si>{}</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>next_url</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>inner</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>login</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s2>&#34;POST&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>user</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;user&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>pwd</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;pwd&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>user</span> <span class=o>==</span> <span class=s2>&#34;alex&#34;</span> <span class=ow>and</span> <span class=n>pwd</span> <span class=o>==</span> <span class=s2>&#34;alex1234&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># è®¾ç½®session</span>
</span></span><span class=line><span class=cl>            <span class=n>request</span><span class=o>.</span><span class=n>session</span><span class=p>[</span><span class=s2>&#34;user&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>user</span>
</span></span><span class=line><span class=cl>            <span class=c1># è·å–è·³åˆ°ç™»é™†é¡µé¢ä¹‹å‰çš„URL</span>
</span></span><span class=line><span class=cl>            <span class=n>next_url</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>GET</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;next&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=c1># å¦‚æœæœ‰ï¼Œå°±è·³è½¬å›ç™»é™†ä¹‹å‰çš„URL</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>next_url</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=n>next_url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=c1># å¦åˆ™é»˜è®¤è·³è½¬åˆ°indexé¡µé¢</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=s2>&#34;/index/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=s2>&#34;login.html&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@check_login</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>logout</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># åˆ é™¤æ‰€æœ‰å½“å‰è¯·æ±‚ç›¸å…³çš„session</span>
</span></span><span class=line><span class=cl>    <span class=n>request</span><span class=o>.</span><span class=n>session</span><span class=o>.</span><span class=n>delete</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=s2>&#34;/login/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@check_login</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>index</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>current_user</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>session</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;user&#34;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=s2>&#34;index.html&#34;</span><span class=p>,</span> <span class=p>{</span><span class=s2>&#34;user&#34;</span><span class=p>:</span> <span class=n>current_user</span><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>æ€»ç»“ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>  djangoé»˜è®¤ç»™æˆ‘ä»¬æä¾›äº†ä¸€å¼  django_sessionè¡¨
</span></span></span><span class=line><span class=cl><span class=s2>  å­¦äº†sessionä¹‹å æˆ‘ä»¬å‘ç° æˆ‘ä»¬é€šè¿‡ request.session.get(key) å¯ä»¥æ‹¿åˆ°æˆ‘ä»¬å­˜å‚¨çš„æ•°æ® è€Œä¸”å¯ä»¥åœ¨ä»»æ„è§†å›¾ç›´æ¥ä½¿ç”¨
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>é«˜é˜¶ç”¨æ³•ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>  æœ‰æ—¶å€™ å¦‚æœå¤šä¸ªè§†å›¾å‡½æ•°éƒ½éœ€è¦ä½¿ç”¨åˆ°ä¸€äº›æ•°æ®çš„è¯ ä½ ä¹Ÿå¯ä»¥è€ƒè™‘å°†è¯¥æ•°æ®å­˜å‚¨åˆ°django_sessionè¡¨ä¸­ æ–¹ä¾¿åç»­çš„ä½¿ç”¨
</span></span></span><span class=line><span class=cl><span class=s2>  e.g: ç™»å½•éªŒè¯ç æ ¡éªŒ
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=djangoä¸­é—´ä»¶>Djangoä¸­é—´ä»¶</h2><h3 id=ä¸­é—´ä»¶>ä¸­é—´ä»¶</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>djangoè‡ªå¸¦ä¸ƒä¸ªä¸­é—´ä»¶</span> <span class=n>æ¯ä¸ªä¸­é—´ä»¶éƒ½æœ‰å„è‡ªå¯¹åº”çš„åŠŸèƒ½</span> <span class=n>å¹¶ä¸”djangoè¿˜æ”¯æŒç¨‹åºå‘˜è‡ªå®šä¹‰ä¸­é—´ä»¶</span>
</span></span><span class=line><span class=cl><span class=n>ä½ åœ¨ç”¨djangoå¼€å‘é¡¹ç›®çš„æ—¶å€™</span> <span class=n>åªè¦æ˜¯æ¶‰åŠåˆ°</span> <span class=n>å…¨å±€</span> <span class=n>ç›¸å…³çš„åŠŸèƒ½</span> <span class=n>éƒ½å¯ä»¥ä½¿ç”¨ä¸­é—´ä»¶æ–¹ä¾¿çš„å®Œæˆ</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>e</span><span class=o>.</span><span class=n>g</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=o>-</span> <span class=n>å…¨å±€ç”¨æˆ·èº«ä»½æ ¡éªŒ</span>
</span></span><span class=line><span class=cl>    <span class=o>-</span> <span class=n>å…¨å±€ç”¨æˆ·æƒé™æ ¡éªŒ</span>
</span></span><span class=line><span class=cl>    <span class=o>-</span> <span class=n>å…¨å±€è®¿é—®é¢‘ç‡æ ¡éªŒ</span><span class=p>(</span><span class=n>åçˆ¬è™«æªæ–½ä¹‹ä¸€</span> <span class=o>--</span> <span class=n>ç ´è§£</span><span class=err>ï¼š</span><span class=n>IPä»£ç†æ± </span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=o>-</span> <span class=o>...</span><span class=p>(</span><span class=n>å…¶ä»–æ¶‰åŠå…¨å±€çš„åŠŸèƒ½</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>djangoä¸­é—´ä»¶æ˜¯djangoçš„é—¨æˆ·(è¯·æ±‚æ¥å’Œèµ° ä¸¤ä¸ªæ–¹å‘éƒ½è¦ç»è¿‡)
</span></span></span><span class=line><span class=cl><span class=s2>  1. è¯·æ±‚æ¥çš„æ—¶å€™ éœ€è¦å…ˆç»è¿‡ä¸­é—´ä»¶æ‰èƒ½åˆ°è¾¾çœŸæ­£çš„djangoåç«¯
</span></span></span><span class=line><span class=cl><span class=s2>  2. å“åº”èµ°çš„æ—¶å€™ ä¹Ÿéœ€è¦ç»è¿‡ä¸­é—´ä»¶æ‰èƒ½å‘é€å‡ºå»
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=n>ä»”ç»†ç†è§£djangoè¯·æ±‚ç”Ÿå‘½å‘¨æœŸæµç¨‹å›¾</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=n>ç ”ç©¶djangoä¸­é—´ä»¶ä»£ç è§„å¾‹</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=è‡ªå¸¦ä¸ƒä¸ªä¸­é—´ä»¶>è‡ªå¸¦ä¸ƒä¸ªä¸­é—´ä»¶</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># åˆ—è¡¨é‡Œé¢å…¶å®ä¸æ˜¯å­—ç¬¦ä¸² æ˜¯åœ¨å¯¼å…¥æ¨¡å—(å­—ç¬¦ä¸²æ–¹å¼å¯¼å…¥æ¨¡å—) æ¨¡å—è·¯å¾„çš„å­—ç¬¦ä¸²å½¢å¼</span>
</span></span><span class=line><span class=cl><span class=n>MIDDLEWARE</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.middleware.security.SecurityMiddleware&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.contrib.sessions.middleware.SessionMiddleware&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.middleware.common.CommonMiddleware&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.middleware.csrf.CsrfViewMiddleware&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.contrib.auth.middleware.AuthenticationMiddleware&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.contrib.messages.middleware.MessageMiddleware&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.middleware.clickjacking.XFrameOptionsMiddleware&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># çœ‹æºç å‡ ä¸ªä¸­é—´ä»¶çš„ä»£ç ç»„ç»‡ç»“æ„</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>djangoæ”¯æŒç¨‹åºå‘˜è‡ªå®šä¹‰ä¸­é—´ä»¶ å¹¶ä¸”æš´éœ²ç»™ç¨‹åºå‘˜äº”ä¸ªå¯ä»¥è‡ªå®šä¹‰çš„æ–¹æ³•
</span></span></span><span class=line><span class=cl><span class=s2>  1. ç¬¬ä¸€ç±» å¿…é¡»æŒæ¡
</span></span></span><span class=line><span class=cl><span class=s2>    - process_request
</span></span></span><span class=line><span class=cl><span class=s2>    - process_response
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>  2. äº†è§£å³å¯
</span></span></span><span class=line><span class=cl><span class=s2>    - process_view 
</span></span></span><span class=line><span class=cl><span class=s2>    - process_template_response
</span></span></span><span class=line><span class=cl><span class=s2>    - process_exception
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>SessionMiddleware</span><span class=p>(</span><span class=n>MiddlewareMixin</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process_request</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>csrf_token</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_token</span><span class=p>(</span><span class=n>request</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>csrf_token</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># Use same token next time.</span>
</span></span><span class=line><span class=cl>            <span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=p>[</span><span class=s1>&#39;CSRF_COOKIE&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>csrf_token</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process_response</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>response</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>response</span>
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>CsrfViewMiddleware</span><span class=p>(</span><span class=n>MiddlewareMixin</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process_request</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>csrf_token</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_token</span><span class=p>(</span><span class=n>request</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>csrf_token</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># Use same token next time.</span>
</span></span><span class=line><span class=cl>            <span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=p>[</span><span class=s1>&#39;CSRF_COOKIE&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>csrf_token</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process_view</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>callback</span><span class=p>,</span> <span class=n>callback_args</span><span class=p>,</span> <span class=n>callback_kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_accept</span><span class=p>(</span><span class=n>request</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process_response</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>response</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>response</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>AuthenticationMiddleware</span><span class=p>(</span><span class=n>MiddlewareMixin</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process_request</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>request</span><span class=o>.</span><span class=n>user</span> <span class=o>=</span> <span class=n>SimpleLazyObject</span><span class=p>(</span><span class=k>lambda</span><span class=p>:</span> <span class=n>get_user</span><span class=p>(</span><span class=n>request</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=è‡ªå®šä¹‰ä¸­é—´ä»¶>è‡ªå®šä¹‰ä¸­é—´ä»¶</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>å›ºå®šæ­¥éª¤ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>  1. åœ¨é¡¹ç›®åæˆ–è€…åº”ç”¨åä¸‹åˆ›å»ºä»¥ä¸€ä¸ªä»»æ„åç§°çš„æ–‡ä»¶å¤¹
</span></span></span><span class=line><span class=cl><span class=s2>  2. åœ¨è¯¥æ–‡ä»¶å¤¹å†…åˆ›å»ºä¸€ä¸ªä»»æ„åç§°çš„pyæ–‡ä»¶
</span></span></span><span class=line><span class=cl><span class=s2>  3. åœ¨è¯¥pyæ–‡ä»¶å†…éœ€è¦ä¹¦å†™ç±»(è¿™ä¸ªç±»å¿…é¡»ç»§æ‰¿MiddlewareMixin)
</span></span></span><span class=line><span class=cl><span class=s2>     3.1 åœ¨è¿™ä¸ªç±»é‡Œé¢ å°±å¯ä»¥è‡ªå®šä¹‰è¿™5ä¸ªæ–¹æ³•
</span></span></span><span class=line><span class=cl><span class=s2>     3.2 è¿™5ä¸ªæ–¹æ³•å¹¶ä¸æ˜¯å…¨éƒ¨éƒ½éœ€è¦ä¹¦å†™ ç”¨åˆ°å‡ ä¸ªå†™å‡ ä¸ª
</span></span></span><span class=line><span class=cl><span class=s2>  4. éœ€è¦å°†ç±»çš„è·¯å¾„ä»¥å­—ç¬¦ä¸²çš„å½¢å¼æ³¨å†Œåˆ°é…ç½®æ–‡ä»¶æ‰èƒ½ç”Ÿæ•ˆ
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2># æ³¨å†Œä¸­é—´ä»¶
</span></span></span><span class=line><span class=cl><span class=s2>MIDDLEWARE = [
</span></span></span><span class=line><span class=cl><span class=s2>    &#39;django.middleware.security.SecurityMiddleware&#39;,
</span></span></span><span class=line><span class=cl><span class=s2>    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
</span></span></span><span class=line><span class=cl><span class=s2>    &#39;django.middleware.common.CommonMiddleware&#39;,
</span></span></span><span class=line><span class=cl><span class=s2>    &#39;django.middleware.csrf.CsrfViewMiddleware&#39;,
</span></span></span><span class=line><span class=cl><span class=s2>    &#39;django.contrib.auth.middleware.AuthenticationMiddleware&#39;,
</span></span></span><span class=line><span class=cl><span class=s2>    &#39;django.contrib.messages.middleware.MessageMiddleware&#39;,
</span></span></span><span class=line><span class=cl><span class=s2>    &#39;django.middleware.clickjacking.XFrameOptionsMiddleware&#39;,
</span></span></span><span class=line><span class=cl><span class=s2>    &#39;ä½ è‡ªå·±å†™çš„ä¸­é—´ä»¶è·¯å¾„1&#39;,
</span></span></span><span class=line><span class=cl><span class=s2>    &#39;ä½ è‡ªå·±å†™çš„ä¸­é—´ä»¶è·¯å¾„2&#39;,
</span></span></span><span class=line><span class=cl><span class=s2>    &#39;ä½ è‡ªå·±å†™çš„ä¸­é—´ä»¶è·¯å¾„3&#39;,
</span></span></span><span class=line><span class=cl><span class=s2>]
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=ä¸­é—´ä»¶æ–¹æ³•è¯¦è§£>ä¸­é—´ä»¶æ–¹æ³•è¯¦è§£</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>djangoæ”¯æŒç¨‹åºå‘˜è‡ªå®šä¹‰ä¸­é—´ä»¶ å¹¶ä¸”æš´éœ²ç»™ç¨‹åºå‘˜äº”ä¸ªå¯ä»¥è‡ªå®šä¹‰çš„æ–¹æ³•
</span></span></span><span class=line><span class=cl><span class=s2>  1. ç¬¬ä¸€ç±» å¿…é¡»æŒæ¡
</span></span></span><span class=line><span class=cl><span class=s2>     process_request(self, request)
</span></span></span><span class=line><span class=cl><span class=s2>     process_response(self, request, response)
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>  2. äº†è§£å³å¯
</span></span></span><span class=line><span class=cl><span class=s2>     process_view(self, view_name, *args, **kwargs)
</span></span></span><span class=line><span class=cl><span class=s2>     process_template_response(self, request, response)
</span></span></span><span class=line><span class=cl><span class=s2>     process_exception(self, request, exception)
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=process_request>process_request</h5><p><strong>ä½¿ç”¨é¢‘ç‡æœ€é«˜ æœ€å¥½ç”¨çš„ é‡ç‚¹</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=mf>1.</span> <span class=n>è¯·æ±‚æ¥çš„æ—¶å€™</span> <span class=n>éœ€è¦ç»è¿‡æ¯ä¸€ä¸ªä¸­é—´ä»¶é‡Œé¢çš„process_requestæ–¹æ³•</span> 
</span></span><span class=line><span class=cl>   <span class=n>ç»“æœçš„é¡ºåºæ˜¯æŒ‰ç…§é…ç½®æ–‡ä»¶ä¸­æ³¨å†Œçš„ä¸­é—´ä»¶é¡ºåº</span> <span class=n>ä»ä¸Šå¾€ä¸‹</span> <span class=n>ä¾æ¬¡æ‰§è¡Œ</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=mf>2.</span> <span class=n>å¦‚æœä¸­é—´ä»¶é‡Œé¢æ²¡æœ‰å®šä¹‰è¯¥æ–¹æ³•</span> <span class=n>é‚£ä¹ˆç›´æ¥è·³è¿‡æ‰§è¡Œä¸‹ä¸€ä¸ªä¸­é—´ä»¶</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>3.</span> <span class=n>å¦‚æœè¯¥æ–¹æ³•è¿”å›äº†HttpResponseå¯¹è±¡</span> <span class=n>é‚£ä¹ˆè¯·æ±‚å°†ä¸å†ç»§ç»­å¾€åæ‰§è¡Œ</span> <span class=n>è€Œæ˜¯ç›´æ¥åŸè·¯è¿”å›</span><span class=p>(</span><span class=n>e</span><span class=o>.</span><span class=n>g</span><span class=p>:</span><span class=n>æ ¡éªŒå¤±è´¥ä¸å…è®¸è®¿é—®</span> <span class=n>åçˆ¬</span><span class=o>...</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>æ€»ç»“</span><span class=err>ï¼š</span><span class=n>process_requestæ–¹æ³•</span> <span class=n>å°±æ˜¯ç”¨æ¥åšå…¨å±€ç›¸å…³çš„æ‰€æœ‰é™åˆ¶åŠŸèƒ½</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>ç ”ç©¶ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>  å¦‚æœåœ¨ç¬¬ä¸€ä¸ªprocess_requestæ–¹æ³• å°±å·²ç»è¿”å›äº†HttpResponseå¯¹è±¡ é‚£ä¹ˆå“åº”èµ°çš„æ—¶å€™ æ˜¯ç»è¿‡æ‰€æœ‰çš„ä¸­é—´ä»¶é‡Œé¢çš„process_responseè¿˜æ˜¯æœ‰å…¶ä»–æƒ…å†µ?
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>  ç»“æœï¼šå…¶ä»–æƒ…å†µ ä¼šç›´æ¥èµ°åŒçº§åˆ«(åŒä¸€ä¸ªä¸­é—´ä»¶)çš„process_response ç„¶åä¾æ¬¡è¿”å›
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>  Flaskæ¡†æ¶ä¹Ÿæœ‰ç±»ä¼¼çš„ä¸­é—´ä»¶ ä½†æ˜¯å®ƒçš„è§„å¾‹ä¸djangoä¸ä¸€æ ·ï¼šFlaskä¸­é—´ä»¶åªè¦è¿”å›æ•°æ®äº†å°±å¿…é¡»ç»è¿‡æ‰€æœ‰ä¸­é—´ä»¶é‡Œé¢çš„ç±»ä¼¼äºprocess_responseæ–¹æ³•
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=process_response>process_response</h5><p><strong>é‡ç‚¹</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=mf>1.</span> <span class=n>å“åº”èµ°çš„æ—¶å€™</span> <span class=n>éœ€è¦ç»è¿‡æ¯ä¸€ä¸ªä¸­é—´ä»¶çš„process_responseæ–¹æ³•</span>
</span></span><span class=line><span class=cl>   <span class=n>è¯¥æ–¹æ³•æœ‰ä¸¤ä¸ªé¢å¤–çš„å‚æ•°</span> <span class=n>process_response</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=n>response</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=n>response</span><span class=p>:</span> <span class=n>é»˜è®¤å°±æ˜¯åç«¯è§†å›¾å‡½æ•°è¿”å›ç»™æµè§ˆå™¨çš„å†…å®¹</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=mf>2.</span> <span class=n>è¯¥æ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ªHttpResponseå¯¹è±¡</span>
</span></span><span class=line><span class=cl>   <span class=mf>2.1</span> <span class=n>é»˜è®¤è¿”å›çš„å°±æ˜¯å½¢å‚response</span>
</span></span><span class=line><span class=cl>   <span class=mf>2.2</span> <span class=n>ä½ ä¹Ÿå¯ä»¥è¿”å›è‡ªå·±çš„å†…å®¹</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>3.</span> <span class=n>é¡ºåºæ˜¯æŒ‰ç…§é…ç½®æ–‡ä»¶ä¸­æ³¨å†Œäº†çš„ä¸­é—´ä»¶</span> <span class=n>ä»ä¸‹å¾€ä¸Š</span> <span class=n>ä¾æ¬¡ç»è¿‡</span>
</span></span><span class=line><span class=cl>   <span class=n>å¦‚æœä½ æ²¡æœ‰å®šä¹‰çš„è¯</span> <span class=n>ç›´æ¥è·³è¿‡æ‰§è¡Œä¸‹ä¸€ä¸ª</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=process_view>process_view</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>process_view</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>view_name</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>view_name</span><span class=p>,</span> <span class=n>args</span><span class=p>,</span> <span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;è‡ªå®šä¹‰ä¸­é—´ä»¶é‡Œé¢çš„process_view&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl><span class=n>è·¯ç”±åŒ¹é…æˆåŠŸä¹‹å</span> <span class=n>æ‰§è¡Œè§†å›¾å‡½æ•°ä¹‹å‰</span> <span class=n>ä¼šè‡ªåŠ¨æ‰§è¡Œä¸­é—´ä»¶é‡Œé¢çš„process_viewæ–¹æ³•</span>
</span></span><span class=line><span class=cl><span class=n>é¡ºåºæ˜¯æŒ‰ç…§é…ç½®æ–‡ä»¶ä¸­æ³¨å†Œçš„ä¸­é—´ä»¶é¡ºåº</span> <span class=n>ä»ä¸Šå¾€ä¸‹</span> <span class=n>ä¾æ¬¡æ‰§è¡Œ</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=process_template_response>process_template_response</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>index</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;æˆ‘æ˜¯è§†å›¾å‡½æ•°index&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>obj</span> <span class=o>=</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;index&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>render</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;å†…éƒ¨çš„render&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;ojbk&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>obj</span><span class=o>.</span><span class=n>render</span> <span class=o>=</span> <span class=n>render</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>obj</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>è¿”å›çš„HttpResponseå¯¹è±¡æœ‰renderå±æ€§çš„æ—¶å€™æ‰ä¼šè§¦å‘</span>
</span></span><span class=line><span class=cl><span class=n>é¡ºåºæ˜¯æŒ‰ç…§é…ç½®æ–‡ä»¶ä¸­æ³¨å†Œäº†çš„ä¸­é—´ä»¶</span> <span class=n>ä»ä¸‹å¾€ä¸Š</span> <span class=n>ä¾æ¬¡ç»è¿‡</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=process_exception>process_exception</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>å½“è§†å›¾å‡½æ•°ä¸­å‡ºç°å¼‚å¸¸çš„æƒ…å†µä¸‹è§¦å‘</span>
</span></span><span class=line><span class=cl><span class=n>é¡ºåºæ˜¯æŒ‰ç…§é…ç½®æ–‡ä»¶ä¸­æ³¨å†Œäº†çš„ä¸­é—´ä»¶</span> <span class=n>ä»ä¸‹å¾€ä¸Š</span> <span class=n>ä¾æ¬¡ç»è¿‡</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=ç¼–ç¨‹æ€æƒ³>ç¼–ç¨‹æ€æƒ³</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># åŸºäºdjangoä¸­é—´ä»¶çš„ä¸€ä¸ªé‡è¦çš„ç¼–ç¨‹æ€æƒ³</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=importlibç®€å•ä»‹ç»>importlibç®€å•ä»‹ç»</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># æœ‰ä»¥ä¸‹ç›®å½•ç»“æ„</span>
</span></span><span class=line><span class=cl><span class=n>Projects</span><span class=o>/</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>myfile</span><span class=o>/</span>
</span></span><span class=line><span class=cl>    <span class=o>-</span> <span class=n>b</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>a</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># b.py</span>
</span></span><span class=line><span class=cl><span class=n>name</span> <span class=o>=</span> <span class=s1>&#39;bbbbbb&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>é—®é¢˜ï¼šå¦‚ä½•åœ¨a.pyä¸­ä½¿ç”¨b.pyé‡Œé¢çš„å˜é‡?
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>æ¨¡å—å¯¼å…¥</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># æ–¹æ³•1</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>myfile</span> <span class=kn>import</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>b</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>importlibä½¿ç”¨</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># æ–¹æ³•2</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>importlib</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=s1>&#39;myfile.b&#39;</span>
</span></span><span class=line><span class=cl><span class=n>ret</span> <span class=o>=</span> <span class=n>importlib</span><span class=o>.</span><span class=n>import_module</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>  <span class=c1># å†…éƒ¨å¤„ç†ï¼šfrom myfile import b</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è¯¥æ–¹æ³•æœ€å°åªèƒ½åˆ°æ¨¡å—(pyæ–‡ä»¶å) ä¸èƒ½åˆ°pyæ–‡ä»¶ä¸‹é¢çš„å˜é‡(ç±» å‡½æ•° å˜é‡...)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=importlibè¿›é˜¶ä½¿ç”¨>importlibè¿›é˜¶ä½¿ç”¨</h4><ol><li><strong>é…ç½®æ–‡ä»¶æ³¨å†ŒåŠŸèƒ½</strong></li><li><strong>importlibæ¨¡å—</strong></li><li><strong>å­—ç¬¦ä¸²åˆ‡å‰²rsplit maxsplitå‚æ•°</strong></li><li><strong>åå°„ getattr()&mldr;</strong></li><li><strong>é¢å‘å¯¹è±¡é¸­å­ç±»å‹</strong></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># notify.py é‡Œé¢å°è£…çš„ä¸‰ä¸ªé€šçŸ¥å‡½æ•°</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>wechat</span><span class=p>(</span><span class=n>content</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;å¾®ä¿¡é€šçŸ¥ï¼š</span><span class=si>%s</span><span class=s1>&#39;</span> <span class=o>%</span> <span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>qq</span><span class=p>(</span><span class=n>content</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;qqé€šçŸ¥ï¼š</span><span class=si>%s</span><span class=s1>&#39;</span> <span class=o>%</span> <span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>email</span><span class=p>(</span><span class=n>content</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;é‚®ç®±é€šçŸ¥ï¼š</span><span class=si>%s</span><span class=s1>&#39;</span> <span class=o>%</span> <span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;  
</span></span></span><span class=line><span class=cl><span class=s2>æˆ‘åœ¨å…¶ä»–åœ°æ–¹è¦ä½¿ç”¨è¿™ä¸‰ä¸ªé€šçŸ¥å‡½æ•° å¯ä»¥å…¨éƒ¨å¯¼å…¥ ç„¶åè¿›è¡Œä½¿ç”¨
</span></span></span><span class=line><span class=cl><span class=s2>é—®é¢˜ï¼šå¦‚æœæˆ‘å¾ˆå¤šåœ°æ–¹éƒ½ä½¿ç”¨äº†è¿™ä¸‰ä¸ªé€šçŸ¥å‡½æ•° ç°åœ¨æˆ‘éœ€è¦æŠŠå…¶ä¸­ä¸€ç§æ–¹å¼å–æ¶ˆæ‰ æ€ä¹ˆåŠ?
</span></span></span><span class=line><span class=cl><span class=s2>     1. æ‰¾åˆ°æ‰€æœ‰ä½¿ç”¨çš„åœ°æ–¹ æ³¨é‡Šæ‰å¯¹åº”é€šçŸ¥å‡½æ•° - å¯ä»¥è§£å†³ ä½¿ç”¨åœ°æ–¹å¤šçš„è¯ æ¯”è¾ƒéº»çƒ¦
</span></span></span><span class=line><span class=cl><span class=s2>     2. importlibé«˜é˜¶ä½¿ç”¨
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>notify</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>send_all</span><span class=p>(</span><span class=n>content</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>wechat</span><span class=p>(</span><span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># qq(content)</span>
</span></span><span class=line><span class=cl>    <span class=n>email</span><span class=p>(</span><span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>send_all</span><span class=p>(</span><span class=s1>&#39;å•¥æ—¶å€™æ”¾é•¿å‡&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=o>===============================</span>
</span></span><span class=line><span class=cl><span class=c1># è§£å†³ä¸Šè¿°é—®é¢˜ æŠŠnotifyé€šçŸ¥çš„æ–¹æ³•å°è£…ä¸ºç±»åˆ°ä¸€ä¸ªåŒ…é‡Œé¢çš„ä¸‰ä¸ªæ¨¡å—</span>
</span></span><span class=line><span class=cl><span class=n>notify</span><span class=o>/</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=fm>__init__</span><span class=o>.</span><span class=n>py</span>  <span class=c1># åŒ…æ–‡ä»¶</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>email</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>qq</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>wechat</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># email.py</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Email</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>  <span class=c1># å‘é€é‚®ä»¶å‰éœ€è¦åšçš„å‰æœŸå‡†å¤‡å·¥ä½œ</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>send</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>content</span><span class=p>):</span>    <span class=c1># å…¶ä»–é€šçŸ¥å°è£…ç±»ä¼¼ éƒ½æä¾›ä¸€ä¸ªsendæ–¹æ³•</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;é‚®ç®±é€šçŸ¥ï¼š</span><span class=si>%s</span><span class=s1>&#39;</span> <span class=o>%</span> <span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl><span class=c1># ç„¶åæä¾›ä¸€ä¸ªé…ç½®æ–‡ä»¶settings.py - djangoå¯å‘</span>
</span></span><span class=line><span class=cl><span class=n>NOTIFY_LIST</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;notify.email.Email&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=c1># &#39;notify.qq.QQ&#39;,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;notify.wechat.Wechat&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># é‡ç‚¹ï¼šåœ¨notifyåŒ…çš„__init__.pyæ–‡ä»¶ä¸­åšä¸€ä¸‹æ“ä½œ</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>settings</span>    <span class=c1># å¯¼å…¥é…ç½®æ–‡ä»¶</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>importlib</span>   <span class=c1># å¯¼å…¥importlib</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>send_all</span><span class=p>(</span><span class=n>content</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>path_str</span> <span class=ow>in</span> <span class=n>settings</span><span class=o>.</span><span class=n>NOTIFY_LIST</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>module_path</span><span class=p>,</span> <span class=n>class_name</span> <span class=o>=</span> <span class=n>path_str</span><span class=o>.</span><span class=n>rsplit</span><span class=p>(</span><span class=s1>&#39;.&#39;</span><span class=p>,</span> <span class=n>maxsplit</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>  <span class=c1># ä»å³å¾€å·¦åˆ‡ åªåˆ‡ä¸€æ¬¡</span>
</span></span><span class=line><span class=cl>        <span class=c1># æ‹¿åˆ°æ¨¡å—åå’Œç±»å</span>
</span></span><span class=line><span class=cl>        <span class=c1># module_path = &#39;notify.email&#39; class_name = &#39;Email&#39;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 1. åˆ©ç”¨å­—ç¬¦ä¸²å¯¼å…¥æ¨¡å—</span>
</span></span><span class=line><span class=cl>        <span class=n>module</span> <span class=o>=</span> <span class=n>importlib</span><span class=o>.</span><span class=n>import_module</span><span class=p>(</span><span class=n>module_path</span><span class=p>)</span>  <span class=c1># from notify import email</span>
</span></span><span class=line><span class=cl>        <span class=c1># 2. åˆ©ç”¨åå°„è·å–ç±»å</span>
</span></span><span class=line><span class=cl>        <span class=bp>cls</span> <span class=o>=</span> <span class=nb>getattr</span><span class=p>(</span><span class=n>module</span><span class=p>,</span> <span class=n>class_name</span><span class=p>)</span>  <span class=c1># æ‹¿åˆ°ç±»å Email QQ Wechat</span>
</span></span><span class=line><span class=cl>        <span class=c1># 3. ç”Ÿæˆç±»çš„å¯¹è±¡(å®ä¾‹åŒ–)</span>
</span></span><span class=line><span class=cl>        <span class=n>obj</span> <span class=o>=</span> <span class=bp>cls</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=c1># 4. åˆ©ç”¨é¸­å­ç±»å‹ç›´æ¥æ‹¿è°ƒç”¨sendæ–¹æ³•</span>
</span></span><span class=line><span class=cl>        <span class=n>obj</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl><span class=c1># æœ€åä½¿ç”¨ start.py</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>è¿™ä¸ªæ—¶å€™ å¯æ‰©å±•æ€§éå¸¸é«˜
</span></span></span><span class=line><span class=cl><span class=s2>å¦‚æœæˆ‘ä»¬ä¸æƒ³ç”¨å“ªä¸ªæ–¹æ³• ç›´æ¥å»é…ç½®æ–‡ä»¶æ³¨é‡Šæ‰å¯¹åº”çš„é…ç½®å³å¯
</span></span></span><span class=line><span class=cl><span class=s2>éœ€è¦åŠ é€šçŸ¥æ–¹æ³• ä¹Ÿå¾ˆæ–¹ä¾¿
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>notify</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>notify</span><span class=o>.</span><span class=n>send_all</span><span class=p>(</span><span class=s1>&#39;é€šçŸ¥&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=csrfè·¨ç«™è¯·æ±‚ä¼ªé€ >csrfè·¨ç«™è¯·æ±‚ä¼ªé€ </h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>é’“é±¼ç½‘ç«™(e.g: å¤§å­¦è‹±è¯­4 6çº§ ç™»å½•ç¼´è´¹é’“é±¼ç½‘ç«™)
</span></span></span><span class=line><span class=cl><span class=s2>  æˆ‘æ­å»ºä¸€ä¸ªè·Ÿæ­£è§„ç½‘ç«™ä¸€æ‘¸ä¸€æ ·çš„ç•Œé¢(ä¸­å›½é“¶è¡Œ)
</span></span></span><span class=line><span class=cl><span class=s2>  ç”¨æˆ·ä¸å°å¿ƒè¿›å…¥åˆ°äº†æˆ‘ä»¬çš„ç½‘ç«™ ç”¨æˆ·ç»™æŸä¸ªäººè½¬é’±
</span></span></span><span class=line><span class=cl><span class=s2>  æ‰“é’±çš„æ“ä½œç¡®ç¡®å®å®æäº¤ç»™äº†ä¸­å›½é“¶è¡Œçš„ç³»ç»Ÿ ç”¨æˆ·çš„é’±ä¹Ÿç¡®å®å‡å°‘äº† å”¯ä¸€çš„ä¸åŒå°±æ˜¯ç›®æ ‡è´¦æˆ·ä¸æ˜¯ç”¨æˆ·æƒ³è¦è½¬é’±çš„è´¦æˆ· å˜æˆäº†ä¸€ä¸ªè«åå…¶å¦™çš„è´¦æˆ·
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>å†…éƒ¨æœ¬è´¨ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>  æˆ‘ä»¬åœ¨é’“é±¼ç½‘ç«™çš„é¡µé¢ é’ˆå¯¹ç›®æ ‡è´¦å· åªç»™ç”¨æˆ·æä¾›ä¸€ä¸ªæ²¡æœ‰nameå±æ€§çš„æ™®é€šinputæ¡†
</span></span></span><span class=line><span class=cl><span class=s2>  ç„¶åæˆ‘ä»¬åœ¨å†…éƒ¨éšè—ä¸€ä¸ªå·²ç»å†™å¥½nameå’Œvalueçš„inputæ¡† æäº¤çš„æ—¶å€™ action urlå†™æ­£å¸¸ç½‘ç«™çš„url
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>=========
</span></span></span><span class=line><span class=cl><span class=s2>å¦‚ä½•è§„é¿ä¸Šè¿°é—®é¢˜ -- csrfè·¨ç«™è¯·æ±‚ä¼ªé€ 
</span></span></span><span class=line><span class=cl><span class=s2>  ç½‘ç«™åœ¨ç»™ç”¨æˆ·è¿”å›ä¸€ä¸ªå…·æœ‰æäº¤æ•°æ®åŠŸèƒ½é¡µé¢çš„æ—¶å€™ ä¼šç»™è¿™ä¸ªé¡µé¢åŠ ä¸€ä¸ªå”¯ä¸€æ ‡è¯†(ä¸åŒçš„é¡µé¢ä¸ä¸€æ · æ°¸è¿œä¸é‡å¤)
</span></span></span><span class=line><span class=cl><span class=s2>  å½“è¿™ä¸ªé¡µé¢æœåç«¯å‘é€postè¯·æ±‚çš„æ—¶å€™ æˆ‘çš„åç«¯ä¼šå…ˆæ ¡éªŒè¿™ä¸ªå”¯ä¸€æ ‡è¯† å¦‚æœè¿™ä¸ªå”¯ä¸€æ ‡è¯†ä¸å¯¹ ç›´æ¥æ‹’ç»(403 forbidden) å¦‚æœæˆåŠŸåˆ™æ­£å¸¸æ‰§è¡Œ(csrfä¸­é—´ä»¶å¸®æˆ‘ä»¬æå®š)
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=formè¡¨å•å¦‚ä½•æ ¡éªŒ>Formè¡¨å•å¦‚ä½•æ ¡éªŒ</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>form</span> <span class=na>action</span><span class=o>=</span><span class=s>&#34;&#34;</span> <span class=na>method</span><span class=o>=</span><span class=s>&#34;post&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  {% csrf_token %}
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;hidden&#34;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;csrfmiddlewaretoken&#34;</span> <span class=na>value</span><span class=o>=</span><span class=s>&#34;å”¯ä¸€çš„éšæœºå­—ç¬¦ä¸²&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  ...
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>form</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>&lt;!-- hiddenå±æ€§ éšè— --&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;hidden&#34;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;csrfmiddlewaretoken&#34;</span> <span class=na>value</span><span class=o>=</span><span class=s>&#34;JCVNo1kxO4Z1WSUSmFkLBTFsO6XIYAl3Gr9VUfSQoWo6gBJn4jJxhn8V6YCWJxdQ&#34;</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=ajaxå¦‚ä½•æ ¡éªŒ>Ajaxå¦‚ä½•æ ¡éªŒ</h4><ul><li><strong>æ–¹å¼ä¸€</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>$</span><span class=p>.</span><span class=nx>ajax</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>url</span><span class=o>:</span> <span class=s2>&#34;/cookie_ajax/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;POST&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>data</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;username&#34;</span><span class=o>:</span> <span class=s2>&#34;Tonny&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;password&#34;</span><span class=o>:</span> <span class=mi>123456</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;csrfmiddlewaretoken&#34;</span><span class=o>:</span> <span class=nx>$</span><span class=p>(</span><span class=s2>&#34;[name = &#39;csrfmiddlewaretoken&#39;]&#34;</span><span class=p>).</span><span class=nx>val</span><span class=p>()</span>  <span class=c1>// ä½¿ç”¨JQueryå–å‡ºcsrfmiddlewaretokençš„å€¼ æ‹¼æ¥åˆ°dataä¸­
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// &#34;csrfmiddlewaretoken&#34;: &#39;{{ csrf_token }}&#39;  // æˆ–è€…åˆ©ç”¨æ¨¡æ¿è¯­æ³•æä¾›çš„å¿«æ·ä¹¦å†™
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nx>success</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>data</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>æ–¹å¼äºŒ</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>$</span><span class=p>.</span><span class=nx>ajax</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>url</span><span class=o>:</span> <span class=s2>&#34;/cookie_ajax/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;POST&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>headers</span><span class=o>:</span> <span class=p>{</span><span class=s2>&#34;X-CSRFToken&#34;</span><span class=o>:</span> <span class=nx>$</span><span class=p>.</span><span class=nx>cookie</span><span class=p>(</span><span class=s1>&#39;csrftoken&#39;</span><span class=p>)},</span>  <span class=c1>// ä»Cookieå–csrf_token å¹¶è®¾ç½®ajaxè¯·æ±‚å¤´
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>data</span><span class=o>:</span> <span class=p>{</span><span class=s2>&#34;username&#34;</span><span class=o>:</span> <span class=s2>&#34;Q1mi&#34;</span><span class=p>,</span> <span class=s2>&#34;password&#34;</span><span class=o>:</span> <span class=mi>123456</span><span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nx>success</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>data</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>æ–¹å¼ä¸‰(é€šç”¨)</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// å°†è¿™æ®µä»£ç é…ç½®åˆ°ä½ çš„Djangoé¡¹ç›®çš„é™æ€æ–‡ä»¶ä¸­ ç›´æ¥å¯¼å…¥è¯¥æ–‡ä»¶å³å¯è‡ªåŠ¨å¸®æˆ‘ä»¬è§£å†³ajaxæäº¤postæ•°æ®æ—¶æ ¡éªŒcsrf_tokençš„é—®é¢˜(ä¾èµ–jQuery)
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>getCookie</span><span class=p>(</span><span class=nx>name</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>cookieValue</span> <span class=o>=</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nb>document</span><span class=p>.</span><span class=nx>cookie</span> <span class=o>&amp;&amp;</span> <span class=nb>document</span><span class=p>.</span><span class=nx>cookie</span> <span class=o>!==</span> <span class=s1>&#39;&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>cookies</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>cookie</span><span class=p>.</span><span class=nx>split</span><span class=p>(</span><span class=s1>&#39;;&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=nx>cookies</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kd>var</span> <span class=nx>cookie</span> <span class=o>=</span> <span class=nx>jQuery</span><span class=p>.</span><span class=nx>trim</span><span class=p>(</span><span class=nx>cookies</span><span class=p>[</span><span class=nx>i</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>            <span class=c1>// Does this cookie string begin with the name we want?
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=k>if</span> <span class=p>(</span><span class=nx>cookie</span><span class=p>.</span><span class=nx>substring</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nx>name</span><span class=p>.</span><span class=nx>length</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>===</span> <span class=p>(</span><span class=nx>name</span> <span class=o>+</span> <span class=s1>&#39;=&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>cookieValue</span> <span class=o>=</span> <span class=nb>decodeURIComponent</span><span class=p>(</span><span class=nx>cookie</span><span class=p>.</span><span class=nx>substring</span><span class=p>(</span><span class=nx>name</span><span class=p>.</span><span class=nx>length</span> <span class=o>+</span> <span class=mi>1</span><span class=p>));</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>cookieValue</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>csrftoken</span> <span class=o>=</span> <span class=nx>getCookie</span><span class=p>(</span><span class=s1>&#39;csrftoken&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>csrfSafeMethod</span><span class=p>(</span><span class=nx>method</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// these HTTP methods do not require CSRF protection
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>return</span> <span class=p>(</span><span class=sr>/^(GET|HEAD|OPTIONS|TRACE)$/</span><span class=p>.</span><span class=nx>test</span><span class=p>(</span><span class=nx>method</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>$</span><span class=p>.</span><span class=nx>ajaxSetup</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>beforeSend</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>xhr</span><span class=p>,</span> <span class=nx>settings</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>csrfSafeMethod</span><span class=p>(</span><span class=nx>settings</span><span class=p>.</span><span class=nx>type</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=k>this</span><span class=p>.</span><span class=nx>crossDomain</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>xhr</span><span class=p>.</span><span class=nx>setRequestHeader</span><span class=p>(</span><span class=s2>&#34;X-CSRFToken&#34;</span><span class=p>,</span> <span class=nx>csrftoken</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><p><a class=link href=https://docs.djangoproject.com/zh-hans/3.1/ref/csrf/ target=_blank rel=noopener>djangoè·¨ç«™è¯·æ±‚ä¼ªé€ ä¿æŠ¤å®˜æ–¹æ–‡æ¡£</a></p><h4 id=csrfç›¸å…³è£…é¥°å™¨>csrfç›¸å…³è£…é¥°å™¨</h4><p><a class=link href=https://docs.djangoproject.com/zh-hans/3.1/ref/csrf/#module-django.views.decorators.csrf target=_blank rel=noopener>è£…é¥°å™¨æ–¹æ³•</a></p><p><a class=link href=https://docs.djangoproject.com/zh-hans/3.1/topics/class-based-views/intro/#id1 target=_blank rel=noopener>è£…é¥°ç±»</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>1. ç½‘ç«™æ•´ä½“éƒ½ä¸æ ¡éªŒcsrf å°±å•å•å‡ ä¸ªè§†å›¾å‡½æ•°éœ€è¦æ ¡éªŒ
</span></span></span><span class=line><span class=cl><span class=s2>2. ç½‘ç«™æ•´ä½“éƒ½æ ¡éªŒcsrf å°±å•å•å‡ ä¸ªè§†å›¾å‡½æ•°ä¸éœ€è¦æ ¡éªŒ
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>  csrf_exempt  - å¿½è§†æ ¡éªŒ
</span></span></span><span class=line><span class=cl><span class=s2>  csrf_protect - éœ€è¦æ ¡éªŒ 
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è§£å†³:Djangoæä¾›çš„è£…é¥°å™¨</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.views.decorators.csrf</span> <span class=kn>import</span> <span class=n>csrf_exempt</span><span class=p>,</span> <span class=n>csrf_protect</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># FBVç›´æ¥åŠ å¯¹åº”è£…é¥°å™¨å³å¯</span>
</span></span><span class=line><span class=cl><span class=c1># @csrf_exempt</span>
</span></span><span class=line><span class=cl><span class=nd>@csrf_protect</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>index</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># CBV</span>
</span></span><span class=line><span class=cl><span class=n>csrf_protect</span> <span class=o>-</span> <span class=n>å…¨å±€å¿½è§†</span> <span class=n>å±€éƒ¨éœ€è¦æ ¡éªŒ</span> <span class=o>-&gt;</span> <span class=n>ä½¿ç”¨CBVè£…é¥°å™¨çš„ä¸‰ç§æ–¹æ³•éƒ½å¯ä»¥</span>
</span></span><span class=line><span class=cl><span class=n>csrf_exempt</span>  <span class=o>-</span> <span class=n>å…¨å±€æ ¡éªŒ</span> <span class=n>å±€éƒ¨å¿½è§†æ ¡éªŒ</span> <span class=o>-&gt;</span> <span class=n>åªå¯ä»¥åŠ ç»™dispathæ–¹æ³•</span> <span class=n>æ‰æœ‰æ•ˆ</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@method_decorator</span><span class=p>(</span><span class=n>csrf_exempt</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=s1>&#39;dispath&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>MyIndex</span><span class=p>(</span><span class=n>View</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># @method_decorator(csrf_exempt)</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>dispath</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>dispath</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>post</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;POST&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=authæ¨¡å—>Authæ¨¡å—</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># åªè¦æ˜¯è·Ÿç”¨æˆ·ç›¸å…³çš„ç™»å½•ã€æ³¨å†Œã€æ£€éªŒã€ä¿®æ”¹å¯†ç ã€æ³¨é”€ã€éªŒè¯ç”¨æˆ·æ˜¯å¦ç™»å½• éƒ½èƒ½ç”¨è¯¥æ¨¡å—å®ç°</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>å…¶å®æˆ‘ä»¬åœ¨åˆ›å»ºå¥½ä¸€ä¸ªdjangoé¡¹ç›®ä¹‹å ç›´æ¥æ‰§è¡Œæ•°æ®åº“è¿ç§»å‘½ä»¤ ä¼šè‡ªåŠ¨ç”Ÿæˆå¾ˆå¤šè¡¨
</span></span></span><span class=line><span class=cl><span class=s2>  django_session
</span></span></span><span class=line><span class=cl><span class=s2>  auth_user  # ç”¨æˆ·è¡¨
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>djangoåœ¨å¯åŠ¨ä¹‹å å°±å¯ä»¥ç›´æ¥è®¿é—®adminè·¯ç”± éœ€è¦è¾“å…¥ç”¨æˆ·åå’Œå¯†ç  æ•°æ®å‚è€ƒçš„å°±æ˜¯auh_userè¡¨ å¹¶ä¸”è¿˜å¿…é¡»æ˜¯ç®¡ç†å‘˜æ‰èƒ½è¿›å…¥
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>åˆ›å»ºè¶…çº§ç”¨æˆ·(ç®¡ç†å‘˜)
</span></span></span><span class=line><span class=cl><span class=s2>   eatesuperuser
</span></span></span><span class=line><span class=cl><span class=s2>   
</span></span></span><span class=line><span class=cl><span class=s2>ä¾èµ–äºauth_userè¡¨å®Œæˆç”¨æˆ·ç›¸å…³çš„æ‰€æœ‰åŠŸèƒ½
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>ä½¿ç”¨authæ¨¡å— è¦ç”¨å°±ç”¨å…¨å¥— å°è£…çš„å¾ˆå¥½
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=å¸¸ç”¨æ–¹æ³•æ€»ç»“>å¸¸ç”¨æ–¹æ³•æ€»ç»“</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=mf>1.</span> <span class=n>æ¯”å¯¹ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦æ­£ç¡®</span>
</span></span><span class=line><span class=cl><span class=c1># æ‹¬å·å†…å¿…é¡»åŒæ—¶ä¼ å…¥ç”¨æˆ·åå’Œå¯†ç </span>
</span></span><span class=line><span class=cl><span class=n>user_obj</span> <span class=o>=</span> <span class=n>auth</span><span class=o>.</span><span class=n>authenticate</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=n>username</span><span class=o>=</span><span class=n>username</span><span class=p>,</span> <span class=n>password</span><span class=o>=</span><span class=n>password</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>user_obj</span><span class=p>)</span>  <span class=c1># ç”¨æˆ·å¯¹è±¡ æ•°æ®ä¸ç¬¦åˆè¿”å›None</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>user_obj</span><span class=o>.</span><span class=n>username</span><span class=p>)</span>  <span class=c1># minho</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>user_obj</span><span class=o>.</span><span class=n>password</span><span class=p>)</span>  <span class=c1># å¯†æ–‡</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>2.</span> <span class=n>ä¿å­˜ç”¨æˆ·çŠ¶æ€</span>
</span></span><span class=line><span class=cl><span class=n>auth</span><span class=o>.</span><span class=n>login</span><span class=p>(</span><span class=n>request</span><span class=p>,</span><span class=n>user_obj</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># ç±»ä¼¼äºreqeust.session[key] = user_obj</span>
</span></span><span class=line><span class=cl><span class=c1># åªè¦æ‰§è¡Œäº†è¯¥æ–¹æ³• ä½ å°±å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹é€šè¿‡request.userå°±èƒ½è·å–åˆ°å½“å‰ç™»å½•çš„ç”¨æˆ·å¯¹è±¡</span>
</span></span><span class=line><span class=cl><span class=c1># å®ƒè‡ªåŠ¨å»django_sessioné‡Œé¢æŸ¥æ‰¾å¯¹åº”çš„ç”¨æˆ·å¯¹è±¡ ç»™ä½ å°è£…åˆ°request.userä¸­</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>3.</span> <span class=n>åˆ¤æ–­å½“å‰ç”¨æˆ·æ˜¯å¦ç™»å½•</span>
</span></span><span class=line><span class=cl><span class=n>request</span><span class=o>.</span><span class=n>user</span><span class=o>.</span><span class=n>is_authenticated</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>4.</span> <span class=n>è·å–å½“å‰ç™»å½•ç”¨æˆ·</span>
</span></span><span class=line><span class=cl><span class=c1># è·å–ç”¨æˆ·å¯¹è±¡ æœªç™»å½•ï¼šAnonymousUser</span>
</span></span><span class=line><span class=cl><span class=n>request</span><span class=o>.</span><span class=n>user</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>5.</span> <span class=n>æ ¡éªŒç”¨æˆ·æ˜¯å¦ç™»å½•</span> <span class=o>-</span> <span class=n>è£…é¥°å™¨</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.contrib.auth.decorators</span> <span class=kn>import</span> <span class=n>login_required</span>
</span></span><span class=line><span class=cl><span class=c1># ä¸¤ç§ä½¿ç”¨æ–¹å¼</span>
</span></span><span class=line><span class=cl><span class=c1># å±€éƒ¨é…ç½®</span>
</span></span><span class=line><span class=cl><span class=nd>@login_required</span><span class=p>(</span><span class=n>login_url</span><span class=o>=</span><span class=s1>&#39;/login/&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># å…¨å±€é…ç½®</span>
</span></span><span class=line><span class=cl><span class=n>LOGIN_URL</span> <span class=o>=</span> <span class=s1>&#39;/login/&#39;</span>  <span class=c1># settings.py</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>6.</span> <span class=n>æ¯”å¯¹åŸå¯†ç </span>
</span></span><span class=line><span class=cl><span class=n>request</span><span class=o>.</span><span class=n>user</span><span class=o>.</span><span class=n>check_password</span><span class=p>(</span><span class=n>old_password</span><span class=p>)</span>  <span class=c1># è‡ªåŠ¨åŠ å¯†å¯¹æ¯”å¯†ç </span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>7.</span> <span class=n>ä¿®æ”¹å¯†ç </span>
</span></span><span class=line><span class=cl><span class=n>request</span><span class=o>.</span><span class=n>user</span><span class=o>.</span><span class=n>set_password</span><span class=p>(</span><span class=n>new_password</span><span class=p>)</span>  <span class=c1># è¿™æ­¥ä¸ä¼šå½±å“æ•°æ®åº“ ä»…ä»…æ˜¯åœ¨ä¿®æ”¹å¯¹è±¡çš„å±æ€§</span>
</span></span><span class=line><span class=cl><span class=n>request</span><span class=o>.</span><span class=n>user</span><span class=o>.</span><span class=n>save</span><span class=p>()</span>  <span class=c1># çœŸæ­£çš„æ“ä½œæ•°æ®åº“</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>8.</span> <span class=n>æ³¨é”€</span>
</span></span><span class=line><span class=cl><span class=n>auth</span><span class=o>.</span><span class=n>logout</span><span class=p>(</span><span class=n>request</span><span class=p>)</span>  <span class=c1># request.sessionè¡¨æ‰¾åˆ°ç™»å½•çš„å¯¹è±¡ ç±»ä¼¼ï¼šrequest.session.flush</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>9.</span> <span class=n>æ³¨å†Œ</span>
</span></span><span class=line><span class=cl><span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>create</span><span class=p>(</span><span class=n>username</span><span class=o>=</span><span class=n>username</span><span class=p>,</span> <span class=n>password</span><span class=o>=</span><span class=n>password</span><span class=p>)</span>  <span class=c1># å†™å…¥æ•°æ® ä¸èƒ½ä½¿ç”¨create å¯†ç æ²¡æœ‰åŠ å¯†å¤„ç† åé¢ä½¿ç”¨å¯†ç æ¯”å¯¹ request.user.check_password ä¼šå‡ºé”™</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># åˆ›å»ºæ™®é€šç”¨æˆ·</span>
</span></span><span class=line><span class=cl><span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>create_user</span><span class=p>(</span><span class=n>username</span><span class=o>=</span><span class=n>username</span><span class=p>,</span> <span class=n>password</span><span class=o>=</span><span class=n>password</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># åˆ›å»ºè¶…çº§ç”¨æˆ·(äº†è§£): ä½¿ç”¨ä»£ç åˆ›å»ºæŸ¥è¶…çº§ç”¨æˆ· é‚®ç®±å¿…å¡« å‘½ä»¤è¡Œåˆ›å»ºå¯ä»¥ä¸å¡«</span>
</span></span><span class=line><span class=cl><span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>create_superuser</span><span class=p>(</span><span class=n>username</span><span class=o>=</span><span class=n>username</span><span class=p>,</span> <span class=n>password</span><span class=o>=</span><span class=n>password</span><span class=p>,</span> <span class=n>email</span><span class=o>=</span><span class=s1>&#39;1234567@qq.com&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=å®Œæ•´ä»£ç ç¤ºä¾‹>å®Œæ•´ä»£ç ç¤ºä¾‹</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span><span class=lnt>93
</span><span class=lnt>94
</span><span class=lnt>95
</span><span class=lnt>96
</span><span class=lnt>97
</span><span class=lnt>98
</span><span class=lnt>99
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.shortcuts</span> <span class=kn>import</span> <span class=n>render</span><span class=p>,</span> <span class=n>HttpResponse</span><span class=p>,</span> <span class=n>redirect</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.contrib</span> <span class=kn>import</span> <span class=n>auth</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.contrib.auth.decorators</span> <span class=kn>import</span> <span class=n>login_required</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.contrib.auth.models</span> <span class=kn>import</span> <span class=n>User</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>hmac</span> <span class=kn>import</span> <span class=n>compare_digest</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>ä½¿ç”¨authæ¨¡å— è¦ç”¨å°±ç”¨å…¨å¥— å¦åˆ™ä¼šå‡ºä¸€äº›å¥‡æ€ªçš„é”™è¯¯
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>login</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;POST&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>username</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;username&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>password</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;password&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># å»ç”¨æˆ·è¡¨ä¸­æ ¡éªŒæ•°æ®</span>
</span></span><span class=line><span class=cl>        <span class=c1># 1. è¡¨å¦‚ä½•è·å–</span>
</span></span><span class=line><span class=cl>        <span class=c1># 2. å¯†ç å¦‚ä½•æ¯”å¯¹</span>
</span></span><span class=line><span class=cl>        <span class=n>user_obj</span> <span class=o>=</span> <span class=n>auth</span><span class=o>.</span><span class=n>authenticate</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=n>username</span><span class=o>=</span><span class=n>username</span><span class=p>,</span> <span class=n>password</span><span class=o>=</span><span class=n>password</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>user_obj</span><span class=p>)</span>  <span class=c1># ç”¨æˆ·å¯¹è±¡ æ•°æ®ä¸ç¬¦åˆè¿”å›None</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(user_obj.username)</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(user_obj.password)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>user_obj</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># ä¿å­˜ç”¨æˆ·çŠ¶æ€</span>
</span></span><span class=line><span class=cl>            <span class=n>auth</span><span class=o>.</span><span class=n>login</span><span class=p>(</span><span class=n>request</span><span class=p>,</span><span class=n>user_obj</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=c1># ç±»ä¼¼äºreqeust.session[key] = user_obj</span>
</span></span><span class=line><span class=cl>            <span class=c1># åªè¦æ‰§è¡Œäº†è¯¥æ–¹æ³• ä½ å°±å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹é€šè¿‡request.userå°±èƒ½è·å–åˆ°å½“å‰ç™»å½•çš„ç”¨æˆ·å¯¹è±¡</span>
</span></span><span class=line><span class=cl>            <span class=c1># å®ƒè‡ªåŠ¨å»django_sessioné‡Œé¢æŸ¥æ‰¾å¯¹åº”çš„ç”¨æˆ·å¯¹è±¡ ç»™ä½ å°è£…åˆ°request.userä¸­</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        authenticate
</span></span></span><span class=line><span class=cl><span class=s2>        1. è‡ªåŠ¨æŸ¥æ‰¾auth_useræ ‡ç­¾
</span></span></span><span class=line><span class=cl><span class=s2>        2. è‡ªåŠ¨ç»™å¯†ç åŠ å¯†å†æ¯”å¯¹
</span></span></span><span class=line><span class=cl><span class=s2>        è¯¥æ–¹æ³•æ³¨æ„äº‹é¡¹ï¼šæ‹¬å·å†…å¿…é¡»åŒæ—¶ä¼ å…¥ç”¨æˆ·åå’Œå¯†ç  ä¸èƒ½åªä¼ ç”¨æˆ·å(ä¸€æ­¥ç›´æ¥ç­›å‡ºç”¨æˆ·å¯¹è±¡ å¦åˆ™è¿˜éœ€è¦é€šè¿‡ç”¨æˆ·åå†å»æŸ¥æ‰¾å¯†ç  å†æ¯”å¯¹)
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=s1>&#39;login.html&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># @login_required(login_url=&#39;/app03/login/&#39;)  # å±€éƒ¨é…ç½®: ç”¨æˆ·æ²¡æœ‰ç™»å½•è·³è½¬åˆ°login_useråé¢æŒ‡å®šçš„ç½‘å€</span>
</span></span><span class=line><span class=cl><span class=nd>@login_required</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>home</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;ç”¨æˆ·ç™»å½•ä¹‹åæ‰èƒ½çœ‹home&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># è·å–ç”¨æˆ·å¯¹è±¡ æœªç™»å½•ï¼šAnonymousUser</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>user</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»å½•</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>user</span><span class=o>.</span><span class=n>is_authenticated</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;OK&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>å¦‚æœå±€éƒ¨å’Œå…¨å±€éƒ½æœ‰ å±€éƒ¨ä¼˜å…ˆ
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>å±€éƒ¨å’Œå…¨å±€å“ªä¸ªå¥½?
</span></span></span><span class=line><span class=cl><span class=s2>  å…¨å±€çš„å¥½å¤„åœ¨äº æ— éœ€é‡å¤å†™ä»£ç  ä½†æ˜¯è·³è½¬çš„é¡µé¢å´å¾ˆå•ä¸€
</span></span></span><span class=line><span class=cl><span class=s2>  å±€éƒ¨çš„å¥½å¤„åœ¨äº ä¸åŒçš„è§†å›¾å‡½æ•°åœ¨ç”¨æˆ·æ²¡æœ‰ç™»å½•çš„æƒ…å†µä¸‹å¯ä»¥è·³è½¬åˆ°ä¸åŒçš„é¡µé¢
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># @login_required(login_url=&#39;/app03/login/&#39;)</span>
</span></span><span class=line><span class=cl><span class=nd>@login_required</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>index</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>HttpResponse</span><span class=p>(</span><span class=s1>&#39;index&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@login_required</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>set_password</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;POST&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>old_password</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;old_password&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>new_password</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;new_password&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>confirm_password</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;confirm_password&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># å…ˆæ£€éªŒ2æ¬¡å¯†ç æ˜¯å¦ä¸€è‡´</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>new_password</span> <span class=o>==</span> <span class=n>confirm_password</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># æ ¡éªŒè€å¯†ç æ˜¯å¦å¯¹ä¸å¯¹</span>
</span></span><span class=line><span class=cl>            <span class=n>is_right</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>user</span><span class=o>.</span><span class=n>check_password</span><span class=p>(</span><span class=n>old_password</span><span class=p>)</span>  <span class=c1># è‡ªåŠ¨åŠ å¯†å¯¹æ¯”å¯†ç </span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>is_right</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1># ä¿®æ”¹å¯†ç </span>
</span></span><span class=line><span class=cl>                <span class=n>request</span><span class=o>.</span><span class=n>user</span><span class=o>.</span><span class=n>set_password</span><span class=p>(</span><span class=n>new_password</span><span class=p>)</span>  <span class=c1># ç›´åˆ°è¿™æ­¥ä¸ä¼šå½±å“æ•°æ®åº“ ä»…ä»…æ˜¯åœ¨ä¿®æ”¹å¯¹è±¡çš„å±æ€§</span>
</span></span><span class=line><span class=cl>                <span class=n>request</span><span class=o>.</span><span class=n>user</span><span class=o>.</span><span class=n>save</span><span class=p>()</span>  <span class=c1># çœŸæ­£çš„æ“ä½œæ•°æ®åº“</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=s1>&#39;/app03/login/&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=s1>&#39;set_password.html&#39;</span><span class=p>,</span> <span class=nb>locals</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@login_required</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>logout</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>auth</span><span class=o>.</span><span class=n>logout</span><span class=p>(</span><span class=n>request</span><span class=p>)</span>  <span class=c1># request.sessionè¡¨æ‰¾åˆ°ç™»å½•çš„å¯¹è±¡ ç±»ä¼¼ï¼šrequest.session.flush</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=s1>&#39;/app03/login/&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>register</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;POST&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>username</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;username&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>password</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;password&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>confirm_password</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;confirm_password&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># æ“ä½œauth_userè¡¨ å†™å…¥æ•°æ®</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>compare_digest</span><span class=p>(</span><span class=n>password</span><span class=p>,</span> <span class=n>confirm_password</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=c1># User.objects.create(username=username, password=password)  # å†™å…¥æ•°æ® ä¸èƒ½ä½¿ç”¨create å¯†ç æ²¡æœ‰åŠ å¯†å¤„ç†</span>
</span></span><span class=line><span class=cl>            <span class=c1># åˆ›å»ºæ™®é€šç”¨æˆ·</span>
</span></span><span class=line><span class=cl>            <span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>create_user</span><span class=p>(</span><span class=n>username</span><span class=o>=</span><span class=n>username</span><span class=p>,</span> <span class=n>password</span><span class=o>=</span><span class=n>password</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=c1># åˆ›å»ºè¶…çº§ç”¨æˆ·(äº†è§£): ä½¿ç”¨ä»£ç åˆ›å»ºæŸ¥è¶…çº§ç”¨æˆ· é‚®ç®±å¿…å¡« å‘½ä»¤è¡Œåˆ›å»ºå¯ä»¥ä¸å¡«</span>
</span></span><span class=line><span class=cl>            <span class=c1># User.objects.create_superuser(username=username, password=password, email=&#39;1234567@qq.com&#39;)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=s1>&#39;register.html&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=å¦‚ä½•æ‰©å±•auth_userè¡¨>å¦‚ä½•æ‰©å±•auth_userè¡¨</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.db</span> <span class=kn>import</span> <span class=n>models</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.contrib.auth.models</span> <span class=kn>import</span> <span class=n>User</span><span class=p>,</span> <span class=n>AbstractUser</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ‰©å±•auth_userè¡¨çš„ä¸¤ç§æ–¹å¼</span>
</span></span><span class=line><span class=cl><span class=c1># ç¬¬ä¸€ç§ï¼šä¸€å¯¹ä¸€å…³ç³» ä¸æ¨è</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>UserDetail</span><span class=p>(</span><span class=n>models</span><span class=o>.</span><span class=n>Model</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>phone</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>BigIntegerField</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>user</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>OneToOneField</span><span class=p>(</span><span class=n>to</span><span class=o>=</span><span class=s1>&#39;User&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ç¬¬äºŒç§ï¼šåˆ©ç”¨é¢å‘å¯¹è±¡çš„ç»§æ‰¿</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>UserInfo</span><span class=p>(</span><span class=n>AbstractUser</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    å¦‚æœç»§æ‰¿äº†AbstractUser
</span></span></span><span class=line><span class=cl><span class=s2>    é‚£ä¹ˆåœ¨æ‰§è¡Œæ•°æ®åº“è¿ç§»å‘½ä»¤çš„æ—¶å€™ auth_userè¡¨å°±ä¸ä¼šå†åˆ›å»ºå‡ºæ¥äº†
</span></span></span><span class=line><span class=cl><span class=s2>    è€ŒUserInfoè¡¨ä¸­ä¼šå‡ºç° auth_useræ‰€æœ‰çš„å­—æ®µå¤–åŠ è‡ªå·±æ‰©å±•çš„å­—æ®µ
</span></span></span><span class=line><span class=cl><span class=s2>    è¿™ä¹ˆåšçš„å¥½å¤„ï¼šåœ¨äºä½ èƒ½å¤Ÿç›´æ¥ç‚¹å‡»ä½ è‡ªå·±çš„è¡¨æ›´åŠ å¿«é€Ÿçš„å®Œæˆæ“ä½œåŠæ‰©å±•
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    å‰æï¼š
</span></span></span><span class=line><span class=cl><span class=s2>       1.åœ¨ç»§æ‰¿ä¹‹å‰æ²¡æœ‰æ‰§è¡Œè¿‡æ•°æ®åº“è¿ç§»å‘½ä»¤
</span></span></span><span class=line><span class=cl><span class=s2>          auth_useræ²¡æœ‰è¢«åˆ›å»ºå‡ºæ¥ - åœ¨æ•°æ®åº“è®¾è®¡é˜¶æ®µå°±è¦æ˜ç¡®éœ€ä¸éœ€è¦æ‰©å±•è¯¥å­—æ®µ
</span></span></span><span class=line><span class=cl><span class=s2>          å¦‚æœå½“å‰åº“å·²ç»åˆ›å»ºäº† é‚£ä¹ˆä½ å°±é‡æ–°æ¢ä¸€ä¸ªåº“
</span></span></span><span class=line><span class=cl><span class=s2>       2.ç»§æ‰¿çš„ç±»é‡Œé¢ ä¸è¦è¦†ç›–AbstractUseré‡Œé¢çš„å­—æ®µå
</span></span></span><span class=line><span class=cl><span class=s2>          è¡¨é‡Œé¢æœ‰çš„å­—æ®µä¸èƒ½åŠ¨ åªèƒ½é¢å¤–æ‰©å±•å­—æ®µ
</span></span></span><span class=line><span class=cl><span class=s2>       3.éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­å‘Šè¯‰django ä½ è¦ç”¨UserInfoæ›¿æ¢auth_user ***
</span></span></span><span class=line><span class=cl><span class=s2>          AUTH_USER_MODEL = &#39;app03.UserInfo&#39;  # åº”ç”¨å.è¡¨å ä¸è¦åŠ models
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>phone</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>BigIntegerField</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>ä½ å¦‚æœè‡ªå·±å†™è¡¨æ›¿ä»£äº†auth_user
</span></span></span><span class=line><span class=cl><span class=s2>é‚£ä¹ˆ authæ¨¡å—çš„åŠŸèƒ½è¿˜æ˜¯ç…§å¸¸ä½¿ç”¨ å‚è€ƒ
</span></span></span><span class=line><span class=cl><span class=s2>çš„è¡¨ä¹Ÿç”±åŸæ¥çš„auth_userå˜æˆäº†UserInfo
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=djangoç‰ˆæœ¬åŒºåˆ«>Djangoç‰ˆæœ¬åŒºåˆ«</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=mf>1.</span><span class=n>x</span> <span class=mf>2.</span><span class=n>x</span> <span class=mf>3.</span><span class=n>xåŒºåˆ«</span>
</span></span><span class=line><span class=cl><span class=mf>2.</span><span class=n>x</span> <span class=mf>3.</span><span class=n>x</span> <span class=n>å·®ä¸å¤š</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=è·¯ç”±å±‚-1>è·¯ç”±å±‚</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>1. django 1.x è·¯ç”±å±‚ä½¿ç”¨çš„æ˜¯urlæ–¹æ³•
</span></span></span><span class=line><span class=cl><span class=s2>   django 2.x 3.x è·¯ç”±å±‚ä½¿ç”¨çš„æ˜¯pathæ–¹æ³•
</span></span></span><span class=line><span class=cl><span class=s2>    - url() ç¬¬ä¸€ä¸ªå‚æ•°æ”¯æŒæ­£åˆ™
</span></span></span><span class=line><span class=cl><span class=s2>    - path() ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸æ”¯æŒæ­£åˆ™çš„ å†™ä»€ä¹ˆå°±åŒ¹é…ä»€ä¹ˆ
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>å¦‚æœä½ ä¸ä¹ æƒ¯ä½¿ç”¨path ä¹Ÿæä¾›äº†å¦ä¸€ä¸ªæ–¹æ³• re_path
</span></span></span><span class=line><span class=cl><span class=s2>from django.urls import re_path
</span></span></span><span class=line><span class=cl><span class=s2>from django.conf.urls import url  # å¯ä»¥ç»§ç»­ä½¿ç”¨url ä¸æ¨è
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>2.x 3.x é‡Œé¢çš„re_path() ç­‰ä»·äº1.xé‡Œé¢çš„url
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>2. è™½ç„¶pathä¸æ”¯æŒæ­£åˆ™ ä½†æ˜¯å®ƒçš„å†…éƒ¨æ”¯æŒ5ç§è½¬æ¢å™¨
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=pathè½¬æ¢å™¨>pathè½¬æ¢å™¨</h4><p><a class=link href=https://www.cnblogs.com/xiaoyuanqujing/articles/11642628.html target=_blank rel=noopener>åšå®¢å‚è€ƒ</a></p><ul><li><strong>ç¤ºä¾‹</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># å°†ç¬¬äºŒä¸ªè·¯ç”±é‡Œé¢çš„å†…å®¹å…ˆè½¬æˆæ•´å‹ ç„¶åä»¥å…³é”®å­—çš„å½¢å¼ä¼ é€’ç»™åé¢çš„è§†å›¾å‡½æ•°</span>
</span></span><span class=line><span class=cl><span class=n>path</span><span class=p>(</span><span class=s1>&#39;index/&lt;int:id&gt;/&#39;</span><span class=p>,</span> <span class=n>views</span><span class=o>.</span><span class=n>index</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>5ç§è½¬æ¢å™¨</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 5ç§è½¬æ¢å™¨</span>
</span></span><span class=line><span class=cl><span class=nb>str</span>    <span class=n>åŒ¹é…é™¤äº†è·¯å¾„åˆ†éš”ç¬¦</span><span class=err>ï¼ˆ</span><span class=o>/</span><span class=err>ï¼‰</span><span class=n>ä¹‹å¤–çš„éç©ºå­—ç¬¦ä¸²</span><span class=err>ï¼Œ</span><span class=n>è¿™æ˜¯é»˜è®¤çš„å½¢å¼</span>
</span></span><span class=line><span class=cl><span class=nb>int</span>    <span class=n>åŒ¹é…æ­£æ•´æ•°</span><span class=err>ï¼Œ</span><span class=n>åŒ…å«0</span>
</span></span><span class=line><span class=cl><span class=n>slug</span>   <span class=n>åŒ¹é…å­—æ¯</span><span class=err>ã€</span><span class=n>æ•°å­—ä»¥åŠæ¨ªæ </span><span class=err>ã€</span><span class=n>ä¸‹åˆ’çº¿ç»„æˆçš„å­—ç¬¦ä¸²</span>
</span></span><span class=line><span class=cl><span class=n>uuid</span>   <span class=n>åŒ¹é…æ ¼å¼åŒ–çš„uuid</span><span class=err>ï¼Œ</span><span class=n>å¦‚</span> <span class=mi>075194</span><span class=n>d3</span><span class=o>-</span><span class=mi>6885</span><span class=o>-</span><span class=mi>417</span><span class=n>e</span><span class=o>-</span><span class=n>a8a8</span><span class=o>-</span><span class=mi>6</span><span class=n>c931e272f00</span>
</span></span><span class=line><span class=cl><span class=n>path</span>   <span class=n>åŒ¹é…ä»»ä½•éç©ºå­—ç¬¦ä¸²</span> <span class=n>åŒ…å«äº†è·¯å¾„åˆ†éš”ç¬¦</span><span class=err>ï¼ˆ</span><span class=o>/</span><span class=err>ï¼‰ï¼ˆ</span><span class=n>ä¸èƒ½ç”¨</span><span class=err>ï¼Ÿï¼‰</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>è‡ªå®šä¹‰è½¬æ¢å™¨</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># é™¤äº†æœ‰é»˜è®¤çš„5ä¸ªè½¬æ¢å™¨ä¹‹å¤– è¿˜æ”¯æŒè‡ªå®šä¹‰è½¬æ¢å™¨</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>MonthConverter</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>regex</span><span class=o>=</span><span class=s1>&#39;\d</span><span class=si>{2}</span><span class=s1>&#39;</span> <span class=c1># å±æ€§åå¿…é¡»ä¸ºregex</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>to_python</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>value</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>int</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>to_url</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>value</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># åŒ¹é…çš„regexæ˜¯ä¸¤ä¸ªæ•°å­—ï¼Œè¿”å›çš„ç»“æœä¹Ÿå¿…é¡»æ˜¯ä¸¤ä¸ªæ•°å­—</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>value</span> 
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>è‡ªåŠ¨è½¬æ¢å™¨ä½¿ç”¨</strong></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.urls</span> <span class=kn>import</span> <span class=n>path</span><span class=p>,</span><span class=n>register_converter</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>app01.path_converts</span> <span class=kn>import</span> <span class=n>MonthConverter</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ³¨å†Œ</span>
</span></span><span class=line><span class=cl><span class=n>register_converter</span><span class=p>(</span><span class=n>MonthConverter</span><span class=p>,</span><span class=s1>&#39;mon&#39;</span><span class=p>)</span>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ä½¿ç”¨</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>app01</span> <span class=kn>import</span> <span class=n>views</span>
</span></span><span class=line><span class=cl><span class=n>urlpatterns</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=n>path</span><span class=p>(</span><span class=s1>&#39;articles/&lt;int:year&gt;/&lt;mon:month&gt;/&lt;slug:other&gt;/&#39;</span><span class=p>,</span> <span class=n>views</span><span class=o>.</span><span class=n>article_detail</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=s1>&#39;aaa&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ¨¡å‹å±‚-1>æ¨¡å‹å±‚</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>æ¨¡å‹å±‚é‡Œé¢1.xå¤–é”®é»˜è®¤éƒ½æ˜¯çº§è”æ›´æ–°åˆ é™¤çš„
</span></span></span><span class=line><span class=cl><span class=s2>ä½†æ˜¯åˆ°äº†2.xå’Œ3.xä¸­ éœ€è¦ä½ è‡ªå·±æ‰‹åŠ¨é…ç½®on_deleteå‚æ•°
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1.x</span>
</span></span><span class=line><span class=cl><span class=n>publish</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>ForeignKey</span><span class=p>(</span><span class=n>to</span><span class=o>=</span><span class=s1>&#39;Publish&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2.x 3.x</span>
</span></span><span class=line><span class=cl><span class=c1># å…·ä½“å‚æ•°å‚è€ƒå®˜ç½‘æ–‡æ¡£</span>
</span></span><span class=line><span class=cl><span class=n>publish</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>ForeignKey</span><span class=p>(</span><span class=n>to</span><span class=o>=</span><span class=s1>&#39;Publish&#39;</span><span class=p>,</span> <span class=n>on_delete</span><span class=o>=</span><span class=s1>&#39;xxx&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>on_deleteå‚æ•°è¡¥å……</strong></p><p><a class=link href=https://docs.djangoproject.com/zh-hans/3.1/ref/models/fields/#django.db.models.ForeignKey.on_delete target=_blank rel=noopener>ForeignKey.on_delete</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>on_delete</span><span class=o>=</span><span class=n>models</span><span class=o>.</span><span class=n>CASCADE</span><span class=p>,</span>     <span class=c1># åˆ é™¤å…³è”æ•°æ®,ä¸ä¹‹å…³è”ä¹Ÿåˆ é™¤</span>
</span></span><span class=line><span class=cl><span class=n>on_delete</span><span class=o>=</span><span class=n>models</span><span class=o>.</span><span class=n>DO_NOTHING</span><span class=p>,</span>  <span class=c1># åˆ é™¤å…³è”æ•°æ®,ä»€ä¹ˆä¹Ÿä¸åš</span>
</span></span><span class=line><span class=cl><span class=n>on_delete</span><span class=o>=</span><span class=n>models</span><span class=o>.</span><span class=n>PROTECT</span><span class=p>,</span>     <span class=c1># åˆ é™¤å…³è”æ•°æ®,å¼•å‘é”™è¯¯ProtectedError</span>
</span></span><span class=line><span class=cl><span class=n>on_delete</span><span class=o>=</span><span class=n>models</span><span class=o>.</span><span class=n>SET_NULL</span><span class=p>,</span>    <span class=c1># åˆ é™¤å…³è”æ•°æ®,ä¸ä¹‹å…³è”çš„å€¼è®¾ç½®ä¸ºnullï¼ˆå‰æè¯¥å­—æ®µéœ€è¦è®¾ç½®ä¸ºå¯ç©º,ä¸€å¯¹ä¸€åŒç†ï¼‰</span>
</span></span><span class=line><span class=cl><span class=n>on_delete</span><span class=o>=</span><span class=n>models</span><span class=o>.</span><span class=n>SET_DEFAULT</span><span class=p>,</span> <span class=c1># åˆ é™¤å…³è”æ•°æ®,ä¸ä¹‹å…³è”çš„å€¼è®¾ç½®ä¸ºé»˜è®¤å€¼ï¼ˆå‰æFKå­—æ®µéœ€è¦è®¾ç½®é»˜è®¤å€¼,ä¸€å¯¹ä¸€åŒç†ï¼‰</span>
</span></span><span class=line><span class=cl><span class=n>on_delete</span><span class=o>=</span><span class=n>models</span><span class=o>.</span><span class=n>SET</span><span class=p>(),</span>       <span class=c1># åˆ é™¤ä¹‹åæ‰§è¡Œä¸€ä¸ªå‡½æ•°</span>
</span></span><span class=line><span class=cl><span class=n>on_delete</span><span class=o>=</span><span class=n>RESTRICT</span><span class=p>,</span>           <span class=c1># New in Django 3.1.</span>
</span></span></code></pre></td></tr></table></div></div></section><footer class=article-footer><section class=article-tags><a href=/tags/python/>Python</a>
<a href=/tags/django/>Django</a>
<a href=/tags/web/>Web</a>
<a href=/tags/orm/>ORM</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>ç›¸å…³æ–‡ç« </h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/djangorestframework/><div class=article-details><h2 class=article-title>DjangoRESTframework</h2></div></a></article></div></div></aside><script src=https://utteranc.es/client.js repo=ilolicon/ilolicon.github.io issue-term=pathname crossorigin=anonymous async></script><style>.utterances{max-width:unset}</style><script>let utterancesLoaded=!1;function setUtterancesTheme(e){let t=document.querySelector(".utterances iframe");t&&t.contentWindow.postMessage({type:"set-theme",theme:`github-${e}`},"https://utteranc.es")}addEventListener("message",e=>{if(e.origin!=="https://utteranc.es")return;utterancesLoaded=!0,setUtterancesTheme(document.documentElement.dataset.scheme)}),window.addEventListener("onColorSchemeChange",e=>{if(!utterancesLoaded)return;setUtterancesTheme(e.detail)})</script><footer class=site-footer><section class=copyright>&copy;
2017 -
2025 ilolicon's Blog</section><section class=powerby>VicissitudeğŸ³<br>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.21.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>